<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="$lang$" xml:lang="$lang$"$if(dir)$ dir="$dir$"$endif$>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
$for(author-meta)$
  <meta name="author" content="$author-meta$" />
$endfor$
$if(date-meta)$
  <meta name="dcterms.date" content="$date-meta$" />
$endif$
$if(keywords)$
  <meta name="keywords" content="$for(keywords)$$keywords$$sep$, $endfor$" />
$endif$
  <title>$if(title-prefix)$$title-prefix$ – $endif$$pagetitle$</title>
  <link data-external="1" $-- data-external is needed to make sure pandoc does not
                          $-- download and integrate the bootstrap CSS file. If it
                          $-- would do so, it breaks bootstrap as the css refers to
                          $-- other files too that pandoc does not download.
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
    crossorigin="anonymous">
  <link data-external="1" rel="stylesheet"
     href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
</head>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
$if(quotes)$
      q { quotes: "“" "”" "‘" "’"; }
$endif$
  </style>
$if(highlighting-css)$
  <style type="text/css">
$highlighting-css$
  </style>
$endif$
$for(css)$
  <link rel="stylesheet" href="$css$" />
$endfor$
$if(math)$
  $math$
$endif$
$for(header-includes)$
  $header-includes$
$endfor$
</head>

<body>
$-- Implement the button row at the top of the screen.
<nav id="top-bar"
     class="navbar navbar-light bg-light">
  <div class="container-fluid">
    <div> $-- div is needed to keep the buttons in it next to each other.
    <a role="button"
      id="toggle-toc-button"
      class="btn btn-sm btn-outline-primary"
      data-bs-toggle="tooltip" data-bs-title="Toggle table-of-contents"
      data-bs-placement="bottom">
      <span class="navbar-toggler-icon"></span>
    </a>
    <a id="view-source-button"
      class="btn btn-sm btn-outline-primary" role="button"
      data-bs-placement="bottom"
      data-bs-toggle="tooltip" data-bs-title="Github repo"
      href="$github-repo$">
      <i class="bi bi-github"></i></a>
    <a id="view-source-button"
      class="btn btn-sm btn-outline-primary" role="button"
      data-bs-placement="bottom"
      data-bs-toggle="tooltip" data-bs-title="Suggest an edit"
      href="$github-edit-link$">
      <i class="bi bi-pen"></i></a>
    <span class="dropdown" id="share-dropdown">
      <button
        class="btn btn-outline-primary btn-sm dropdown-toggle"
        id="share-button"
        type="button" id="shareDropdownMenuButton"
        data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
        >
        <i class="bi bi-share-fill"></i></button>
      <div class="dropdown-menu" aria-labelledby="shareDropdownMenuButton">
        <a id="twitter-share-link" class="dropdown-item" href="#" target="_blank">Twitter</a>
        <a id="mastodon-share-link" class="dropdown-item" href="#" target="_blank">Mastodon</a>
        <a id="linkedin-share-link" class="dropdown-item" href="#" target="_blank">LinkedIn</a>
      </div>
    </span>
    </div>
    <a class="navbar-brand" href="#">LLSoftSecBook</a>
  </div>
</nav>

<div id="all-below-top-bar">
  <div class="container-fluid h-100">
    <div class="row h-100 d-flex justify-content-around">
$if(toc)$
  $-- show the TOC on the left hand side on xl screens and larger.
  $-- d-none d-xl-block: makes the toc sidebar only visible on xl screens.
  $-- h-100 -> make div same height as parent div (#all-below-top-bar here)
  <div id="toc-sidebar" class="h-100 d-none d-xl-block overflow-auto">
    $table-of-contents$
  </div>
$endif$

$-- start of the "main" column
<div id="main-content-col" class="h-100  d-flex justify-content-center overflow-auto">
  <div id="main-content-with-sidenotes" class="h-100">
  $-- max-width container for main content
  <div id="main-content-max-width" class="h-100">
$if(title)$
<header id="title-block-header">
  <h1 class="title">$title$</h1>
  $if(subtitle)$
    <p class="subtitle">$subtitle$</p>
  $endif$
  $for(author)$
    <p class="author">$author$</p>
  $endfor$
  $if(date)$
    <p class="date">$date$</p>
  $endif$
  <p>
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
    <img alt="Creative Commons License" style="border-width:0"
      src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>
    This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
      Creative Commons Attribution 4.0 International License</a>.
  </p>
  <p>
  $for(copyright)$
    $copyright.SPDX-FileCopyrightText$<br />
  $endfor$
  </p>
  <p>Version: $VERSION$</p>
</header>
$endif$

<main id="content">
$body$
</main>
</div> $-- max-width container for main content
</div> $-- main-content-with-sidenotes
</div> $-- main-content-col
</div> $-- container-fluid
</div> $-- end of the "all-below-top-bar" column

<script
  data-external="1"
  src="https://code.jquery.com/jquery-3.6.3.min.js"
  integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU="
  crossorigin="anonymous"></script>
<script
  data-external="1"
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
  crossorigin="anonymous"></script>
<script
  data-external="1"
  src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"/>

<script>
  function isXL() {
    var width = jQuery(window).width();
    return width>=1200;
  }

  jQuery(document).ready(function() {
    let toc_sidebar = jQuery('#toc-sidebar');
    let main_content_col = jQuery('#main-content-col');

    function setTocVisibility(visible) {
      if (visible) {
        toc_sidebar.removeClass("d-none");
        main_content_col.removeClass("without-tocsidebar");
        if (!isXL()) {
          // on a small screen, make the main content invisible
          // when the TOC is visible.
          main_content_col.addClass("d-none");
        }
      } else {
        toc_sidebar.addClass("d-none");
        // when the TOC is not visible, make the main container span the full
        // width of the screen. This makes sure that the scrollbar appears on
        // the far right hand side.
        main_content_col.removeClass("d-none");
        main_content_col.addClass("without-tocsidebar");
      }
    }

    // Toggle sidebar-toc visibility when the toggle button is clicked.
    jQuery('#toggle-toc-button').click(function() {
      if (toc_sidebar.hasClass("d-xl-block")) {
        // This is the first time the TOC toggler was clicked.
        toc_sidebar.removeClass("d-xl-block");
        // The screensize is smaller than xl -> make the TOC visible.
        // Otherwise, leave the d-none class to make the TOC invisible.
        setTocVisibility(!isXL());
      } else {
        let isVisibleNow = !toc_sidebar.hasClass("d-none");
        setTocVisibility(!isVisibleNow);
      }
    });

    // When the window resizes across the XL boundary, reset TOC
    // visibility to the default, i.e. adding classes d-none and d-xl-block.
    function reset_default_toc_visibility() {
      toc_sidebar.addClass("d-none");
      toc_sidebar.addClass("d-xl-block");
      main_content_col.removeClass("d-none");
      main_content_col.removeClass("without-tocsidebar");
    }

    let previousWindowSizeWasXL = isXL();
    jQuery(window).resize(function() {
      let is_XL = isXL();
      if (is_XL != previousWindowSizeWasXL) {
        previousWindowSizeWasXL = is_XL;
        reset_default_toc_visibility();
      }
    });

    // Also make the TOC sidebar invisible after clicking a link in it
    // when !iXL();
    jQuery('#toc-sidebar a').click(function(){
      if (!isXL()) {
        reset_default_toc_visibility();
      }
    });

    // Make links in the TOC be "secondary links". The result is that
    // they will be coloured grey, so will be less distracting.
    jQuery("#toc-sidebar a").addClass("link-secondary");

    // Make the share button work:
    // Use the web Share API where it is supported, on mobile devices,
    // where it hopefully allows the user to pick any suitable app they
    // have installed to share.
    let isTouchScreen = "ontouchstart" in document.documentElement;
    let useNativeShare = isTouchScreen && navigator.share;
    let shared_title = "$pagetitle$";
    let shared_url = "https://llsoftsec.github.io/llsoftsecbook";
    if (useNativeShare) {
      let share_button = jQuery('#share-button');
      share_button.click(function(){
        navigator.share({ title: shared_title, url: shared_url});
      });
      // Disable drop-down functionality of the share button.
      jQuery('#share-dropdown').removeClass('dropdown');
      share_button.removeClass('dropdown-toggle');
      share_button.removeAttr('data-bs-toggle');
      // and add tooltip to the button now that it's not a drop-down.
      share_button.attr("data-bs-placement", "bottom");
      share_button.attr("data-bs-toggle", "tooltip");
      share_button.attr("data-bs-title", "Share");
    };
    let twitter_params = { text: shared_title, url: shared_url,
                           hashtags: "llsoftsecbook" };
    jQuery("#twitter-share-link").attr("href",
      "https://twitter.com/intent/tweet?" + jQuery.param(twitter_params));
    jQuery("#linkedin-share-link").attr("href",
      "https://www.linkedin.com/sharing/share-offsite/?"
      + jQuery.param({url: shared_url}));
    jQuery("#mastodon-share-link").attr("href",
      "https://tootpick.org/#"
      + jQuery.param({text: shared_title + ' ' + shared_url
                            + ' #llsoftsecbook'}));


    // Needed to enable the bootstrap tooltips:
    if (!isTouchScreen) {
      let tooltipTriggerList =
        document.querySelectorAll('[data-bs-toggle="tooltip"]');
      let tooltipList = [...tooltipTriggerList].map(
        tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl,
                                                  {trigger : 'hover'}));
    }

    // Make sidenotes toggleable:
    jQuery('.sidenote_ref').click(function(){
      let sidenote_id = jQuery(this).attr("href");
      let sidenote = jQuery(sidenote_id);
      if (sidenote.css("display") == "none") {
        sidenote.css("display", "block");
      } else {
        sidenote.css("display", "none");
      }
    });
  });
</script>

</body>

</html>

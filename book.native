Pandoc
  Meta
    { unMeta =
        fromList
          [ ( "SPDX-License-Identifier"
            , MetaInlines [ Str "CC-BY-4.0" ]
            )
          , ( "VERSION" , MetaString "0-181-gc5e568a" )
          , ( "bibliography"
            , MetaList [ MetaInlines [ Str "book.bib" ] ]
            )
          , ( "colorlinks" , MetaBool True )
          , ( "copyright"
            , MetaList
                [ MetaMap
                    (fromList
                       [ ( "SPDX-FileCopyrightText"
                         , MetaInlines
                             [ Str "Copyright"
                             , Space
                             , Str "2021-2024"
                             , Space
                             , Str "Arm"
                             , Space
                             , Str "Limited"
                             , Space
                             , Link
                                 ( "" , [ "email" ] , [] )
                                 [ Str "open-source-office@arm.com" ]
                                 ( "mailto:open-source-office@arm.com"
                                 , ""
                                 )
                             ]
                         )
                       ])
                , MetaMap
                    (fromList
                       [ ( "SPDX-FileCopyrightText"
                         , MetaInlines
                             [ Str "Copyright"
                             , Space
                             , Str "2023"
                             , Space
                             , Str "Bill"
                             , Space
                             , Str "Wendling"
                             , Space
                             , Link
                                 ( "" , [ "email" ] , [] )
                                 [ Str "morbo@google.com" ]
                                 ( "mailto:morbo@google.com" , "" )
                             ]
                         )
                       ])
                , MetaMap
                    (fromList
                       [ ( "SPDX-FileCopyrightText"
                         , MetaInlines
                             [ Str "Copyright"
                             , Space
                             , Str "2023"
                             , Space
                             , Str "Lucian"
                             , Space
                             , Str "Popescu"
                             , Space
                             , Link
                                 ( "" , [ "email" ] , [] )
                                 [ Str "lucian.popescu187@gmail.com" ]
                                 ( "mailto:lucian.popescu187@gmail.com"
                                 , ""
                                 )
                             ]
                         )
                       ])
                ]
            )
          , ( "discord-server"
            , MetaInlines [ Str "https://discord.gg/Bm55Z9Ppgn" ]
            )
          , ( "documentclass" , MetaInlines [ Str "report" ] )
          , ( "github-edit-link"
            , MetaInlines
                [ Str
                    "https://github.com/llsoftsec/llsoftsecbook/edit/main/book.md"
                ]
            )
          , ( "github-repo"
            , MetaInlines
                [ Str "https://github.com/llsoftsec/llsoftsecbook" ]
            )
          , ( "header-includes"
            , MetaList
                [ MetaBlocks
                    [ RawBlock
                        (Format "latex")
                        "\\usepackage{makeidx}\n\\makeindex\n\\newcounter{TodoCounter}\n\\usepackage[backgroundcolor=white,linecolor=black]{todonotes}\n\\let\\oldtodo\\todo\n\\usepackage{bclogo}%  \\bcpanchant\n\\newcommand{\\todospan}[1]{\n  \\stepcounter{TodoCounter}\n  \\oldtodo[caption={\\arabic{TodoCounter}. #1}]{\\bcpanchant #1}\n}\n\\newcommand{\\tododiv}[1]{\n  \\stepcounter{TodoCounter}\n  \\oldtodo[inline,caption={\\arabic{TodoCounter}. #1}]{\\bcpanchant \\textit{#1}}\n}\n\\usepackage{caption}\n\\captionsetup[figure]{labelformat=empty}"
                    ]
                ]
            )
          , ( "link-citations" , MetaBool True )
          , ( "papersize" , MetaInlines [ Str "A4" ] )
          , ( "title"
            , MetaInlines
                [ Str "Low-Level"
                , Space
                , Str "Software"
                , Space
                , Str "Security"
                , Space
                , Str "for"
                , Space
                , Str "Compiler"
                , Space
                , Str "Developers"
                ]
            )
          ]
    }
  [ Header
      1 ( "introduction" , [] , [] ) [ Str "Introduction" ]
  , Para
      [ Str "Compilers,"
      , Space
      , Str "assemblers"
      , Space
      , Str "and"
      , Space
      , Str "similar"
      , Space
      , Str "tools"
      , Space
      , Str "generate"
      , Space
      , Str "all"
      , Space
      , Str "the"
      , Space
      , Str "binary"
      , Space
      , Str "code"
      , Space
      , Str "that"
      , SoftBreak
      , Str "processors"
      , Space
      , Str "execute."
      , Space
      , Str "It"
      , Space
      , Str "is"
      , Space
      , Str "no"
      , Space
      , Str "surprise"
      , Space
      , Str "then"
      , Space
      , Str "that"
      , Space
      , Str "these"
      , Space
      , Str "tools"
      , Space
      , Str "play"
      , Space
      , Str "a"
      , Space
      , Str "major"
      , Space
      , Str "role"
      , SoftBreak
      , Str "in"
      , Space
      , Str "security"
      , Space
      , Str "analysis"
      , Space
      , Str "and"
      , Space
      , Str "hardening"
      , Space
      , Str "of"
      , Space
      , Str "relevant"
      , Space
      , Str "binary"
      , Space
      , Str "code."
      ]
  , Para
      [ Str "Often"
      , Space
      , Str "the"
      , Space
      , Str "only"
      , Space
      , Str "practical"
      , Space
      , Str "way"
      , Space
      , Str "to"
      , Space
      , Str "protect"
      , Space
      , Str "all"
      , Space
      , Str "binaries"
      , Space
      , Str "with"
      , Space
      , Str "a"
      , Space
      , Str "particular"
      , Space
      , Str "security"
      , SoftBreak
      , Str "hardening"
      , Space
      , Str "method"
      , Space
      , Str "is"
      , Space
      , Str "to"
      , Space
      , Str "have"
      , Space
      , Str "the"
      , Space
      , Str "compiler"
      , Space
      , Str "do"
      , Space
      , Str "it."
      , Space
      , Str "And,"
      , Space
      , Str "with"
      , Space
      , Str "software"
      , Space
      , Str "security"
      , SoftBreak
      , Str "becoming"
      , Space
      , Str "more"
      , Space
      , Str "and"
      , Space
      , Str "more"
      , Space
      , Str "important"
      , Space
      , Str "in"
      , Space
      , Str "recent"
      , Space
      , Str "years,"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , Space
      , Str "no"
      , Space
      , Str "surprise"
      , Space
      , Str "to"
      , Space
      , Str "see"
      , Space
      , Str "an"
      , SoftBreak
      , Str "ever"
      , Space
      , Str "increasing"
      , Space
      , Str "variety"
      , Space
      , Str "of"
      , Space
      , Str "security"
      , Space
      , Str "hardening"
      , Space
      , Str "features"
      , Space
      , Str "and"
      , Space
      , Str "mitigations"
      , Space
      , Str "against"
      , SoftBreak
      , Str "vulnerabilities"
      , Space
      , Str "implemented"
      , Space
      , Str "in"
      , Space
      , Str "compilers."
      , Space
      , Str "Indeed,"
      , Space
      , Str "compared"
      , Space
      , Str "to"
      , Space
      , Str "a"
      , Space
      , Str "few"
      , Space
      , Str "decades"
      , SoftBreak
      , Str "ago,"
      , Space
      , Str "today\8217s"
      , Space
      , Str "compiler"
      , Space
      , Str "developer"
      , Space
      , Str "is"
      , Space
      , Str "much"
      , Space
      , Str "more"
      , Space
      , Str "likely"
      , Space
      , Str "to"
      , Space
      , Str "implement"
      , Space
      , Str "security"
      , SoftBreak
      , Str "features"
      , Space
      , Str "than"
      , Space
      , Str "not."
      ]
  , Para
      [ Str "Furthermore,"
      , Space
      , Str "with"
      , Space
      , Str "the"
      , Space
      , Str "ever-expanding"
      , Space
      , Str "range"
      , Space
      , Str "of"
      , Space
      , Str "techniques"
      , Space
      , Str "implemented,"
      , Space
      , Str "it\8217s"
      , Space
      , Str "very"
      , SoftBreak
      , Str "hard"
      , Space
      , Str "to"
      , Space
      , Str "gain"
      , Space
      , Str "a"
      , Space
      , Str "basic"
      , Space
      , Str "understanding"
      , Space
      , Str "of"
      , Space
      , Str "all"
      , Space
      , Str "security"
      , Space
      , Str "features"
      , Space
      , Str "implemented"
      , Space
      , Str "in"
      , SoftBreak
      , Str "typical"
      , Space
      , Str "compilers."
      ]
  , Para
      [ Str "This"
      , Space
      , Str "poses"
      , Space
      , Str "a"
      , Space
      , Str "practical"
      , Space
      , Str "problem:"
      , Space
      , Str "compiler"
      , Space
      , Str "developers"
      , Space
      , Str "must"
      , Space
      , Str "be"
      , Space
      , Str "able"
      , Space
      , Str "to"
      , Space
      , Str "work"
      , Space
      , Str "on"
      , SoftBreak
      , Str "security"
      , Space
      , Str "hardening"
      , Space
      , Str "features,"
      , Space
      , Str "yet"
      , Space
      , Str "it\8217s"
      , Space
      , Str "hard"
      , Space
      , Str "to"
      , Space
      , Str "gain"
      , Space
      , Str "a"
      , Space
      , Str "good,"
      , Space
      , Str "basic"
      , Space
      , Str "understanding"
      , SoftBreak
      , Str "of"
      , Space
      , Str "such"
      , Space
      , Str "compiler"
      , Space
      , Str "features."
      ]
  , Para
      [ Str "There"
      , Space
      , Str "are"
      , Space
      , Str "a"
      , Space
      , Str "lot"
      , Space
      , Str "of"
      , Space
      , Str "materials"
      , Space
      , Str "that"
      , Space
      , Str "explain"
      , Space
      , Str "individual"
      , Space
      , Str "vulnerabilities"
      , Space
      , Str "or"
      , Space
      , Str "attack"
      , SoftBreak
      , Str "vectors."
      , Space
      , Str "There"
      , Space
      , Str "are"
      , Space
      , Str "also"
      , Space
      , Str "lots"
      , Space
      , Str "of"
      , Space
      , Str "presentations"
      , Space
      , Str "explaining"
      , Space
      , Str "specific"
      , Space
      , Str "exploits."
      , SoftBreak
      , Str "But"
      , Space
      , Str "there"
      , Space
      , Str "seems"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "a"
      , Space
      , Str "limited"
      , Space
      , Str "set"
      , Space
      , Str "of"
      , Space
      , Str "materials"
      , Space
      , Str "that"
      , Space
      , Str "give"
      , Space
      , Str "a"
      , Space
      , Str "structured"
      , SoftBreak
      , Str "overview"
      , Space
      , Str "of"
      , Space
      , Str "all"
      , Space
      , Str "vulnerabilities"
      , Space
      , Str "and"
      , Space
      , Str "exploits"
      , Space
      , Str "against"
      , Space
      , Str "which"
      , Space
      , Str "a"
      , Space
      , Str "code"
      , Space
      , Str "generator"
      , SoftBreak
      , Str "plays"
      , Space
      , Str "a"
      , Space
      , Str "role"
      , Space
      , Str "in"
      , Space
      , Str "protecting."
      ]
  , Para
      [ Str "This"
      , Space
      , Str "book"
      , Space
      , Str "aims"
      , Space
      , Str "to"
      , Space
      , Str "provide"
      , Space
      , Str "such"
      , Space
      , Str "a"
      , Space
      , Str "structured,"
      , Space
      , Str "broad"
      , Space
      , Str "overview."
      , Space
      , Str "It"
      , Space
      , Str "does"
      , Space
      , Str "not"
      , SoftBreak
      , Str "necessarily"
      , Space
      , Str "go"
      , Space
      , Str "into"
      , Space
      , Str "full"
      , Space
      , Str "details,"
      , Space
      , Str "instead"
      , Space
      , Str "aiming"
      , Space
      , Str "to"
      , Space
      , Str "give"
      , Space
      , Str "a"
      , Space
      , Str "thorough"
      , Space
      , Str "description"
      , SoftBreak
      , Str "of"
      , Space
      , Str "all"
      , Space
      , Str "relevant"
      , Space
      , Str "high-level"
      , Space
      , Str "aspects"
      , Space
      , Str "of"
      , Space
      , Str "attacks,"
      , Space
      , Str "vulnerabilities,"
      , Space
      , Str "mitigations,"
      , SoftBreak
      , Str "and"
      , Space
      , Str "hardening"
      , Space
      , Str "techniques."
      , Space
      , Str "For"
      , Space
      , Str "further"
      , Space
      , Str "details,"
      , Space
      , Str "this"
      , Space
      , Str "book"
      , Space
      , Str "provides"
      , Space
      , Str "pointers"
      , Space
      , Str "to"
      , SoftBreak
      , Str "materials"
      , Space
      , Str "with"
      , Space
      , Str "more"
      , Space
      , Str "details"
      , Space
      , Str "on"
      , Space
      , Str "specific"
      , Space
      , Str "techniques."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "purpose"
      , Space
      , Str "of"
      , Space
      , Str "this"
      , Space
      , Str "book"
      , Space
      , Str "is"
      , Space
      , Str "to"
      , Space
      , Str "serve"
      , Space
      , Str "as"
      , Space
      , Str "a"
      , Space
      , Str "guide"
      , Space
      , Str "to"
      , Space
      , Str "every"
      , Space
      , Str "compiler"
      , Space
      , Str "developer"
      , SoftBreak
      , Str "that"
      , Space
      , Str "needs"
      , Space
      , Str "to"
      , Space
      , Str "learn"
      , Space
      , Str "about"
      , Space
      , Str "software"
      , Space
      , Str "security"
      , Space
      , Str "relevant"
      , Space
      , Str "to"
      , Space
      , Str "compilers."
      , Space
      , Str "Even"
      , Space
      , Str "though"
      , SoftBreak
      , Str "the"
      , Space
      , Str "focus"
      , Space
      , Str "is"
      , Space
      , Str "on"
      , Space
      , Str "compiler"
      , Space
      , Str "developers,"
      , Space
      , Str "we"
      , Space
      , Str "expect"
      , Space
      , Str "that"
      , Space
      , Str "this"
      , Space
      , Str "book"
      , Space
      , Str "will"
      , Space
      , Str "also"
      , Space
      , Str "be"
      , SoftBreak
      , Str "useful"
      , Space
      , Str "to"
      , Space
      , Str "people"
      , Space
      , Str "working"
      , Space
      , Str "on"
      , Space
      , Str "other"
      , Space
      , Str "low-level"
      , Space
      , Str "software."
      ]
  , Header
      2
      ( "why-an-open-source-book" , [] , [] )
      [ Str "Why"
      , Space
      , Str "an"
      , Space
      , Str "open"
      , Space
      , Str "source"
      , Space
      , Str "book?"
      ]
  , Para
      [ Str "The"
      , Space
      , Str "idea"
      , Space
      , Str "for"
      , Space
      , Str "this"
      , Space
      , Str "book"
      , Space
      , Str "emerged"
      , Space
      , Str "out"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "frustration"
      , Space
      , Str "of"
      , Space
      , Str "not"
      , Space
      , Str "finding"
      , Space
      , Str "a"
      , Space
      , Str "good"
      , SoftBreak
      , Str "overview"
      , Space
      , Str "on"
      , Space
      , Str "this"
      , Space
      , Str "topic."
      , Space
      , Str "Kristof"
      , Space
      , Str "Beyls"
      , Space
      , Str "and"
      , Space
      , Str "Georgia"
      , Space
      , Str "Kouveli,"
      , Space
      , Str "both"
      , Space
      , Str "compiler"
      , SoftBreak
      , Str "engineers"
      , Space
      , Str "working"
      , Space
      , Str "on"
      , Space
      , Str "security"
      , Space
      , Str "features,"
      , Space
      , Str "wished"
      , Space
      , Str "a"
      , Space
      , Str "book"
      , Space
      , Str "like"
      , Space
      , Str "this"
      , Space
      , Str "would"
      , Space
      , Str "exist."
      , SoftBreak
      , Str "After"
      , Space
      , Str "not"
      , Space
      , Str "finding"
      , Space
      , Str "such"
      , Space
      , Str "a"
      , Space
      , Str "book,"
      , Space
      , Str "they"
      , Space
      , Str "decided"
      , Space
      , Str "to"
      , Space
      , Str "try"
      , Space
      , Str "and"
      , Space
      , Str "write"
      , Space
      , Str "one"
      , Space
      , Str "themselves."
      , SoftBreak
      , Str "They"
      , Space
      , Str "immediately"
      , Space
      , Str "realized"
      , Space
      , Str "that"
      , Space
      , Str "they"
      , Space
      , Str "do"
      , Space
      , Str "not"
      , Space
      , Str "have"
      , Space
      , Str "all"
      , Space
      , Str "necessary"
      , Space
      , Str "expertise"
      , SoftBreak
      , Str "themselves"
      , Space
      , Str "to"
      , Space
      , Str "complete"
      , Space
      , Str "such"
      , Space
      , Str "a"
      , Space
      , Str "daunting"
      , Space
      , Str "task."
      , Space
      , Str "So"
      , Space
      , Str "they"
      , Space
      , Str "decided"
      , Space
      , Str "to"
      , Space
      , Str "try"
      , Space
      , Str "and"
      , Space
      , Str "create"
      , SoftBreak
      , Str "this"
      , Space
      , Str "book"
      , Space
      , Str "in"
      , Space
      , Str "an"
      , Space
      , Str "open"
      , Space
      , Str "source"
      , Space
      , Str "style,"
      , Space
      , Str "seeking"
      , Space
      , Str "contributions"
      , Space
      , Str "from"
      , Space
      , Str "many"
      , Space
      , Str "experts."
      ]
  , Para
      [ Str "As"
      , Space
      , Str "you"
      , Space
      , Str "read"
      , Space
      , Str "this,"
      , Space
      , Str "the"
      , Space
      , Str "book"
      , Space
      , Str "remains"
      , Space
      , Str "unfinished."
      , Space
      , Str "This"
      , Space
      , Str "book"
      , Space
      , Str "may"
      , Space
      , Str "well"
      , Space
      , Str "never"
      , Space
      , Str "be"
      , SoftBreak
      , Str "finished,"
      , Space
      , Str "as"
      , Space
      , Str "new"
      , Space
      , Str "vulnerabilities"
      , Space
      , Str "continue"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "discovered"
      , Space
      , Str "regularly."
      , Space
      , Str "Our"
      , Space
      , Str "hope"
      , SoftBreak
      , Str "is"
      , Space
      , Str "that"
      , Space
      , Str "developing"
      , Space
      , Str "the"
      , Space
      , Str "book"
      , Space
      , Str "as"
      , Space
      , Str "an"
      , Space
      , Str "open"
      , Space
      , Str "source"
      , Space
      , Str "project"
      , Space
      , Str "will"
      , Space
      , Str "allow"
      , Space
      , Str "for"
      , Space
      , Str "it"
      , Space
      , Str "to"
      , SoftBreak
      , Str "continue"
      , Space
      , Str "to"
      , Space
      , Str "evolve"
      , Space
      , Str "and"
      , Space
      , Str "improve."
      , Space
      , Str "The"
      , Space
      , Str "open"
      , Space
      , Str "source"
      , Space
      , Str "development"
      , Space
      , Str "process"
      , Space
      , Str "of"
      , Space
      , Str "this"
      , Space
      , Str "book"
      , SoftBreak
      , Str "increases"
      , Space
      , Str "the"
      , Space
      , Str "likelihood"
      , Space
      , Str "that"
      , Space
      , Str "it"
      , Space
      , Str "remains"
      , Space
      , Str "relevant"
      , Space
      , Str "as"
      , Space
      , Str "new"
      , Space
      , Str "vulnerabilities"
      , Space
      , Str "and"
      , SoftBreak
      , Str "mitigations"
      , Space
      , Str "emerge."
      ]
  , Para
      [ Str "Kristof"
      , Space
      , Str "and"
      , Space
      , Str "Georgia,"
      , Space
      , Str "the"
      , Space
      , Str "initial"
      , Space
      , Str "authors,"
      , Space
      , Str "are"
      , Space
      , Str "far"
      , Space
      , Str "from"
      , Space
      , Str "experts"
      , Space
      , Str "on"
      , Space
      , Str "all"
      , Space
      , Str "possible"
      , SoftBreak
      , Str "vulnerabilities."
      , Space
      , Str "So"
      , Space
      , Str "what"
      , Space
      , Str "is"
      , Space
      , Str "the"
      , Space
      , Str "plan"
      , Space
      , Str "to"
      , Space
      , Str "get"
      , Space
      , Str "high"
      , Space
      , Str "quality"
      , Space
      , Str "content"
      , Space
      , Str "to"
      , Space
      , Str "cover"
      , Space
      , Str "all"
      , SoftBreak
      , Str "relevant"
      , Space
      , Str "topics?"
      , Space
      , Str "It"
      , Space
      , Str "is"
      , Space
      , Str "two-fold."
      ]
  , Para
      [ Str "First,"
      , Space
      , Str "by"
      , Space
      , Str "studying"
      , Space
      , Str "specific"
      , Space
      , Str "topics,"
      , Space
      , Str "they"
      , Space
      , Str "hope"
      , Space
      , Str "to"
      , Space
      , Str "gain"
      , Space
      , Str "enough"
      , Space
      , Str "knowledge"
      , Space
      , Str "to"
      , Space
      , Str "write"
      , SoftBreak
      , Str "up"
      , Space
      , Str "a"
      , Space
      , Str "good"
      , Space
      , Str "summary"
      , Space
      , Str "for"
      , Space
      , Str "this"
      , Space
      , Str "book."
      ]
  , Para
      [ Str "Second,"
      , Space
      , Str "they"
      , Space
      , Str "very"
      , Space
      , Str "much"
      , Space
      , Str "invite"
      , Space
      , Str "and"
      , Space
      , Str "welcome"
      , Space
      , Str "contributions."
      , Space
      , Str "If"
      , Space
      , Str "you\8217re"
      , Space
      , Str "interested"
      , SoftBreak
      , Str "in"
      , Space
      , Str "potentially"
      , Space
      , Str "contributing"
      , Space
      , Str "content,"
      , Space
      , Str "please"
      , Space
      , Str "go"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "home"
      , Space
      , Str "location"
      , Space
      , Str "for"
      , Space
      , Str "the"
      , SoftBreak
      , Str "open"
      , Space
      , Str "source"
      , Space
      , Str "project"
      , Space
      , Str "at"
      , Space
      , Link
          ( "" , [ "uri" ] , [] )
          [ Str "https://github.com/llsoftsec/llsoftsecbook" ]
          ( "https://github.com/llsoftsec/llsoftsecbook" , "" )
      , Str "."
      ]
  , Para
      [ Str "As"
      , Space
      , Str "a"
      , Space
      , Str "reader,"
      , Space
      , Str "you"
      , Space
      , Str "can"
      , Space
      , Str "also"
      , Space
      , Str "contribute"
      , Space
      , Str "to"
      , Space
      , Str "making"
      , Space
      , Str "this"
      , Space
      , Str "book"
      , Space
      , Str "better."
      , Space
      , Str "We"
      , Space
      , Str "highly"
      , SoftBreak
      , Str "encourage"
      , Space
      , Str "feedback,"
      , Space
      , Str "both"
      , Space
      , Str "positive"
      , Space
      , Str "and"
      , Space
      , Str "constructive"
      , Space
      , Str "criticisms."
      , Space
      , Str "We"
      , Space
      , Str "prefer"
      , SoftBreak
      , Str "feedback"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "received"
      , Space
      , Str "through"
      , Space
      , Link
          ( "" , [ "uri" ] , [] )
          [ Str "https://github.com/llsoftsec/llsoftsecbook" ]
          ( "https://github.com/llsoftsec/llsoftsecbook" , "" )
      , Str "."
      ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "Add"
          , Space
          , Str "section"
          , Space
          , Str "describing"
          , Space
          , Str "the"
          , Space
          , Str "structure"
          , Space
          , Str "of"
          , Space
          , Str "the"
          , Space
          , Str "rest"
          , Space
          , Str "of"
          , Space
          , Str "the"
          , Space
          , Str "book."
          ]
      ]
  , Header
      1
      ( "memory-vulnerability-based-attacks" , [] , [] )
      [ Str "Memory"
      , Space
      , Str "vulnerability"
      , Space
      , Str "based"
      , Space
      , Str "attacks"
      ]
  , Header
      2
      ( "a-bit-of-background-on-memory-vulnerabilities"
      , []
      , []
      )
      [ Str "A"
      , Space
      , Str "bit"
      , Space
      , Str "of"
      , Space
      , Str "background"
      , Space
      , Str "on"
      , Space
      , Str "memory"
      , Space
      , Str "vulnerabilities"
      ]
  , Para
      [ Str "Memory"
      , Space
      , Str "access"
      , Space
      , Str "errors"
      , Space
      , Str "describe"
      , Space
      , Str "memory"
      , Space
      , Str "accesses"
      , Space
      , Str "that,"
      , Space
      , Str "although"
      , Space
      , Str "permitted"
      , Space
      , Str "by"
      , Space
      , Str "a"
      , SoftBreak
      , Str "program,"
      , Space
      , Str "were"
      , Space
      , Str "not"
      , Space
      , Str "intended"
      , Space
      , Str "by"
      , Space
      , Str "the"
      , Space
      , Str "programmer."
      , Space
      , Str "These"
      , Space
      , Str "types"
      , Space
      , Str "of"
      , Space
      , Str "errors"
      , Space
      , Str "are"
      , Space
      , Str "usually"
      , SoftBreak
      , Str "defined"
      , Space
      , Cite
          [ Citation
              { citationId = "Hicks2014"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 1
              , citationHash = 0
              }
          ]
          [ Str "[@Hicks2014]" ]
      , Space
      , Str "by"
      , Space
      , Str "explicitly"
      , Space
      , Str "listing"
      , Space
      , Str "their"
      , Space
      , Str "types,"
      , Space
      , Str "which"
      , Space
      , Str "include:"
      ]
  , BulletList
      [ [ Plain [ Str "buffer" , Space , Str "overflow" ] ]
      , [ Plain
            [ Str "null"
            , Space
            , Str "pointer"
            , Space
            , Str "dereference"
            ]
        ]
      , [ Plain
            [ Str "use" , Space , Str "after" , Space , Str "free" ]
        ]
      , [ Plain
            [ Str "use"
            , Space
            , Str "of"
            , Space
            , Str "uninitialized"
            , Space
            , Str "memory"
            ]
        ]
      , [ Plain [ Str "illegal" , Space , Str "free" ] ]
      ]
  , Para
      [ Str "Memory"
      , Space
      , Str "vulnerabilities"
      , Space
      , Str "are"
      , Space
      , Str "an"
      , Space
      , Str "important"
      , Space
      , Str "class"
      , Space
      , Str "of"
      , Space
      , Str "vulnerabilities"
      , Space
      , Str "that"
      , Space
      , Str "arise"
      , Space
      , Str "due"
      , SoftBreak
      , Str "to"
      , Space
      , Str "these"
      , Space
      , Str "types"
      , Space
      , Str "of"
      , Space
      , Str "errors,"
      , Space
      , Str "and"
      , Space
      , Str "they"
      , Space
      , Str "most"
      , Space
      , Str "commonly"
      , Space
      , Str "occur"
      , Space
      , Str "due"
      , Space
      , Str "to"
      , Space
      , Str "programming"
      , SoftBreak
      , Str "mistakes"
      , Space
      , Str "when"
      , Space
      , Str "using"
      , Space
      , Str "languages"
      , Space
      , Str "such"
      , Space
      , Str "as"
      , Space
      , Str "C/C++"
      , Space
      , RawInline (Format "tex") "\\index{C}"
      , RawInline (Format "tex") "\\index{C++}"
      , Str "."
      , Space
      , Str "These"
      , SoftBreak
      , Str "languages"
      , Space
      , Str "do"
      , Space
      , Str "not"
      , Space
      , Str "provide"
      , Space
      , Str "mechanisms"
      , Space
      , Str "to"
      , Space
      , Str "protect"
      , Space
      , Str "against"
      , Space
      , Str "memory"
      , Space
      , Str "access"
      , Space
      , Str "errors"
      , Space
      , Str "by"
      , SoftBreak
      , Str "default."
      , Space
      , Str "An"
      , Space
      , Str "attacker"
      , Space
      , Str "can"
      , Space
      , Str "exploit"
      , Space
      , Str "such"
      , Space
      , Str "vulnerabilities"
      , Space
      , Str "to"
      , Space
      , Str "leak"
      , Space
      , Str "sensitive"
      , Space
      , Str "data"
      , Space
      , Str "or"
      , SoftBreak
      , Str "overwrite"
      , Space
      , Str "critical"
      , Space
      , Str "memory"
      , Space
      , Str "locations"
      , Space
      , Str "and"
      , Space
      , Str "gain"
      , Space
      , Str "control"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "vulnerable"
      , Space
      , Str "program."
      ]
  , Para
      [ Str "Memory"
      , Space
      , Str "vulnerabilities"
      , Space
      , Str "have"
      , Space
      , Str "a"
      , Space
      , Str "long"
      , Space
      , Str "history."
      , Space
      , Str "The"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "Morris" , SoftBreak , Str "worm" ]
          ( "https://en.wikipedia.org/wiki/Morris_worm" , "" )
      , Space
      , Str "in"
      , Space
      , Str "1988"
      , Space
      , Str "was"
      , Space
      , Str "the"
      , Space
      , Str "first"
      , Space
      , Str "widely"
      , SoftBreak
      , Str "publicized"
      , Space
      , Str "attack"
      , Space
      , Str "exploiting"
      , Space
      , Str "a"
      , Space
      , Str "buffer"
      , Space
      , Str "overflow."
      , Space
      , Str "Later,"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "mid-90s,"
      , Space
      , Str "a"
      , Space
      , Str "few"
      , SoftBreak
      , Str "famous"
      , Space
      , Str "write-ups"
      , Space
      , Str "describing"
      , Space
      , Str "buffer"
      , Space
      , Str "overflows"
      , Space
      , Str "appeared"
      , Space
      , Cite
          [ Citation
              { citationId = "AlephOne1996"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 2
              , citationHash = 0
              }
          ]
          [ Str "[@AlephOne1996]" ]
      , Str "."
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "Stack"
          , SoftBreak
          , Str "buffer"
          , Space
          , Str "overflows"
          ]
          ( "#stack-buffer-overflows" , "" )
      , Space
      , Str "were"
      , Space
      , Str "mitigated"
      , Space
      , Str "with"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "stack" , SoftBreak , Str "canaries" ]
          ( "#stack-buffer-overflows" , "" )
      , Space
      , Str "and"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "non-executable" , SoftBreak , Str "stacks" ]
          ( "#stack-buffer-overflows" , "" )
      , Str "."
      , Space
      , Str "The"
      , Space
      , Str "answer"
      , Space
      , Str "was"
      , Space
      , Str "more"
      , Space
      , Str "ingenious"
      , Space
      , Str "ways"
      , Space
      , Str "to"
      , Space
      , Str "bypass"
      , SoftBreak
      , Str "these"
      , Space
      , Str "mitigations:"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "code" , Space , Str "reuse" , Space , Str "attacks" ]
          ( "#code-reuse-attacks" , "" )
      , Str ","
      , Space
      , Str "starting"
      , Space
      , Str "with"
      , SoftBreak
      , Str "attacks"
      , Space
      , Str "like"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "return-into-libc" ]
          ( "#code-reuse-attacks" , "" )
      , Space
      , Cite
          [ Citation
              { citationId = "Solar1997"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 3
              , citationHash = 0
              }
          ]
          [ Str "[@Solar1997]" ]
      , Str "."
      , Space
      , Str "Code"
      , Space
      , Str "reuse"
      , SoftBreak
      , Str "attacks"
      , Space
      , Str "later"
      , Space
      , Str "evolved"
      , Space
      , Str "to"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "Return-Oriented"
          , Space
          , Str "Programming"
          , SoftBreak
          , Str "(ROP)"
          ]
          ( "#return-oriented-programming" , "" )
      , Space
      , Cite
          [ Citation
              { citationId = "Shacham2007"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 4
              , citationHash = 0
              }
          ]
          [ Str "[@Shacham2007]" ]
      , Space
      , Str "and"
      , Space
      , Str "even"
      , Space
      , Str "more"
      , Space
      , Str "complex"
      , SoftBreak
      , Str "techniques."
      ]
  , Para
      [ Str "To"
      , Space
      , Str "defend"
      , Space
      , Str "against"
      , Space
      , Str "code"
      , Space
      , Str "reuse"
      , Space
      , Str "attacks,"
      , Space
      , Str "the"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "Address"
          , Space
          , Str "Space"
          , Space
          , Str "Layout"
          , Space
          , Str "Randomization"
          , SoftBreak
          , Str "(ASLR)"
          ]
          ( "#aslr" , "" )
      , Space
      , Str "and"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "Control-Flow"
          , Space
          , Str "Integrity"
          , Space
          , Str "(CFI)"
          ]
          ( "#cfi" , "" )
      , Space
      , Str "measures"
      , Space
      , Str "were"
      , SoftBreak
      , Str "introduced."
      , Space
      , Str "This"
      , Space
      , Str "interaction"
      , Space
      , Str "between"
      , Space
      , Str "offensive"
      , Space
      , Str "and"
      , Space
      , Str "defensive"
      , Space
      , Str "security"
      , Space
      , Str "research"
      , SoftBreak
      , Str "has"
      , Space
      , Str "been"
      , Space
      , Str "essential"
      , Space
      , Str "to"
      , Space
      , Str "improving"
      , Space
      , Str "security,"
      , Space
      , Str "and"
      , Space
      , Str "continues"
      , Space
      , Str "to"
      , Space
      , Str "this"
      , Space
      , Str "day."
      , Space
      , Str "Each"
      , Space
      , Str "newly"
      , SoftBreak
      , Str "deployed"
      , Space
      , Str "mitigation"
      , Space
      , Str "results"
      , Space
      , Str "in"
      , Space
      , Str "attempts,"
      , Space
      , Str "often"
      , Space
      , Str "successful,"
      , Space
      , Str "to"
      , Space
      , Str "bypass"
      , Space
      , Str "it,"
      , Space
      , Str "or"
      , Space
      , Str "in"
      , SoftBreak
      , Str "alternative,"
      , Space
      , Str "more"
      , Space
      , Str "complex"
      , Space
      , Str "exploitation"
      , Space
      , Str "techniques,"
      , Space
      , Str "and"
      , Space
      , Str "even"
      , Space
      , Str "tools"
      , Space
      , Str "to"
      , Space
      , Str "automate"
      , SoftBreak
      , Str "them."
      ]
  , Para
      [ Str "Memory"
      , Space
      , Str "safe"
      , Space
      , Cite
          [ Citation
              { citationId = "Hicks2014"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 5
              , citationHash = 0
              }
          ]
          [ Str "[@Hicks2014]" ]
      , Space
      , Str "languages"
      , Space
      , Str "are"
      , Space
      , Str "designed"
      , Space
      , Str "with"
      , Space
      , Str "prevention"
      , Space
      , Str "of"
      , Space
      , Str "such"
      , SoftBreak
      , Str "vulnerabilities"
      , Space
      , Str "in"
      , Space
      , Str "mind"
      , Space
      , Str "and"
      , Space
      , Str "use"
      , Space
      , Str "techniques"
      , Space
      , Str "such"
      , Space
      , Str "as"
      , Space
      , Str "bounds"
      , Space
      , Str "checking"
      , Space
      , Str "and"
      , SoftBreak
      , Str "automatic"
      , Space
      , Str "memory"
      , Space
      , Str "management."
      , Space
      , Str "If"
      , Space
      , Str "these"
      , Space
      , Str "languages"
      , Space
      , Str "promise"
      , Space
      , Str "to"
      , Space
      , Str "eliminate"
      , SoftBreak
      , Str "memory"
      , Space
      , Str "vulnerabilities,"
      , Space
      , Str "why"
      , Space
      , Str "are"
      , Space
      , Str "we"
      , Space
      , Str "still"
      , Space
      , Str "discussing"
      , Space
      , Str "this"
      , Space
      , Str "topic?"
      ]
  , Para
      [ Str "On"
      , Space
      , Str "the"
      , Space
      , Str "one"
      , Space
      , Str "hand,"
      , Space
      , Str "C"
      , Space
      , Str "and"
      , Space
      , Str "C++"
      , Space
      , RawInline (Format "tex") "\\index{C}"
      , RawInline (Format "tex") "\\index{C++}"
      , Space
      , Str "remain"
      , Space
      , Str "very"
      , Space
      , Str "popular"
      , Space
      , Str "languages,"
      , SoftBreak
      , Str "particularly"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "implementation"
      , Space
      , Str "of"
      , Space
      , Str "low-level"
      , Space
      , Str "software."
      , Space
      , Str "On"
      , Space
      , Str "the"
      , Space
      , Str "other"
      , Space
      , Str "hand,"
      , SoftBreak
      , Str "programs"
      , Space
      , Str "written"
      , Space
      , Str "in"
      , Space
      , Str "memory"
      , Space
      , Str "safe"
      , Space
      , Str "languages"
      , Space
      , Str "can"
      , Space
      , Str "themselves"
      , Space
      , Str "be"
      , Space
      , Str "vulnerable"
      , Space
      , Str "to"
      , SoftBreak
      , Str "memory"
      , Space
      , Str "errors"
      , Space
      , Str "as"
      , Space
      , Str "a"
      , Space
      , Str "result"
      , Space
      , Str "of"
      , Space
      , Str "bugs"
      , Space
      , Str "in"
      , Space
      , Str "how"
      , Space
      , Str "they"
      , Space
      , Str "are"
      , Space
      , Str "implemented,"
      , Space
      , Str "e.g.\160a"
      , Space
      , Str "bug"
      , Space
      , Str "in"
      , SoftBreak
      , Str "their"
      , Space
      , Str "compiler."
      , Space
      , Str "Can"
      , Space
      , Str "we"
      , Space
      , Str "fix"
      , Space
      , Str "the"
      , Space
      , Str "problem"
      , Space
      , Str "by"
      , Space
      , Str "also"
      , Space
      , Str "using"
      , Space
      , Str "memory"
      , Space
      , Str "safe"
      , Space
      , Str "languages"
      , Space
      , Str "for"
      , SoftBreak
      , Str "the"
      , Space
      , Str "compiler"
      , Space
      , Str "and"
      , Space
      , Str "runtime"
      , Space
      , Str "implementation?"
      , Space
      , Str "Even"
      , Space
      , Str "if"
      , Space
      , Str "that"
      , Space
      , Str "were"
      , Space
      , Str "as"
      , Space
      , Str "simple"
      , Space
      , Str "as"
      , Space
      , Str "it"
      , SoftBreak
      , Str "sounds,"
      , Space
      , Str "unfortunately"
      , Space
      , Str "there"
      , Space
      , Str "are"
      , Space
      , Str "types"
      , Space
      , Str "of"
      , Space
      , Str "programming"
      , Space
      , Str "errors"
      , Space
      , Str "that"
      , Space
      , Str "these"
      , SoftBreak
      , Str "languages"
      , Space
      , Str "cannot"
      , Space
      , Str "protect"
      , Space
      , Str "against."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "a"
      , Space
      , Str "logical"
      , Space
      , Str "error"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , SoftBreak
      , Str "implementation"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "compiler"
      , Space
      , Str "or"
      , Space
      , Str "runtime"
      , Space
      , Str "for"
      , Space
      , Str "a"
      , Space
      , Str "memory"
      , Space
      , Str "safe"
      , Space
      , Str "language"
      , Space
      , Str "can"
      , Space
      , Str "lead"
      , Space
      , Str "to"
      , SoftBreak
      , Str "a"
      , Space
      , Str "memory"
      , Space
      , Str "access"
      , Space
      , Str "error"
      , Space
      , Str "not"
      , Space
      , Str "being"
      , Space
      , Str "detected."
      , Space
      , Str "We"
      , Space
      , Str "will"
      , Space
      , Str "see"
      , Space
      , Str "examples"
      , Space
      , Str "of"
      , Space
      , Str "such"
      , Space
      , Str "logic"
      , SoftBreak
      , Str "errors"
      , Space
      , Str "in"
      , Space
      , Str "compiler"
      , Space
      , Str "optimizations"
      , Space
      , Str "in"
      , Space
      , Str "a"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "later" , SoftBreak , Str "section" ]
          ( "#jit-compiler-vulnerabilities" , "" )
      , Str "."
      ]
  , Para
      [ Str "Given"
      , Space
      , Str "the"
      , Space
      , Str "rich"
      , Space
      , Str "history"
      , Space
      , Str "of"
      , Space
      , Str "memory"
      , Space
      , Str "vulnerabilities"
      , Space
      , Str "and"
      , Space
      , Str "mitigations"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , Space
      , Str "active"
      , SoftBreak
      , Str "developments"
      , Space
      , Str "in"
      , Space
      , Str "this"
      , Space
      , Str "area,"
      , Space
      , Str "compiler"
      , Space
      , Str "developers"
      , Space
      , Str "are"
      , Space
      , Str "likely"
      , Space
      , Str "to"
      , Space
      , Str "encounter"
      , Space
      , Str "some"
      , Space
      , Str "of"
      , SoftBreak
      , Str "these"
      , Space
      , Str "issues"
      , Space
      , Str "over"
      , Space
      , Str "the"
      , Space
      , Str "course"
      , Space
      , Str "of"
      , Space
      , Str "their"
      , Space
      , Str "careers."
      , Space
      , Str "This"
      , Space
      , Str "chapter"
      , Space
      , Str "aims"
      , Space
      , Str "to"
      , Space
      , Str "serve"
      , Space
      , Str "as"
      , Space
      , Str "an"
      , SoftBreak
      , Str "introduction"
      , Space
      , Str "to"
      , Space
      , Str "this"
      , Space
      , Str "area."
      , Space
      , Str "We"
      , Space
      , Str "start"
      , Space
      , Str "with"
      , Space
      , Str "a"
      , Space
      , Str "discussion"
      , Space
      , Str "of"
      , Space
      , Str "exploitation"
      , SoftBreak
      , Str "primitives,"
      , Space
      , Str "which"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "useful"
      , Space
      , Str "when"
      , Space
      , Str "analyzing"
      , Space
      , Str "threat"
      , Space
      , Str "models"
      , Space
      , Span
          ( "" , [ "todo" ] , [] )
          [ Str "Discuss"
          , Space
          , Str "threat"
          , SoftBreak
          , Str "models"
          , Space
          , Str "elsewhere"
          , Space
          , Str "in"
          , Space
          , Str "book"
          , Space
          , Str "and"
          , Space
          , Str "refer"
          , Space
          , Str "to"
          , Space
          , Str "that"
          , Space
          , Str "section"
          , Space
          , Str "here"
          , Space
          , Span ( "" , [ "issue" ] , [] ) [ Str "161" ]
          ]
      , Str "."
      , SoftBreak
      , Str "We"
      , Space
      , Str "then"
      , Space
      , Str "continue"
      , Space
      , Str "with"
      , Space
      , Str "a"
      , Space
      , Str "more"
      , Space
      , Str "detailed"
      , Space
      , Str "discussion"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "various"
      , Space
      , Str "types"
      , Space
      , Str "of"
      , SoftBreak
      , Str "vulnerabilities,"
      , Space
      , Str "along"
      , Space
      , Str "with"
      , Space
      , Str "their"
      , Space
      , Str "mitigations,"
      , Space
      , Str "presented"
      , Space
      , Str "in"
      , Space
      , Str "a"
      , Space
      , Str "rough"
      , SoftBreak
      , Str "chronological"
      , Space
      , Str "order"
      , Space
      , Str "of"
      , Space
      , Str "their"
      , Space
      , Str "appearance,"
      , Space
      , Str "and,"
      , Space
      , Str "therefore,"
      , Space
      , Str "complexity."
      ]
  , Header
      2
      ( "exploitation-primitives" , [] , [] )
      [ Str "Exploitation" , Space , Str "primitives" ]
  , Para
      [ Str "Newcomers"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "area"
      , Space
      , Str "of"
      , Space
      , Str "software"
      , Space
      , Str "security"
      , Space
      , Str "may"
      , Space
      , Str "find"
      , Space
      , Str "themselves"
      , Space
      , Str "lost"
      , Space
      , Str "in"
      , Space
      , Str "many"
      , SoftBreak
      , Str "blog"
      , Space
      , Str "posts"
      , Space
      , Str "and"
      , Space
      , Str "other"
      , Space
      , Str "publications"
      , Space
      , Str "describing"
      , Space
      , Str "specific"
      , Space
      , Str "memory"
      , SoftBreak
      , Str "vulnerabilities"
      , Space
      , Str "and"
      , Space
      , Str "how"
      , Space
      , Str "to"
      , Space
      , Str "exploit"
      , Space
      , Str "them."
      , Space
      , Str "Two"
      , Space
      , Str "very"
      , Space
      , Str "common,"
      , Space
      , Str "yet"
      , Space
      , Str "unfamiliar"
      , Space
      , Str "to"
      , Space
      , Str "a"
      , SoftBreak
      , Str "newcomer,"
      , Space
      , Str "terms"
      , Space
      , Str "that"
      , Space
      , Str "appear"
      , Space
      , Str "in"
      , Space
      , Str "such"
      , Space
      , Str "publications"
      , Space
      , Str "are"
      , Space
      , Emph [ Str "read" , Space , Str "primitive" ]
      , Space
      , Str "and"
      , SoftBreak
      , Emph [ Str "write" , Space , Str "primitive" ]
      , Str "."
      , Space
      , Str "In"
      , Space
      , Str "order"
      , Space
      , Str "to"
      , Space
      , Str "understand"
      , Space
      , Str "memory"
      , Space
      , Str "vulnerabilities"
      , Space
      , Str "and"
      , Space
      , Str "be"
      , Space
      , Str "able"
      , Space
      , Str "to"
      , SoftBreak
      , Str "design"
      , Space
      , Str "effective"
      , Space
      , Str "mitigations,"
      , Space
      , Str "it\8217s"
      , Space
      , Str "important"
      , Space
      , Str "to"
      , Space
      , Str "understand"
      , Space
      , Str "what"
      , Space
      , Str "these"
      , Space
      , Str "terms"
      , SoftBreak
      , Str "mean,"
      , Space
      , Str "how"
      , Space
      , Str "these"
      , Space
      , Str "primitives"
      , Space
      , Str "could"
      , Space
      , Str "be"
      , Space
      , Str "obtained"
      , Space
      , Str "by"
      , Space
      , Str "an"
      , Space
      , Str "attacker,"
      , Space
      , Str "and"
      , Space
      , Str "how"
      , Space
      , Str "they"
      , Space
      , Str "can"
      , SoftBreak
      , Str "be"
      , Space
      , Str "used."
      ]
  , Para
      [ Str "An"
      , Space
      , Emph [ Str "exploit" , Space , Str "primitive" ]
      , RawInline (Format "tex") "\\index{exploit primitive}"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "mechanism"
      , Space
      , Str "that"
      , Space
      , Str "allows"
      , Space
      , Str "an"
      , SoftBreak
      , Str "attacker"
      , Space
      , Str "to"
      , Space
      , Str "perform"
      , Space
      , Str "a"
      , Space
      , Str "specific"
      , Space
      , Str "operation"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "memory"
      , Space
      , Str "space"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , SoftBreak
      , Str "victim"
      , Space
      , Str "program."
      , Space
      , Str "This"
      , Space
      , Str "is"
      , Space
      , Str "done"
      , Space
      , Str "by"
      , Space
      , Str "providing"
      , Space
      , Str "specially"
      , Space
      , Str "crafted"
      , Space
      , Str "input"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , SoftBreak
      , Str "victim"
      , Space
      , Str "program."
      ]
  , Para
      [ Str "A"
      , Space
      , Emph [ Str "write" , Space , Str "primitive" ]
      , RawInline (Format "tex") "\\index{write primitive}"
      , Space
      , Str "gives"
      , Space
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "some"
      , Space
      , Str "level"
      , Space
      , Str "of"
      , SoftBreak
      , Str "write"
      , Space
      , Str "access"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "victim\8217s"
      , Space
      , Str "memory"
      , Space
      , Str "space."
      , Space
      , Str "The"
      , Space
      , Str "value"
      , Space
      , Str "written"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , Space
      , Str "address"
      , SoftBreak
      , Str "written"
      , Space
      , Str "to"
      , Space
      , Str "may"
      , Space
      , Str "be"
      , Space
      , Str "controlled"
      , Space
      , Str "by"
      , Space
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "to"
      , Space
      , Str "various"
      , Space
      , Str "degrees."
      , Space
      , Str "The"
      , Space
      , Str "primitive,"
      , SoftBreak
      , Str "for"
      , Space
      , Str "example,"
      , Space
      , Str "may"
      , Space
      , Str "allow:"
      ]
  , BulletList
      [ [ Plain
            [ Str "writing"
            , Space
            , Str "a"
            , Space
            , Str "fixed"
            , Space
            , Str "value"
            , Space
            , Str "to"
            , Space
            , Str "an"
            , Space
            , Str "attacker-controlled"
            , Space
            , Str "address,"
            , Space
            , Str "or"
            ]
        ]
      , [ Plain
            [ Str "writing"
            , Space
            , Str "to"
            , Space
            , Str "an"
            , Space
            , Str "address"
            , Space
            , Str "consisting"
            , Space
            , Str "of"
            , Space
            , Str "a"
            , Space
            , Str "fixed"
            , Space
            , Str "base"
            , Space
            , Str "and"
            , Space
            , Str "an"
            , Space
            , Str "attacker-controlled"
            , SoftBreak
            , Str "offset"
            , Space
            , Str "limited"
            , Space
            , Str "to"
            , Space
            , Str "a"
            , Space
            , Str "specific"
            , Space
            , Str "range"
            , Space
            , Str "(e.g.\160a"
            , Space
            , Str "32-bit"
            , Space
            , Str "offset)"
            , Span
                ( "" , [ "todo" ] , [] )
                [ Str "Consider"
                , Space
                , Str "describing"
                , SoftBreak
                , Str "in"
                , Space
                , Str "more"
                , Space
                , Str "detail"
                , Space
                , Str "why"
                , Space
                , Str "the"
                , Space
                , Str "range"
                , Space
                , Str "limitation"
                , Space
                , Str "matters"
                , Span ( "" , [ "issue" ] , [] ) [ Str "162" ]
                ]
            , Str ","
            , Space
            , Str "or"
            ]
        ]
      , [ Plain
            [ Str "writing"
            , Space
            , Str "to"
            , Space
            , Str "an"
            , Space
            , Str "attacker-controlled"
            , Space
            , Str "base"
            , Space
            , Str "address"
            , Space
            , Str "with"
            , Space
            , Str "a"
            , Space
            , Str "fixed"
            , Space
            , Str "offset."
            ]
        ]
      ]
  , Para
      [ Str "Primitives"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "further"
      , Space
      , Str "classified"
      , Space
      , Str "according"
      , Space
      , Str "to"
      , Space
      , Str "more"
      , Space
      , Str "detailed"
      , Space
      , Str "properties."
      , SoftBreak
      , Str "See"
      , Space
      , Str "slide"
      , Space
      , Str "11"
      , Space
      , Str "of"
      , Space
      , Cite
          [ Citation
              { citationId = "Miller2012"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 6
              , citationHash = 0
              }
          ]
          [ Str "[@Miller2012]" ]
      , Space
      , Str "for"
      , Space
      , Str "an"
      , Space
      , Str "example."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "most"
      , Space
      , Str "powerful"
      , Space
      , Str "version"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "write"
      , Space
      , Str "primitive"
      , Space
      , Str "is"
      , Space
      , Str "an"
      , Space
      , Emph [ Str "arbitrary" , Space , Str "write" ]
      , SoftBreak
      , Str "primitive,"
      , Space
      , Str "where"
      , Space
      , Str "both"
      , Space
      , Str "the"
      , Space
      , Str "address"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , Space
      , Str "value"
      , Space
      , Str "are"
      , Space
      , Str "fully"
      , Space
      , Str "controlled"
      , Space
      , Str "by"
      , Space
      , Str "the"
      , SoftBreak
      , Str "attacker."
      ]
  , Para
      [ Str "A"
      , Space
      , Emph [ Str "read" , Space , Str "primitive" ]
      , RawInline (Format "tex") "\\index{read primitive}"
      , Str ","
      , Space
      , Str "respectively,"
      , Space
      , Str "gives"
      , Space
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "read"
      , SoftBreak
      , Str "access"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "victim\8217s"
      , Space
      , Str "memory"
      , Space
      , Str "space."
      , Space
      , Str "The"
      , Space
      , Str "address"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "memory"
      , Space
      , Str "location"
      , SoftBreak
      , Str "accessed"
      , Space
      , Str "will"
      , Space
      , Str "be"
      , Space
      , Str "controlled"
      , Space
      , Str "by"
      , Space
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "to"
      , Space
      , Str "some"
      , Space
      , Str "degree,"
      , Space
      , Str "as"
      , Space
      , Str "for"
      , Space
      , Str "the"
      , Space
      , Str "write"
      , SoftBreak
      , Str "primitive."
      , Space
      , Str "A"
      , Space
      , Str "particularly"
      , Space
      , Str "useful"
      , Space
      , Str "primitive"
      , Space
      , Str "is"
      , Space
      , Str "an"
      , Space
      , Emph [ Str "arbitrary" , Space , Str "read" ]
      , Space
      , Str "primitive,"
      , Space
      , Str "in"
      , SoftBreak
      , Str "which"
      , Space
      , Str "the"
      , Space
      , Str "address"
      , Space
      , Str "is"
      , Space
      , Str "fully"
      , Space
      , Str "controlled"
      , Space
      , Str "by"
      , Space
      , Str "the"
      , Space
      , Str "attacker."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "effects"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "write"
      , Space
      , Str "primitive"
      , Space
      , Str "are"
      , Space
      , Str "perhaps"
      , Space
      , Str "easier"
      , Space
      , Str "to"
      , Space
      , Str "understand,"
      , Space
      , Str "as"
      , Space
      , Str "it"
      , SoftBreak
      , Str "has"
      , Space
      , Str "obvious"
      , Space
      , Str "side-effects:"
      , Space
      , Str "a"
      , Space
      , Str "value"
      , Space
      , Str "is"
      , Space
      , Str "written"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "program\8217s"
      , Space
      , Str "memory."
      , SoftBreak
      , Str "But"
      , Space
      , Str "how"
      , Space
      , Str "can"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "observe"
      , Space
      , Str "the"
      , Space
      , Str "result"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "read"
      , Space
      , Str "primitive?"
      ]
  , Para
      [ Str "This"
      , Space
      , Str "depends"
      , Space
      , Str "on"
      , Space
      , Str "whether"
      , Space
      , Str "the"
      , Space
      , Str "attack"
      , Space
      , Str "is"
      , Space
      , Str "interactive"
      , Space
      , Str "or"
      , Space
      , Str "non-interactive"
      , Space
      , Cite
          [ Citation
              { citationId = "Hu2016"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 7
              , citationHash = 0
              }
          ]
          [ Str "[@Hu2016]" ]
      , Str "."
      ]
  , BulletList
      [ [ Plain
            [ Str "In"
            , Space
            , Str "an"
            , Space
            , Emph [ Str "interactive" , Space , Str "attack" ]
            , RawInline (Format "tex") "\\index{interactive attack}"
            , Str ","
            , Space
            , Str "the"
            , Space
            , Str "attacker"
            , Space
            , Str "gives"
            , SoftBreak
            , Str "malicious"
            , Space
            , Str "input"
            , Space
            , Str "to"
            , Space
            , Str "the"
            , Space
            , Str "victim"
            , Space
            , Str "program."
            , Space
            , Str "The"
            , Space
            , Str "malicious"
            , Space
            , Str "input"
            , Space
            , Str "causes"
            , Space
            , Str "the"
            , Space
            , Str "victim"
            , SoftBreak
            , Str "program"
            , Space
            , Str "to"
            , Space
            , Str "perform"
            , Space
            , Str "the"
            , Space
            , Str "read"
            , Space
            , Str "the"
            , Space
            , Str "attacker"
            , Space
            , Str "instructed"
            , Space
            , Str "it"
            , Space
            , Str "to,"
            , Space
            , Str "and"
            , Space
            , Str "to"
            , Space
            , Str "output"
            , SoftBreak
            , Str "the"
            , Space
            , Str "results"
            , Space
            , Str "of"
            , Space
            , Str "that"
            , Space
            , Str "read."
            , Space
            , Str "This"
            , Space
            , Str "output"
            , Space
            , Str "could"
            , Space
            , Str "be"
            , Space
            , Str "any"
            , Space
            , Str "kind"
            , Space
            , Str "of"
            , Space
            , Str "output,"
            , Space
            , Str "for"
            , SoftBreak
            , Str "example"
            , Space
            , Str "a"
            , Space
            , Str "network"
            , Space
            , Str "packet"
            , Space
            , Str "that"
            , Space
            , Str "the"
            , Space
            , Str "victim"
            , Space
            , Str "transmits."
            , Space
            , Str "The"
            , Space
            , Str "attacker"
            , Space
            , Str "can"
            , Space
            , Str "observe"
            , SoftBreak
            , Str "the"
            , Space
            , Str "result"
            , Space
            , Str "of"
            , Space
            , Str "the"
            , Space
            , Str "read"
            , Space
            , Str "primitive"
            , Space
            , Str "by"
            , Space
            , Str "looking"
            , Space
            , Str "at"
            , Space
            , Str "this"
            , Space
            , Str "output,"
            , Space
            , Str "for"
            , Space
            , Str "example"
            , SoftBreak
            , Str "parsing"
            , Space
            , Str "this"
            , Space
            , Str "network"
            , Space
            , Str "packet."
            , Space
            , Str "This"
            , Space
            , Str "process"
            , Space
            , Str "then"
            , Space
            , Str "repeats:"
            , Space
            , Str "the"
            , Space
            , Str "attacker"
            , Space
            , Str "sends"
            , SoftBreak
            , Str "more"
            , Space
            , Str "malicious"
            , Space
            , Str "input"
            , Space
            , Str "to"
            , Space
            , Str "the"
            , Space
            , Str "victim,"
            , Space
            , Str "observes"
            , Space
            , Str "the"
            , Space
            , Str "output"
            , Space
            , Str "and"
            , Space
            , Str "prepares"
            , Space
            , Str "the"
            , Space
            , Str "next"
            , SoftBreak
            , Str "input."
            , Space
            , Str "You"
            , Space
            , Str "can"
            , Space
            , Str "see"
            , Space
            , Str "an"
            , Space
            , Str "example"
            , Space
            , Str "of"
            , Space
            , Str "this"
            , Space
            , Str "type"
            , Space
            , Str "of"
            , Space
            , Str "attack"
            , Space
            , Str "in"
            , SoftBreak
            , Cite
                [ Citation
                    { citationId = "Beer2020"
                    , citationPrefix = []
                    , citationSuffix = []
                    , citationMode = NormalCitation
                    , citationNoteNum = 8
                    , citationHash = 0
                    }
                ]
                [ Str "[@Beer2020]" ]
            , Str ","
            , Space
            , Str "which"
            , Space
            , Str "describes"
            , Space
            , Str "a"
            , Space
            , Str "zero-click"
            , Space
            , Str "radio"
            , Space
            , Str "proximity"
            , Space
            , Str "exploit."
            ]
        ]
      , [ Plain
            [ Str "In"
            , Space
            , Str "a"
            , Space
            , Emph
                [ Str "non-interactive"
                , Space
                , Str "(one-shot)"
                , Space
                , Str "attack"
                ]
            , RawInline
                (Format "tex")
                "\\index{non-interactive (one-shot)\nattack}"
            , Str ","
            , Space
            , Str "the"
            , Space
            , Str "attacker"
            , Space
            , Str "provides"
            , Space
            , Str "all"
            , Space
            , Str "malicious"
            , Space
            , Str "input"
            , Space
            , Str "to"
            , Space
            , Str "the"
            , Space
            , Str "victim"
            , Space
            , Str "program"
            , Space
            , Str "at"
            , SoftBreak
            , Str "once."
            , Space
            , Str "The"
            , Space
            , Str "malicious"
            , Space
            , Str "input"
            , Space
            , Str "triggers"
            , Space
            , Str "multiple"
            , Space
            , Str "primitives"
            , Space
            , Str "one"
            , Space
            , Str "after"
            , Space
            , Str "the"
            , Space
            , Str "other,"
            , SoftBreak
            , Str "and"
            , Space
            , Str "the"
            , Space
            , Str "primitives"
            , Space
            , Str "are"
            , Space
            , Str "able"
            , Space
            , Str "to"
            , Space
            , Str "observe"
            , Space
            , Str "the"
            , Space
            , Str "effects"
            , Space
            , Str "of"
            , Space
            , Str "the"
            , Space
            , Str "preceding"
            , SoftBreak
            , Str "operations"
            , Space
            , Str "through"
            , Space
            , Str "the"
            , Space
            , Str "victim"
            , Space
            , Str "program\8217s"
            , Space
            , Str "state."
            , Space
            , Str "The"
            , Space
            , Str "input"
            , Space
            , Str "could"
            , Space
            , Str "be,"
            , Space
            , Str "for"
            , SoftBreak
            , Str "example,"
            , Space
            , Str "in"
            , Space
            , Str "the"
            , Space
            , Str "form"
            , Space
            , Str "of"
            , Space
            , Str "a"
            , Space
            , Str "JavaScript"
            , Space
            , Str "program"
            , Space
            , Cite
                [ Citation
                    { citationId = "Gro\223\&2020"
                    , citationPrefix = []
                    , citationSuffix = []
                    , citationMode = NormalCitation
                    , citationNoteNum = 9
                    , citationHash = 0
                    }
                ]
                [ Str "[@Gro\223\&2020]" ]
            , Str ","
            , Space
            , Str "or"
            , Space
            , Str "a"
            , Space
            , Str "PDF"
            , Space
            , Str "file"
            , SoftBreak
            , Str "pretending"
            , Space
            , Str "to"
            , Space
            , Str "be"
            , Space
            , Str "a"
            , Space
            , Str "GIF"
            , Space
            , Cite
                [ Citation
                    { citationId = "Beer2021"
                    , citationPrefix = []
                    , citationSuffix = []
                    , citationMode = NormalCitation
                    , citationNoteNum = 10
                    , citationHash = 0
                    }
                ]
                [ Str "[@Beer2021]" ]
            , Str "."
            ]
        ]
      ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "The"
          , Space
          , Str "references"
          , Space
          , Str "in"
          , Space
          , Str "this"
          , Space
          , Str "section"
          , Space
          , Str "describe"
          , Space
          , Str "complicated"
          , Space
          , Str "modern"
          , Space
          , Str "exploits."
          , SoftBreak
          , Str "Consider"
          , Space
          , Str "linking"
          , Space
          , Str "to"
          , Space
          , Str "simpler"
          , Space
          , Str "exploits,"
          , Space
          , Str "as"
          , Space
          , Str "well"
          , Space
          , Str "as"
          , Space
          , Str "some"
          , Space
          , Str "tutorial-level"
          , Space
          , Str "material."
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "163" ]
          ]
      ]
  , Para
      [ Str "How"
      , Space
      , Str "does"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "obtain"
      , Space
      , Str "these"
      , Space
      , Str "kinds"
      , Space
      , Str "of"
      , Space
      , Str "primitives"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "first"
      , Space
      , Str "place?"
      , Space
      , Str "The"
      , SoftBreak
      , Str "details"
      , Space
      , Str "vary,"
      , Space
      , Str "and"
      , Space
      , Str "in"
      , Space
      , Str "some"
      , Space
      , Str "cases"
      , Space
      , Str "it"
      , Space
      , Str "takes"
      , Space
      , Str "a"
      , Space
      , Str "combination"
      , Space
      , Str "of"
      , Space
      , Str "many"
      , Space
      , Str "techniques,"
      , Space
      , Str "some"
      , SoftBreak
      , Str "of"
      , Space
      , Str "which"
      , Space
      , Str "are"
      , Space
      , Str "out"
      , Space
      , Str "of"
      , Space
      , Str "scope"
      , Space
      , Str "for"
      , Space
      , Str "this"
      , Space
      , Str "book."
      , Space
      , Str "But"
      , Space
      , Str "we"
      , Space
      , Str "will"
      , Space
      , Str "be"
      , Space
      , Str "describing"
      , Space
      , Str "a"
      , Space
      , Str "few"
      , Space
      , Str "of"
      , SoftBreak
      , Str "them"
      , Space
      , Str "in"
      , Space
      , Str "this"
      , Space
      , Str "chapter."
      , Space
      , Str "For"
      , Space
      , Str "example"
      , Space
      , Str "a"
      , Space
      , Str "stack"
      , Space
      , Str "buffer"
      , Space
      , Str "overflow"
      , Space
      , Str "results"
      , Space
      , Str "in"
      , Space
      , Str "a"
      , SoftBreak
      , Str "(restricted)"
      , Space
      , Str "write"
      , Space
      , Str "primitive"
      , Space
      , Str "when"
      , Space
      , Str "the"
      , Space
      , Str "input"
      , Space
      , Str "size"
      , Space
      , Str "exceeds"
      , Space
      , Str "what"
      , Space
      , Str "the"
      , Space
      , Str "program"
      , SoftBreak
      , Str "expected."
      ]
  , Para
      [ Str "As"
      , Space
      , Str "part"
      , Space
      , Str "of"
      , Space
      , Str "an"
      , Space
      , Str "attack,"
      , Space
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "will"
      , Space
      , Str "want"
      , Space
      , Str "to"
      , Space
      , Str "execute"
      , Space
      , Str "each"
      , Space
      , Str "primitive"
      , Space
      , Str "more"
      , SoftBreak
      , Str "than"
      , Space
      , Str "once,"
      , Space
      , Str "since"
      , Space
      , Str "a"
      , Space
      , Str "single"
      , Space
      , Str "read"
      , Space
      , Str "or"
      , Space
      , Str "write"
      , Space
      , Str "operation"
      , Space
      , Str "will"
      , Space
      , Str "rarely"
      , Space
      , Str "be"
      , Space
      , Str "enough"
      , Space
      , Str "to"
      , SoftBreak
      , Str "achieve"
      , Space
      , Str "their"
      , Space
      , Str "end"
      , Space
      , Str "goal"
      , Space
      , Str "(more"
      , Space
      , Str "on"
      , Space
      , Str "this"
      , Space
      , Str "later)."
      , Space
      , Str "How"
      , Space
      , Str "can"
      , Space
      , Str "primitives"
      , Space
      , Str "be"
      , Space
      , Str "combined"
      , SoftBreak
      , Str "to"
      , Space
      , Str "perform"
      , Space
      , Str "multiple"
      , Space
      , Str "reads/writes?"
      ]
  , Para
      [ Str "In"
      , Space
      , Str "the"
      , Space
      , Str "case"
      , Space
      , Str "of"
      , Space
      , Str "an"
      , Space
      , Str "interactive"
      , Space
      , Str "attack,"
      , Space
      , Str "preparing"
      , Space
      , Str "and"
      , Space
      , Str "sending"
      , Space
      , Str "input"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , SoftBreak
      , Str "program"
      , Space
      , Str "and"
      , Space
      , Str "parsing"
      , Space
      , Str "the"
      , Space
      , Str "output"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "program"
      , Space
      , Str "are"
      , Space
      , Str "usually"
      , Space
      , Str "done"
      , Space
      , Str "in"
      , Space
      , Str "an"
      , SoftBreak
      , Str "external"
      , Space
      , Str "program"
      , Space
      , Str "that"
      , Space
      , Str "drives"
      , Space
      , Str "the"
      , Space
      , Str "exploit."
      , Space
      , Str "The"
      , Space
      , Str "attacker"
      , Space
      , Str "is"
      , Space
      , Str "free"
      , Space
      , Str "to"
      , Space
      , Str "use"
      , Space
      , Str "a"
      , SoftBreak
      , Str "programming"
      , Space
      , Str "language"
      , Space
      , Str "of"
      , Space
      , Str "their"
      , Space
      , Str "choice,"
      , Space
      , Str "as"
      , Space
      , Str "long"
      , Space
      , Str "as"
      , Space
      , Str "they"
      , Space
      , Str "can"
      , Space
      , Str "interact"
      , Space
      , Str "with"
      , Space
      , Str "the"
      , SoftBreak
      , Str "victim"
      , Space
      , Str "program"
      , Space
      , Str "in"
      , Space
      , Str "it."
      , Space
      , Str "Let\8217s"
      , Space
      , Str "assume,"
      , Space
      , Str "for"
      , Space
      , Str "example,"
      , Space
      , Str "an"
      , Space
      , Str "exploit"
      , Space
      , Str "program"
      , Space
      , Str "in"
      , Space
      , Str "C,"
      , SoftBreak
      , Str "communicating"
      , Space
      , Str "with"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "program"
      , Space
      , Str "over"
      , Space
      , Str "TCP."
      , Space
      , Str "In"
      , Space
      , Str "this"
      , Space
      , Str "case,"
      , Space
      , Str "the"
      , Space
      , Str "primitives"
      , SoftBreak
      , Str "are"
      , Space
      , Str "abstracted"
      , Space
      , Str "into"
      , Space
      , Str "C"
      , Space
      , Str "functions,"
      , Space
      , Str "which"
      , Space
      , Str "prepare"
      , Space
      , Str "and"
      , Space
      , Str "send"
      , Space
      , Str "packets"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "victim,"
      , SoftBreak
      , Str "and"
      , Space
      , Str "parse"
      , Space
      , Str "the"
      , Space
      , Str "victim\8217s"
      , Space
      , Str "responses."
      , Space
      , Str "Using"
      , Space
      , Str "the"
      , Space
      , Str "primitives"
      , Space
      , Str "is"
      , Space
      , Str "then"
      , Space
      , Str "as"
      , Space
      , Str "simple"
      , Space
      , Str "as"
      , SoftBreak
      , Str "calling"
      , Space
      , Str "these"
      , Space
      , Str "functions."
      , Space
      , Str "These"
      , Space
      , Str "calls"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "easily"
      , Space
      , Str "combined"
      , Space
      , Str "with"
      , Space
      , Str "arbitrary"
      , SoftBreak
      , Str "computations,"
      , Space
      , Str "all"
      , Space
      , Str "written"
      , Space
      , Str "in"
      , Space
      , Str "C,"
      , Space
      , Str "to"
      , Space
      , Str "form"
      , Space
      , Str "the"
      , Space
      , Str "exploit."
      ]
  , Para
      [ Str "For"
      , Space
      , Str "this"
      , Space
      , Str "cycle"
      , Space
      , Str "of"
      , Space
      , Str "repeated"
      , Space
      , Str "input/output"
      , Space
      , Str "interactions"
      , Space
      , Str "to"
      , Space
      , Str "work,"
      , Space
      , Str "the"
      , Space
      , Str "state"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , SoftBreak
      , Str "victim"
      , Space
      , Str "program"
      , Space
      , Str "must"
      , Space
      , Str "not"
      , Space
      , Str "be"
      , Space
      , Str "lost"
      , Space
      , Str "between"
      , Space
      , Str "the"
      , Space
      , Str "different"
      , Space
      , Str "iterations"
      , Space
      , Str "of"
      , Space
      , Str "providing"
      , SoftBreak
      , Str "input"
      , Space
      , Str "and"
      , Space
      , Str "observing"
      , Space
      , Str "output."
      , Space
      , Str "In"
      , Space
      , Str "other"
      , Space
      , Str "words,"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "process"
      , Space
      , Str "must"
      , Space
      , Str "not"
      , Space
      , Str "be"
      , SoftBreak
      , Str "restarted."
      ]
  , Para
      [ Str "It\8217s"
      , Space
      , Str "interesting"
      , Space
      , Str "to"
      , Space
      , Str "note"
      , Space
      , Str "that"
      , Space
      , Str "while"
      , Space
      , Str "the"
      , Space
      , Str "read/write"
      , Space
      , Str "primitives"
      , Space
      , Str "consist"
      , Space
      , Str "of"
      , SoftBreak
      , Str "carefully"
      , Space
      , Str "constructed"
      , Space
      , Str "inputs"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "program,"
      , Space
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "can"
      , Space
      , Str "view"
      , Space
      , Str "these"
      , SoftBreak
      , Str "inputs"
      , Space
      , Str "as"
      , Space
      , Emph [ Str "instructions" ]
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "program."
      , Space
      , Str "The"
      , Space
      , Str "victim"
      , Space
      , Str "program"
      , Space
      , Str "effectively"
      , SoftBreak
      , Str "implements"
      , Space
      , Str "an"
      , Space
      , Str "interpreter"
      , Space
      , Str "unintentionally,"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "can"
      , Space
      , Str "send"
      , Space
      , Str "instructions"
      , SoftBreak
      , Str "to"
      , Space
      , Str "this"
      , Space
      , Str "interpreter."
      , Space
      , Str "This"
      , Space
      , Str "is"
      , Space
      , Str "explored"
      , Space
      , Str "further"
      , Space
      , Str "in"
      , Space
      , Cite
          [ Citation
              { citationId = "Dullien2020"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 11
              , citationHash = 0
              }
          ]
          [ Str "[@Dullien2020]" ]
      , Str "."
      ]
  , Para
      [ Str "In"
      , Space
      , Str "the"
      , Space
      , Str "case"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "non-interactive"
      , Space
      , Str "attack,"
      , Space
      , Str "all"
      , Space
      , Str "computation"
      , Space
      , Str "happens"
      , Space
      , Str "within"
      , Space
      , Str "the"
      , SoftBreak
      , Str "victim"
      , Space
      , Str "program."
      , Space
      , Str "The"
      , Space
      , Str "duality"
      , Space
      , Str "of"
      , Space
      , Str "input"
      , Space
      , Str "data"
      , Space
      , Str "and"
      , Space
      , Str "code"
      , Space
      , Str "is"
      , Space
      , Str "even"
      , Space
      , Str "more"
      , Space
      , Str "obvious"
      , Space
      , Str "in"
      , Space
      , Str "this"
      , SoftBreak
      , Str "case,"
      , Space
      , Str "as"
      , Space
      , Str "the"
      , Space
      , Str "malicious"
      , Space
      , Str "input"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "viewed"
      , Space
      , Str "as"
      , Space
      , Str "the"
      , Space
      , Str "exploit"
      , Space
      , Str "code."
      , SoftBreak
      , Str "There"
      , Space
      , Str "are"
      , Space
      , Str "cases"
      , Space
      , Str "for"
      , Space
      , Str "which"
      , Space
      , Str "the"
      , Space
      , Str "input"
      , Space
      , Str "is"
      , Space
      , Str "obviously"
      , Space
      , Str "interpreted"
      , Space
      , Str "as"
      , Space
      , Str "code"
      , Space
      , Str "by"
      , Space
      , Str "the"
      , SoftBreak
      , Str "victim"
      , Space
      , Str "application"
      , Space
      , Str "as"
      , Space
      , Str "well,"
      , Space
      , Str "as"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "case"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "JavaScript"
      , Space
      , Str "program"
      , Space
      , Str "given"
      , Space
      , Str "as"
      , SoftBreak
      , Str "input"
      , Space
      , Str "to"
      , Space
      , Str "a"
      , Space
      , Str "JavaScript"
      , Space
      , Str "engine."
      , Space
      , Str "In"
      , Space
      , Str "this"
      , Space
      , Str "case,"
      , Space
      , Str "the"
      , Space
      , Str "read/write"
      , Space
      , Str "primitives"
      , Space
      , Str "would"
      , SoftBreak
      , Str "be"
      , Space
      , Str "written"
      , Space
      , Str "as"
      , Space
      , Str "JavaScript"
      , Space
      , Str "functions,"
      , Space
      , Str "which"
      , Space
      , Str "when"
      , Space
      , Str "called"
      , Space
      , Str "have"
      , Space
      , Str "the"
      , Space
      , Str "unintended"
      , SoftBreak
      , Str "side-effect"
      , Space
      , Str "of"
      , Space
      , Str "accessing"
      , Space
      , Str "arbitrary"
      , Space
      , Str "memory"
      , Space
      , Str "that"
      , Space
      , Str "a"
      , Space
      , Str "JavaScript"
      , Space
      , Str "program"
      , Space
      , Str "is"
      , Space
      , Str "not"
      , SoftBreak
      , Str "supposed"
      , Space
      , Str "to"
      , Space
      , Str "have"
      , Space
      , Str "access"
      , Space
      , Str "to."
      , Space
      , Str "The"
      , Space
      , Str "primitives"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "chained"
      , Space
      , Str "together"
      , Space
      , Str "with"
      , SoftBreak
      , Str "arbitrary"
      , Space
      , Str "computations,"
      , Space
      , Str "also"
      , Space
      , Str "expressed"
      , Space
      , Str "in"
      , Space
      , Str "JavaScript."
      ]
  , Para
      [ Str "There"
      , Space
      , Str "are,"
      , Space
      , Str "however,"
      , Space
      , Str "cases"
      , Space
      , Str "where"
      , Space
      , Str "the"
      , Space
      , Str "correspondence"
      , Space
      , Str "between"
      , Space
      , Str "data"
      , Space
      , Str "and"
      , Space
      , Str "code"
      , Space
      , Str "isn\8217t"
      , SoftBreak
      , Str "as"
      , Space
      , Str "obvious."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "in"
      , Space
      , Cite
          [ Citation
              { citationId = "Beer2021"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 12
              , citationHash = 0
              }
          ]
          [ Str "[@Beer2021]" ]
      , Str ","
      , Space
      , Str "the"
      , Space
      , Str "malicious"
      , Space
      , Str "input"
      , Space
      , Str "consists"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "PDF"
      , SoftBreak
      , Str "file,"
      , Space
      , Str "masquerading"
      , Space
      , Str "as"
      , Space
      , Str "a"
      , Space
      , Str "GIF."
      , Space
      , Str "Due"
      , Space
      , Str "to"
      , Space
      , Str "an"
      , Space
      , Str "integer"
      , Space
      , Str "overflow"
      , Space
      , Str "bug"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "PDF"
      , Space
      , Str "decoder,"
      , SoftBreak
      , Str "the"
      , Space
      , Str "malicious"
      , Space
      , Str "input"
      , Space
      , Str "leads"
      , Space
      , Str "to"
      , Space
      , Str "an"
      , Space
      , Str "unbounded"
      , Space
      , Str "buffer"
      , Space
      , Str "access,"
      , Space
      , Str "therefore"
      , Space
      , Str "to"
      , Space
      , Str "an"
      , SoftBreak
      , Str "arbitrary"
      , Space
      , Str "read/write"
      , Space
      , Str "primitive."
      , Space
      , Str "In"
      , Space
      , Str "the"
      , Space
      , Str "case"
      , Space
      , Str "of"
      , Space
      , Str "JavaScript"
      , Space
      , Str "engine"
      , Space
      , Str "exploitation,"
      , SoftBreak
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "would"
      , Space
      , Str "normally"
      , Space
      , Str "be"
      , Space
      , Str "able"
      , Space
      , Str "to"
      , Space
      , Str "use"
      , Space
      , Str "JavaScript"
      , Space
      , Str "operations"
      , Space
      , Str "and"
      , Space
      , Str "perform"
      , SoftBreak
      , Str "arbitrary"
      , Space
      , Str "computations,"
      , Space
      , Str "making"
      , Space
      , Str "exploitation"
      , Space
      , Str "more"
      , Space
      , Str "straightforward."
      , Space
      , Str "In"
      , Space
      , Str "this"
      , Space
      , Str "case,"
      , SoftBreak
      , Str "there"
      , Space
      , Str "are"
      , Space
      , Str "no"
      , Space
      , Str "scripting"
      , Space
      , Str "capabilities"
      , Space
      , Str "officially"
      , Space
      , Str "supported."
      , Space
      , Str "The"
      , Space
      , Str "attackers,"
      , SoftBreak
      , Str "however,"
      , Space
      , Str "take"
      , Space
      , Str "advantage"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "compression"
      , Space
      , Str "format"
      , Space
      , Str "intricacies"
      , Space
      , Str "to"
      , Space
      , Str "implement"
      , Space
      , Str "a"
      , SoftBreak
      , Str "small"
      , Space
      , Str "computer"
      , Space
      , Str "architecture,"
      , Space
      , Str "in"
      , Space
      , Str "thousands"
      , Space
      , Str "of"
      , Space
      , Str "simple"
      , Space
      , Str "commands"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "decoder."
      , SoftBreak
      , Str "In"
      , Space
      , Str "this"
      , Space
      , Str "way,"
      , Space
      , Str "they"
      , Space
      , Str "effectively"
      , Space
      , Emph [ Str "introduce" ]
      , Space
      , Str "scripting"
      , Space
      , Str "capabilities"
      , Space
      , Str "and"
      , Space
      , Str "are"
      , Space
      , Str "able"
      , SoftBreak
      , Str "to"
      , Space
      , Str "express"
      , Space
      , Str "their"
      , Space
      , Str "exploit"
      , Space
      , Str "as"
      , Space
      , Str "a"
      , Space
      , Str "program"
      , Space
      , Str "to"
      , Space
      , Str "this"
      , Space
      , Str "architecture."
      ]
  , Para
      [ Str "So"
      , Space
      , Str "far,"
      , Space
      , Str "we"
      , Space
      , Str "have"
      , Space
      , Str "described"
      , Space
      , Str "read/write"
      , Space
      , Str "primitives."
      , Space
      , Str "We"
      , Space
      , Str "have"
      , Space
      , Str "also"
      , Space
      , Str "discussed"
      , Space
      , Str "how"
      , Space
      , Str "an"
      , SoftBreak
      , Str "attacker"
      , Space
      , Str "might"
      , Space
      , Str "perform"
      , Space
      , Str "arbitrary"
      , Space
      , Str "computations:"
      ]
  , BulletList
      [ [ Plain
            [ Str "in"
            , Space
            , Str "an"
            , Space
            , Str "external"
            , Space
            , Str "program"
            , Space
            , Str "in"
            , Space
            , Str "the"
            , Space
            , Str "case"
            , Space
            , Str "of"
            , Space
            , Str "interactive"
            , Space
            , Str "attacks,"
            , Space
            , Str "or"
            ]
        ]
      , [ Plain
            [ Str "by"
            , Space
            , Str "using"
            , Space
            , Str "scripting"
            , Space
            , Str "capabilities"
            , Space
            , Str "(whether"
            , Space
            , Str "originally"
            , Space
            , Str "supported"
            , Space
            , Str "or"
            , SoftBreak
            , Str "introduced"
            , Space
            , Str "by"
            , Space
            , Str "the"
            , Space
            , Str "attacker)"
            , Space
            , Str "in"
            , Space
            , Str "non-interactive"
            , Space
            , Str "attacks."
            ]
        ]
      ]
  , Para
      [ Str "Assuming"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "has"
      , Space
      , Str "gained"
      , Space
      , Str "these"
      , Space
      , Str "capabilities,"
      , Space
      , Str "how"
      , Space
      , Str "can"
      , Space
      , Str "they"
      , Space
      , Str "use"
      , Space
      , Str "them"
      , Space
      , Str "to"
      , SoftBreak
      , Str "achieve"
      , Space
      , Str "their"
      , Space
      , Str "goals?"
      ]
  , Para
      [ Str "The"
      , Space
      , Str "ultimate"
      , Space
      , Str "goal"
      , Space
      , Str "of"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "may"
      , Space
      , Str "vary:"
      , Space
      , Str "it"
      , Space
      , Str "may"
      , Space
      , Str "be,"
      , Space
      , Str "among"
      , Space
      , Str "other"
      , Space
      , Str "things,"
      , SoftBreak
      , Str "getting"
      , Space
      , Str "access"
      , Space
      , Str "to"
      , Space
      , Str "a"
      , Space
      , Str "system,"
      , Space
      , Str "leaking"
      , Space
      , Str "sensitive"
      , Space
      , Str "information"
      , Space
      , Str "or"
      , Space
      , Str "bringing"
      , Space
      , Str "down"
      , Space
      , Str "a"
      , SoftBreak
      , Str "service."
      , Space
      , Str "Frequently,"
      , Space
      , Str "a"
      , Space
      , Str "first"
      , Space
      , Str "step"
      , Space
      , Str "towards"
      , Space
      , Str "these"
      , Space
      , Str "wider"
      , Space
      , Str "goals"
      , Space
      , Str "is"
      , Space
      , Str "arbitrary"
      , Space
      , Str "code"
      , SoftBreak
      , Str "execution"
      , RawInline
          (Format "tex") "\\index{arbitrary code execution}"
      , Space
      , Str "within"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "process."
      , Space
      , Str "We"
      , Space
      , Str "have"
      , SoftBreak
      , Str "already"
      , Space
      , Str "mentioned"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "will"
      , Space
      , Str "typically"
      , Space
      , Str "have"
      , Space
      , Str "arbitrary"
      , Space
      , Str "computation"
      , SoftBreak
      , Str "capabilities"
      , Space
      , Str "at"
      , Space
      , Str "this"
      , Space
      , Str "point,"
      , Space
      , Str "but"
      , Space
      , Str "arbitrary"
      , Space
      , Str "code"
      , Space
      , Str "execution"
      , Space
      , Str "also"
      , Space
      , Str "involves"
      , Space
      , Str "things"
      , SoftBreak
      , Str "like"
      , Space
      , Str "calling"
      , Space
      , Str "arbitrary"
      , Space
      , Str "library"
      , Space
      , Str "functions"
      , Space
      , Str "and"
      , Space
      , Str "performing"
      , Space
      , Str "system"
      , Space
      , Str "calls."
      ]
  , Para
      [ Str "Some"
      , Space
      , Str "examples"
      , Space
      , Str "of"
      , Space
      , Str "how"
      , Space
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "may"
      , Space
      , Str "use"
      , Space
      , Str "the"
      , Space
      , Str "obtained"
      , Space
      , Str "primitives:"
      ]
  , BulletList
      [ [ Plain
            [ Str "Leak"
            , Space
            , Str "information,"
            , Space
            , Str "such"
            , Space
            , Str "as"
            , Space
            , Str "pointers"
            , Space
            , Str "to"
            , Space
            , Str "specific"
            , Space
            , Str "data"
            , Space
            , Str "structures"
            , Space
            , Str "or"
            , Space
            , Str "code,"
            , SoftBreak
            , Str "or"
            , Space
            , Str "the"
            , Space
            , Str "stack"
            , Space
            , Str "pointer."
            ]
        ]
      , [ Plain
            [ Str "Overwrite"
            , Space
            , Str "the"
            , Space
            , Str "stack"
            , Space
            , Str "contents,"
            , Space
            , Str "e.g.\160to"
            , Space
            , Str "perform"
            , Space
            , Str "a"
            , Space
            , Link
                ( "" , [] , [] )
                [ Str "ROP" , Space , Str "attack" ]
                ( "#rop" , "" )
            , Str "."
            ]
        ]
      , [ Plain
            [ Str "Overwrite"
            , Space
            , Str "non-control"
            , Space
            , Str "data,"
            , Space
            , Str "e.g.\160authorization"
            , Space
            , Str "state."
            , Space
            , Str "Sometimes"
            , Space
            , Str "this"
            , SoftBreak
            , Str "step"
            , Space
            , Str "is"
            , Space
            , Str "sufficient"
            , Space
            , Str "to"
            , Space
            , Str "achieve"
            , Space
            , Str "the"
            , Space
            , Str "attacker\8217s"
            , Space
            , Str "goal,"
            , Space
            , Str "bypassing"
            , Space
            , Str "the"
            , Space
            , Str "need"
            , Space
            , Str "for"
            , SoftBreak
            , Str "arbitrary"
            , Space
            , Str "code"
            , Space
            , Str "execution."
            ]
        ]
      ]
  , Para
      [ Str "Once"
      , Space
      , Str "arbitrary"
      , Space
      , Str "code"
      , Space
      , Str "execution"
      , Space
      , Str "is"
      , Space
      , Str "achieved,"
      , Space
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "may"
      , Space
      , Str "need"
      , Space
      , Str "to"
      , Space
      , Str "exploit"
      , SoftBreak
      , Str "additional"
      , Space
      , Str "vulnerabilities"
      , Space
      , Str "in"
      , Space
      , Str "order"
      , Space
      , Str "to"
      , Space
      , Str "escape"
      , Space
      , Str "a"
      , Space
      , Str "process"
      , Space
      , Str "sandbox,"
      , Space
      , Str "escalate"
      , SoftBreak
      , Str "privilege,"
      , Space
      , Str "etc."
      , Space
      , Str "Such"
      , Space
      , Str "vulnerability"
      , Space
      , Str "chaining"
      , Space
      , Str "is"
      , Space
      , Str "common,"
      , Space
      , Str "but"
      , Space
      , Str "for"
      , Space
      , Str "the"
      , SoftBreak
      , Str "purposes"
      , Space
      , Str "of"
      , Space
      , Str "this"
      , Space
      , Str "chapter"
      , Space
      , Str "we"
      , Space
      , Str "will"
      , Space
      , Str "focus"
      , Space
      , Str "on:"
      ]
  , BulletList
      [ [ Plain
            [ Str "Preventing"
            , Space
            , Str "memory"
            , Space
            , Str "vulnerabilities"
            , Space
            , Str "in"
            , Space
            , Str "the"
            , Space
            , Str "first"
            , Space
            , Str "place,"
            , Space
            , Str "thus"
            , Space
            , Str "stopping"
            , SoftBreak
            , Str "the"
            , Space
            , Str "attacker"
            , Space
            , Str "from"
            , Space
            , Str "obtaining"
            , Space
            , Str "powerful"
            , Space
            , Str "read/write"
            , Space
            , Str "primitives."
            ]
        ]
      , [ Plain
            [ Str "Mitigating"
            , Space
            , Str "the"
            , Space
            , Str "effects"
            , Space
            , Str "of"
            , Space
            , Str "read/write"
            , Space
            , Str "primitives,"
            , Space
            , Str "e.g.\160with"
            , Space
            , Str "mechanisms"
            , SoftBreak
            , Str "to"
            , Space
            , Str "maintain"
            , Space
            , Link
                ( "" , [] , [] )
                [ Str "Control-Flow"
                , Space
                , Str "Integrity"
                , Space
                , Str "(CFI)"
                ]
                ( "#cfi" , "" )
            , Str "."
            ]
        ]
      ]
  , Header
      2
      ( "stack-buffer-overflows" , [] , [] )
      [ Str "Stack"
      , Space
      , Str "buffer"
      , Space
      , Str "overflows"
      ]
  , Para
      [ Str "A"
      , Space
      , Str "buffer"
      , Space
      , Str "overflow"
      , Space
      , Str "occurs"
      , Space
      , Str "when"
      , Space
      , Str "a"
      , Space
      , Str "read"
      , Space
      , Str "from"
      , Space
      , Str "or"
      , Space
      , Str "write"
      , Space
      , Str "to"
      , Space
      , Str "a"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "data" , SoftBreak , Str "buffer" ]
          ( "https://en.wikipedia.org/wiki/Data_buffer" , "" )
      , Space
      , Str "exceeds"
      , Space
      , Str "its"
      , Space
      , Str "boundaries."
      , SoftBreak
      , Str "This"
      , Space
      , Str "typically"
      , Space
      , Str "results"
      , Space
      , Str "in"
      , Space
      , Str "adjacent"
      , Space
      , Str "data"
      , Space
      , Str "structures"
      , Space
      , Str "being"
      , Space
      , Str "accessed,"
      , Space
      , Str "which"
      , Space
      , Str "has"
      , SoftBreak
      , Str "the"
      , Space
      , Str "potential"
      , Space
      , Str "of"
      , Space
      , Str "leaking"
      , Space
      , Str "or"
      , Space
      , Str "compromising"
      , Space
      , Str "the"
      , Space
      , Str "integrity"
      , Space
      , Str "of"
      , Space
      , Str "this"
      , Space
      , Str "adjacent"
      , Space
      , Str "data."
      ]
  , Para
      [ Str "When"
      , Space
      , Str "the"
      , Space
      , Str "buffer"
      , Space
      , Str "is"
      , Space
      , Str "allocated"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "stack,"
      , Space
      , Str "we"
      , Space
      , Str "refer"
      , Space
      , Str "to"
      , Space
      , Str "a"
      , Space
      , Str "stack"
      , Space
      , Str "buffer"
      , Space
      , Str "overflow."
      , SoftBreak
      , Str "In"
      , Space
      , Str "this"
      , Space
      , Str "section"
      , Space
      , Str "we"
      , Space
      , Str "focus"
      , Space
      , Str "on"
      , Space
      , Str "stack"
      , Space
      , Str "buffer"
      , Space
      , Str "overflows"
      , Space
      , Str "since,"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "absence"
      , Space
      , Str "of"
      , Space
      , Str "any"
      , SoftBreak
      , Str "mitigations,"
      , Space
      , Str "they"
      , Space
      , Str "are"
      , Space
      , Str "some"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "simplest"
      , Space
      , Str "buffer"
      , Space
      , Str "overflows"
      , Space
      , Str "to"
      , Space
      , Str "exploit."
      ]
  , Para
      [ Str "The"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "stack" , Space , Str "frame" ]
          ( "https://en.wikipedia.org/wiki/Call_stack" , "" )
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "function"
      , SoftBreak
      , Str "includes"
      , Space
      , Str "important"
      , Space
      , Str "control"
      , Space
      , Str "information,"
      , Space
      , Str "such"
      , Space
      , Str "as"
      , Space
      , Str "the"
      , Space
      , Str "saved"
      , Space
      , Str "return"
      , Space
      , Str "address"
      , Space
      , Str "and"
      , SoftBreak
      , Str "the"
      , Space
      , Str "saved"
      , Space
      , Str "frame"
      , Space
      , Str "pointer."
      , Space
      , Str "Overwriting"
      , Space
      , Str "these"
      , Space
      , Str "values"
      , Space
      , Str "unintentionally"
      , Space
      , Str "will"
      , SoftBreak
      , Str "typically"
      , Space
      , Str "result"
      , Space
      , Str "in"
      , Space
      , Str "a"
      , Space
      , Str "crash,"
      , Space
      , Str "but"
      , Space
      , Str "the"
      , Space
      , Str "overflowing"
      , Space
      , Str "values"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "carefully"
      , Space
      , Str "chosen"
      , SoftBreak
      , Str "by"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "to"
      , Space
      , Str "gain"
      , Space
      , Str "control"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "program\8217s"
      , Space
      , Str "execution."
      ]
  , Para
      [ Str "Here"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "simple"
      , Space
      , Str "example"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "program"
      , Space
      , Str "vulnerable"
      , Space
      , Str "to"
      , Space
      , Str "a"
      , Space
      , Str "stack"
      , Space
      , Str "buffer"
      , Space
      , Str "overflow"
      , Note
          [ Para
              [ Str "This"
              , Space
              , Str "is"
              , Space
              , Str "an"
              , Space
              , Str "oversimplified"
              , Space
              , Str "example"
              , Space
              , Str "for"
              , Space
              , Str "illustrative"
              , Space
              , Str "purposes."
              , SoftBreak
              , Str "However,"
              , Space
              , Str "as"
              , Space
              , Str "this"
              , Space
              , Str "is"
              , Space
              , Str "a"
              , Space
              , Link
                  ( "" , [] , [] )
                  [ Str "wide"
                  , Space
                  , Str "class"
                  , Space
                  , Str "of"
                  , SoftBreak
                  , Str "vulnerabilities"
                  ]
                  ( "https://cwe.mitre.org/data/definitions/121.html"
                  , ""
                  )
              , Str ","
              , SoftBreak
              , Link
                  ( "" , [] , [] )
                  [ Str "many"
                  , Space
                  , Str "real-world"
                  , Space
                  , Str "examples"
                  ]
                  ( "https://www.cvedetails.com/vulnerability-list/cweid-121/vulnerabilities.html"
                  , ""
                  )
              , SoftBreak
              , Str "can"
              , Space
              , Str "be"
              , Space
              , Str "found"
              , Space
              , Str "and"
              , Space
              , Str "studied."
              ]
          ]
      , Str ":"
      ]
  , CodeBlock
      ( "" , [] , [] )
      "#include <stdio.h>\n#include <string.h>\n\nvoid copy_and_print(char* src) {\n  char dst[16];\n\n  for (int i = 0; i < strlen(src) + 1; ++i)\n    dst[i] = src[i];\n  printf(\"%s\\n\", dst);\n}\n\nint main(int argc, char* argv[]) {\n  if (argc > 1) {\n    copy_and_print(argv[1]);\n  }\n}"
  , Para
      [ Str "In"
      , Space
      , Str "the"
      , Space
      , Str "code"
      , Space
      , Str "above,"
      , Space
      , Str "since"
      , Space
      , Str "the"
      , Space
      , Str "length"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "argument"
      , Space
      , Str "is"
      , Space
      , Str "not"
      , Space
      , Str "checked"
      , Space
      , Str "before"
      , SoftBreak
      , Str "copying"
      , Space
      , Str "it"
      , Space
      , Str "into"
      , Space
      , Code ( "" , [] , [] ) "dst"
      , Str ","
      , Space
      , Str "we"
      , Space
      , Str "have"
      , Space
      , Str "a"
      , Space
      , Str "potential"
      , Space
      , Str "for"
      , Space
      , Str "a"
      , Space
      , Str "buffer"
      , Space
      , Str "overflow."
      ]
  , Para
      [ Str "When"
      , Space
      , Str "looking"
      , Space
      , Str "at"
      , Space
      , Str "code"
      , Space
      , Str "generated"
      , Space
      , Str "for"
      , Space
      , Str "AArch64"
      , Space
      , Str "with"
      , Space
      , Str "GCC"
      , Space
      , Str "11.2"
      , Note
          [ Para
              [ Str "The"
              , Space
              , Str "code"
              , Space
              , Str "is"
              , Space
              , Str "generated"
              , Space
              , Str "with"
              , Space
              , Str "the"
              , Space
              , Code ( "" , [] , [] ) "-fno-stack-protector"
              , Space
              , Str "option,"
              , SoftBreak
              , Str "to"
              , Space
              , Str "ensure"
              , Space
              , Str "GCC\8217s"
              , Space
              , Str "stack"
              , Space
              , Str "guard"
              , Space
              , Str "feature"
              , Space
              , Str "is"
              , Space
              , Str "disabled."
              , Space
              , Str "We"
              , Space
              , Str "also"
              , Space
              , Str "used"
              , Space
              , Str "the"
              , Space
              , Code ( "" , [] , [] ) "-O1"
              , SoftBreak
              , Str "optimization"
              , Space
              , Str "level."
              ]
          ]
      , Str ","
      , SoftBreak
      , Str "the"
      , Space
      , Str "stack"
      , Space
      , Str "layout"
      , Space
      , Str "looks"
      , Space
      , Str "like"
      , Space
      , Str "this:"
      ]
  , Figure
      ( "" , [] , [] )
      (Caption
         Nothing
         [ Plain
             [ Str "Stack"
             , Space
             , Str "frame"
             , Space
             , Str "layout"
             , Space
             , Str "for"
             , Space
             , Str "stack"
             , Space
             , Str "buffer"
             , Space
             , Str "overflow"
             , Space
             , Str "example"
             ]
         ])
      [ Plain
          [ Image
              ( "" , [] , [ ( "width" , "80%" ) ] )
              [ Str "Stack"
              , Space
              , Str "frame"
              , Space
              , Str "layout"
              , Space
              , Str "for"
              , Space
              , Str "stack"
              , Space
              , Str "buffer"
              , Space
              , Str "overflow"
              , Space
              , Str "example"
              ]
              ( "img/stack-buffer-overflow" , "" )
          ]
      ]
  , Para
      [ Str "The"
      , Space
      , Str "exact"
      , Space
      , Str "details"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "stack"
      , Space
      , Str "frame"
      , Space
      , Str "layout,"
      , Space
      , Str "including"
      , Space
      , Str "the"
      , Space
      , Str "ordering"
      , Space
      , Str "of"
      , SoftBreak
      , Str "variables"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , Space
      , Str "exact"
      , Space
      , Str "control"
      , Space
      , Str "information"
      , Space
      , Str "stored,"
      , Space
      , Str "will"
      , Space
      , Str "depend"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "specific"
      , SoftBreak
      , Str "compiler"
      , Space
      , Str "version"
      , Space
      , Str "you"
      , Space
      , Str "use"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , Space
      , Str "architecture"
      , Space
      , Str "you"
      , Space
      , Str "compile"
      , Space
      , Str "for."
      ]
  , Para
      [ Str "As"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "seen"
      , Space
      , Str "the"
      , Space
      , Str "stack"
      , Space
      , Str "diagram,"
      , Space
      , Str "an"
      , Space
      , Str "overflowing"
      , Space
      , Str "write"
      , Space
      , Str "in"
      , Space
      , Str "function"
      , SoftBreak
      , Code ( "" , [] , [] ) "copy_and_print"
      , Space
      , Str "can"
      , Space
      , Str "overwrite"
      , Space
      , Str "the"
      , Space
      , Str "saved"
      , Space
      , Str "frame"
      , Space
      , Str "pointer"
      , Space
      , Str "(FP)"
      , Space
      , Str "and"
      , Space
      , Str "link"
      , Space
      , Str "register"
      , SoftBreak
      , Str "(LR)"
      , Space
      , Str "in"
      , Space
      , Code ( "" , [] , [] ) "main"
      , Str "\8217s"
      , Space
      , Str "frame."
      , Space
      , Str "When"
      , Space
      , Code ( "" , [] , [] ) "copy_and_print"
      , Space
      , Str "returns,"
      , Space
      , Str "execution"
      , Space
      , Str "continues"
      , Space
      , Str "in"
      , SoftBreak
      , Code ( "" , [] , [] ) "main"
      , Str "."
      , Space
      , Str "When"
      , Space
      , Code ( "" , [] , [] ) "main"
      , Space
      , Str "returns,"
      , Space
      , Str "however,"
      , Space
      , Str "execution"
      , Space
      , Str "continues"
      , Space
      , Str "from"
      , Space
      , Str "the"
      , Space
      , Str "address"
      , SoftBreak
      , Str "stored"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "saved"
      , Space
      , Str "LR,"
      , Space
      , Str "which"
      , Space
      , Str "has"
      , Space
      , Str "been"
      , Space
      , Str "overwritten."
      , Space
      , Str "Therefore,"
      , Space
      , Str "when"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , SoftBreak
      , Str "can"
      , Space
      , Str "choose"
      , Space
      , Str "the"
      , Space
      , Str "value"
      , Space
      , Str "that"
      , Space
      , Str "overwrites"
      , Space
      , Str "the"
      , Space
      , Str "saved"
      , Space
      , Str "LR,"
      , Space
      , Str "it\8217s"
      , Space
      , Str "possible"
      , Space
      , Str "to"
      , Space
      , Str "control"
      , SoftBreak
      , Str "where"
      , Space
      , Str "the"
      , Space
      , Str "program"
      , Space
      , Str "resumes"
      , Space
      , Str "execution"
      , Space
      , Str "after"
      , Space
      , Str "returning"
      , Space
      , Str "from"
      , Space
      , Code ( "" , [] , [] ) "main"
      , Str "."
      ]
  , Para
      [ Str "Before"
      , Space
      , Str "non-executable"
      , Space
      , Str "stacks"
      , Space
      , Str "were"
      , Space
      , Str "mainstream,"
      , Space
      , Str "a"
      , Space
      , Str "common"
      , Space
      , Str "way"
      , Space
      , Str "to"
      , Space
      , Str "exploit"
      , Space
      , Str "these"
      , SoftBreak
      , Str "vulnerabilities"
      , Space
      , Str "would"
      , Space
      , Str "be"
      , Space
      , Str "to"
      , Space
      , Str "use"
      , Space
      , Str "the"
      , Space
      , Str "overflow"
      , Space
      , Str "to"
      , Space
      , Str "simultaneously"
      , Space
      , Str "write"
      , SoftBreak
      , Str "shellcode"
      , Note
          [ Para
              [ Str "A"
              , Space
              , Str "shellcode"
              , Space
              , Str "is"
              , Space
              , Str "a"
              , Space
              , Str "short"
              , Space
              , Str "instruction"
              , Space
              , Str "sequence"
              , Space
              , Str "that"
              , Space
              , Str "performs"
              , Space
              , Str "an"
              , SoftBreak
              , Str "action"
              , Space
              , Str "such"
              , Space
              , Str "as"
              , Space
              , Str "starting"
              , Space
              , Str "a"
              , Space
              , Str "shell"
              , Space
              , Str "on"
              , Space
              , Str "the"
              , Space
              , Str "victim"
              , Space
              , Str "machine."
              ]
          ]
      , RawInline (Format "tex") "\\index{shellcode}"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "stack"
      , Space
      , Str "and"
      , Space
      , Str "overwrite"
      , Space
      , Str "the"
      , Space
      , Str "return"
      , SoftBreak
      , Str "address"
      , Space
      , Str "so"
      , Space
      , Str "that"
      , Space
      , Str "it"
      , Space
      , Str "points"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "shellcode."
      , Space
      , Cite
          [ Citation
              { citationId = "AlephOne1996"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 16
              , citationHash = 0
              }
          ]
          [ Str "[@AlephOne1996]" ]
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "classic"
      , SoftBreak
      , Str "example"
      , Space
      , Str "of"
      , Space
      , Str "this"
      , Space
      , Str "technique."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "obvious"
      , Space
      , Str "solution"
      , Space
      , Str "to"
      , Space
      , Str "this"
      , Space
      , Str "issue"
      , Space
      , Str "is"
      , Space
      , Str "to"
      , Space
      , Str "use"
      , Space
      , Str "memory"
      , Space
      , Str "protection"
      , Space
      , Str "features"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , SoftBreak
      , Str "processor"
      , Space
      , Str "in"
      , Space
      , Str "order"
      , Space
      , Str "to"
      , Space
      , Str "mark"
      , Space
      , Str "the"
      , Space
      , Str "stack"
      , Space
      , Str "(along"
      , Space
      , Str "with"
      , Space
      , Str "other"
      , Space
      , Str "data"
      , Space
      , Str "sections)"
      , Space
      , Str "as"
      , SoftBreak
      , Str "non-executable"
      , Note
          [ Para
              [ Str "Note"
              , Space
              , Str "that"
              , Space
              , Str "the"
              , Space
              , Str "use"
              , Space
              , Str "of"
              , Space
              , Link
                  ( "" , [] , [] )
                  [ Str "nested" , SoftBreak , Str "functions" ]
                  ( "https://gcc.gnu.org/onlinedocs/gcc/Nested-Functions.html"
                  , ""
                  )
              , Space
              , Str "in"
              , Space
              , Str "GCC"
              , SoftBreak
              , Str "requires"
              , Space
              , Link
                  ( "" , [] , [] )
                  [ Str "trampolines" ]
                  ( "https://gcc.gnu.org/onlinedocs/gccint/Trampolines.html"
                  , ""
                  )
              , SoftBreak
              , Str "which"
              , Space
              , Str "reside"
              , Space
              , Str "on"
              , Space
              , Str "an"
              , Space
              , Str "executable"
              , Space
              , Str "stack."
              , Space
              , Str "The"
              , Space
              , Str "use"
              , Space
              , Str "of"
              , Space
              , Str "nested"
              , Space
              , Str "functions,"
              , Space
              , Str "therefore,"
              , SoftBreak
              , Str "poses"
              , Space
              , Str "a"
              , Space
              , Str "security"
              , Space
              , Str "risk."
              ]
          ]
      , Str "."
      , Space
      , Str "However,"
      , Space
      , Str "even"
      , Space
      , Str "when"
      , Space
      , Str "the"
      , Space
      , Str "stack"
      , Space
      , Str "is"
      , Space
      , Str "not"
      , Space
      , Str "executable,"
      , SoftBreak
      , Str "more"
      , Space
      , Str "advanced"
      , Space
      , Str "techniques"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "used"
      , Space
      , Str "to"
      , Space
      , Str "exploit"
      , Space
      , Str "an"
      , Space
      , Str "overflow"
      , Space
      , Str "that"
      , Space
      , Str "overwrites"
      , Space
      , Str "the"
      , SoftBreak
      , Str "return"
      , Space
      , Str "address."
      , Space
      , Str "These"
      , Space
      , Str "take"
      , Space
      , Str "advantage"
      , Space
      , Str "of"
      , Space
      , Str "code"
      , Space
      , Str "that"
      , Space
      , Str "already"
      , Space
      , Str "exists"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , SoftBreak
      , Str "executable"
      , Space
      , Str "or"
      , Space
      , Str "in"
      , Space
      , Str "library"
      , Space
      , Str "code,"
      , Space
      , Str "and"
      , Space
      , Str "will"
      , Space
      , Str "be"
      , Space
      , Str "described"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "next"
      , Space
      , Str "section."
      ]
  , Para
      [ Str "Stack"
      , Space
      , Str "canaries"
      , Space
      , Str "are"
      , Space
      , Str "an"
      , Space
      , Str "alternative"
      , Space
      , Str "mitigation"
      , Space
      , Str "for"
      , Space
      , Str "stack"
      , Space
      , Str "buffer"
      , Space
      , Str "overflows."
      , Space
      , Str "The"
      , SoftBreak
      , Str "general"
      , Space
      , Str "idea"
      , Space
      , Str "is"
      , Space
      , Str "to"
      , Space
      , Str "store"
      , Space
      , Str "a"
      , Space
      , Str "known"
      , Space
      , Str "value,"
      , Space
      , Str "called"
      , Space
      , Str "the"
      , Space
      , Str "stack"
      , Space
      , Str "canary,"
      , Space
      , Str "between"
      , Space
      , Str "the"
      , SoftBreak
      , Str "buffer"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , Space
      , Str "control"
      , Space
      , Str "information"
      , Space
      , Str "(in"
      , Space
      , Str "the"
      , Space
      , Str "example,"
      , Space
      , Str "the"
      , Space
      , Str "saved"
      , Space
      , Str "FP"
      , Space
      , Str "and"
      , Space
      , Str "LR),"
      , Space
      , Str "and"
      , SoftBreak
      , Str "to"
      , Space
      , Str "check"
      , Space
      , Str "this"
      , Space
      , Str "value"
      , Space
      , Str "before"
      , Space
      , Str "leaving"
      , Space
      , Str "the"
      , Space
      , Str "function."
      , Space
      , Str "Since"
      , Space
      , Str "an"
      , Space
      , Str "overflow"
      , Space
      , Str "that"
      , Space
      , Str "would"
      , SoftBreak
      , Str "overwrite"
      , Space
      , Str "the"
      , Space
      , Str "return"
      , Space
      , Str "address"
      , Space
      , Str "is"
      , Space
      , Str "going"
      , Space
      , Str "to"
      , Space
      , Str "overwrite"
      , Space
      , Str "the"
      , Space
      , Str "canary"
      , Space
      , Str "first,"
      , Space
      , Str "a"
      , Space
      , Str "corruption"
      , Space
      , Str "of"
      , SoftBreak
      , Str "the"
      , Space
      , Str "return"
      , Space
      , Str "address"
      , Space
      , Str "through"
      , Space
      , Str "a"
      , Space
      , Str "stack"
      , Space
      , Str "buffer"
      , Space
      , Str "overflow"
      , Space
      , Str "will"
      , Space
      , Str "be"
      , Space
      , Str "detected."
      ]
  , Para
      [ Str "This"
      , Space
      , Str "technique"
      , Space
      , Str "has"
      , Space
      , Str "a"
      , Space
      , Str "few"
      , Space
      , Str "limitations:"
      , Space
      , Str "first"
      , Space
      , Str "of"
      , Space
      , Str "all,"
      , Space
      , Str "it"
      , Space
      , Str "specifically"
      , Space
      , Str "aims"
      , Space
      , Str "to"
      , SoftBreak
      , Str "protect"
      , Space
      , Str "against"
      , Space
      , Str "stack"
      , Space
      , Str "buffer"
      , Space
      , Str "overflows,"
      , Space
      , Str "and"
      , Space
      , Str "does"
      , Space
      , Str "nothing"
      , Space
      , Str "to"
      , Space
      , Str "protect"
      , Space
      , Str "against"
      , SoftBreak
      , Str "stronger"
      , Space
      , Str "primitives"
      , Space
      , Str "(e.g.\160arbitrary"
      , Space
      , Str "write"
      , Space
      , Str "primitives)."
      , Space
      , Str "Control-flow"
      , Space
      , Str "integrity"
      , SoftBreak
      , Str "techniques,"
      , Space
      , Str "which"
      , Space
      , Str "are"
      , Space
      , Str "described"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "next"
      , Space
      , Str "section,"
      , Space
      , Str "aim"
      , Space
      , Str "to"
      , Space
      , Str "protect"
      , Space
      , Str "the"
      , SoftBreak
      , Str "integrity"
      , Space
      , Str "of"
      , Space
      , Str "stored"
      , Space
      , Str "code"
      , Space
      , Str "pointers"
      , Space
      , Str "against"
      , Space
      , Str "any"
      , Space
      , Str "modification."
      ]
  , Para
      [ Str "Secondly,"
      , Space
      , Str "since"
      , Space
      , Str "a"
      , Space
      , Str "compiler"
      , Space
      , Str "needs"
      , Space
      , Str "to"
      , Space
      , Str "generate"
      , Space
      , Str "additional"
      , Space
      , Str "instructions"
      , Space
      , Str "for"
      , SoftBreak
      , Str "ensuring"
      , Space
      , Str "the"
      , Space
      , Str "canary\8217s"
      , Space
      , Str "integrity,"
      , Space
      , Str "heuristics"
      , Space
      , Str "are"
      , Space
      , Str "usually"
      , Space
      , Str "employed"
      , Space
      , Str "to"
      , Space
      , Str "determine"
      , SoftBreak
      , Str "which"
      , Space
      , Str "functions"
      , Space
      , Str "are"
      , Space
      , Str "considered"
      , Space
      , Str "vulnerable."
      , Space
      , Str "The"
      , Space
      , Str "additional"
      , Space
      , Str "instructions"
      , Space
      , Str "are"
      , Space
      , Str "then"
      , SoftBreak
      , Str "generated"
      , Space
      , Str "only"
      , Space
      , Str "for"
      , Space
      , Str "the"
      , Space
      , Str "functions"
      , Space
      , Str "that"
      , Space
      , Str "are"
      , Space
      , Str "considered"
      , Space
      , Str "vulnerable."
      , Space
      , Str "Since"
      , SoftBreak
      , Str "heuristics"
      , Space
      , Str "aren\8217t"
      , Space
      , Str "always"
      , Space
      , Str "perfect,"
      , Space
      , Str "this"
      , Space
      , Str "poses"
      , Space
      , Str "another"
      , Space
      , Str "potential"
      , Space
      , Str "limitation"
      , Space
      , Str "of"
      , SoftBreak
      , Str "the"
      , Space
      , Str "technique."
      , Space
      , Str "To"
      , Space
      , Str "address"
      , Space
      , Str "this,"
      , Space
      , Str "compilers"
      , Space
      , Str "can"
      , Space
      , Str "introduce"
      , Space
      , Str "various"
      , Space
      , Str "levels"
      , Space
      , Str "of"
      , SoftBreak
      , Str "heuristics,"
      , Space
      , Str "ranging"
      , Space
      , Str "from"
      , Space
      , Str "applying"
      , Space
      , Str "the"
      , Space
      , Str "mitigations"
      , Space
      , Str "only"
      , Space
      , Str "to"
      , Space
      , Str "a"
      , Space
      , Str "small"
      , Space
      , Str "proportion"
      , Space
      , Str "of"
      , SoftBreak
      , Str "functions,"
      , Space
      , Str "to"
      , Space
      , Str "applying"
      , Space
      , Str "it"
      , Space
      , Str "universally."
      , Space
      , Str "See,"
      , Space
      , Str "for"
      , Space
      , Str "example,"
      , Space
      , Str "the"
      , SoftBreak
      , Code ( "" , [] , [] ) "-fstack-protector"
      , Str ","
      , Space
      , Code ( "" , [] , [] ) "-fstack-protector-strong"
      , Space
      , Str "and"
      , Space
      , Code ( "" , [] , [] ) "-fstack-protector-all"
      , SoftBreak
      , Str "options"
      , Space
      , Str "offered"
      , Space
      , Str "by"
      , Space
      , Str "both"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "GCC" ]
          ( "https://gcc.gnu.org/onlinedocs/gcc/Instrumentation-Options.html"
          , ""
          )
      , Space
      , Str "and"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "Clang" ]
          ( "https://clang.llvm.org/docs/ClangCommandLineReference.html#cmdoption-clang-fstack-protector"
          , ""
          )
      , Str "."
      ]
  , Para
      [ Str "Another"
      , Space
      , Str "limitation"
      , Space
      , Str "is"
      , Space
      , Str "the"
      , Space
      , Str "possibility"
      , Space
      , Str "of"
      , Space
      , Str "leaks"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "canary"
      , Space
      , Str "value."
      , Space
      , Str "The"
      , Space
      , Str "canary"
      , SoftBreak
      , Str "value"
      , Space
      , Str "is"
      , Space
      , Str "often"
      , Space
      , Str "randomized"
      , Space
      , Str "at"
      , Space
      , Str "program"
      , Space
      , Str "start"
      , Space
      , Str "but"
      , Space
      , Str "remains"
      , Space
      , Str "the"
      , Space
      , Str "same"
      , Space
      , Str "during"
      , Space
      , Str "the"
      , SoftBreak
      , Str "program\8217s"
      , Space
      , Str "execution."
      , Space
      , Str "An"
      , Space
      , Str "attacker"
      , Space
      , Str "who"
      , Space
      , Str "manages"
      , Space
      , Str "to"
      , Space
      , Str "obtain"
      , Space
      , Str "the"
      , Space
      , Str "canary"
      , Space
      , Str "value"
      , Space
      , Str "at"
      , SoftBreak
      , Str "some"
      , Space
      , Str "point"
      , Space
      , Str "might,"
      , Space
      , Str "therefore,"
      , Space
      , Str "be"
      , Space
      , Str "able"
      , Space
      , Str "to"
      , Space
      , Str "reuse"
      , Space
      , Str "the"
      , Space
      , Str "leaked"
      , Space
      , Str "canary"
      , Space
      , Str "value"
      , Space
      , Str "and"
      , SoftBreak
      , Str "corrupt"
      , Space
      , Str "control"
      , Space
      , Str "information"
      , Space
      , Str "while"
      , Space
      , Str "avoiding"
      , Space
      , Str "detection."
      , Space
      , Str "Choosing"
      , Space
      , Str "a"
      , Space
      , Str "canary"
      , Space
      , Str "value"
      , SoftBreak
      , Str "that"
      , Space
      , Str "includes"
      , Space
      , Str "a"
      , Space
      , Str "null"
      , Space
      , Str "byte"
      , Space
      , Str "(the"
      , Space
      , Str "C-style"
      , Space
      , Str "string"
      , Space
      , Str "terminator)"
      , Space
      , Str "might"
      , Space
      , Str "help"
      , Space
      , Str "in"
      , SoftBreak
      , Str "limiting"
      , Space
      , Str "the"
      , Space
      , Str "damage"
      , Space
      , Str "of"
      , Space
      , Str "overflows"
      , Space
      , Str "coming"
      , Space
      , Str "from"
      , Space
      , Str "string"
      , Space
      , Str "manipulation"
      , Space
      , Str "functions,"
      , SoftBreak
      , Str "even"
      , Space
      , Str "when"
      , Space
      , Str "the"
      , Space
      , Str "value"
      , Space
      , Str "is"
      , Space
      , Str "leaked."
      ]
  , Para
      [ Str "Many"
      , Space
      , Str "buffer"
      , Space
      , Str "overflow"
      , Space
      , Str "vulnerabilities"
      , Space
      , Str "result"
      , Space
      , Str "from"
      , Space
      , Str "the"
      , Space
      , Str "use"
      , Space
      , Str "of"
      , Space
      , Str "unsafe"
      , Space
      , Str "library"
      , SoftBreak
      , Str "functions,"
      , Space
      , Str "such"
      , Space
      , Str "as"
      , Space
      , Code ( "" , [] , [] ) "gets"
      , Str ","
      , Space
      , Str "or"
      , Space
      , Str "from"
      , Space
      , Str "the"
      , Space
      , Str "unsafe"
      , Space
      , Str "use"
      , Space
      , Str "of"
      , Space
      , Str "library"
      , Space
      , Str "functions"
      , Space
      , Str "such"
      , Space
      , Str "as"
      , SoftBreak
      , Code ( "" , [] , [] ) "strcpy"
      , Str "."
      , Space
      , Str "There"
      , Space
      , Str "is"
      , Space
      , Str "extensive"
      , Space
      , Str "literature"
      , Space
      , Str "on"
      , Space
      , Str "writing"
      , Space
      , Str "secure"
      , SoftBreak
      , Str "C/C++"
      , RawInline (Format "tex") "\\index{C}"
      , RawInline (Format "tex") "\\index{C++}"
      , Space
      , Str "code,"
      , Space
      , Str "for"
      , Space
      , Str "example"
      , Space
      , Cite
          [ Citation
              { citationId = "Seacord2013"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 18
              , citationHash = 0
              }
          ]
          [ Str "[@Seacord2013]" ]
      , Space
      , Str "and"
      , Space
      , Cite
          [ Citation
              { citationId = "Dowd2006"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 19
              , citationHash = 0
              }
          ]
          [ Str "[@Dowd2006]" ]
      , Str "."
      , Space
      , Str "A"
      , SoftBreak
      , Str "different"
      , Space
      , Str "approach"
      , Space
      , Str "to"
      , Space
      , Str "limiting"
      , Space
      , Str "the"
      , Space
      , Str "effects"
      , Space
      , Str "of"
      , Space
      , Str "overflows"
      , Space
      , Str "is"
      , Space
      , Str "library"
      , Space
      , Str "function"
      , SoftBreak
      , Str "hardening,"
      , Space
      , Str "which"
      , Space
      , Str "aims"
      , Space
      , Str "to"
      , Space
      , Str "detect"
      , Space
      , Str "buffer"
      , Space
      , Str "overflows"
      , Space
      , Str "and"
      , Space
      , Str "terminate"
      , Space
      , Str "the"
      , Space
      , Str "program"
      , SoftBreak
      , Str "gracefully."
      , Space
      , Str "This"
      , Space
      , Str "involves"
      , Space
      , Str "the"
      , Space
      , Str "introduction"
      , Space
      , Str "of"
      , Space
      , Str "feature"
      , Space
      , Str "macros"
      , Space
      , Str "like"
      , SoftBreak
      , Code ( "" , [] , [] ) "_FORTIFY_SOURCE"
      , Space
      , Cite
          [ Citation
              { citationId = "Sharma2014"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 20
              , citationHash = 0
              }
          ]
          [ Str "[@Sharma2014]" ]
      , Str "."
      ]
  , Para
      [ Str "Finally,"
      , Space
      , Str "it\8217s"
      , Space
      , Str "important"
      , Space
      , Str "to"
      , Space
      , Str "mention"
      , Space
      , Str "that"
      , Space
      , Str "not"
      , Space
      , Str "all"
      , Space
      , Str "buffer"
      , Space
      , Str "overflows"
      , Space
      , Str "aim"
      , Space
      , Str "to"
      , SoftBreak
      , Str "overwrite"
      , Space
      , Str "a"
      , Space
      , Str "saved"
      , Space
      , Str "return"
      , Space
      , Str "address."
      , Space
      , Str "There"
      , Space
      , Str "are"
      , Space
      , Str "many"
      , Space
      , Str "cases"
      , Space
      , Str "where"
      , Space
      , Str "a"
      , Space
      , Str "buffer"
      , Space
      , Str "overflow"
      , SoftBreak
      , Str "can"
      , Space
      , Str "overwrite"
      , Space
      , Str "other"
      , Space
      , Str "data"
      , Space
      , Str "adjacent"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "buffer,"
      , Space
      , Str "for"
      , Space
      , Str "example"
      , Space
      , Str "an"
      , Space
      , Str "adjacent"
      , SoftBreak
      , Str "variable"
      , Space
      , Str "that"
      , Space
      , Str "determines"
      , Space
      , Str "whether"
      , Space
      , Str "authorization"
      , Space
      , Str "was"
      , Space
      , Str "successful,"
      , Space
      , Str "or"
      , Space
      , Str "a"
      , Space
      , Str "function"
      , SoftBreak
      , Str "pointer"
      , Space
      , Str "that,"
      , Space
      , Str "when"
      , Space
      , Str "modified,"
      , Space
      , Str "can"
      , Space
      , Str "modify"
      , Space
      , Str "the"
      , Space
      , Str "program\8217s"
      , Space
      , Str "control"
      , Space
      , Str "flow"
      , Space
      , Str "according"
      , Space
      , Str "to"
      , SoftBreak
      , Str "the"
      , Space
      , Str "attacker\8217s"
      , Space
      , Str "wishes."
      ]
  , Para
      [ Str "Some"
      , Space
      , Str "of"
      , Space
      , Str "these"
      , Space
      , Str "vulnerabilities"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "mitigated"
      , Space
      , Str "with"
      , Space
      , Str "the"
      , Space
      , Str "measures"
      , Space
      , Str "described"
      , Space
      , Str "in"
      , SoftBreak
      , Str "this"
      , Space
      , Str "section,"
      , Space
      , Str "but"
      , Space
      , Str "often"
      , Space
      , Str "more"
      , Space
      , Str "general"
      , Space
      , Str "measures"
      , Space
      , Str "to"
      , Space
      , Str "ensure"
      , Space
      , Str "memory"
      , Space
      , Str "safety"
      , Space
      , Str "or"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "Control-Flow" , Space , Str "Integrity" ]
          ( "#cfi" , "" )
      , Space
      , Str "are"
      , Space
      , Str "necessary."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "in"
      , Space
      , Str "addition"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , SoftBreak
      , Str "hardening"
      , Space
      , Str "of"
      , Space
      , Str "specific"
      , Space
      , Str "library"
      , Space
      , Str "functions,"
      , Space
      , Str "compilers"
      , Space
      , Str "can"
      , Space
      , Str "also"
      , Space
      , Str "implement"
      , Space
      , Str "automatic"
      , SoftBreak
      , Str "bounds"
      , Space
      , Str "checking"
      , Space
      , Str "for"
      , Space
      , Str "arrays"
      , Space
      , Str "where"
      , Space
      , Str "the"
      , Space
      , Str "array"
      , Space
      , Str "bound"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "statically"
      , Space
      , Str "determined"
      , SoftBreak
      , Str "("
      , Code ( "" , [] , [] ) "-fsanitize=bounds"
      , Str "),"
      , Space
      , Str "as"
      , Space
      , Str "well"
      , Space
      , Str "as"
      , Space
      , Str "various"
      , Space
      , Str "other"
      , Space
      , Quoted DoubleQuote [ Str "sanitizers" ]
      , Str "."
      , Space
      , Str "We"
      , Space
      , Str "will"
      , Space
      , Str "describe"
      , SoftBreak
      , Str "these"
      , Space
      , Str "measures"
      , Space
      , Str "in"
      , Space
      , Str "following"
      , Space
      , Str "sections."
      ]
  , Header
      2
      ( "code-reuse-attacks" , [] , [] )
      [ Str "Code" , Space , Str "reuse" , Space , Str "attacks" ]
  , Para
      [ Str "In"
      , Space
      , Str "the"
      , Space
      , Str "early"
      , Space
      , Str "days"
      , Space
      , Str "of"
      , Space
      , Str "memory"
      , Space
      , Str "vulnerability"
      , Space
      , Str "exploitation,"
      , Space
      , Str "attackers"
      , Space
      , Str "could"
      , Space
      , Str "simply"
      , SoftBreak
      , Str "place"
      , Space
      , Str "shellcode"
      , RawInline (Format "tex") "\\index{shellcode}"
      , Space
      , Str "of"
      , Space
      , Str "their"
      , Space
      , Str "choice"
      , Space
      , Str "in"
      , Space
      , Str "executable"
      , Space
      , Str "memory"
      , Space
      , Str "and"
      , Space
      , Str "jump"
      , SoftBreak
      , Str "to"
      , Space
      , Str "it."
      , Space
      , Str "As"
      , Space
      , Str "non-executable"
      , Space
      , Str "stack"
      , Space
      , Str "and"
      , Space
      , Str "heap"
      , Space
      , Str "became"
      , Space
      , Str "mainstream,"
      , Space
      , Str "attackers"
      , Space
      , Str "started"
      , Space
      , Str "to"
      , SoftBreak
      , Str "reuse"
      , Space
      , Str "code"
      , Space
      , Str "already"
      , Space
      , Str "present"
      , Space
      , Str "in"
      , Space
      , Str "an"
      , Space
      , Str "application\8217s"
      , Space
      , Str "binary"
      , Space
      , Str "and"
      , Space
      , Str "linked"
      , Space
      , Str "libraries"
      , SoftBreak
      , Str "instead."
      , Space
      , Str "A"
      , Space
      , Str "variety"
      , Space
      , Str "of"
      , Space
      , Str "different"
      , Space
      , Str "techniques"
      , Space
      , Str "to"
      , Space
      , Str "this"
      , Space
      , Str "effect"
      , Space
      , Str "came"
      , Space
      , Str "to"
      , Space
      , Str "light."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "simplest"
      , Space
      , Str "of"
      , Space
      , Str "these"
      , Space
      , Str "techniques"
      , Space
      , Str "is"
      , Space
      , Str "return-to-libc"
      , Space
      , Cite
          [ Citation
              { citationId = "Solar1997"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 21
              , citationHash = 0
              }
          ]
          [ Str "[@Solar1997]" ]
      , Str "."
      , Space
      , Str "Instead"
      , Space
      , Str "of"
      , SoftBreak
      , Str "returning"
      , Space
      , Str "to"
      , Space
      , Str "shellcode"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "has"
      , Space
      , Str "injected,"
      , Space
      , Str "the"
      , Space
      , Str "return"
      , Space
      , Str "address"
      , Space
      , Str "is"
      , SoftBreak
      , Str "modified"
      , Space
      , Str "to"
      , Space
      , Str "return"
      , Space
      , Str "into"
      , Space
      , Str "a"
      , Space
      , Str "library"
      , Space
      , Str "function,"
      , Space
      , Str "such"
      , Space
      , Str "as"
      , Space
      , Code ( "" , [] , [] ) "system"
      , Space
      , Str "or"
      , Space
      , Code ( "" , [] , [] ) "exec"
      , Str "."
      , Space
      , Str "This"
      , SoftBreak
      , Str "technique"
      , Space
      , Str "is"
      , Space
      , Str "simpler"
      , Space
      , Str "to"
      , Space
      , Str "use"
      , Space
      , Str "when"
      , Space
      , Str "arguments"
      , Space
      , Str "are"
      , Space
      , Str "also"
      , Space
      , Str "passed"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "stack"
      , Space
      , Str "and"
      , SoftBreak
      , Str "can"
      , Space
      , Str "therefore"
      , Space
      , Str "be"
      , Space
      , Str "controlled"
      , Space
      , Str "with"
      , Space
      , Str "the"
      , Space
      , Str "same"
      , Space
      , Str "stack"
      , Space
      , Str "buffer"
      , Space
      , Str "overflow"
      , Space
      , Str "that"
      , Space
      , Str "is"
      , Space
      , Str "used"
      , SoftBreak
      , Str "to"
      , Space
      , Str "modify"
      , Space
      , Str "the"
      , Space
      , Str "address."
      ]
  , Header
      3
      ( "return-oriented-programming" , [] , [] )
      [ Str "Return-oriented" , Space , Str "programming" ]
  , Para
      [ Str "Return-to-libc"
      , Space
      , Str "attacks"
      , Space
      , Str "restrict"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "to"
      , Space
      , Str "whole"
      , Space
      , Str "library"
      , Space
      , Str "functions."
      , Space
      , Str "While"
      , SoftBreak
      , Str "this"
      , Space
      , Str "can"
      , Space
      , Str "lead"
      , Space
      , Str "to"
      , Space
      , Str "powerful"
      , Space
      , Str "attacks,"
      , Space
      , Str "it"
      , Space
      , Str "has"
      , Space
      , Str "also"
      , Space
      , Str "been"
      , Space
      , Str "demonstrated"
      , Space
      , Str "that"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , SoftBreak
      , Str "possible"
      , Space
      , Str "to"
      , Space
      , Str "achieve"
      , Space
      , Str "arbitrary"
      , Space
      , Str "computation"
      , Space
      , Str "by"
      , Space
      , Str "combining"
      , Space
      , Str "a"
      , Space
      , Str "number"
      , Space
      , Str "of"
      , Space
      , Str "short"
      , SoftBreak
      , Str "instruction"
      , Space
      , Str "sequences"
      , Space
      , Str "ending"
      , Space
      , Str "in"
      , Space
      , Str "indirect"
      , Space
      , Str "control"
      , Space
      , Str "transfer"
      , Space
      , Str "instructions,"
      , Space
      , Str "known"
      , SoftBreak
      , Str "as"
      , Space
      , Strong [ Str "gadgets" ]
      , RawInline (Format "tex") "\\index{gadget}"
      , Str "."
      , Space
      , Str "The"
      , Space
      , Str "indirect"
      , Space
      , Str "control"
      , Space
      , Str "transfer"
      , Space
      , Str "instructions"
      , Space
      , Str "make"
      , SoftBreak
      , Str "it"
      , Space
      , Str "easy"
      , Space
      , Str "for"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "to"
      , Space
      , Str "execute"
      , Space
      , Str "gadgets"
      , Space
      , Str "one"
      , Space
      , Str "after"
      , Space
      , Str "another,"
      , Space
      , Str "by"
      , Space
      , Str "controlling"
      , Space
      , Str "the"
      , SoftBreak
      , Str "memory"
      , Space
      , Str "or"
      , Space
      , Str "register"
      , Space
      , Str "that"
      , Space
      , Str "provides"
      , Space
      , Str "each"
      , Space
      , Str "control"
      , Space
      , Str "transfer"
      , Space
      , Str "instruction\8217s"
      , Space
      , Str "target."
      ]
  , Para
      [ Str "In"
      , Space
      , Str "return-oriented"
      , Space
      , Str "programming"
      , Space
      , Str "(ROP)"
      , RawInline
          (Format "tex") "\\index{return-oriented programming (ROP)}"
      , SoftBreak
      , Cite
          [ Citation
              { citationId = "Shacham2007"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 22
              , citationHash = 0
              }
          ]
          [ Str "[@Shacham2007]" ]
      , Str ","
      , Space
      , Str "each"
      , Space
      , Str "gadget"
      , Space
      , Str "performs"
      , Space
      , Str "a"
      , Space
      , Str "simple"
      , Space
      , Str "operation,"
      , Space
      , Str "for"
      , Space
      , Str "example"
      , Space
      , Str "setting"
      , Space
      , Str "a"
      , SoftBreak
      , Str "register,"
      , Space
      , Str "then"
      , Space
      , Str "pops"
      , Space
      , Str "a"
      , Space
      , Str "return"
      , Space
      , Str "address"
      , Space
      , Str "from"
      , Space
      , Str "the"
      , Space
      , Str "stack"
      , Space
      , Str "and"
      , Space
      , Str "returns"
      , Space
      , Str "to"
      , Space
      , Str "it."
      , Space
      , Str "The"
      , SoftBreak
      , Str "attacker"
      , Space
      , Str "constructs"
      , Space
      , Str "a"
      , Space
      , Str "fake"
      , Space
      , Str "call"
      , Space
      , Str "stack"
      , Space
      , Str "(often"
      , Space
      , Str "called"
      , Space
      , Str "a"
      , Space
      , Str "ROP"
      , Space
      , Str "chain"
      , RawInline (Format "tex") "\\index{ROP\nchain}"
      , Str ")"
      , Space
      , Str "which"
      , Space
      , Str "ensures"
      , Space
      , Str "a"
      , Space
      , Str "number"
      , Space
      , Str "of"
      , Space
      , Str "gadgets"
      , Space
      , Str "are"
      , Space
      , Str "executed"
      , Space
      , Str "one"
      , Space
      , Str "after"
      , Space
      , Str "another,"
      , Space
      , Str "in"
      , SoftBreak
      , Str "order"
      , Space
      , Str "to"
      , Space
      , Str "perform"
      , Space
      , Str "a"
      , Space
      , Str "more"
      , Space
      , Str "complex"
      , Space
      , Str "operation."
      ]
  , Para
      [ Str "This"
      , Space
      , Str "will"
      , Space
      , Str "hopefully"
      , Space
      , Str "become"
      , Space
      , Str "more"
      , Space
      , Str "clear"
      , Space
      , Str "with"
      , Space
      , Str "an"
      , Space
      , Str "example:"
      , Space
      , Str "a"
      , Space
      , Str "ROP"
      , Space
      , Str "chain"
      , Space
      , Str "for"
      , Space
      , Str "AArch64"
      , SoftBreak
      , Str "Linux"
      , Space
      , Str "that"
      , Space
      , Str "starts"
      , Space
      , Str "a"
      , Space
      , Str "shell,"
      , Space
      , Str "by"
      , Space
      , Str "calling"
      , Space
      , Code ( "" , [] , [] ) "execve"
      , Space
      , Str "with"
      , Space
      , Code ( "" , [] , [] ) "\"/bin/sh\""
      , Space
      , Str "as"
      , Space
      , Str "an"
      , Space
      , Str "argument."
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "The"
          , Space
          , Str "prototype"
          , Space
          , Str "of"
          , Space
          , Str "the"
          , Space
          , Code ( "" , [] , [] ) "execve"
          , Space
          , Str "library"
          , SoftBreak
          , Str "function"
          ]
          ( "https://man7.org/linux/man-pages/man2/execve.2.html"
          , ""
          )
      , Str ","
      , Space
      , Str "which"
      , Space
      , Str "wraps"
      , Space
      , Str "the"
      , SoftBreak
      , Str "exec"
      , Space
      , Str "system"
      , Space
      , Str "call,"
      , Space
      , Str "is:"
      ]
  , CodeBlock
      ( "" , [] , [] )
      "  int execve(const char *pathname, char *const argv[],\n             char *const envp[]);"
  , Para
      [ Str "For"
      , Space
      , Str "AArch64,"
      , Space
      , Code ( "" , [] , [] ) "pathname"
      , Space
      , Str "will"
      , Space
      , Str "be"
      , Space
      , Str "passed"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Code ( "" , [] , [] ) "x0"
      , Space
      , Str "register,"
      , Space
      , Code ( "" , [] , [] ) "argv"
      , Space
      , Str "will"
      , Space
      , Str "be"
      , SoftBreak
      , Str "passed"
      , Space
      , Str "in"
      , Space
      , Code ( "" , [] , [] ) "x1"
      , Str ","
      , Space
      , Str "and"
      , Space
      , Code ( "" , [] , [] ) "envp"
      , Space
      , Str "in"
      , Space
      , Code ( "" , [] , [] ) "x2"
      , Str "."
      , Space
      , Str "For"
      , Space
      , Str "starting"
      , Space
      , Str "a"
      , Space
      , Str "shell,"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , Space
      , Str "sufficient"
      , SoftBreak
      , Str "to:"
      ]
  , BulletList
      [ [ Plain
            [ Str "Make"
            , Space
            , Code ( "" , [] , [] ) "x0"
            , Space
            , Str "contain"
            , Space
            , Str "a"
            , Space
            , Str "pointer"
            , Space
            , Str "to"
            , Space
            , Code ( "" , [] , [] ) "\"/bin/sh\""
            , Str "."
            ]
        ]
      , [ Plain
            [ Str "Make"
            , Space
            , Code ( "" , [] , [] ) "x1"
            , Space
            , Str "contain"
            , Space
            , Str "a"
            , Space
            , Str "pointer"
            , Space
            , Str "to"
            , Space
            , Str "an"
            , Space
            , Str "array"
            , Space
            , Str "of"
            , Space
            , Str "pointers"
            , Space
            , Str "with"
            , Space
            , Str "two"
            , Space
            , Str "elements:"
            ]
        , BulletList
            [ [ Plain
                  [ Str "The"
                  , Space
                  , Str "first"
                  , Space
                  , Str "element"
                  , Space
                  , Str "is"
                  , Space
                  , Str "a"
                  , Space
                  , Str "pointer"
                  , Space
                  , Str "to"
                  , Space
                  , Code ( "" , [] , [] ) "\"/bin/sh\""
                  , Str "."
                  ]
              ]
            , [ Plain
                  [ Str "The"
                  , Space
                  , Str "second"
                  , Space
                  , Str "element"
                  , Space
                  , Str "is"
                  , Space
                  , Str "zero"
                  , Space
                  , Str "("
                  , Code ( "" , [] , [] ) "NULL"
                  , Str ")."
                  ]
              ]
            ]
        ]
      , [ Plain
            [ Str "Make"
            , Space
            , Code ( "" , [] , [] ) "x2"
            , Space
            , Str "contain"
            , Space
            , Str "zero"
            , Space
            , Str "("
            , Code ( "" , [] , [] ) "NULL"
            , Str ")."
            ]
        ]
      ]
  , Para
      [ Str "This"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "achieved"
      , Space
      , Str "by"
      , Space
      , Str "chaining"
      , Space
      , Str "gadgets"
      , Space
      , Str "to"
      , Space
      , Str "set"
      , Space
      , Str "the"
      , Space
      , Str "registers"
      , Space
      , Code ( "" , [] , [] ) "x0"
      , Str ","
      , Space
      , Code ( "" , [] , [] ) "x1"
      , Str ","
      , SoftBreak
      , Code ( "" , [] , [] ) "x2"
      , Str ","
      , Space
      , Str "and"
      , Space
      , Str "then"
      , Space
      , Str "returning"
      , Space
      , Str "to"
      , Space
      , Code ( "" , [] , [] ) "execve"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "C"
      , Space
      , Str "library."
      ]
  , Para
      [ Str "Let\8217s"
      , Space
      , Str "assume"
      , Space
      , Str "we"
      , Space
      , Str "have"
      , Space
      , Str "the"
      , Space
      , Str "following"
      , Space
      , Str "gadgets:"
      ]
  , OrderedList
      ( 1 , Decimal , Period )
      [ [ Plain
            [ Str "A"
            , Space
            , Str "gadget"
            , Space
            , Str "that"
            , Space
            , Str "loads"
            , Space
            , Code ( "" , [] , [] ) "x0"
            , Space
            , Str "and"
            , Space
            , Code ( "" , [] , [] ) "x1"
            , Space
            , Str "from"
            , Space
            , Str "the"
            , Space
            , Str "stack:"
            ]
        ]
      ]
  , CodeBlock
      ( "" , [] , [] )
      "  gadget_x0_x1:\n    ldp x0, x1, [sp]\n    ldp x20, x19, [sp, #64]\n    ldp x29, x30, [sp, #32]\n    ldr x21, [sp, #48]\n    add sp, sp, #0x50\n    ret"
  , OrderedList
      ( 2 , Decimal , Period )
      [ [ Plain
            [ Str "A"
            , Space
            , Str "gadget"
            , Space
            , Str "that"
            , Space
            , Str "sets"
            , Space
            , Code ( "" , [] , [] ) "x2"
            , Space
            , Str "to"
            , Space
            , Str "zero,"
            , Space
            , Str "but"
            , Space
            , Str "also"
            , Space
            , Str "clears"
            , Space
            , Code ( "" , [] , [] ) "x0"
            , Space
            , Str "as"
            , Space
            , Str "a"
            , Space
            , Str "side-effect:"
            ]
        ]
      ]
  , CodeBlock
      ( "" , [] , [] )
      "  gadget_x2:\n    mov x2, xzr\n    mov x0, x2\n    ldp x20, x19, [sp, #32]\n    ldp x29, x30, [sp]\n    ldr x21, [sp, #16]\n    add sp, sp, #0x30\n    ret"
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "Explain"
          , Space
          , Str "how"
          , Space
          , Str "these"
          , Space
          , Str "gadgets"
          , Space
          , Str "could"
          , Space
          , Str "result"
          , Space
          , Str "from"
          , Space
          , Str "C/C++"
          , Space
          , Str "code."
          , Space
          , Str "The"
          , Space
          , Str "current"
          , SoftBreak
          , Str "versions"
          , Space
          , Str "are"
          , Space
          , Str "slightly"
          , Space
          , Str "tweaked"
          , Space
          , Str "by"
          , Space
          , Str "hand"
          , Space
          , Str "to"
          , Space
          , Str "have"
          , Space
          , Str "more"
          , Space
          , Str "manageable"
          , Space
          , Str "offsets."
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "164" ]
          ]
      ]
  , Para
      [ Str "Both"
      , Space
      , Str "gadgets"
      , Space
      , Str "also"
      , Space
      , Str "clobber"
      , Space
      , Str "several"
      , Space
      , Str "uninteresting"
      , Space
      , Str "registers,"
      , Space
      , Str "but"
      , Space
      , Str "since"
      , SoftBreak
      , Code ( "" , [] , [] ) "gadget_x2"
      , Space
      , Str "also"
      , Space
      , Str "clears"
      , Space
      , Code ( "" , [] , [] ) "x0"
      , Str ","
      , Space
      , Str "it"
      , Space
      , Str "becomes"
      , Space
      , Str "clear"
      , Space
      , Str "that"
      , Space
      , Str "we"
      , Space
      , Str "should"
      , Space
      , Str "use"
      , Space
      , Str "a"
      , SoftBreak
      , Str "ROP"
      , Space
      , Str "chain"
      , Space
      , Str "that:"
      ]
  , OrderedList
      ( 1 , Decimal , Period )
      [ [ Plain
            [ Str "Returns"
            , Space
            , Str "to"
            , Space
            , Code ( "" , [] , [] ) "gadget_x2"
            , Str ","
            , Space
            , Str "which"
            , Space
            , Str "sets"
            , Space
            , Code ( "" , [] , [] ) "x2"
            , Space
            , Str "to"
            , Space
            , Str "zero."
            ]
        ]
      , [ Plain
            [ Str "Returns"
            , Space
            , Str "to"
            , Space
            , Code ( "" , [] , [] ) "gadget_x0_x1"
            , Str ","
            , Space
            , Str "which"
            , Space
            , Str "sets"
            , Space
            , Code ( "" , [] , [] ) "x0"
            , Space
            , Str "and"
            , Space
            , Code ( "" , [] , [] ) "x1"
            , Space
            , Str "to"
            , Space
            , Str "the"
            , Space
            , Str "desired"
            , Space
            , Str "values."
            ]
        ]
      , [ Plain
            [ Str "Returns"
            , Space
            , Str "to"
            , Space
            , Code ( "" , [] , [] ) "execve"
            , Str "."
            ]
        ]
      ]
  , Para
      [ Str "Figure"
      , Space
      , Cite
          [ Citation
              { citationId = "fig:rop-control-flow"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = AuthorInText
              , citationNoteNum = 23
              , citationHash = 0
              }
          ]
          [ Str "@fig:rop-control-flow" ]
      , Space
      , Str "shows"
      , Space
      , Str "this"
      , Space
      , Str "control"
      , Space
      , Str "flow."
      ]
  , Figure
      ( "fig:rop-control-flow" , [] , [] )
      (Caption
         Nothing
         [ Plain
             [ Str "ROP"
             , Space
             , Str "example"
             , Space
             , Str "control"
             , Space
             , Str "flow"
             ]
         ])
      [ Plain
          [ Image
              ( "" , [] , [ ( "width" , "30%" ) ] )
              [ Str "ROP"
              , Space
              , Str "example"
              , Space
              , Str "control"
              , Space
              , Str "flow"
              ]
              ( "img/rop-control-flow" , "" )
          ]
      ]
  , Figure
      ( "fig:rop-call-stack" , [] , [] )
      (Caption
         Nothing
         [ Plain
             [ Str "ROP"
             , Space
             , Str "example"
             , Space
             , Str "fake"
             , Space
             , Str "call"
             , Space
             , Str "stack"
             ]
         ])
      [ Plain
          [ Image
              ( "" , [] , [ ( "width" , "80%" ) ] )
              [ Str "ROP"
              , Space
              , Str "example"
              , Space
              , Str "fake"
              , Space
              , Str "call"
              , Space
              , Str "stack"
              ]
              ( "img/rop-call-stack" , "" )
          ]
      ]
  , Para
      [ Str "We"
      , Space
      , Str "can"
      , Space
      , Str "achieve"
      , Space
      , Str "this"
      , Space
      , Str "by"
      , Space
      , Str "constructing"
      , Space
      , Str "the"
      , Space
      , Str "fake"
      , Space
      , Str "call"
      , Space
      , Str "stack"
      , Space
      , Str "shown"
      , Space
      , Str "in"
      , Space
      , Str "figure"
      , SoftBreak
      , Cite
          [ Citation
              { citationId = "fig:rop-call-stack"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = AuthorInText
              , citationNoteNum = 24
              , citationHash = 0
              }
          ]
          [ Str "@fig:rop-call-stack" ]
      , Str ","
      , Space
      , Str "where"
      , Space
      , Quoted
          DoubleQuote [ Str "Original" , Space , Str "frame" ]
      , Space
      , Str "marks"
      , Space
      , Str "the"
      , Space
      , Str "frame"
      , Space
      , Str "in"
      , Space
      , Str "which"
      , Space
      , Str "the"
      , SoftBreak
      , Str "address"
      , Space
      , Str "of"
      , Space
      , Code ( "" , [] , [] ) "gadget_x2"
      , Space
      , Str "has"
      , Space
      , Str "replaced"
      , Space
      , Str "a"
      , Space
      , Str "saved"
      , Space
      , Str "return"
      , Space
      , Str "address"
      , Space
      , Str "that"
      , Space
      , Str "will"
      , Space
      , Str "be"
      , Space
      , Str "loaded"
      , SoftBreak
      , Str "and"
      , Space
      , Str "returned"
      , Space
      , Str "to"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "future."
      , Space
      , Str "As"
      , Space
      , Str "an"
      , Space
      , Str "alternative,"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "could"
      , Space
      , Str "place"
      , Space
      , Str "this"
      , SoftBreak
      , Str "fake"
      , Space
      , Str "call"
      , Space
      , Str "stack"
      , Space
      , Str "somewhere"
      , Space
      , Str "else,"
      , Space
      , Str "for"
      , Space
      , Str "example"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "heap,"
      , Space
      , Str "and"
      , Space
      , Str "use"
      , Space
      , Str "a"
      , Space
      , Str "primitive"
      , SoftBreak
      , Str "that"
      , Space
      , Str "changes"
      , Space
      , Str "the"
      , Space
      , Str "stack"
      , Space
      , Str "pointer\8217s"
      , Space
      , Str "value"
      , Space
      , Str "instead."
      , Space
      , Str "This"
      , Space
      , Str "is"
      , Space
      , Str "known"
      , Space
      , Str "as"
      , Space
      , Str "stack"
      , SoftBreak
      , Str "pivoting"
      , RawInline (Format "tex") "\\index{stack pivoting}"
      , Str "."
      ]
  , Para
      [ Str "Note"
      , Space
      , Str "that"
      , Space
      , Str "this"
      , Space
      , Str "fake"
      , Space
      , Str "call"
      , Space
      , Str "stack"
      , Space
      , Str "contains"
      , Space
      , Str "NULL"
      , Space
      , Str "bytes,"
      , Space
      , Str "even"
      , Space
      , Str "without"
      , Space
      , Str "considering"
      , SoftBreak
      , Str "the"
      , Space
      , Str "exact"
      , Space
      , Str "values"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "various"
      , Space
      , Str "return"
      , Space
      , Str "addresses"
      , Space
      , Str "included."
      , Space
      , Str "An"
      , Space
      , Str "overflow"
      , Space
      , Str "bug"
      , Space
      , Str "that"
      , SoftBreak
      , Str "is"
      , Space
      , Str "based"
      , Space
      , Str "on"
      , Space
      , Str "a"
      , Space
      , Str "C-style"
      , Space
      , Str "string"
      , Space
      , Str "operation"
      , Space
      , Str "would"
      , Space
      , Str "not"
      , Space
      , Str "allow"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "to"
      , Space
      , Str "replace"
      , SoftBreak
      , Str "the"
      , Space
      , Str "stack"
      , Space
      , Str "contents"
      , Space
      , Str "with"
      , Space
      , Str "this"
      , Space
      , Str "fake"
      , Space
      , Str "call"
      , Space
      , Str "stack"
      , Space
      , Str "in"
      , Space
      , Str "one"
      , Space
      , Str "go,"
      , Space
      , Str "since"
      , Space
      , Str "C-style"
      , Space
      , Str "strings"
      , SoftBreak
      , Str "are"
      , Space
      , Str "null-terminated"
      , Space
      , Str "and"
      , Space
      , Str "copying"
      , Space
      , Str "the"
      , Space
      , Str "fake"
      , Space
      , Str "stack"
      , Space
      , Str "contents"
      , Space
      , Str "would"
      , Space
      , Str "stop"
      , Space
      , Str "once"
      , Space
      , Str "the"
      , SoftBreak
      , Str "first"
      , Space
      , Str "NULL"
      , Space
      , Str "byte"
      , Space
      , Str "is"
      , Space
      , Str "encountered."
      , Space
      , Str "The"
      , Space
      , Str "ROP"
      , Space
      , Str "chain"
      , Space
      , Str "would"
      , Space
      , Str "therefore"
      , Space
      , Str "need"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , SoftBreak
      , Str "adjusted"
      , Space
      , Str "so"
      , Space
      , Str "that"
      , Space
      , Str "it"
      , Space
      , Str "doesn\8217t"
      , Space
      , Str "contain"
      , Space
      , Str "NULL"
      , Space
      , Str "bytes,"
      , Space
      , Str "for"
      , Space
      , Str "example"
      , Space
      , Str "by"
      , Space
      , Str "initially"
      , SoftBreak
      , Str "replacing"
      , Space
      , Str "the"
      , Space
      , Str "NULL"
      , Space
      , Str "bytes"
      , Space
      , Str "with"
      , Space
      , Str "a"
      , Space
      , Str "different"
      , Space
      , Str "byte"
      , Space
      , Str "and"
      , Space
      , Str "adding"
      , Space
      , Str "some"
      , Space
      , Str "more"
      , Space
      , Str "gadgets"
      , Space
      , Str "to"
      , SoftBreak
      , Str "the"
      , Space
      , Str "ROP"
      , Space
      , Str "chain"
      , Space
      , Str "that"
      , Space
      , Str "write"
      , Space
      , Str "zero"
      , Space
      , Str "to"
      , Space
      , Str "those"
      , Space
      , Str "stack"
      , Space
      , Str "locations."
      ]
  , Para
      [ Str "A"
      , Space
      , Str "question"
      , Space
      , Str "that"
      , Space
      , Str "comes"
      , Space
      , Str "up"
      , Space
      , Str "when"
      , Space
      , Str "looking"
      , Space
      , Str "at"
      , Space
      , Str "the"
      , Space
      , Str "stack"
      , Space
      , Str "diagram"
      , Space
      , Str "is"
      , Space
      , Quoted
          DoubleQuote
          [ Str "how"
          , Space
          , Str "do"
          , Space
          , Str "we"
          , SoftBreak
          , Str "know"
          , Space
          , Str "the"
          , Space
          , Str "addresses"
          , Space
          , Str "of"
          , Space
          , Str "these"
          , Space
          , Str "gadgets"
          ]
      , Str "?"
      , Space
      , Str "We"
      , Space
      , Str "will"
      , Space
      , Str "talk"
      , Space
      , Str "a"
      , Space
      , Str "bit"
      , Space
      , Str "more"
      , Space
      , Str "about"
      , Space
      , Str "this"
      , Space
      , Str "in"
      , SoftBreak
      , Str "the"
      , Space
      , Str "next"
      , Space
      , Str "section."
      ]
  , Para
      [ Str "ROP"
      , Space
      , Str "gadgets"
      , Space
      , Str "like"
      , Space
      , Str "the"
      , Space
      , Str "ones"
      , Space
      , Str "used"
      , Space
      , Str "here"
      , Space
      , Str "may"
      , Space
      , Str "be"
      , Space
      , Str "easy"
      , Space
      , Str "to"
      , Space
      , Str "identify"
      , Space
      , Str "by"
      , Space
      , Str "visual"
      , SoftBreak
      , Str "inspection"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "disassembled"
      , Space
      , Str "binary,"
      , Space
      , Str "but"
      , Space
      , Str "it\8217s"
      , Space
      , Str "common"
      , Space
      , Str "for"
      , Space
      , Str "attackers"
      , Space
      , Str "to"
      , Space
      , Str "use"
      , SoftBreak
      , Quoted
          DoubleQuote [ Str "gadget" , Space , Str "scanner" ]
      , RawInline (Format "tex") "\\index{gadget scanner}"
      , Space
      , Str "tools"
      , Space
      , Str "in"
      , Space
      , Str "order"
      , Space
      , Str "to"
      , Space
      , Str "discover"
      , Space
      , Str "large"
      , Space
      , Str "numbers"
      , SoftBreak
      , Str "of"
      , Space
      , Str "gadgets"
      , Space
      , Str "automatically."
      , Space
      , Str "Such"
      , Space
      , Str "tools"
      , Space
      , Str "can"
      , Space
      , Str "also"
      , Space
      , Str "be"
      , Space
      , Str "useful"
      , Space
      , Str "to"
      , Space
      , Str "a"
      , Space
      , Str "compiler"
      , Space
      , Str "engineer"
      , SoftBreak
      , Str "working"
      , Space
      , Str "on"
      , Space
      , Str "a"
      , Space
      , Str "code"
      , Space
      , Str "reuse"
      , Space
      , Str "attack"
      , Space
      , Str "mitigation,"
      , Space
      , Str "as"
      , Space
      , Str "they"
      , Space
      , Str "can"
      , Space
      , Str "point"
      , Space
      , Str "out"
      , Space
      , Str "code"
      , Space
      , Str "sequences"
      , SoftBreak
      , Str "that"
      , Space
      , Str "should"
      , Space
      , Str "be"
      , Space
      , Str "protected"
      , Space
      , Str "and"
      , Space
      , Str "have"
      , Space
      , Str "been"
      , Space
      , Str "missed."
      ]
  , Header
      3
      ( "jump-oriented-programming" , [] , [] )
      [ Str "Jump-oriented" , Space , Str "programming" ]
  , Para
      [ Str "Jump-oriented"
      , Space
      , Str "programming"
      , Space
      , Str "(JOP)"
      , RawInline
          (Format "tex") "\\index{jump-oriented programming (JOP)}"
      , SoftBreak
      , Cite
          [ Citation
              { citationId = "Bletsch2011"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 25
              , citationHash = 0
              }
          ]
          [ Str "[@Bletsch2011]" ]
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "variation"
      , Space
      , Str "on"
      , Space
      , Str "ROP,"
      , Space
      , Str "where"
      , Space
      , Str "gadgets"
      , Space
      , Str "can"
      , Space
      , Str "also"
      , Space
      , Str "end"
      , Space
      , Str "in"
      , Space
      , Str "indirect"
      , SoftBreak
      , Str "branch"
      , Space
      , Str "instructions"
      , Space
      , Str "instead"
      , Space
      , Str "of"
      , Space
      , Str "return"
      , Space
      , Str "instructions."
      , Space
      , Str "The"
      , Space
      , Str "attacker"
      , Space
      , Str "chains"
      , Space
      , Str "a"
      , SoftBreak
      , Str "number"
      , Space
      , Str "of"
      , Space
      , Str "such"
      , Space
      , Str "gadgets"
      , Space
      , Str "through"
      , Space
      , Str "a"
      , Space
      , Str "dispatcher"
      , Space
      , Str "gadget"
      , RawInline (Format "tex") "\\index{dispatcher gadget}"
      , Str ","
      , SoftBreak
      , Str "which"
      , Space
      , Str "loads"
      , Space
      , Str "pointers"
      , Space
      , Str "one"
      , Space
      , Str "after"
      , Space
      , Str "another"
      , Space
      , Str "from"
      , Space
      , Str "an"
      , Space
      , Str "array"
      , Space
      , Str "of"
      , Space
      , Str "pointers,"
      , Space
      , Str "and"
      , Space
      , Str "branches"
      , SoftBreak
      , Str "to"
      , Space
      , Str "each"
      , Space
      , Str "one"
      , Space
      , Str "in"
      , Space
      , Str "return."
      , Space
      , Str "The"
      , Space
      , Str "gadgets"
      , Space
      , Str "used"
      , Space
      , Str "must"
      , Space
      , Str "be"
      , Space
      , Str "set"
      , Space
      , Str "up"
      , Space
      , Str "so"
      , Space
      , Str "that"
      , Space
      , Str "they"
      , Space
      , Str "branch"
      , Space
      , Str "or"
      , SoftBreak
      , Str "return"
      , Space
      , Str "back"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "dispatcher"
      , Space
      , Str "after"
      , Space
      , Str "they\8217re"
      , Space
      , Str "done."
      , Space
      , Str "This"
      , Space
      , Str "is"
      , Space
      , Str "demonstrated"
      , Space
      , Str "in"
      , SoftBreak
      , Str "figure"
      , Space
      , Cite
          [ Citation
              { citationId = "fig:jop"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = AuthorInText
              , citationNoteNum = 26
              , citationHash = 0
              }
          ]
          [ Str "@fig:jop" ]
      , Str "."
      ]
  , Figure
      ( "fig:jop" , [] , [] )
      (Caption
         Nothing [ Plain [ Str "JOP" , Space , Str "example" ] ])
      [ Plain
          [ Image
              ( "" , [] , [ ( "width" , "50%" ) ] )
              [ Str "JOP" , Space , Str "example" ]
              ( "img/jop" , "" )
          ]
      ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "The"
          , Space
          , Str "gadgets"
          , Space
          , Str "in"
          , Space
          , Str "the"
          , Space
          , Str "figure"
          , Space
          , Str "are"
          , Space
          , Str "made"
          , Space
          , Str "up,"
          , Space
          , Str "chosen"
          , Space
          , Str "to"
          , Space
          , Str "highlight"
          , Space
          , Str "that"
          , Space
          , Str "each"
          , SoftBreak
          , Str "gadget"
          , Space
          , Str "can"
          , Space
          , Str "end"
          , Space
          , Str "in"
          , Space
          , Str "a"
          , Space
          , Str "different"
          , Space
          , Str "type"
          , Space
          , Str "of"
          , Space
          , Str "indirect"
          , Space
          , Str "control"
          , Space
          , Str "flow"
          , Space
          , Str "transfer"
          , SoftBreak
          , Str "instruction."
          , Space
          , Str "Consider"
          , Space
          , Str "replacing"
          , Space
          , Str "them"
          , Space
          , Str "with"
          , Space
          , Str "more"
          , Space
          , Str "realistic"
          , Space
          , Str "ones."
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "165" ]
          ]
      ]
  , Para
      [ Str "In"
      , Space
      , Str "figure"
      , Space
      , Cite
          [ Citation
              { citationId = "fig:jop"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = AuthorInText
              , citationNoteNum = 27
              , citationHash = 0
              }
          ]
          [ Str "@fig:jop" ]
      , Str ","
      , Space
      , Code ( "" , [] , [] ) "x4"
      , Space
      , Str "initially"
      , Space
      , Str "points"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Quoted
          DoubleQuote [ Str "dispatch" , Space , Str "table" ]
      , Str ","
      , Space
      , Str "which"
      , Space
      , Str "has"
      , SoftBreak
      , Str "been"
      , Space
      , Str "modified"
      , Space
      , Str "by"
      , Space
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "to"
      , Space
      , Str "contain"
      , Space
      , Str "the"
      , Space
      , Str "addresses"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "three"
      , Space
      , Str "gadgets"
      , SoftBreak
      , Str "they"
      , Space
      , Str "want"
      , Space
      , Str "to"
      , Space
      , Str "execute."
      , Space
      , Str "The"
      , Space
      , Str "dispatcher"
      , Space
      , Str "gadget"
      , Space
      , Str "loads"
      , Space
      , Str "each"
      , Space
      , Str "address"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "dispatch"
      , SoftBreak
      , Str "table"
      , Space
      , Str "one"
      , Space
      , Str "by"
      , Space
      , Str "one"
      , Space
      , Str "and"
      , Space
      , Str "branches"
      , Space
      , Str "to"
      , Space
      , Str "them."
      , Space
      , Str "The"
      , Space
      , Str "first"
      , Space
      , Str "gadget"
      , Space
      , Str "loads"
      , Space
      , Code ( "" , [] , [] ) "x0"
      , Space
      , Str "and"
      , Space
      , Code ( "" , [] , [] ) "x1"
      , SoftBreak
      , Str "from"
      , Space
      , Str "the"
      , Space
      , Str "stack,"
      , Space
      , Str "where"
      , Space
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "has"
      , Space
      , Str "placed"
      , Space
      , Str "the"
      , Space
      , Str "inputs"
      , Space
      , Str "of"
      , Space
      , Str "their"
      , Space
      , Str "choice."
      , Space
      , Str "It"
      , SoftBreak
      , Str "then"
      , Space
      , Str "loads"
      , Space
      , Str "its"
      , Space
      , Str "return"
      , Space
      , Str "address,"
      , Space
      , Str "also"
      , Space
      , Str "modified"
      , Space
      , Str "by"
      , Space
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "so"
      , Space
      , Str "that"
      , Space
      , Str "it"
      , Space
      , Str "points"
      , SoftBreak
      , Str "back"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "dispatcher"
      , Space
      , Str "gadget,"
      , Space
      , Str "and"
      , Space
      , Str "returns"
      , Space
      , Str "to"
      , Space
      , Str "it."
      , Space
      , Str "The"
      , Space
      , Str "dispatcher"
      , Space
      , Str "branches"
      , Space
      , Str "to"
      , SoftBreak
      , Str "the"
      , Space
      , Str "next"
      , Space
      , Str "gadget,"
      , Space
      , Str "which"
      , Space
      , Str "adds"
      , Space
      , Code ( "" , [] , [] ) "x0"
      , Space
      , Str "and"
      , Space
      , Code ( "" , [] , [] ) "x1"
      , Space
      , Str "and"
      , Space
      , Str "leaves"
      , Space
      , Str "the"
      , Space
      , Str "result"
      , Space
      , Str "in"
      , Space
      , Code ( "" , [] , [] ) "x0"
      , Str ","
      , SoftBreak
      , Str "branching"
      , Space
      , Str "back"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "dispatcher"
      , Space
      , Str "through"
      , Space
      , Str "another"
      , Space
      , Str "value"
      , Space
      , Str "loaded"
      , Space
      , Str "from"
      , Space
      , Str "the"
      , Space
      , Str "stack"
      , SoftBreak
      , Str "into"
      , Space
      , Code ( "" , [] , [] ) "x2"
      , Str "."
      , Space
      , Str "The"
      , Space
      , Str "final"
      , Space
      , Str "gadget"
      , Space
      , Str "stores"
      , Space
      , Str "the"
      , Space
      , Str "result"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "addition,"
      , Space
      , Str "which"
      , Space
      , Str "remains"
      , Space
      , Str "in"
      , SoftBreak
      , Code ( "" , [] , [] ) "x0"
      , Str ","
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "stack,"
      , Space
      , Str "before"
      , Space
      , Str "branching"
      , Space
      , Str "to"
      , Space
      , Code ( "" , [] , [] ) "x2"
      , Str ","
      , Space
      , Str "which"
      , Space
      , Str "still"
      , Space
      , Str "points"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , SoftBreak
      , Str "dispatcher"
      , Space
      , Str "gadget."
      ]
  , Header
      3
      ( "counterfeit-object-oriented-programming" , [] , [] )
      [ Str "Counterfeit"
      , Space
      , Str "Object-oriented"
      , Space
      , Str "programming"
      ]
  , Para
      [ Str "Counterfeit"
      , Space
      , Str "Object-oriented"
      , Space
      , Str "programming"
      , Space
      , Str "(COOP)"
      , RawInline
          (Format "tex")
          "\\index{counterfeit\nobject-oriented programming (COOP)}"
      , Space
      , Cite
          [ Citation
              { citationId = "Schuster2015"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 28
              , citationHash = 0
              }
          ]
          [ Str "[@Schuster2015]" ]
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "code"
      , Space
      , Str "reuse"
      , Space
      , Str "technique"
      , SoftBreak
      , Str "that"
      , Space
      , Str "takes"
      , Space
      , Str "advantage"
      , Space
      , Str "of"
      , Space
      , Str "C++"
      , Space
      , RawInline (Format "tex") "\\index{C++}"
      , Space
      , Str "virtual"
      , Space
      , Str "function"
      , Space
      , Str "calls."
      , Space
      , Str "A"
      , Space
      , Str "COOP"
      , Space
      , Str "attack"
      , SoftBreak
      , Str "takes"
      , Space
      , Str "advantage"
      , Space
      , Str "of"
      , Space
      , Str "existing"
      , Space
      , Str "virtual"
      , Space
      , Str "functions"
      , Space
      , Str "and"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "vtables" ]
          ( "https://en.wikipedia.org/wiki/Virtual_method_table"
          , ""
          )
      , Str ","
      , Space
      , Str "and"
      , Space
      , Str "creates"
      , Space
      , Str "fake"
      , SoftBreak
      , Str "objects"
      , Space
      , Str "pointing"
      , Space
      , Str "to"
      , Space
      , Str "these"
      , Space
      , Str "existing"
      , Space
      , Str "vtables."
      , Space
      , Str "The"
      , Space
      , Str "virtual"
      , Space
      , Str "functions"
      , Space
      , Str "used"
      , Space
      , Str "as"
      , SoftBreak
      , Str "gadgets"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "attack"
      , Space
      , Str "are"
      , Space
      , Str "called"
      , Space
      , Str "vfgadgets."
      , Space
      , Str "To"
      , Space
      , Str "chain"
      , Space
      , Str "vfgadgets"
      , Space
      , Str "together,"
      , Space
      , Str "the"
      , SoftBreak
      , Str "attacker"
      , Space
      , Str "uses"
      , Space
      , Str "a"
      , Space
      , Quoted
          DoubleQuote
          [ Str "main" , Space , Str "loop" , Space , Str "gadget" ]
      , Str ","
      , Space
      , Str "similar"
      , Space
      , Str "to"
      , Space
      , Str "JOP\8217s"
      , Space
      , Str "dispatcher"
      , Space
      , Str "gadget,"
      , Space
      , Str "which"
      , SoftBreak
      , Str "is"
      , Space
      , Str "itself"
      , Space
      , Str "a"
      , Space
      , Str "virtual"
      , Space
      , Str "function"
      , Space
      , Str "that"
      , Space
      , Str "loops"
      , Space
      , Str "over"
      , Space
      , Str "a"
      , Space
      , Str "container"
      , Space
      , Str "of"
      , Space
      , Str "pointers"
      , Space
      , Str "to"
      , Space
      , Str "C++"
      , SoftBreak
      , Str "objects"
      , Space
      , Str "and"
      , Space
      , Str "invokes"
      , Space
      , Str "a"
      , Space
      , Str "virtual"
      , Space
      , Str "function"
      , Space
      , Str "on"
      , Space
      , Str "these"
      , Space
      , Str "objects."
      , Space
      , Cite
          [ Citation
              { citationId = "Schuster2015"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 29
              , citationHash = 0
              }
          ]
          [ Str "[@Schuster2015]" ]
      , SoftBreak
      , Str "describes"
      , Space
      , Str "the"
      , Space
      , Str "attack"
      , Space
      , Str "in"
      , Space
      , Str "more"
      , Space
      , Str "detail."
      , Space
      , Str "It"
      , Space
      , Str "is"
      , Space
      , Str "specifically"
      , Space
      , Str "mentioned"
      , Space
      , Str "here"
      , Space
      , Str "as"
      , Space
      , Str "an"
      , SoftBreak
      , Str "example"
      , Space
      , Str "of"
      , Space
      , Str "an"
      , Space
      , Str "attack"
      , Space
      , Str "that"
      , Space
      , Str "doesn\8217t"
      , Space
      , Str "depend"
      , Space
      , Str "on"
      , Space
      , Str "directly"
      , Space
      , Str "replacing"
      , Space
      , Str "return"
      , Space
      , Str "addresses"
      , SoftBreak
      , Str "and"
      , Space
      , Str "code"
      , Space
      , Str "pointers,"
      , Space
      , Str "like"
      , Space
      , Str "ROP"
      , Space
      , Str "and"
      , Space
      , Str "JOP"
      , Space
      , Str "do."
      , Space
      , Str "Such"
      , Space
      , Str "language-specific"
      , Space
      , Str "attacks"
      , Space
      , Str "are"
      , SoftBreak
      , Str "important"
      , Space
      , Str "to"
      , Space
      , Str "consider"
      , Space
      , Str "when"
      , Space
      , Str "considering"
      , Space
      , Str "mitigations"
      , Space
      , Str "against"
      , Space
      , Str "code"
      , Space
      , Str "reuse"
      , Space
      , Str "attacks,"
      , SoftBreak
      , Str "which"
      , Space
      , Str "will"
      , Space
      , Str "be"
      , Space
      , Str "the"
      , Space
      , Str "topic"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "next"
      , Space
      , Str "section."
      ]
  , Header
      3
      ( "sigreturn-oriented-programming" , [] , [] )
      [ Str "Sigreturn-oriented" , Space , Str "programming" ]
  , Para
      [ Str "One"
      , Space
      , Str "last"
      , Space
      , Str "example"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "code"
      , Space
      , Str "reuse"
      , Space
      , Str "attack"
      , Space
      , Str "that"
      , Space
      , Str "is"
      , Space
      , Str "worth"
      , Space
      , Str "mentioning"
      , Space
      , Str "here"
      , Space
      , Str "is"
      , SoftBreak
      , Str "sigreturn-oriented"
      , Space
      , Str "programming"
      , Space
      , Str "(SROP)"
      , RawInline
          (Format "tex")
          "\\index{sigreturn-oriented programming\n(SROP)}"
      , Space
      , Cite
          [ Citation
              { citationId = "Bosman2014"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 30
              , citationHash = 0
              }
          ]
          [ Str "[@Bosman2014]" ]
      , Str "."
      , Space
      , Str "It"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "special"
      , Space
      , Str "case"
      , Space
      , Str "of"
      , Space
      , Str "ROP"
      , Space
      , Str "where"
      , Space
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "creates"
      , Space
      , Str "a"
      , SoftBreak
      , Str "fake"
      , Space
      , Str "signal"
      , Space
      , Str "handler"
      , Space
      , Str "frame"
      , Space
      , Str "and"
      , Space
      , Str "calls"
      , Space
      , Code ( "" , [] , [] ) "sigreturn"
      , Str "."
      , Space
      , Code ( "" , [] , [] ) "sigreturn"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "system"
      , Space
      , Str "call"
      , SoftBreak
      , Str "on"
      , Space
      , Str "many"
      , Space
      , Str "UNIX-type"
      , Space
      , Str "systems"
      , Space
      , Str "which"
      , Space
      , Str "is"
      , Space
      , Str "normally"
      , Space
      , Str "called"
      , Space
      , Str "upon"
      , Space
      , Str "return"
      , Space
      , Str "from"
      , Space
      , Str "a"
      , Space
      , Str "signal"
      , SoftBreak
      , Str "handler,"
      , Space
      , Str "and"
      , Space
      , Str "restores"
      , Space
      , Str "the"
      , Space
      , Str "state"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "process"
      , Space
      , Str "based"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "state"
      , Space
      , Str "that"
      , Space
      , Str "has"
      , Space
      , Str "been"
      , SoftBreak
      , Str "saved"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "signal"
      , Space
      , Str "handler\8217s"
      , Space
      , Str "stack"
      , Space
      , Str "by"
      , Space
      , Str "the"
      , Space
      , Str "kernel"
      , Space
      , Str "previously,"
      , Space
      , Str "on"
      , Space
      , Str "entry"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , SoftBreak
      , Str "signal"
      , Space
      , Str "handler."
      , Space
      , Str "The"
      , Space
      , Str "ability"
      , Space
      , Str "to"
      , Space
      , Str "fake"
      , Space
      , Str "a"
      , Space
      , Str "signal"
      , Space
      , Str "handler"
      , Space
      , Str "frame"
      , Space
      , Str "and"
      , Space
      , Str "call"
      , SoftBreak
      , Code ( "" , [] , [] ) "sigreturn"
      , Space
      , Str "gives"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "a"
      , Space
      , Str "simple"
      , Space
      , Str "way"
      , Space
      , Str "to"
      , Space
      , Str "control"
      , Space
      , Str "the"
      , Space
      , Str "state"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "program."
      ]
  , Header
      2
      ( "mitigations-against-code-reuse-attacks" , [] , [] )
      [ Str "Mitigations"
      , Space
      , Str "against"
      , Space
      , Str "code"
      , Space
      , Str "reuse"
      , Space
      , Str "attacks"
      ]
  , Para
      [ Str "When"
      , Space
      , Str "discussing"
      , Space
      , Str "mitigations"
      , Space
      , Str "against"
      , Space
      , Str "code"
      , Space
      , Str "reuse"
      , Space
      , Str "attacks,"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , Space
      , Str "important"
      , Space
      , Str "to"
      , Space
      , Str "keep"
      , SoftBreak
      , Str "in"
      , Space
      , Str "mind"
      , Space
      , Str "that"
      , Space
      , Str "there"
      , Space
      , Str "are"
      , Space
      , Str "two"
      , Space
      , Str "capabilities"
      , Space
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "must"
      , Space
      , Str "have"
      , Space
      , Str "for"
      , Space
      , Str "such"
      , Space
      , Str "attacks"
      , SoftBreak
      , Str "to"
      , Space
      , Str "work:"
      ]
  , BulletList
      [ [ Plain
            [ Str "the"
            , Space
            , Str "ability"
            , Space
            , Str "to"
            , Space
            , Str "overwrite"
            , Space
            , Str "return"
            , Space
            , Str "addresses"
            , Space
            , Str "or"
            , Space
            , Str "function"
            , Space
            , Str "pointers"
            ]
        ]
      , [ Plain
            [ Str "knowledge"
            , Space
            , Str "of"
            , Space
            , Str "the"
            , Space
            , Str "target"
            , Space
            , Str "addresses"
            , Space
            , Str "to"
            , Space
            , Str "overwrite"
            , Space
            , Str "them"
            , Space
            , Str "with"
            , Space
            , Str "(e.g.\160libc"
            , Space
            , Str "function"
            , SoftBreak
            , Str "entry"
            , Space
            , Str "points)."
            ]
        ]
      ]
  , Para
      [ Str "When"
      , Space
      , Str "code"
      , Space
      , Str "reuse"
      , Space
      , Str "attacks"
      , Space
      , Str "were"
      , Space
      , Str "first"
      , Space
      , Str "described,"
      , Space
      , Str "programs"
      , Space
      , Str "used"
      , Space
      , Str "to"
      , Space
      , Str "contain"
      , Space
      , Str "absolute"
      , SoftBreak
      , Str "code"
      , Space
      , Str "pointers,"
      , Space
      , Str "and"
      , Space
      , Str "needed"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "loaded"
      , Space
      , Str "at"
      , Space
      , Str "fixed"
      , Space
      , Str "addresses."
      , Space
      , Str "The"
      , Space
      , Str "stack"
      , Space
      , Str "base"
      , Space
      , Str "was"
      , SoftBreak
      , Str "predictable,"
      , Space
      , Str "and"
      , Space
      , Str "libraries"
      , Space
      , Str "were"
      , Space
      , Str "loaded"
      , Space
      , Str "in"
      , Space
      , Str "predictable"
      , Space
      , Str "memory"
      , Space
      , Str "locations."
      , Space
      , Str "This"
      , SoftBreak
      , Str "made"
      , Space
      , Str "code"
      , Space
      , Str "reuse"
      , Space
      , Str "attacks"
      , Space
      , Str "simple,"
      , Space
      , Str "as"
      , Space
      , Str "all"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "addresses"
      , Space
      , Str "needed"
      , Space
      , Str "for"
      , Space
      , Str "a"
      , Space
      , Str "successful"
      , SoftBreak
      , Str "exploit"
      , Space
      , Str "were"
      , Space
      , Str "easy"
      , Space
      , Str "to"
      , Space
      , Str "discover."
      ]
  , Header 3 ( "aslr" , [] , [] ) [ Str "ASLR" ]
  , Para
      [ Link
          ( "" , [] , [] )
          [ Str "Address"
          , Space
          , Str "space"
          , Space
          , Str "layout"
          , Space
          , Str "randomization"
          , SoftBreak
          , Str "(ASLR)"
          ]
          ( "https://en.wikipedia.org/wiki/Address_space_layout_randomization"
          , ""
          )
      , RawInline (Format "tex") "\\index{ASLR}"
      , SoftBreak
      , Str "makes"
      , Space
      , Str "this"
      , Space
      , Str "more"
      , Space
      , Str "difficult"
      , Space
      , Str "by"
      , Space
      , Str "randomizing"
      , Space
      , Str "the"
      , Space
      , Str "positions"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "memory"
      , Space
      , Str "areas"
      , SoftBreak
      , Str "containing"
      , Space
      , Str "the"
      , Space
      , Str "executable,"
      , Space
      , Str "the"
      , Space
      , Str "loaded"
      , Space
      , Str "libraries,"
      , Space
      , Str "the"
      , Space
      , Str "stack"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , Space
      , Str "heap."
      , Space
      , Str "ASLR"
      , SoftBreak
      , Str "requires"
      , Space
      , Str "code"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "position-independent."
      , Space
      , Str "Given"
      , Space
      , Str "enough"
      , Space
      , Str "entropy,"
      , Space
      , Str "the"
      , Space
      , Str "chance"
      , Space
      , Str "that"
      , SoftBreak
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "would"
      , Space
      , Str "successfully"
      , Space
      , Str "guess"
      , Space
      , Str "one"
      , Space
      , Str "or"
      , Space
      , Str "more"
      , Space
      , Str "addresses"
      , Space
      , Str "in"
      , Space
      , Str "order"
      , Space
      , Str "to"
      , Space
      , Str "mount"
      , Space
      , Str "a"
      , SoftBreak
      , Str "successful"
      , Space
      , Str "attack"
      , Space
      , Str "will"
      , Space
      , Str "be"
      , Space
      , Str "greatly"
      , Space
      , Str "reduced."
      ]
  , Para
      [ Str "Does"
      , Space
      , Str "this"
      , Space
      , Str "mean"
      , Space
      , Str "that"
      , Space
      , Str "code"
      , Space
      , Str "reuse"
      , Space
      , Str "attacks"
      , Space
      , Str "have"
      , Space
      , Str "been"
      , Space
      , Str "made"
      , Space
      , Str "redundant"
      , Space
      , Str "by"
      , Space
      , Str "ASLR?"
      , SoftBreak
      , Str "Unfortunately,"
      , Space
      , Str "this"
      , Space
      , Str "is"
      , Space
      , Str "not"
      , Space
      , Str "the"
      , Space
      , Str "case."
      , Space
      , Str "There"
      , Space
      , Str "are"
      , Space
      , Str "various"
      , Space
      , Str "ways"
      , Space
      , Str "in"
      , Space
      , Str "which"
      , Space
      , Str "an"
      , SoftBreak
      , Str "attacker"
      , Space
      , Str "can"
      , Space
      , Str "discover"
      , Space
      , Str "the"
      , Space
      , Str "memory"
      , Space
      , Str "layout"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "program."
      , Space
      , Str "This"
      , Space
      , Str "is"
      , Space
      , Str "often"
      , SoftBreak
      , Str "referred"
      , Space
      , Str "to"
      , Space
      , Str "as"
      , Space
      , Str "an"
      , Space
      , Quoted DoubleQuote [ Str "info" , Space , Str "leak" ]
      , RawInline (Format "tex") "\\index{info leak}"
      , Space
      , Cite
          [ Citation
              { citationId = "Serna2012"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 31
              , citationHash = 0
              }
          ]
          [ Str "[@Serna2012]" ]
      , Str "."
      ]
  , Para
      [ Str "Since"
      , Space
      , Str "we"
      , Space
      , Str "can"
      , Space
      , Str "not"
      , Space
      , Str "exclude"
      , Space
      , Str "code"
      , Space
      , Str "reuse"
      , Space
      , Str "attacks"
      , Space
      , Str "solely"
      , Space
      , Str "by"
      , Space
      , Str "making"
      , Space
      , Str "addresses"
      , Space
      , Str "hard"
      , Space
      , Str "to"
      , SoftBreak
      , Str "guess,"
      , Space
      , Str "we"
      , Space
      , Str "need"
      , Space
      , Str "to"
      , Space
      , Str "also"
      , Space
      , Str "consider"
      , Space
      , Str "mitigations"
      , Space
      , Str "that"
      , Space
      , Str "prevent"
      , Space
      , Str "attackers"
      , Space
      , Str "from"
      , SoftBreak
      , Str "overwriting"
      , Space
      , Str "return"
      , Space
      , Str "addresses"
      , Space
      , Str "and"
      , Space
      , Str "other"
      , Space
      , Str "code"
      , Space
      , Str "pointers."
      , Space
      , Str "Some"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "mitigations"
      , SoftBreak
      , Str "described"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "earlier" ]
          ( "#stack-buffer-overflows" , "" )
      , Str ","
      , Space
      , Str "like"
      , Space
      , Str "stack"
      , Space
      , Str "canaries"
      , Space
      , Str "and"
      , Space
      , Str "library"
      , SoftBreak
      , Str "function"
      , Space
      , Str "hardening,"
      , Space
      , Str "can"
      , Space
      , Str "help"
      , Space
      , Str "in"
      , Space
      , Str "specific"
      , Space
      , Str "situations,"
      , Space
      , Str "but"
      , Space
      , Str "for"
      , Space
      , Str "the"
      , Space
      , Str "more"
      , Space
      , Str "general"
      , SoftBreak
      , Str "case"
      , Space
      , Str "where"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "has"
      , Space
      , Str "obtained"
      , Space
      , Str "arbitrary"
      , Space
      , Str "read"
      , Space
      , Str "and"
      , Space
      , Str "write"
      , Space
      , Str "primitives,"
      , Space
      , Str "we"
      , SoftBreak
      , Str "need"
      , Space
      , Str "something"
      , Space
      , Str "more."
      ]
  , Header 3 ( "cfi" , [] , [] ) [ Str "CFI" ]
  , Para
      [ Link
          ( "" , [] , [] )
          [ Str "Control-flow"
          , Space
          , Str "integrity"
          , SoftBreak
          , Str "(CFI)"
          ]
          ( "https://en.wikipedia.org/wiki/Control-flow_integrity"
          , ""
          )
      , RawInline (Format "tex") "\\index{CFI}"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , SoftBreak
      , Str "family"
      , Space
      , Str "of"
      , Space
      , Str "mitigations"
      , Space
      , Str "that"
      , Space
      , Str "aim"
      , Space
      , Str "to"
      , Space
      , Str "preserve"
      , Space
      , Str "the"
      , Space
      , Str "intended"
      , Space
      , Str "control"
      , Space
      , Str "flow"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , SoftBreak
      , Str "program."
      , Space
      , Str "This"
      , Space
      , Str "is"
      , Space
      , Str "done"
      , Space
      , Str "by"
      , Space
      , Str "restricting"
      , Space
      , Str "the"
      , Space
      , Str "possible"
      , Space
      , Str "targets"
      , Space
      , Str "of"
      , Space
      , Str "indirect"
      , Space
      , Str "branches"
      , SoftBreak
      , Str "and"
      , Space
      , Str "returns."
      , Space
      , Str "A"
      , Space
      , Str "scheme"
      , Space
      , Str "that"
      , Space
      , Str "protects"
      , Space
      , Str "indirect"
      , Space
      , Str "jumps"
      , Space
      , Str "and"
      , Space
      , Str "calls"
      , Space
      , Str "is"
      , Space
      , Str "referred"
      , Space
      , Str "to"
      , Space
      , Str "as"
      , SoftBreak
      , Str "forward-edge"
      , Space
      , Str "CFI"
      , RawInline (Format "tex") "\\index{forward-edge CFI}"
      , Str ","
      , Space
      , Str "whereas"
      , Space
      , Str "a"
      , Space
      , Str "scheme"
      , Space
      , Str "that"
      , Space
      , Str "protects"
      , SoftBreak
      , Str "returns"
      , Space
      , Str "is"
      , Space
      , Str "said"
      , Space
      , Str "to"
      , Space
      , Str "implement"
      , Space
      , Str "backward-edge"
      , Space
      , Str "CFI"
      , RawInline (Format "tex") "\\index{backward-edge CFI}"
      , Str "."
      , SoftBreak
      , Str "Ideally,"
      , Space
      , Str "a"
      , Space
      , Str "CFI"
      , Space
      , Str "scheme"
      , Space
      , Str "would"
      , Space
      , Str "not"
      , Space
      , Str "allow"
      , Space
      , Str "any"
      , Space
      , Str "control"
      , Space
      , Str "flow"
      , Space
      , Str "transfers"
      , Space
      , Str "that"
      , Space
      , Str "don\8217t"
      , SoftBreak
      , Str "occur"
      , Space
      , Str "in"
      , Space
      , Str "a"
      , Space
      , Str "correct"
      , Space
      , Str "program"
      , Space
      , Str "execution,"
      , Space
      , Str "however"
      , Space
      , Str "different"
      , Space
      , Str "schemes"
      , Space
      , Str "have"
      , Space
      , Str "varying"
      , SoftBreak
      , Str "granularities."
      , Space
      , Str "They"
      , Space
      , Str "often"
      , Space
      , Str "rely"
      , Space
      , Str "on"
      , Space
      , Str "function"
      , Space
      , Str "type"
      , Space
      , Str "checks"
      , Space
      , Str "or"
      , Space
      , Str "use"
      , Space
      , Str "static"
      , Space
      , Str "analysis"
      , SoftBreak
      , Str "(points-to"
      , Space
      , Str "analysis)"
      , Space
      , Str "to"
      , Space
      , Str "identify"
      , Space
      , Str "potential"
      , Space
      , Str "control"
      , Space
      , Str "flow"
      , Space
      , Str "transfer"
      , Space
      , Str "targets."
      , SoftBreak
      , Cite
          [ Citation
              { citationId = "Burow2017"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 32
              , citationHash = 0
              }
          ]
          [ Str "[@Burow2017]" ]
      , Space
      , Str "compares"
      , Space
      , Str "a"
      , Space
      , Str "number"
      , Space
      , Str "of"
      , Space
      , Str "available"
      , Space
      , Str "CFI"
      , Space
      , Str "schemes"
      , Space
      , Str "based"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "precision."
      , SoftBreak
      , Str "For"
      , Space
      , Str "forward-edge"
      , Space
      , Str "CFI"
      , Space
      , Str "schemes,"
      , Space
      , Str "for"
      , Space
      , Str "example,"
      , Space
      , Str "schemes"
      , Space
      , Str "are"
      , Space
      , Str "classified"
      , Space
      , Str "based"
      , Space
      , Str "on"
      , SoftBreak
      , Str "whether"
      , Space
      , Str "or"
      , Space
      , Str "not"
      , Space
      , Str "they"
      , Space
      , Str "perform,"
      , Space
      , Str "among"
      , Space
      , Str "others,"
      , Space
      , Str "flow-sensitive"
      , Space
      , Str "analysis,"
      , SoftBreak
      , Str "context-sensitive"
      , Space
      , Str "analysis"
      , Space
      , Str "and"
      , Space
      , Str "class-hierarchy"
      , Space
      , Str "analysis."
      ]
  , Header
      4
      ( "clang-cfi" , [] , [] )
      [ Str "Clang" , Space , Str "CFI" ]
  , Para
      [ Link
          ( "" , [] , [] )
          [ Str "Clang\8217s" , Space , Str "CFI" ]
          ( "https://clang.llvm.org/docs/ControlFlowIntegrity.html"
          , ""
          )
      , Space
      , Str "includes"
      , Space
      , Str "a"
      , SoftBreak
      , Str "variety"
      , Space
      , Str "of"
      , Space
      , Str "forward-edge"
      , Space
      , Str "control-flow"
      , Space
      , Str "integrity"
      , Space
      , Str "checks."
      , Space
      , Str "These"
      , Space
      , Str "include"
      , Space
      , Str "checking"
      , SoftBreak
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "target"
      , Space
      , Str "of"
      , Space
      , Str "an"
      , Space
      , Str "indirect"
      , Space
      , Str "function"
      , Space
      , Str "call"
      , Space
      , Str "is"
      , Space
      , Str "an"
      , Space
      , Str "address-taken"
      , Space
      , Str "function"
      , Space
      , Str "of"
      , SoftBreak
      , Str "the"
      , Space
      , Str "correct"
      , Space
      , Str "type"
      , Space
      , Str "and"
      , Space
      , Str "checking"
      , Space
      , Str "that"
      , Space
      , Str "a"
      , Space
      , Str "C++"
      , Space
      , RawInline (Format "tex") "\\index{C++}"
      , Space
      , Str "virtual"
      , Space
      , Str "call"
      , Space
      , Str "happens"
      , Space
      , Str "on"
      , Space
      , Str "an"
      , SoftBreak
      , Str "object"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "correct"
      , Space
      , Str "dynamic"
      , Space
      , Str "type."
      ]
  , Para
      [ Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "assume"
      , Space
      , Str "we"
      , Space
      , Str "have"
      , Space
      , Str "a"
      , Space
      , Str "class"
      , Space
      , Code ( "" , [] , [] ) "A"
      , Space
      , Str "with"
      , Space
      , Str "a"
      , Space
      , Str "virtual"
      , Space
      , Str "function"
      , Space
      , Code ( "" , [] , [] ) "foo"
      , Space
      , Str "and"
      , Space
      , Str "a"
      , SoftBreak
      , Str "class"
      , Space
      , Code ( "" , [] , [] ) "B"
      , Space
      , Str "deriving"
      , Space
      , Str "from"
      , Space
      , Code ( "" , [] , [] ) "A"
      , Str ","
      , Space
      , Str "and"
      , Space
      , Str "that"
      , Space
      , Str "these"
      , Space
      , Str "classes"
      , Space
      , Str "are"
      , Space
      , Str "not"
      , Space
      , Str "exported"
      , Space
      , Str "to"
      , SoftBreak
      , Str "other"
      , Space
      , Str "compilation"
      , Space
      , Str "modules:"
      ]
  , CodeBlock
      ( "" , [] , [] )
      "class A {\npublic:\n  virtual void foo() {}\n};\n\nclass B : public A {\npublic:\n  virtual void foo() {}\n};\n\nvoid call_foo(A* a) {\n  a->foo();\n}"
  , Para
      [ Str "When"
      , Space
      , Str "compiling"
      , Space
      , Str "with"
      , Space
      , Code
          ( "" , [] , [] ) "-fsanitize=cfi -flto -fvisibility=hidden"
      , Space
      , Note
          [ Para
              [ Str "The"
              , Space
              , Str "LTO"
              , Space
              , Str "and"
              , Space
              , Str "visibility"
              , Space
              , Str "flags"
              , Space
              , Str "are"
              , Space
              , Str "required"
              , Space
              , Str "by"
              , Space
              , Str "Clang\8217s"
              , Space
              , Str "CFI."
              ]
          ]
      , Str ","
      , SoftBreak
      , Str "the"
      , Space
      , Str "code"
      , Space
      , Str "for"
      , Space
      , Code ( "" , [] , [] ) "call_foo"
      , Space
      , Str "would"
      , Space
      , Str "look"
      , Space
      , Str "something"
      , Space
      , Str "like"
      , Space
      , Str "this:"
      ]
  , CodeBlock
      ( "" , [] , [] )
      "00000000004006b4 <call_foo(A*)>:\n  4006b4:       a9bf7bfd        stp     x29, x30, [sp, #-16]!\n  4006b8:       910003fd        mov     x29, sp\n  4006bc:       f9400008        ldr     x8, [x0]\n  4006c0:       90000009        adrp    x9, 400000 <_init-0x558>\n  4006c4:       91216129        add     x9, x9, #0x858\n  4006c8:       cb090109        sub     x9, x8, x9\n  4006cc:       d1004129        sub     x9, x9, #0x10\n  4006d0:       93c91529        ror     x9, x9, #5\n  4006d4:       f100093f        cmp     x9, #0x2\n  4006d8:       540000a2        b.cs    4006ec <call_foo(A*)+0x38>\n  4006dc:       f9400108        ldr     x8, [x8]\n  4006e0:       d63f0100        blr     x8\n  4006e4:       a8c17bfd        ldp     x29, x30, [sp], #16\n  4006e8:       d65f03c0        ret\n  4006ec:       d4200020        brk     #0x1"
  , Para
      [ Str "This"
      , Space
      , Str "code"
      , Space
      , Str "looks"
      , Space
      , Str "complicated,"
      , Space
      , Str "but"
      , Space
      , Str "what"
      , Space
      , Str "it"
      , Space
      , Str "does"
      , Space
      , Str "is"
      , Space
      , Str "check"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "virtual"
      , Space
      , Str "table"
      , SoftBreak
      , Str "pointer"
      , Space
      , Str "(vptr)"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "argument"
      , Space
      , Str "points"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "vtable"
      , Space
      , Str "of"
      , Space
      , Code ( "" , [] , [] ) "A"
      , Space
      , Str "or"
      , Space
      , Str "of"
      , Space
      , Code ( "" , [] , [] ) "B"
      , Str ","
      , Space
      , Str "which"
      , Space
      , Str "are"
      , SoftBreak
      , Str "stored"
      , Space
      , Str "consecutively"
      , Space
      , Str "and"
      , Space
      , Str "are"
      , Space
      , Str "the"
      , Space
      , Str "only"
      , Space
      , Str "allowed"
      , Space
      , Str "possibilities."
      , Space
      , Str "The"
      , Space
      , Str "checks"
      , SoftBreak
      , Str "generated"
      , Space
      , Str "for"
      , Space
      , Str "different"
      , Space
      , Str "types"
      , Space
      , Str "of"
      , Space
      , Str "control-flow"
      , Space
      , Str "transfers"
      , Space
      , Str "are"
      , Space
      , Str "similar."
      ]
  , Para
      [ Str "Another"
      , Space
      , Str "implementation"
      , Space
      , Str "of"
      , Space
      , Str "forward-edge"
      , Space
      , Str "CFI"
      , Space
      , Str "is"
      , Space
      , Str "Windows"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "Control"
          , Space
          , Str "Flow"
          , SoftBreak
          , Str "Guard"
          ]
          ( "https://docs.microsoft.com/en-us/windows/win32/secbp/control-flow-guard"
          , ""
          )
      , Str ","
      , SoftBreak
      , Str "which"
      , Space
      , Str "only"
      , Space
      , Str "allows"
      , Space
      , Str "indirect"
      , Space
      , Str "calls"
      , Space
      , Str "to"
      , Space
      , Str "functions"
      , Space
      , Str "that"
      , Space
      , Str "are"
      , Space
      , Str "marked"
      , Space
      , Str "as"
      , Space
      , Str "valid"
      , Space
      , Str "indirect"
      , SoftBreak
      , Str "control"
      , Space
      , Str "flow"
      , Space
      , Str "targets."
      ]
  , Header
      4
      ( "clang-shadow-stack" , [] , [] )
      [ Str "Clang" , Space , Str "Shadow" , Space , Str "Stack" ]
  , Para
      [ Str "Clang"
      , Space
      , Str "also"
      , Space
      , Str "implements"
      , Space
      , Str "a"
      , Space
      , Str "backward-edge"
      , Space
      , Str "CFI"
      , Space
      , Str "scheme"
      , Space
      , Str "known"
      , Space
      , Str "as"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "Shadow" , SoftBreak , Str "Stack" ]
          ( "https://clang.llvm.org/docs/ShadowCallStack.html" , "" )
      , RawInline (Format "tex") "\\index{shadow stack}"
      , Str "."
      , SoftBreak
      , Str "In"
      , Space
      , Str "Clang\8217s"
      , Space
      , Str "implementation,"
      , Space
      , Str "a"
      , Space
      , Str "separate"
      , Space
      , Str "stack"
      , Space
      , Str "is"
      , Space
      , Str "used"
      , Space
      , Str "for"
      , Space
      , Str "return"
      , Space
      , Str "addresses,"
      , Space
      , Str "which"
      , SoftBreak
      , Str "means"
      , Space
      , Str "that"
      , Space
      , Str "stack-based"
      , Space
      , Str "buffer"
      , Space
      , Str "overflows"
      , Space
      , Str "cannot"
      , Space
      , Str "be"
      , Space
      , Str "used"
      , Space
      , Str "to"
      , Space
      , Str "overwrite"
      , Space
      , Str "return"
      , SoftBreak
      , Str "addresses."
      , Space
      , Str "The"
      , Space
      , Str "address"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "shadow"
      , Space
      , Str "stack"
      , Space
      , Str "is"
      , Space
      , Str "randomized"
      , Space
      , Str "and"
      , Space
      , Str "kept"
      , Space
      , Str "in"
      , Space
      , Str "a"
      , SoftBreak
      , Str "dedicated"
      , Space
      , Str "register,"
      , Space
      , Str "with"
      , Space
      , Str "care"
      , Space
      , Str "taken"
      , Space
      , Str "so"
      , Space
      , Str "that"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , Space
      , Str "never"
      , Space
      , Str "leaked,"
      , Space
      , Str "which"
      , Space
      , Str "means"
      , SoftBreak
      , Str "that"
      , Space
      , Str "an"
      , Space
      , Str "arbitrary"
      , Space
      , Str "write"
      , Space
      , Str "primitive"
      , Space
      , Str "cannot"
      , Space
      , Str "be"
      , Space
      , Str "used"
      , Space
      , Str "against"
      , Space
      , Str "the"
      , Space
      , Str "shadow"
      , Space
      , Str "stack"
      , SoftBreak
      , Str "unless"
      , Space
      , Str "its"
      , Space
      , Str "location"
      , Space
      , Str "is"
      , Space
      , Str "discovered"
      , Space
      , Str "through"
      , Space
      , Str "some"
      , Space
      , Str "other"
      , Space
      , Str "means."
      ]
  , Para
      [ Str "As"
      , Space
      , Str "an"
      , Space
      , Str "example,"
      , Space
      , Str "when"
      , Space
      , Str "compiling"
      , Space
      , Str "with"
      , Space
      , Code
          ( "" , [] , [] ) "-fsanitize=shadow-call-stack -ffixed-x18"
      , SoftBreak
      , Note
          [ Para
              [ Str "The"
              , Space
              , Code ( "" , [] , [] ) "-ffixed-x18"
              , Space
              , Str "flag"
              , Space
              , Str "results"
              , Space
              , Str "in"
              , Space
              , Str "treating"
              , Space
              , Str "the"
              , Space
              , Code ( "" , [] , [] ) "x18"
              , SoftBreak
              , Str "register"
              , Space
              , Str "as"
              , Space
              , Str "reserved,"
              , Space
              , Str "and"
              , Space
              , Str "is"
              , Space
              , Str "required"
              , Space
              , Str "by"
              , Space
              , Code ( "" , [] , [] ) "-fsanitize=shadow-call-stack"
              , SoftBreak
              , Str "on"
              , Space
              , Str "some"
              , Space
              , Str "platforms."
              ]
          ]
      , Str ","
      , Space
      , Str "the"
      , Space
      , Str "code"
      , Space
      , Str "generated"
      , Space
      , Str "for"
      , Space
      , Str "the"
      , Space
      , Code ( "" , [] , [] ) "main"
      , Space
      , Str "function"
      , Space
      , Str "from"
      , Space
      , Str "the"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "earlier"
          , Space
          , Str "stack"
          , Space
          , Str "buffer"
          , Space
          , Str "overflow"
          , Space
          , Str "example"
          ]
          ( "#stack-buffer-overflow" , "" )
      , Space
      , Str "will"
      , Space
      , Str "look"
      , SoftBreak
      , Str "something"
      , Space
      , Str "like:"
      ]
  , CodeBlock
      ( "" , [] , [] )
      "main:\n    cmp w0, #2\n    b.lt    .LBB1_2\n    str x30, [x18], #8\n    stp x29, x30, [sp, #-16]!\n    mov x29, sp\n    ldr x0, [x1, #8]\n    bl  copy_and_print\n    ldp x29, x30, [sp], #16\n    ldr x30, [x18, #-8]!\n.LBB1_2:\n    mov w0, wzr\n    ret"
  , Para
      [ Str "You"
      , Space
      , Str "can"
      , Space
      , Str "see"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "shadow"
      , Space
      , Str "stack"
      , Space
      , Str "address"
      , Space
      , Str "is"
      , Space
      , Str "kept"
      , Space
      , Str "in"
      , Space
      , Code ( "" , [] , [] ) "x18"
      , Str "."
      , Space
      , Str "The"
      , Space
      , Str "return"
      , Space
      , Str "address"
      , SoftBreak
      , Str "is"
      , Space
      , Str "also"
      , Space
      , Str "saved"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Quoted DoubleQuote [ Str "normal" ]
      , Space
      , Str "stack"
      , Space
      , Str "for"
      , Space
      , Str "compatibility"
      , Space
      , Str "with"
      , Space
      , Str "unwinders,"
      , Space
      , Str "but"
      , SoftBreak
      , Str "it\8217s"
      , Space
      , Str "not"
      , Space
      , Str "actually"
      , Space
      , Str "used"
      , Space
      , Str "for"
      , Space
      , Str "the"
      , Space
      , Str "function"
      , Space
      , Str "return."
      ]
  , Header
      4
      ( "pointer-authentication" , [] , [] )
      [ Str "Pointer" , Space , Str "Authentication" ]
  , Para
      [ Str "In"
      , Space
      , Str "addition"
      , Space
      , Str "to"
      , Space
      , Str "software"
      , Space
      , Str "implementations,"
      , Space
      , Str "there"
      , Space
      , Str "are"
      , Space
      , Str "a"
      , Space
      , Str "number"
      , Space
      , Str "of"
      , Space
      , Str "hardware-based"
      , SoftBreak
      , Str "CFI"
      , Space
      , Str "implementations."
      , Space
      , Str "A"
      , Space
      , Str "hardware-based"
      , Space
      , Str "implementation"
      , Space
      , Str "has"
      , Space
      , Str "the"
      , Space
      , Str "potential"
      , Space
      , Str "to"
      , Space
      , Str "offer"
      , SoftBreak
      , Str "improved"
      , Space
      , Str "protection"
      , Space
      , Str "and"
      , Space
      , Str "performance"
      , Space
      , Str "compared"
      , Space
      , Str "to"
      , Space
      , Str "an"
      , Space
      , Str "equivalent"
      , Space
      , Str "software-only"
      , Space
      , Str "CFI"
      , SoftBreak
      , Str "scheme."
      ]
  , Para
      [ Str "One"
      , Space
      , Str "such"
      , Space
      , Str "example"
      , Space
      , Str "is"
      , Space
      , Str "Pointer"
      , Space
      , Str "Authentication"
      , RawInline (Format "tex") "\\index{Pointer Authentication}"
      , SoftBreak
      , Cite
          [ Citation
              { citationId = "Rutland2017"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 35
              , citationHash = 0
              }
          ]
          [ Str "[@Rutland2017]" ]
      , Str ","
      , Space
      , Str "an"
      , Space
      , Str "Armv8.3"
      , Space
      , Str "feature,"
      , Space
      , Str "supported"
      , Space
      , Str "only"
      , Space
      , Str "in"
      , Space
      , Str "AArch64"
      , Space
      , Str "state,"
      , Space
      , Str "that"
      , Space
      , Str "can"
      , SoftBreak
      , Str "be"
      , Space
      , Str "used"
      , Space
      , Str "to"
      , Space
      , Str "mitigate"
      , Space
      , Str "code"
      , Space
      , Str "reuse"
      , Space
      , Str "attacks."
      , Space
      , Str "Pointer"
      , Space
      , Str "Authentication"
      , Space
      , Str "introduces"
      , SoftBreak
      , Str "instructions"
      , Space
      , Str "that"
      , Space
      , Str "generate"
      , Space
      , Str "a"
      , Space
      , Str "pointer"
      , Space
      , Emph [ Str "signature" ]
      , Str ","
      , Space
      , Str "called"
      , Space
      , Str "a"
      , Space
      , Str "Pointer"
      , SoftBreak
      , Str "Authentication"
      , Space
      , Str "Code"
      , Space
      , Str "(PAC),"
      , Space
      , Str "based"
      , Space
      , Str "on"
      , Space
      , Str "a"
      , Space
      , Str "key"
      , Space
      , Str "and"
      , Space
      , Str "a"
      , Space
      , Str "modifier."
      , Space
      , Str "It"
      , Space
      , Str "also"
      , Space
      , Str "introduces"
      , SoftBreak
      , Str "matching"
      , Space
      , Str "instructions"
      , Space
      , Str "to"
      , Space
      , Str "authenticate"
      , Space
      , Str "this"
      , Space
      , Str "signature."
      , Space
      , Str "Incorrect"
      , Space
      , Str "authentication"
      , SoftBreak
      , Str "leads"
      , Space
      , Str "to"
      , Space
      , Str "an"
      , Space
      , Str "unusable"
      , Space
      , Str "pointer,"
      , Space
      , Str "that"
      , Space
      , Str "will"
      , Space
      , Str "cause"
      , Space
      , Str "a"
      , Space
      , Str "fault"
      , Space
      , Str "when"
      , Space
      , Str "used"
      , Space
      , Note
          [ Para
              [ Str "With"
              , Space
              , Str "the"
              , Space
              , Str "FPAC"
              , Space
              , Str "extension,"
              , Space
              , Str "a"
              , Space
              , Str "fault"
              , Space
              , Str "is"
              , Space
              , Str "raised"
              , Space
              , Str "at"
              , Space
              , Str "incorrect"
              , Space
              , Str "authentication."
              ]
          ]
      , Str "."
      , Space
      , Str "The"
      , SoftBreak
      , Str "key"
      , Space
      , Str "is"
      , Space
      , Str "not"
      , Space
      , Str "directly"
      , Space
      , Str "accessible"
      , Space
      , Str "by"
      , Space
      , Str "user"
      , Space
      , Str "space"
      , Space
      , Str "software."
      ]
  , Para
      [ Str "Pointers"
      , Space
      , Str "are"
      , Space
      , Str "stored"
      , Space
      , Str "as"
      , Space
      , Str "64-bit"
      , Space
      , Str "values,"
      , Space
      , Str "but"
      , Space
      , Str "they"
      , Space
      , Str "don\8217t"
      , Space
      , Str "need"
      , Space
      , Str "all"
      , Space
      , Str "of"
      , Space
      , Str "these"
      , Space
      , Str "bits"
      , Space
      , Str "to"
      , SoftBreak
      , Str "describe"
      , Space
      , Str "the"
      , Space
      , Str "available"
      , Space
      , Str "address"
      , Space
      , Str "space,"
      , Space
      , Str "so"
      , Space
      , Str "a"
      , Space
      , Str "number"
      , Space
      , Str "of"
      , Space
      , Str "bits"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "top"
      , Space
      , Str "of"
      , Space
      , Str "each"
      , SoftBreak
      , Str "pointer"
      , Space
      , Str "are"
      , Space
      , Str "unused."
      , Space
      , Str "The"
      , Space
      , Str "unused"
      , Space
      , Str "bits"
      , Space
      , Str "must"
      , Space
      , Str "be"
      , Space
      , Str "all"
      , Space
      , Str "ones"
      , Space
      , Str "or"
      , Space
      , Str "all"
      , Space
      , Str "zeros,"
      , Space
      , Str "so"
      , Space
      , Str "we"
      , Space
      , Str "refer"
      , SoftBreak
      , Str "to"
      , Space
      , Str "them"
      , Space
      , Str "as"
      , Space
      , Str "extension"
      , Space
      , Str "bits"
      , RawInline (Format "tex") "\\index{pointer extension bits}"
      , Str "."
      , Space
      , Str "Pointer"
      , Space
      , Str "Authentication"
      , SoftBreak
      , Str "Codes"
      , Space
      , Str "are"
      , Space
      , Str "stored"
      , Space
      , Str "in"
      , Space
      , Str "those"
      , Space
      , Str "unused"
      , Space
      , Str "extension"
      , Space
      , Str "bits"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "pointer."
      , Space
      , Str "The"
      , Space
      , Str "exact"
      , Space
      , Str "number"
      , SoftBreak
      , Str "of"
      , Space
      , Str "PAC"
      , Space
      , Str "bits"
      , Space
      , Str "depends"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "number"
      , Space
      , Str "of"
      , Space
      , Str "unused"
      , Space
      , Str "pointer"
      , Space
      , Str "bits,"
      , Space
      , Str "which"
      , Space
      , Str "varies"
      , Space
      , Str "based"
      , Space
      , Str "on"
      , SoftBreak
      , Str "the"
      , Space
      , Str "configuration"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "virtual"
      , Space
      , Str "address"
      , Space
      , Str "space"
      , Space
      , Str "size."
      , Note
          [ Para
              [ Str "If"
              , Space
              , Str "the"
              , Space
              , Str "Top-Byte-Ignore"
              , Space
              , Str "(TBI)"
              , RawInline
                  (Format "tex") "\\index{Top-Byte-Ignore (TBI)}"
              , Space
              , Str "feature"
              , Space
              , Str "is"
              , SoftBreak
              , Str "enabled,"
              , Space
              , Str "the"
              , Space
              , Str "top"
              , Space
              , Str "byte"
              , Space
              , Str "of"
              , Space
              , Str "pointers"
              , Space
              , Str "is"
              , Space
              , Str "ignored"
              , Space
              , Str "when"
              , Space
              , Str "performing"
              , Space
              , Str "memory"
              , Space
              , Str "accesses."
              , SoftBreak
              , Str "This"
              , Space
              , Str "restricts"
              , Space
              , Str "the"
              , Space
              , Str "number"
              , Space
              , Str "of"
              , Space
              , Str "available"
              , Space
              , Str "PAC"
              , Space
              , Str "bits."
              ]
          ]
      ]
  , Para
      [ Link
          ( "" , [] , [] )
          [ Str "Clang" ]
          ( "https://clang.llvm.org/docs/ClangCommandLineReference.html#aarch64"
          , ""
          )
      , Space
      , Str "and"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "GCC" ]
          ( "https://gcc.gnu.org/onlinedocs/gcc/AArch64-Options.html"
          , ""
          )
      , Space
      , Str "both"
      , Space
      , Str "use"
      , Space
      , Str "Pointer"
      , SoftBreak
      , Str "Authentication"
      , Space
      , Str "for"
      , Space
      , Str "return"
      , Space
      , Str "address"
      , Space
      , Str "signing,"
      , Space
      , Str "when"
      , Space
      , Str "compiling"
      , Space
      , Str "with"
      , Space
      , Str "the"
      , SoftBreak
      , Code ( "" , [] , [] ) "-mbranch-protection=pac-ret"
      , Space
      , Str "flag."
      , Space
      , Str "When"
      , Space
      , Str "compiling"
      , Space
      , Str "with"
      , Space
      , Str "Clang"
      , Space
      , Str "using"
      , Space
      , Str "this"
      , Space
      , Str "flag,"
      , SoftBreak
      , Str "the"
      , Space
      , Code ( "" , [] , [] ) "main"
      , Space
      , Str "function"
      , Space
      , Str "from"
      , Space
      , Str "the"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "earlier"
          , Space
          , Str "stack"
          , Space
          , Str "buffer"
          , Space
          , Str "overflow"
          , SoftBreak
          , Str "example"
          ]
          ( "#stack-buffer-overflow" , "" )
      , Space
      , Str "looks"
      , Space
      , Str "like:"
      ]
  , CodeBlock
      ( "" , [] , [] )
      "main:\n    cmp w0, #2\n    b.lt    .LBB1_2\n    paciasp\n    stp x29, x30, [sp, #-16]!\n    ldr x0, [x1, #8]\n    mov x29, sp\n    bl  copy_and_print\n    ldp x29, x30, [sp], #16\n    autiasp\n.LBB1_2:\n    mov w0, wzr\n    ret"
  , Para
      [ Str "Notice"
      , Space
      , Str "the"
      , Space
      , Code ( "" , [] , [] ) "paciasp"
      , Space
      , Str "and"
      , Space
      , Code ( "" , [] , [] ) "autiasp"
      , Space
      , Str "instructions:"
      , Space
      , Code ( "" , [] , [] ) "paciasp"
      , Space
      , Str "computes"
      , Space
      , Str "a"
      , Space
      , Str "PAC"
      , Space
      , Str "for"
      , SoftBreak
      , Str "the"
      , Space
      , Str "return"
      , Space
      , Str "address"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "link"
      , Space
      , Str "register"
      , Space
      , Str "("
      , Code ( "" , [] , [] ) "x30"
      , Str "),"
      , Space
      , Str "based"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "current"
      , Space
      , Str "value"
      , Space
      , Str "of"
      , SoftBreak
      , Str "the"
      , Space
      , Str "stack"
      , Space
      , Str "pointer"
      , Space
      , Str "("
      , Code ( "" , [] , [] ) "sp"
      , Str ")"
      , Space
      , Str "and"
      , Space
      , Str "a"
      , Space
      , Str "key."
      , Space
      , Str "This"
      , Space
      , Str "PAC"
      , Space
      , Str "is"
      , Space
      , Str "inserted"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "extension"
      , Space
      , Str "bits"
      , SoftBreak
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "pointer."
      , Space
      , Str "We"
      , Space
      , Str "then"
      , Space
      , Str "store"
      , Space
      , Str "this"
      , Space
      , Str "signed"
      , Space
      , Str "version"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "link"
      , Space
      , Str "register"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , SoftBreak
      , Str "stack."
      , Space
      , Str "Before"
      , Space
      , Str "returning,"
      , Space
      , Str "we"
      , Space
      , Str "load"
      , Space
      , Str "the"
      , Space
      , Str "signed"
      , Space
      , Str "return"
      , Space
      , Str "address"
      , Space
      , Str "from"
      , Space
      , Str "the"
      , Space
      , Str "stack,"
      , Space
      , Str "we"
      , SoftBreak
      , Str "execute"
      , Space
      , Code ( "" , [] , [] ) "autiasp"
      , Str ","
      , Space
      , Str "which"
      , Space
      , Str "verifies"
      , Space
      , Str "the"
      , Space
      , Str "PAC"
      , Space
      , Str "stored"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "return"
      , Space
      , Str "address,"
      , Space
      , Str "again"
      , SoftBreak
      , Str "based"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "value"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "key"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , Space
      , Str "value"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "stack"
      , Space
      , Str "pointer"
      , Space
      , Str "(which"
      , Space
      , Str "at"
      , Space
      , Str "this"
      , SoftBreak
      , Str "point"
      , Space
      , Str "will"
      , Space
      , Str "be"
      , Space
      , Str "the"
      , Space
      , Str "same"
      , Space
      , Str "as"
      , Space
      , Str "when"
      , Space
      , Str "we"
      , Space
      , Str "signed"
      , Space
      , Str "the"
      , Space
      , Str "return"
      , Space
      , Str "address)."
      , Space
      , Str "If"
      , Space
      , Str "the"
      , Space
      , Str "PAC"
      , Space
      , Str "is"
      , SoftBreak
      , Str "correct,"
      , Space
      , Str "which"
      , Space
      , Str "will"
      , Space
      , Str "be"
      , Space
      , Str "the"
      , Space
      , Str "case"
      , Space
      , Str "in"
      , Space
      , Str "normal"
      , Space
      , Str "execution,"
      , Space
      , Str "the"
      , Space
      , Str "extension"
      , Space
      , Str "bits"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , SoftBreak
      , Str "address"
      , Space
      , Str "are"
      , Space
      , Str "restored,"
      , Space
      , Str "so"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "address"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "used"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Code ( "" , [] , [] ) "ret"
      , Space
      , Str "instruction."
      , SoftBreak
      , Str "However,"
      , Space
      , Str "if"
      , Space
      , Str "the"
      , Space
      , Str "stored"
      , Space
      , Str "return"
      , Space
      , Str "address"
      , Space
      , Str "has"
      , Space
      , Str "been"
      , Space
      , Str "overwritten"
      , Space
      , Str "with"
      , Space
      , Str "an"
      , Space
      , Str "address"
      , Space
      , Str "with"
      , SoftBreak
      , Str "an"
      , Space
      , Str "incorrect"
      , Space
      , Str "PAC,"
      , Space
      , Str "the"
      , Space
      , Str "upper"
      , Space
      , Str "bits"
      , Space
      , Str "will"
      , Space
      , Str "be"
      , Space
      , Str "corrupted"
      , Space
      , Str "so"
      , Space
      , Str "that"
      , Space
      , Str "subsequent"
      , Space
      , Str "uses"
      , Space
      , Str "of"
      , SoftBreak
      , Str "the"
      , Space
      , Str "address"
      , Space
      , Str "(such"
      , Space
      , Str "as"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Code ( "" , [] , [] ) "ret"
      , Space
      , Str "instruction)"
      , Space
      , Str "will"
      , Space
      , Str "result"
      , Space
      , Str "in"
      , Space
      , Str "a"
      , Space
      , Str "fault."
      ]
  , Para
      [ Str "By"
      , Space
      , Str "making"
      , Space
      , Str "sure"
      , Space
      , Str "we"
      , Space
      , Str "don\8217t"
      , Space
      , Str "store"
      , Space
      , Str "any"
      , Space
      , Str "return"
      , Space
      , Str "addresses"
      , Space
      , Str "without"
      , Space
      , Str "a"
      , Space
      , Str "PAC,"
      , Space
      , Str "we"
      , Space
      , Str "can"
      , SoftBreak
      , Str "significantly"
      , Space
      , Str "reduce"
      , Space
      , Str "the"
      , Space
      , Str "effectiveness"
      , Space
      , Str "of"
      , Space
      , Str "ROP"
      , Space
      , Str "attacks:"
      , Space
      , Str "since"
      , Space
      , Str "the"
      , Space
      , Str "secret"
      , Space
      , Str "key"
      , Space
      , Str "is"
      , SoftBreak
      , Str "not"
      , Space
      , Str "retrievable"
      , Space
      , Str "by"
      , Space
      , Str "an"
      , Space
      , Str "attacker,"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "cannot"
      , Space
      , Str "calculate"
      , Space
      , Str "the"
      , Space
      , Str "correct"
      , Space
      , Str "PAC"
      , SoftBreak
      , Str "for"
      , Space
      , Str "a"
      , Space
      , Str "given"
      , Space
      , Str "address"
      , Space
      , Str "and"
      , Space
      , Str "modifier,"
      , Space
      , Str "and"
      , Space
      , Str "is"
      , Space
      , Str "restricted"
      , Space
      , Str "to"
      , Space
      , Str "guessing"
      , Space
      , Str "it."
      , Space
      , Str "The"
      , SoftBreak
      , Str "probability"
      , Space
      , Str "of"
      , Space
      , Str "success"
      , Space
      , Str "when"
      , Space
      , Str "guessing"
      , Space
      , Str "a"
      , Space
      , Str "PAC"
      , Space
      , Str "depends"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "exact"
      , Space
      , Str "number"
      , Space
      , Str "of"
      , Space
      , Str "PAC"
      , SoftBreak
      , Str "bits"
      , Space
      , Str "available"
      , Space
      , Str "in"
      , Space
      , Str "a"
      , Space
      , Str "given"
      , Space
      , Str "system"
      , Space
      , Str "configuration."
      , Space
      , Str "However,"
      , Space
      , Str "authenticated"
      , Space
      , Str "pointers"
      , SoftBreak
      , Str "are"
      , Space
      , Str "vulnerable"
      , Space
      , Str "to"
      , Space
      , Str "pointer"
      , Space
      , Str "substitution"
      , Space
      , Str "attacks"
      , RawInline
          (Format "tex") "\\index{pointer substitution\nattack}"
      , Str ","
      , Space
      , Str "where"
      , Space
      , Str "a"
      , Space
      , Str "pointer"
      , Space
      , Str "that"
      , Space
      , Str "has"
      , Space
      , Str "been"
      , Space
      , Str "signed"
      , Space
      , Str "with"
      , Space
      , Str "a"
      , Space
      , Str "given"
      , Space
      , Str "modifier"
      , Space
      , Str "is"
      , Space
      , Str "replaced"
      , SoftBreak
      , Str "with"
      , Space
      , Str "a"
      , Space
      , Str "different"
      , Space
      , Str "pointer"
      , Space
      , Str "that"
      , Space
      , Str "has"
      , Space
      , Str "also"
      , Space
      , Str "been"
      , Space
      , Str "signed"
      , Space
      , Str "with"
      , Space
      , Str "the"
      , Space
      , Str "same"
      , Space
      , Str "modifier."
      ]
  , Para
      [ Str "Another"
      , Space
      , Str "backward-edge"
      , Space
      , Str "CFI"
      , Space
      , Str "scheme"
      , Space
      , Str "that"
      , Space
      , Str "uses"
      , Space
      , Str "Pointer"
      , Space
      , Str "Authentication"
      , Space
      , Str "instructions"
      , SoftBreak
      , Str "is"
      , Space
      , Str "PACStack"
      , Space
      , Cite
          [ Citation
              { citationId = "Liljestrand2021"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 38
              , citationHash = 0
              }
          ]
          [ Str "[@Liljestrand2021]" ]
      , Str ","
      , Space
      , Str "which"
      , Space
      , Str "chains"
      , Space
      , Str "together"
      , Space
      , Str "PACs"
      , Space
      , Str "in"
      , Space
      , Str "order"
      , Space
      , Str "to"
      , Space
      , Str "include"
      , SoftBreak
      , Str "the"
      , Space
      , Str "full"
      , Space
      , Str "context"
      , Space
      , Str "(all"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "previous"
      , Space
      , Str "return"
      , Space
      , Str "addresses"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "call"
      , Space
      , Str "stack)"
      , Space
      , Str "when"
      , SoftBreak
      , Str "signing"
      , Space
      , Str "a"
      , Space
      , Str "return"
      , Space
      , Str "address."
      , SoftBreak
      , Span
          ( "" , [ "todo" ] , [] )
          [ Str "Add"
          , Space
          , Str "more"
          , Space
          , Str "references"
          , Space
          , Str "to"
          , Space
          , Str "relevant"
          , Space
          , Str "research"
          , Space
          , Span ( "" , [ "issue" ] , [] ) [ Str "166" ]
          ]
      ]
  , Para
      [ Str "Pointer"
      , Space
      , Str "Authentication"
      , Space
      , Str "can"
      , Space
      , Str "also"
      , Space
      , Str "be"
      , Space
      , Str "used"
      , Space
      , Str "more"
      , Space
      , Str "widely,"
      , Space
      , Str "for"
      , Space
      , Str "example"
      , Space
      , Str "to"
      , Space
      , Str "implement"
      , Space
      , Str "a"
      , SoftBreak
      , Str "forward-edge"
      , Space
      , Str "CFI"
      , Space
      , Str "scheme,"
      , Space
      , Str "as"
      , Space
      , Str "is"
      , Space
      , Str "done"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "arm64e"
      , Space
      , Str "ABI"
      , Space
      , Cite
          [ Citation
              { citationId = "McCall2019"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 39
              , citationHash = 0
              }
          ]
          [ Str "[@McCall2019]" ]
      , Str "."
      , SoftBreak
      , Str "The"
      , Space
      , Str "Pointer"
      , Space
      , Str "Authentication"
      , Space
      , Str "instructions,"
      , Space
      , Str "however,"
      , Space
      , Str "are"
      , Space
      , Str "generic"
      , Space
      , Str "enough"
      , Space
      , Str "to"
      , Space
      , Str "also"
      , Space
      , Str "be"
      , SoftBreak
      , Str "useful"
      , Space
      , Str "in"
      , Space
      , Str "implementing"
      , Space
      , Str "more"
      , Space
      , Str "general"
      , Space
      , Str "memory"
      , Space
      , Str "safety"
      , Space
      , Str "measures,"
      , Space
      , Str "beyond"
      , Space
      , Str "CFI."
      , SoftBreak
      , Span
          ( "" , [ "todo" ] , [] )
          [ Str "Mention"
          , Space
          , Str "more"
          , Space
          , Str "Pointer"
          , Space
          , Str "Authentication"
          , Space
          , Str "uses"
          , Space
          , Str "in"
          , Space
          , Str "later"
          , Space
          , Str "section,"
          , Space
          , Str "and"
          , Space
          , Str "add"
          , Space
          , Str "link"
          , SoftBreak
          , Str "here"
          , Space
          , Span ( "" , [ "issue" ] , [] ) [ Str "167" ]
          ]
      ]
  , Header 4 ( "bti" , [] , [] ) [ Str "BTI" ]
  , Para
      [ Link
          ( "" , [] , [] )
          [ Str "Branch"
          , Space
          , Str "Target"
          , Space
          , Str "Identification"
          , SoftBreak
          , Str "(BTI)"
          ]
          ( "https://developer.arm.com/documentation/102433/0100/Jump-oriented-programming?lang=en"
          , ""
          )
      , SoftBreak
      , RawInline (Format "tex") "\\index{BTI}"
      , Str ","
      , Space
      , Str "introduced"
      , Space
      , Str "in"
      , Space
      , Str "Armv8.5,"
      , Space
      , Str "offers"
      , Space
      , Str "coarse-grained"
      , Space
      , Str "forward-edge"
      , SoftBreak
      , Str "protection."
      , Space
      , Str "With"
      , Space
      , Str "BTI,"
      , Space
      , Str "the"
      , Space
      , Str "locations"
      , Space
      , Str "that"
      , Space
      , Str "are"
      , Space
      , Str "targets"
      , Space
      , Str "of"
      , Space
      , Str "indirect"
      , Space
      , Str "branches"
      , Space
      , Str "have"
      , SoftBreak
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "marked"
      , Space
      , Str "with"
      , Space
      , Str "a"
      , Space
      , Str "new"
      , Space
      , Str "instruction,"
      , Space
      , Code ( "" , [] , [] ) "BTI"
      , Str "."
      , Space
      , Str "There"
      , Space
      , Str "are"
      , Space
      , Str "four"
      , Space
      , Str "different"
      , Space
      , Str "types"
      , Space
      , Str "of"
      , SoftBreak
      , Str "BTI"
      , Space
      , Str "instructions"
      , Space
      , Str "that"
      , Space
      , Str "permit"
      , Space
      , Str "different"
      , Space
      , Str "types"
      , Space
      , Str "of"
      , Space
      , Str "indirect"
      , Space
      , Str "branches"
      , Space
      , Str "(indirect"
      , SoftBreak
      , Str "jump,"
      , Space
      , Str "indirect"
      , Space
      , Str "call,"
      , Space
      , Str "both,"
      , Space
      , Str "or"
      , Space
      , Str "none)."
      , Space
      , Str "An"
      , Space
      , Str "indirect"
      , Space
      , Str "branch"
      , Space
      , Str "to"
      , Space
      , Str "a"
      , Space
      , Str "non-BTI"
      , SoftBreak
      , Str "instruction"
      , Space
      , Str "or"
      , Space
      , Str "the"
      , Space
      , Str "wrong"
      , Space
      , Str "type"
      , Space
      , Str "of"
      , Space
      , Str "BTI"
      , Space
      , Str "instruction"
      , Space
      , Str "will"
      , Space
      , Str "raise"
      , Space
      , Str "a"
      , Space
      , Str "Branch"
      , Space
      , Str "Target"
      , SoftBreak
      , Str "Exception."
      ]
  , Para
      [ Str "Both"
      , Space
      , Str "Clang"
      , Space
      , Str "and"
      , Space
      , Str "GCC"
      , Space
      , Str "support"
      , Space
      , Str "generating"
      , Space
      , Str "BTI"
      , Space
      , Str "instructions,"
      , Space
      , Str "with"
      , Space
      , Str "the"
      , SoftBreak
      , Code ( "" , [] , [] ) "-mbranch-protection=bti"
      , Space
      , Str "flag,"
      , Space
      , Str "or,"
      , Space
      , Str "to"
      , Space
      , Str "enable"
      , Space
      , Str "both"
      , Space
      , Str "BTI"
      , Space
      , Str "and"
      , Space
      , Str "return"
      , Space
      , Str "address"
      , SoftBreak
      , Str "signing"
      , Space
      , Str "with"
      , Space
      , Str "Pointer"
      , Space
      , Str "Authentication,"
      , Space
      , Code ( "" , [] , [] ) "-mbranch-protection=standard"
      , Str "."
      ]
  , Para
      [ Str "Two"
      , Space
      , Str "aspects"
      , Space
      , Str "of"
      , Space
      , Str "BTI"
      , Space
      , Str "can"
      , Space
      , Str "simplify"
      , Space
      , Str "its"
      , Space
      , Str "deployment:"
      , Space
      , Str "individual"
      , Space
      , Str "pages"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "marked"
      , SoftBreak
      , Str "as"
      , Space
      , Str "guarded"
      , Space
      , Str "or"
      , Space
      , Str "unguarded,"
      , Space
      , Str "with"
      , Space
      , Str "BTI"
      , Space
      , Str "checks"
      , Space
      , Str "as"
      , Space
      , Str "described"
      , Space
      , Str "above"
      , Space
      , Str "only"
      , Space
      , Str "applying"
      , Space
      , Str "to"
      , SoftBreak
      , Str "indirect"
      , Space
      , Str "branches"
      , Space
      , Str "targeting"
      , Space
      , Str "guarded"
      , Space
      , Str "pages."
      , Space
      , Str "In"
      , Space
      , Str "addition"
      , Space
      , Str "to"
      , Space
      , Str "this,"
      , Space
      , Str "the"
      , Space
      , Str "BTI"
      , SoftBreak
      , Str "instruction"
      , Space
      , Str "has"
      , Space
      , Str "been"
      , Space
      , Str "assigned"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "hint"
      , Space
      , Str "space,"
      , Space
      , Str "therefore"
      , Space
      , Str "it"
      , Space
      , Str "will"
      , Space
      , Str "be"
      , Space
      , Str "executed"
      , SoftBreak
      , Str "as"
      , Space
      , Str "a"
      , Space
      , Str "no-op"
      , Space
      , Str "in"
      , Space
      , Str "cores"
      , Space
      , Str "that"
      , Space
      , Str "do"
      , Space
      , Str "not"
      , Space
      , Str "support"
      , Space
      , Str "BTI,"
      , Space
      , Str "aiding"
      , Space
      , Str "its"
      , Space
      , Str "adoption."
      ]
  , Header
      4
      ( "cfi-implementation-pitfalls" , [] , [] )
      [ Str "CFI"
      , Space
      , Str "implementation"
      , Space
      , Str "pitfalls"
      ]
  , Para
      [ Str "When"
      , Space
      , Str "implementing"
      , Space
      , Str "CFI"
      , Space
      , Str "measures"
      , Space
      , Str "like"
      , Space
      , Str "the"
      , Space
      , Str "ones"
      , Space
      , Str "described"
      , Space
      , Str "here,"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , Space
      , Str "important"
      , Space
      , Str "to"
      , SoftBreak
      , Str "be"
      , Space
      , Str "aware"
      , Space
      , Str "of"
      , Space
      , Str "known"
      , Space
      , Str "weaknesses"
      , Space
      , Str "that"
      , Space
      , Str "affect"
      , Space
      , Str "similar"
      , Space
      , Str "schemes."
      , Space
      , Cite
          [ Citation
              { citationId = "Conti2015"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 40
              , citationHash = 0
              }
          ]
          [ Str "[@Conti2015]" ]
      , SoftBreak
      , Str "describes"
      , Space
      , Str "how"
      , Space
      , Str "CFI"
      , Space
      , Str "implementations"
      , Space
      , Str "can"
      , Space
      , Str "suffer"
      , Space
      , Str "when"
      , Space
      , Str "certain"
      , Space
      , Str "registers"
      , Space
      , Str "are"
      , Space
      , Str "spilled"
      , SoftBreak
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "stack,"
      , Space
      , Str "where"
      , Space
      , Str "they"
      , Space
      , Str "could"
      , Space
      , Str "be"
      , Space
      , Str "controlled"
      , Space
      , Str "by"
      , Space
      , Str "an"
      , Space
      , Str "attacker."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "if"
      , Space
      , Str "a"
      , SoftBreak
      , Str "register"
      , Space
      , Str "that"
      , Space
      , Str "contains"
      , Space
      , Str "a"
      , Space
      , Str "function"
      , Space
      , Str "pointer"
      , Space
      , Str "that"
      , Space
      , Str "has"
      , Space
      , Str "just"
      , Space
      , Str "been"
      , Space
      , Str "validated"
      , Space
      , Str "gets"
      , SoftBreak
      , Str "spilled,"
      , Space
      , Str "the"
      , Space
      , Str "check"
      , Space
      , Str "can"
      , Space
      , Str "effectively"
      , Space
      , Str "be"
      , Space
      , Str "bypassed"
      , Space
      , Str "by"
      , Space
      , Str "overwriting"
      , Space
      , Str "the"
      , Space
      , Str "spilled"
      , SoftBreak
      , Str "pointer."
      ]
  , Para
      [ Str "Having"
      , Space
      , Str "discussed"
      , Space
      , Str "various"
      , Space
      , Str "mitigations"
      , Space
      , Str "against"
      , Space
      , Str "code"
      , Space
      , Str "reuse"
      , Space
      , Str "attacks,"
      , Space
      , Str "it\8217s"
      , Space
      , Str "time"
      , Space
      , Str "to"
      , SoftBreak
      , Str "turn"
      , Space
      , Str "our"
      , Space
      , Str "attention"
      , Space
      , Str "to"
      , Space
      , Str "a"
      , Space
      , Str "different"
      , Space
      , Str "type"
      , Space
      , Str "of"
      , Space
      , Str "attacks,"
      , Space
      , Str "which"
      , Space
      , Str "do"
      , Space
      , Str "not"
      , Space
      , Str "try"
      , Space
      , Str "to"
      , Space
      , Str "overwrite"
      , SoftBreak
      , Str "code"
      , Space
      , Str "pointers:"
      , Space
      , Str "attacks"
      , Space
      , Str "against"
      , Space
      , Str "non-control"
      , Space
      , Str "data,"
      , Space
      , Str "which"
      , Space
      , Str "will"
      , Space
      , Str "be"
      , Space
      , Str "the"
      , Space
      , Str "topic"
      , Space
      , Str "of"
      , SoftBreak
      , Str "the"
      , Space
      , Str "next"
      , Space
      , Str "section."
      ]
  , Header
      2
      ( "non-control-data-attacks" , [] , [] )
      [ Str "Non-control"
      , Space
      , Str "data"
      , Space
      , Str "attacks"
      ]
  , Para
      [ Str "In"
      , Space
      , Str "the"
      , Space
      , Str "previous"
      , Space
      , Str "sections,"
      , Space
      , Str "we"
      , Space
      , Str "have"
      , Space
      , Str "focused"
      , Space
      , Str "on"
      , Space
      , Str "subverting"
      , Space
      , Str "control"
      , Space
      , Str "flow"
      , Space
      , Str "by"
      , SoftBreak
      , Str "overwriting"
      , Space
      , Str "control"
      , Space
      , Str "data"
      , RawInline (Format "tex") "\\index{control data}"
      , Str ","
      , Space
      , Str "which"
      , Space
      , Str "are"
      , Space
      , Str "used"
      , Space
      , Str "to"
      , Space
      , Str "change"
      , Space
      , Str "the"
      , SoftBreak
      , Str "value"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "program"
      , Space
      , Str "counter,"
      , Space
      , Str "such"
      , Space
      , Str "as"
      , Space
      , Str "return"
      , Space
      , Str "addresses"
      , Space
      , Str "and"
      , Space
      , Str "function"
      , Space
      , Str "pointers."
      , SoftBreak
      , Str "Since"
      , Space
      , Str "these"
      , Space
      , Str "types"
      , Space
      , Str "of"
      , Space
      , Str "attacks"
      , Space
      , Str "are"
      , Space
      , Str "prominent,"
      , Space
      , Str "many"
      , Space
      , Str "mitigations"
      , Space
      , Str "have"
      , Space
      , Str "been"
      , Space
      , Str "designed"
      , SoftBreak
      , Str "with"
      , Space
      , Str "the"
      , Space
      , Str "goal"
      , Space
      , Str "of"
      , Space
      , Str "maintaining"
      , Space
      , Str "control-flow"
      , Space
      , Str "integrity."
      , Space
      , Str "Non-control"
      , Space
      , Str "data"
      , SoftBreak
      , Str "attacks"
      , RawInline
          (Format "tex") "\\index{non-control data attacks}"
      , Str ","
      , Space
      , Str "also"
      , Space
      , Str "known"
      , Space
      , Str "as"
      , Space
      , Str "data-only"
      , SoftBreak
      , Str "attacks"
      , RawInline (Format "tex") "\\index{data-only attacks}"
      , Str ","
      , Space
      , Str "can"
      , Space
      , Str "completely"
      , Space
      , Str "bypass"
      , Space
      , Str "these"
      , Space
      , Str "mitigations,"
      , SoftBreak
      , Str "since"
      , Space
      , Str "the"
      , Space
      , Str "data"
      , Space
      , Str "they"
      , Space
      , Str "modify"
      , Space
      , Str "is"
      , Space
      , Str "not"
      , Space
      , Str "the"
      , Space
      , Str "control"
      , Space
      , Str "data"
      , Space
      , Str "that"
      , Space
      , Str "these"
      , Space
      , Str "mitigations"
      , SoftBreak
      , Str "protect."
      ]
  , Para
      [ Str "Non-control"
      , Space
      , Str "data"
      , Space
      , Str "attacks"
      , Space
      , Str "can"
      , Space
      , Str "range"
      , Space
      , Str "from"
      , Space
      , Str "very"
      , Space
      , Str "simple"
      , Space
      , Str "attacks"
      , Space
      , Str "targeting"
      , Space
      , Str "a"
      , Space
      , Str "single"
      , SoftBreak
      , Str "piece"
      , Space
      , Str "of"
      , Space
      , Str "data"
      , Space
      , Str "to"
      , Space
      , Str "very"
      , Space
      , Str "elaborate"
      , Space
      , Str "attacks"
      , Space
      , Str "with"
      , Space
      , Str "very"
      , Space
      , Str "high"
      , Space
      , Str "expressiveness"
      , SoftBreak
      , Cite
          [ Citation
              { citationId = "Beer2021"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 41
              , citationHash = 0
              }
          ]
          [ Str "[@Beer2021]" ]
      , Str "."
      , Space
      , Str "A"
      , Space
      , Str "very"
      , Space
      , Str "simple"
      , Space
      , Str "example"
      , Space
      , Str "may"
      , Space
      , Str "look"
      , Space
      , Str "something"
      , Space
      , Str "like"
      , Space
      , Str "this:"
      ]
  , CodeBlock
      ( "" , [] , [] )
      "// Returns zero for failure, non-zero for success.\nint authenticate() {\n  int authenticated = 0;\n  char passphrase[10];\n  if (fgets(passphrase, 20, stdin)) {     // buffer overflow\n    if (!strcmp(passphrase, \"secret\\n\")) {\n      authenticated = 1;\n    }\n  }\n  return authenticated;\n}"
  , Para
      [ Str "The"
      , Space
      , Str "example"
      , Space
      , Str "shows"
      , Space
      , Str "a"
      , Space
      , Str "simplified"
      , Note
          [ Para
              [ Str "This"
              , Space
              , Str "is"
              , Space
              , Str "obviously"
              , Space
              , Str "not"
              , Space
              , Str "a"
              , Space
              , Str "realistic"
              , Space
              , Str "example"
              , Space
              , Str "of"
              , Space
              , Str "how"
              , SoftBreak
              , Str "authentication"
              , Space
              , Str "should"
              , Space
              , Str "be"
              , Space
              , Str "done,"
              , Space
              , Str "but"
              , Space
              , Str "simply"
              , Space
              , Str "serves"
              , Space
              , Str "to"
              , Space
              , Str "illustrate"
              , Space
              , Str "how"
              , Space
              , Str "a"
              , SoftBreak
              , Str "buffer"
              , Space
              , Str "overflow"
              , Space
              , Str "into"
              , Space
              , Str "a"
              , Space
              , Str "non-control"
              , Space
              , Str "variable"
              , Space
              , Str "can"
              , Space
              , Str "have"
              , Space
              , Str "serious"
              , Space
              , Str "security"
              , SoftBreak
              , Str "consequences."
              ]
          ]
      , Space
      , Str "function"
      , Space
      , Str "that"
      , Space
      , Str "reads"
      , Space
      , Str "a"
      , SoftBreak
      , Str "passphrase"
      , Space
      , Str "from"
      , Space
      , Str "a"
      , Space
      , Str "user,"
      , Space
      , Str "compares"
      , Space
      , Str "it"
      , Space
      , Str "with"
      , Space
      , Str "a"
      , Space
      , Str "known"
      , Space
      , Str "value"
      , Space
      , Str "and"
      , Space
      , Str "sets"
      , Space
      , Str "an"
      , Space
      , Str "integer"
      , SoftBreak
      , Str "stack"
      , Space
      , Str "variable"
      , Space
      , Str "to"
      , Space
      , Str "indicate"
      , Space
      , Str "whether"
      , Space
      , Quoted DoubleQuote [ Str "authentication" ]
      , Space
      , Str "was"
      , Space
      , Str "successful"
      , Space
      , Str "or"
      , Space
      , Str "not."
      , Space
      , Str "The"
      , SoftBreak
      , Str "function"
      , Space
      , Str "contains"
      , Space
      , Str "a"
      , Space
      , Str "very"
      , Space
      , Str "obvious"
      , Space
      , Str "buffer"
      , Space
      , Str "overflow,"
      , Space
      , Str "as"
      , Space
      , Str "the"
      , Space
      , Str "string"
      , Space
      , Str "length"
      , Space
      , Str "limit"
      , SoftBreak
      , Str "passed"
      , Space
      , Str "to"
      , Space
      , Code ( "" , [] , [] ) "fgets"
      , Space
      , Str "does"
      , Space
      , Str "not"
      , Space
      , Str "match"
      , Space
      , Str "the"
      , Space
      , Str "buffer"
      , Space
      , Str "size."
      ]
  , Para
      [ Str "Figure"
      , Space
      , Cite
          [ Citation
              { citationId = "fig:non-control-data-attack"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = AuthorInText
              , citationNoteNum = 43
              , citationHash = 0
              }
          ]
          [ Str "@fig:non-control-data-attack" ]
      , Space
      , Str "shows"
      , Space
      , Str "the"
      , Space
      , Str "stack"
      , Space
      , Str "frame"
      , Space
      , Str "layout"
      , Space
      , Str "for"
      , Space
      , Str "this"
      , SoftBreak
      , Str "function"
      , Space
      , Str "when"
      , Space
      , Str "the"
      , Space
      , Str "code"
      , Space
      , Str "is"
      , Space
      , Str "compiled"
      , Space
      , Str "for"
      , Space
      , Str "AArch64"
      , Space
      , Str "with"
      , Space
      , Str "Clang"
      , Space
      , Str "10.0"
      , Note
          [ Para
              [ Str "The"
              , Space
              , Str "stack"
              , Space
              , Str "frame"
              , Space
              , Str "layout"
              , Space
              , Str "may"
              , Space
              , Str "be"
              , Space
              , Str "significantly"
              , Space
              , Str "different"
              , Space
              , Str "for"
              , Space
              , Str "other"
              , SoftBreak
              , Str "architectures"
              , Space
              , Str "and"
              , Space
              , Str "compilers."
              ]
          ]
      , Str "."
      , Space
      , Str "As"
      , Space
      , Str "the"
      , Space
      , Str "figure"
      , SoftBreak
      , Str "shows,"
      , Space
      , Str "an"
      , Space
      , Str "overflow"
      , Space
      , Str "of"
      , Space
      , Code ( "" , [] , [] ) "passphrase"
      , Space
      , Str "will"
      , Space
      , Str "overwrite"
      , Space
      , Code ( "" , [] , [] ) "authenticated"
      , Str ","
      , Space
      , Str "setting"
      , Space
      , Str "it"
      , SoftBreak
      , Str "to"
      , Space
      , Str "a"
      , Space
      , Str "non-zero"
      , Space
      , Str "value,"
      , Space
      , Str "even"
      , Space
      , Str "though"
      , Space
      , Str "the"
      , Space
      , Str "passphrase"
      , Space
      , Str "was"
      , Space
      , Str "incorrect."
      , Space
      , Str "The"
      , SoftBreak
      , Code ( "" , [] , [] ) "authenticate"
      , Space
      , Str "function"
      , Space
      , Str "will"
      , Space
      , Str "then"
      , Space
      , Str "return"
      , Space
      , Str "a"
      , Space
      , Str "non-zero"
      , Space
      , Str "value,"
      , Space
      , Str "incorrectly"
      , SoftBreak
      , Str "indicating"
      , Space
      , Str "authentication"
      , Space
      , Str "success."
      ]
  , Figure
      ( "fig:non-control-data-attack" , [] , [] )
      (Caption
         Nothing
         [ Plain
             [ Str "Stack"
             , Space
             , Str "frame"
             , Space
             , Str "for"
             , Space
             , Code ( "" , [] , [] ) "authenticate"
             ]
         ])
      [ Plain
          [ Image
              ( "" , [] , [ ( "width" , "60%" ) ] )
              [ Str "Stack"
              , Space
              , Str "frame"
              , Space
              , Str "for"
              , Space
              , Code ( "" , [] , [] ) "authenticate"
              ]
              ( "img/non-control-data-attack" , "" )
          ]
      ]
  , Para
      [ Str "For"
      , Space
      , Str "many"
      , Space
      , Str "more"
      , Space
      , Str "simple"
      , Space
      , Str "examples"
      , Space
      , Str "of"
      , Space
      , Str "data-only"
      , Space
      , Str "attacks"
      , Space
      , Str "that"
      , Space
      , Str "can"
      , Space
      , Str "occur"
      , Space
      , Str "in"
      , Space
      , Str "real"
      , SoftBreak
      , Str "applications,"
      , Space
      , Str "see"
      , Space
      , Cite
          [ Citation
              { citationId = "Chen2005"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 45
              , citationHash = 0
              }
          ]
          [ Str "[@Chen2005]" ]
      , Str "."
      , Space
      , Str "Although"
      , Space
      , Str "this"
      , Space
      , Str "makes"
      , Space
      , Str "it"
      , Space
      , Str "clear"
      , Space
      , Str "that"
      , Space
      , Str "data-only"
      , SoftBreak
      , Str "attacks"
      , Space
      , Str "are"
      , Space
      , Str "a"
      , Space
      , Str "real"
      , Space
      , Str "issue,"
      , Space
      , Str "it"
      , Space
      , Str "leaves"
      , Space
      , Str "open"
      , Space
      , Str "a"
      , Space
      , Str "very"
      , Space
      , Str "important"
      , Space
      , Str "question:"
      , Space
      , Str "what"
      , Space
      , Str "are"
      , SoftBreak
      , Str "the"
      , Space
      , Str "limits"
      , Space
      , Str "of"
      , Space
      , Str "such"
      , Space
      , Str "attacks?"
      , Space
      , Str "It"
      , Space
      , Str "is"
      , Space
      , Str "tempting"
      , Space
      , Str "to"
      , Space
      , Str "assume"
      , Space
      , Str "that"
      , Space
      , Str "data-only"
      , Space
      , Str "attacks"
      , Space
      , Str "are"
      , SoftBreak
      , Str "somehow"
      , Space
      , Str "inherently"
      , Space
      , Str "limited,"
      , Space
      , Str "however"
      , Space
      , Str "it"
      , Space
      , Str "has"
      , Space
      , Str "been"
      , Space
      , Str "demonstrated"
      , Space
      , Str "in"
      , Space
      , Cite
          [ Citation
              { citationId = "Hu2016"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 46
              , citationHash = 0
              }
          ]
          [ Str "[@Hu2016]" ]
      , Space
      , Str "that"
      , SoftBreak
      , Str "they"
      , Space
      , Str "can,"
      , Space
      , Str "in"
      , Space
      , Str "fact,"
      , Space
      , Str "be"
      , Space
      , Str "very"
      , Space
      , Str "expressive."
      , Space
      , Cite
          [ Citation
              { citationId = "Hu2016"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 47
              , citationHash = 0
              }
          ]
          [ Str "[@Hu2016]" ]
      , Space
      , Str "describes"
      , Space
      , Str "Data-Oriented"
      , SoftBreak
      , Str "Programming"
      , Space
      , Str "(DOP),"
      , Space
      , Str "a"
      , Space
      , Str "general"
      , Space
      , Str "method"
      , Space
      , Str "for"
      , Space
      , Str "building"
      , Space
      , Str "data-only"
      , Space
      , Str "attacks"
      , Space
      , Str "against"
      , Space
      , Str "a"
      , SoftBreak
      , Str "vulnerable"
      , Space
      , Str "program,"
      , Space
      , Str "starting"
      , Space
      , Str "from"
      , Space
      , Str "a"
      , Space
      , Str "known"
      , Space
      , Str "memory"
      , Space
      , Str "error"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "program"
      , Note
          [ Para
              [ Str "The"
              , Space
              , Str "authors"
              , Space
              , Str "describe"
              , Space
              , Str "how"
              , Space
              , Str "DOP"
              , Space
              , Str "gadgets"
              , Space
              , Str "can"
              , Space
              , Str "be"
              , Space
              , Str "chained"
              , Space
              , Str "to"
              , Space
              , Str "simulate"
              , SoftBreak
              , Str "a"
              , Space
              , Str "Turing"
              , Space
              , Str "machine,"
              , Space
              , Str "making"
              , Space
              , Str "DOP"
              , Space
              , Str "attacks"
              , Space
              , Str "Turing-complete"
              , Space
              , Str "(it\8217s"
              , Space
              , Str "not"
              , Space
              , Str "possible"
              , SoftBreak
              , Str "to"
              , Space
              , Str "simulate"
              , Space
              , Str "the"
              , Space
              , Str "infinite"
              , Space
              , Str "tape"
              , Space
              , Str "of"
              , Space
              , Str "a"
              , Space
              , Str "Turing"
              , Space
              , Str "machine"
              , Space
              , Str "on"
              , Space
              , Str "any"
              , Space
              , Str "actual"
              , Space
              , Str "hardware,"
              , SoftBreak
              , Str "of"
              , Space
              , Str "course)."
              , Space
              , Str "Turing-completeness"
              , Space
              , Str "is"
              , Space
              , Str "not,"
              , Space
              , Str "however,"
              , Space
              , Str "a"
              , Space
              , Str "particularly"
              , Space
              , Str "useful"
              , SoftBreak
              , Str "measure"
              , Space
              , Str "of"
              , Space
              , Str "exploitability,"
              , Space
              , Str "as"
              , Space
              , Str "explained"
              , Space
              , Str "in"
              , Space
              , Cite
                  [ Citation
                      { citationId = "Dullien2018"
                      , citationPrefix = []
                      , citationSuffix = []
                      , citationMode = NormalCitation
                      , citationNoteNum = 48
                      , citationHash = 0
                      }
                  ]
                  [ Str "[@Dullien2018]" ]
              , Str "."
              , Space
              , Str "Many"
              , Space
              , Str "applications"
              , SoftBreak
              , Str "offer"
              , Space
              , Str "their"
              , Space
              , Str "users"
              , Space
              , Str "the"
              , Space
              , Str "ability"
              , Space
              , Str "to"
              , Space
              , Str "perform"
              , Space
              , Str "arbitrary"
              , Space
              , Str "computation,"
              , Space
              , Str "for"
              , SoftBreak
              , Str "example"
              , Space
              , Str "JavaScript"
              , Space
              , Str "engines,"
              , Space
              , Str "and"
              , Space
              , Str "those"
              , Space
              , Str "capabilities"
              , Space
              , Str "can"
              , Space
              , Str "be"
              , Space
              , Str "useful"
              , Space
              , Str "to"
              , Space
              , Str "an"
              , SoftBreak
              , Str "attacker,"
              , Space
              , Str "but"
              , Space
              , Str "performing"
              , Space
              , Str "a"
              , Space
              , Str "computation"
              , Space
              , Str "without"
              , Space
              , Str "affecting"
              , Space
              , Str "normal"
              , Space
              , Str "program"
              , SoftBreak
              , Str "behavior"
              , Space
              , Str "does"
              , Space
              , Str "not"
              , Space
              , Str "constitute"
              , Space
              , Quoted DoubleQuote [ Str "exploitation" ]
              , Str "."
              ]
          ]
      , Str "."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "authors"
      , Space
      , Str "of"
      , Space
      , Cite
          [ Citation
              { citationId = "Hu2016"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 49
              , citationHash = 0
              }
          ]
          [ Str "[@Hu2016]" ]
      , Space
      , Str "describe"
      , Space
      , Str "a"
      , Space
      , Str "small"
      , Space
      , Str "language"
      , Space
      , Str "called"
      , SoftBreak
      , Str "MINDOP,"
      , Space
      , Str "with"
      , Space
      , Str "a"
      , Space
      , Str "virtual"
      , Space
      , Str "instruction"
      , Space
      , Str "set"
      , Space
      , Str "and"
      , Space
      , Str "virtual"
      , Space
      , Str "registers."
      , Space
      , Str "The"
      , Space
      , Str "virtual"
      , SoftBreak
      , Str "registers"
      , Space
      , Str "of"
      , Space
      , Str "MINDOP"
      , Space
      , Str "correspond"
      , Space
      , Str "to"
      , Space
      , Str "memory"
      , Space
      , Str "locations."
      , Space
      , Str "The"
      , Space
      , Str "MINDOP"
      , Space
      , Str "instructions"
      , SoftBreak
      , Str "correspond"
      , Space
      , Str "to"
      , Space
      , Str "operations"
      , Space
      , Str "on"
      , Space
      , Str "these"
      , Space
      , Str "virtual"
      , Space
      , Str "registers,"
      , Space
      , Str "for"
      , Space
      , Str "example"
      , Space
      , Str "loading"
      , Space
      , Str "a"
      , SoftBreak
      , Str "value"
      , Space
      , Str "into"
      , Space
      , Str "a"
      , Space
      , Str "virtual"
      , Space
      , Str "register,"
      , Space
      , Str "storing"
      , Space
      , Str "a"
      , Space
      , Str "value"
      , Space
      , Str "from"
      , Space
      , Str "a"
      , Space
      , Str "virtual"
      , Space
      , Str "register,"
      , SoftBreak
      , Str "arithmetic"
      , Space
      , Str "operations"
      , Space
      , Str "and"
      , Space
      , Str "even"
      , Space
      , Str "conditional"
      , Space
      , Str "and"
      , Space
      , Str "unconditional"
      , Space
      , Str "jumps."
      , Space
      , Str "The"
      , Space
      , Str "authors"
      , SoftBreak
      , Str "show"
      , Space
      , Str "how"
      , Space
      , Str "to"
      , Space
      , Str "identify"
      , Space
      , Str "gadgets"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "code"
      , Space
      , Str "that"
      , Space
      , Str "implement"
      , Space
      , Str "the"
      , Space
      , Str "various"
      , Space
      , Str "MINDOP"
      , SoftBreak
      , Str "instructions"
      , Space
      , Str "and"
      , Space
      , Str "are"
      , Space
      , Str "reachable"
      , Space
      , Str "from"
      , Space
      , Str "memory"
      , Space
      , Str "errors,"
      , Space
      , Str "and"
      , Space
      , Str "how"
      , Space
      , Str "those"
      , Space
      , Str "gadgets"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , SoftBreak
      , Str "stitched"
      , Space
      , Str "together"
      , Space
      , Str "with"
      , Space
      , Str "the"
      , Space
      , Str "help"
      , Space
      , Str "of"
      , Space
      , Str "dispatcher"
      , Space
      , Str "gadgets,"
      , Space
      , Str "the"
      , Space
      , Str "role"
      , Space
      , Str "of"
      , Space
      , Str "which"
      , Space
      , Str "is"
      , SoftBreak
      , Str "specifically"
      , Space
      , Str "to"
      , Space
      , Str "chain"
      , Space
      , Str "gadgets"
      , Space
      , Str "together."
      ]
  , Para
      [ Str "Stitching"
      , Space
      , Str "gadgets"
      , Space
      , Str "together"
      , Space
      , Str "is"
      , Space
      , Str "simpler"
      , Space
      , Str "for"
      , Space
      , Str "interactive"
      , Space
      , Str "attacks,"
      , Space
      , Str "where"
      , Space
      , Str "the"
      , SoftBreak
      , Str "attacker"
      , Space
      , Str "can"
      , Space
      , Str "keep"
      , Space
      , Str "providing"
      , Space
      , Str "malicious"
      , Space
      , Str "input"
      , Space
      , Str "to"
      , Space
      , Str "trigger"
      , Space
      , Str "the"
      , Space
      , Str "initial"
      , Space
      , Str "memory"
      , SoftBreak
      , Str "error"
      , Space
      , Str "and"
      , Space
      , Str "a"
      , Space
      , Str "certain"
      , Space
      , Str "chain"
      , Space
      , Str "of"
      , Space
      , Str "gadgets,"
      , Space
      , Str "as"
      , Space
      , Str "many"
      , Space
      , Str "times"
      , Space
      , Str "as"
      , Space
      , Str "needed."
      , Space
      , Str "For"
      , SoftBreak
      , Str "non-interactive"
      , Space
      , Str "attacks,"
      , Space
      , Str "the"
      , Space
      , Str "MINDOP"
      , Space
      , Str "jump"
      , Space
      , Str "operations"
      , Space
      , Str "are"
      , Space
      , Str "required"
      , Space
      , Str "as"
      , Space
      , Str "well,"
      , SoftBreak
      , Str "used"
      , Space
      , Str "in"
      , Space
      , Str "conjunction"
      , Space
      , Str "with"
      , Space
      , Str "a"
      , Space
      , Str "memory"
      , Space
      , Str "location"
      , Space
      , Str "that"
      , Space
      , Str "provides"
      , Space
      , Str "a"
      , Space
      , Str "virtual"
      , Space
      , Str "program"
      , SoftBreak
      , Str "counter."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "process"
      , Space
      , Str "of"
      , Space
      , Str "creating"
      , Space
      , Str "a"
      , Space
      , Str "DOP"
      , Space
      , Str "attack"
      , Space
      , Str "is"
      , Space
      , Str "not"
      , Space
      , Str "so"
      , Space
      , Str "simple"
      , Space
      , Str "and"
      , Space
      , Str "not"
      , Space
      , Str "fully"
      , SoftBreak
      , Str "automated."
      , Space
      , Str "Related"
      , Space
      , Str "literature"
      , Space
      , Cite
          [ Citation
              { citationId = "Ispoglou2018"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 50
              , citationHash = 0
              }
          ]
          [ Str "[@Ispoglou2018]" ]
      , Space
      , Str "focuses"
      , Space
      , Str "on"
      , Space
      , Str "automating"
      , SoftBreak
      , Str "data-only"
      , Space
      , Str "attacks."
      ]
  , Para
      [ Str "When"
      , Space
      , Str "reading"
      , Space
      , Str "write-ups"
      , Space
      , Str "on"
      , Space
      , Str "recent"
      , Space
      , Str "security"
      , Space
      , Str "issues,"
      , Space
      , Str "instead"
      , Space
      , Str "of"
      , Space
      , Str "terminology"
      , SoftBreak
      , Str "related"
      , Space
      , Str "to"
      , Space
      , Str "data-oriented"
      , Space
      , Str "gadgets,"
      , Space
      , Str "you"
      , Space
      , Str "are"
      , Space
      , Str "more"
      , Space
      , Str "likely"
      , Space
      , Str "to"
      , Space
      , Str "encounter"
      , Space
      , Str "the"
      , Space
      , Str "term"
      , SoftBreak
      , Quoted DoubleQuote [ Str "primitive" ]
      , Str ","
      , Space
      , Str "which"
      , Space
      , Str "has"
      , Space
      , Str "been"
      , Space
      , Str "described"
      , Space
      , Str "in"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "an"
          , Space
          , Str "earlier"
          , SoftBreak
          , Str "section"
          ]
          ( "#exploitation-primitives" , "" )
      , Str "."
      , Space
      , Str "These"
      , Space
      , Str "concepts"
      , Space
      , Str "are"
      , Space
      , Str "related:"
      , Space
      , Str "an"
      , Space
      , Str "arbitrary"
      , SoftBreak
      , Str "read"
      , Space
      , Str "primitive,"
      , Space
      , Str "for"
      , Space
      , Str "example,"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "produced"
      , Space
      , Str "by"
      , Space
      , Str "chaining"
      , Space
      , Str "a"
      , Space
      , Str "(possibly"
      , Space
      , Str "large)"
      , SoftBreak
      , Str "number"
      , Space
      , Str "of"
      , Space
      , Str "DOP"
      , Space
      , Str "gadgets."
      , Space
      , Str "Talking"
      , Space
      , Str "about"
      , Space
      , Str "primitives"
      , Space
      , Str "offers"
      , Space
      , Str "a"
      , Space
      , Str "nicer"
      , Space
      , Str "level"
      , Space
      , Str "of"
      , SoftBreak
      , Str "abstraction,"
      , Space
      , Str "as"
      , Space
      , Str "it"
      , Space
      , Str "tends"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "simpler"
      , Space
      , Str "to"
      , Space
      , Str "reason"
      , Space
      , Str "in"
      , Space
      , Str "terms"
      , Space
      , Str "of"
      , Space
      , Str "higher-level"
      , SoftBreak
      , Str "operations"
      , Space
      , Str "instead"
      , Space
      , Str "of"
      , Space
      , Str "many"
      , Space
      , Str "small"
      , Space
      , Str "pieces"
      , Space
      , Str "of"
      , Space
      , Str "code"
      , Space
      , Str "that"
      , Space
      , Str "need"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "stitched"
      , SoftBreak
      , Str "together"
      , Space
      , Str "to"
      , Space
      , Str "perform"
      , Space
      , Str "the"
      , Space
      , Str "operations."
      ]
  , Para
      [ Str "To"
      , Space
      , Str "summarize,"
      , Space
      , Str "data-only"
      , Space
      , Str "attacks"
      , Space
      , Str "are"
      , Space
      , Str "a"
      , Space
      , Str "significant"
      , Space
      , Str "concern."
      , Space
      , Str "As"
      , Space
      , Str "most"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , SoftBreak
      , Str "mitigation"
      , Space
      , Str "techniques"
      , Space
      , Str "we"
      , Space
      , Str "have"
      , Space
      , Str "seen"
      , Space
      , Str "so"
      , Space
      , Str "far"
      , Space
      , Str "are"
      , Space
      , Str "control-flow"
      , Space
      , Str "oriented,"
      , Space
      , Str "they"
      , Space
      , Str "are"
      , SoftBreak
      , Str "by"
      , Space
      , Str "design"
      , Space
      , Str "inadequate"
      , Space
      , Str "to"
      , Space
      , Str "protect"
      , Space
      , Str "against"
      , Space
      , Str "this"
      , Space
      , Str "different"
      , Space
      , Str "type"
      , Space
      , Str "of"
      , Space
      , Str "attacks."
      , Space
      , Str "In"
      , Space
      , Str "the"
      , SoftBreak
      , Str "next"
      , Space
      , Str "section,"
      , Space
      , Str "we"
      , Space
      , Str "will"
      , Space
      , Str "look"
      , Space
      , Str "at"
      , Space
      , Str "what"
      , Space
      , Str "we"
      , Space
      , Str "can"
      , Space
      , Str "do"
      , Space
      , Str "to"
      , Space
      , Str "address"
      , Space
      , Str "them"
      , Space
      , Str "at"
      , Space
      , Str "their"
      , Space
      , Str "source:"
      , SoftBreak
      , Str "memory"
      , Space
      , Str "errors."
      ]
  , Header
      2
      ( "preventing-and-detecting-memory-errors" , [] , [] )
      [ Str "Preventing"
      , Space
      , Str "and"
      , Space
      , Str "detecting"
      , Space
      , Str "memory"
      , Space
      , Str "errors"
      ]
  , Para
      [ Str "We"
      , Space
      , Str "have"
      , Space
      , Str "so"
      , Space
      , Str "far"
      , Space
      , Str "discussed"
      , Space
      , Str "how"
      , Space
      , Str "languages"
      , Space
      , Str "that"
      , Space
      , Str "are"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "not"
          , Space
          , Str "memory"
          , SoftBreak
          , Str "safe"
          ]
          ( "#a-bit-of-background-on-memory-vulnerabilities" , "" )
      , Str ","
      , Space
      , Str "like"
      , Space
      , Str "C"
      , Space
      , Str "and"
      , Space
      , Str "C++,"
      , Space
      , Str "are"
      , SoftBreak
      , Str "vulnerable"
      , Space
      , Str "to"
      , Space
      , Str "memory"
      , Space
      , Str "errors"
      , Space
      , Str "and"
      , Space
      , Str "therefore"
      , Space
      , Str "exploitation."
      , Space
      , Str "In"
      , Space
      , Str "this"
      , Space
      , Str "section,"
      , Space
      , Str "we"
      , SoftBreak
      , Str "will"
      , Space
      , Str "discuss"
      , Space
      , Str "tools"
      , Space
      , Str "that"
      , Space
      , Str "are"
      , Space
      , Str "available"
      , Space
      , Str "to"
      , Space
      , Str "C/C++"
      , Space
      , RawInline (Format "tex") "\\index{C}"
      , RawInline (Format "tex") "\\index{C++}"
      , Str "programmers"
      , SoftBreak
      , Str "to"
      , Space
      , Str "help"
      , Space
      , Str "them"
      , Space
      , Str "detect"
      , Space
      , Str "vulnerabilities"
      , Space
      , Str "that"
      , Space
      , Str "can"
      , Space
      , Str "lead"
      , Space
      , Str "to"
      , Space
      , Str "memory"
      , Space
      , Str "errors."
      ]
  , Header 3 ( "sanitizers" , [] , [] ) [ Str "Sanitizers" ]
  , Para
      [ Str "Sanitizers"
      , Space
      , RawInline (Format "tex") "\\index{sanitizers}"
      , Space
      , Str "are"
      , Space
      , Str "tools"
      , Space
      , Str "that"
      , Space
      , Str "detect"
      , Space
      , Str "bugs"
      , Space
      , Str "during"
      , Space
      , Str "program"
      , SoftBreak
      , Str "execution."
      , Space
      , Str "Sanitizers"
      , Space
      , Str "usually"
      , Space
      , Str "have"
      , Space
      , Str "two"
      , Space
      , Str "components:"
      , Space
      , Str "a"
      , Space
      , Str "compiler"
      , Space
      , Str "instrumentation"
      , SoftBreak
      , Str "part"
      , Space
      , Str "that"
      , Space
      , Str "introduces"
      , Space
      , Str "the"
      , Space
      , Str "new"
      , Space
      , Str "checks,"
      , Space
      , Str "and"
      , Space
      , Str "a"
      , Space
      , Str "runtime"
      , Space
      , Str "library"
      , Space
      , Str "part."
      , Space
      , Str "They"
      , Space
      , Str "are"
      , Space
      , Str "often"
      , SoftBreak
      , Str "too"
      , Space
      , Str "expensive"
      , Space
      , Str "to"
      , Space
      , Str "run"
      , Space
      , Str "in"
      , Space
      , Str "production"
      , Space
      , Str "mode,"
      , Space
      , Str "as"
      , Space
      , Str "they"
      , Space
      , Str "tend"
      , Space
      , Str "to"
      , Space
      , Str "increase"
      , Space
      , Str "execution"
      , SoftBreak
      , Str "time"
      , Space
      , Str "and"
      , Space
      , Str "memory"
      , Space
      , Str "usage."
      , Space
      , Str "They"
      , Space
      , Str "are"
      , Space
      , Str "commonly"
      , Space
      , Str "used"
      , Space
      , Str "during"
      , Space
      , Str "testing"
      , Space
      , Str "of"
      , Space
      , Str "an"
      , Space
      , Str "application,"
      , SoftBreak
      , Str "frequently"
      , Space
      , Str "in"
      , Space
      , Str "combination"
      , Space
      , Str "with"
      , Space
      , Str "fuzzers"
      , RawInline (Format "tex") "\\index{fuzzing}"
      , Note
          [ Para
              [ Link
                  ( "" , [] , [] )
                  [ Str "Fuzzing" ]
                  ( "https://en.wikipedia.org/wiki/Fuzzing" , "" )
              , Space
              , RawInline (Format "tex") "\\index{fuzzing}"
              , Space
              , Str "is"
              , SoftBreak
              , Str "a"
              , Space
              , Str "powerful"
              , Space
              , Str "testing"
              , Space
              , Str "technique"
              , Space
              , Str "that"
              , Space
              , Str "relies"
              , Space
              , Str "on"
              , Space
              , Str "automatically"
              , Space
              , Str "generating"
              , Space
              , Str "large"
              , SoftBreak
              , Str "amounts"
              , Space
              , Str "of"
              , Space
              , Str "random"
              , Space
              , Str "inputs"
              , Space
              , Str "to"
              , Space
              , Str "the"
              , Space
              , Str "program"
              , Space
              , Str "under"
              , Space
              , Str "test."
              ]
          ]
      , Str "."
      ]
  , Para
      [ Str "A"
      , Space
      , Str "very"
      , Space
      , Str "popular"
      , Space
      , Str "sanitizer"
      , Space
      , Str "is"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "Address" , SoftBreak , Str "Sanitizer" ]
          ( "https://clang.llvm.org/docs/AddressSanitizer.html" , "" )
      , SoftBreak
      , Str "(ASan)"
      , RawInline
          (Format "tex") "\\index{AddressSanitizer (ASan)}"
      , Str "."
      , Space
      , Str "It"
      , Space
      , Str "aims"
      , Space
      , Str "to"
      , Space
      , Str "detect"
      , Space
      , Str "various"
      , Space
      , Str "memory"
      , Space
      , Str "errors."
      , SoftBreak
      , Str "These"
      , Space
      , Str "include"
      , Space
      , Str "out-of-bounds"
      , Space
      , Str "accesses,"
      , Space
      , Str "use-after-free,"
      , Space
      , Str "double-free"
      , Space
      , Str "and"
      , Space
      , Str "invalid"
      , SoftBreak
      , Str "free"
      , Note
          [ Para
              [ Str "ASan"
              , Space
              , Str "also"
              , Space
              , Str "includes"
              , Space
              , Str "a"
              , Space
              , Link
                  ( "" , [] , [] )
                  [ Str "memory"
                  , Space
                  , Str "leak"
                  , SoftBreak
                  , Str "detector"
                  ]
                  ( "https://clang.llvm.org/docs/LeakSanitizer.html"
                  , ""
                  )
              , SoftBreak
              , RawInline (Format "tex") "\\index{LeakSanitizer}"
              , Str "."
              ]
          ]
      , Str "."
      , Space
      , Str "There"
      , Space
      , Str "are"
      , Space
      , Str "Address"
      , Space
      , Str "Sanitizer"
      , Space
      , Str "implementations"
      , Space
      , Str "for"
      , Space
      , Str "both"
      , Space
      , Str "GCC"
      , SoftBreak
      , RawInline (Format "tex") "\\index{GCC}"
      , Space
      , Str "and"
      , Space
      , Str "Clang"
      , RawInline (Format "tex") "\\index{Clang}"
      , Str ","
      , Space
      , Str "but"
      , Space
      , Str "we"
      , Space
      , Str "will"
      , Space
      , Str "focus"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "Clang"
      , SoftBreak
      , Str "implementation"
      , Space
      , Str "here."
      ]
  , Para
      [ Str "ASan"
      , Space
      , Str "uses"
      , Space
      , Str "shadow"
      , Space
      , Str "memory"
      , RawInline (Format "tex") "\\index{shadow memory}"
      , Space
      , Str "to"
      , Space
      , Str "keep"
      , Space
      , Str "track"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "state"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , SoftBreak
      , Str "application\8217s"
      , Space
      , Str "memory."
      , Space
      , Str "Each"
      , Space
      , Str "byte"
      , Space
      , Str "of"
      , Space
      , Str "shadow"
      , Space
      , Str "memory"
      , Space
      , Str "records"
      , Space
      , Str "information"
      , Space
      , Str "on"
      , Space
      , Str "8"
      , SoftBreak
      , Str "bytes"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "application\8217s"
      , Space
      , Str "memory."
      , Space
      , Str "It"
      , Space
      , Str "represents"
      , Space
      , Str "how"
      , Space
      , Str "many"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "8"
      , Space
      , Str "bytes"
      , Space
      , Str "are"
      , SoftBreak
      , Str "addressable."
      , Space
      , Str "When"
      , Space
      , Str "none"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "bytes"
      , Space
      , Str "are"
      , Space
      , Str "addressable,"
      , Space
      , Str "it"
      , Space
      , Str "encodes"
      , Space
      , Str "additional"
      , SoftBreak
      , Str "details"
      , Space
      , Str "(whether"
      , Space
      , Str "the"
      , Space
      , Str "8"
      , Space
      , Str "bytes"
      , Space
      , Str "are"
      , Space
      , Str "out-of-bounds"
      , Space
      , Str "stack,"
      , Space
      , Str "out-of-bounds"
      , Space
      , Str "heap,"
      , SoftBreak
      , Str "freed"
      , Space
      , Str "memory,"
      , Space
      , Str "and"
      , Space
      , Str "so"
      , Space
      , Str "on)."
      , Space
      , Str "Requiring"
      , Space
      , Str "one"
      , Space
      , Str "byte"
      , Space
      , Str "of"
      , Space
      , Str "shadow"
      , Space
      , Str "memory"
      , Space
      , Str "for"
      , Space
      , Str "every"
      , Space
      , Str "8"
      , SoftBreak
      , Str "bytes"
      , Space
      , Str "of"
      , Space
      , Str "application"
      , Space
      , Str "memory"
      , Space
      , Str "means"
      , Space
      , Str "that"
      , Space
      , Str "ASan"
      , Space
      , Str "needs"
      , Space
      , Str "to"
      , Space
      , Str "reserve"
      , Space
      , Str "one-eighth"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , SoftBreak
      , Str "application\8217s"
      , Space
      , Str "virtual"
      , Space
      , Str "address"
      , Space
      , Str "space"
      , Space
      , Cite
          [ Citation
              { citationId = "Serebryany2012"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 53
              , citationHash = 0
              }
          ]
          [ Str "[@Serebryany2012]" ]
      , Str "."
      , Space
      , Str "Shadow"
      , Space
      , Str "memory"
      , Space
      , Str "is"
      , SoftBreak
      , Str "allocated"
      , Space
      , Str "in"
      , Space
      , Str "one"
      , Space
      , Str "contiguous"
      , Space
      , Str "chunk,"
      , Space
      , Str "which"
      , Space
      , Str "keeps"
      , Space
      , Str "mapping"
      , Space
      , Str "application"
      , Space
      , Str "memory"
      , Space
      , Str "to"
      , SoftBreak
      , Str "shadow"
      , Space
      , Str "memory"
      , Space
      , Str "simple."
      ]
  , Para
      [ Str "ASan\8217s"
      , Space
      , Str "runtime"
      , Space
      , Str "library"
      , Space
      , Str "replaces"
      , Space
      , Str "memory"
      , Space
      , Str "allocation"
      , Space
      , Str "functions"
      , Space
      , Str "like"
      , SoftBreak
      , Code ( "" , [] , [] ) "malloc"
      , RawInline (Format "tex") "\\index{malloc}"
      , Space
      , Str "and"
      , Space
      , Code ( "" , [] , [] ) "free"
      , RawInline (Format "tex") "\\index{free}"
      , Space
      , Str "with"
      , Space
      , Str "its"
      , Space
      , Str "own"
      , Space
      , Str "specialized"
      , SoftBreak
      , Str "versions."
      , Space
      , Code ( "" , [] , [] ) "malloc"
      , Space
      , Str "introduces"
      , Space
      , Str "redzones"
      , RawInline (Format "tex") "\\index{redzone}"
      , Space
      , Str "before"
      , Space
      , Str "and"
      , Space
      , Str "after"
      , Space
      , Str "each"
      , SoftBreak
      , Str "allocation,"
      , Space
      , Str "which"
      , Space
      , Str "are"
      , Space
      , Str "marked"
      , Space
      , Str "as"
      , Space
      , Str "unaddressable."
      , Space
      , Code ( "" , [] , [] ) "free"
      , Space
      , Str "marks"
      , Space
      , Str "the"
      , Space
      , Str "entire"
      , SoftBreak
      , Str "allocation"
      , Space
      , Str "as"
      , Space
      , Str "unaddressable"
      , Space
      , Str "and"
      , Space
      , Str "places"
      , Space
      , Str "it"
      , Space
      , Str "in"
      , Space
      , Str "quarantine,"
      , Space
      , Str "so"
      , Space
      , Str "that"
      , Space
      , Str "it"
      , Space
      , Str "doesn\8217t"
      , Space
      , Str "get"
      , SoftBreak
      , Str "reallocated"
      , Space
      , Str "for"
      , Space
      , Str "a"
      , Space
      , Str "while"
      , Space
      , Str "(in"
      , Space
      , Str "a"
      , Space
      , Str "FIFO"
      , Space
      , Str "basis)."
      , Space
      , Str "This"
      , Space
      , Str "allows"
      , Space
      , Str "for"
      , Space
      , Str "detecting"
      , SoftBreak
      , Str "use-after-free."
      , Space
      , Str "The"
      , Space
      , Str "runtime"
      , Space
      , Str "library"
      , Space
      , Str "also"
      , Space
      , Str "handles"
      , Space
      , Str "management"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "shadow"
      , SoftBreak
      , Str "memory."
      ]
  , Para
      [ Str "ASan\8217s"
      , Space
      , Str "code"
      , Space
      , Str "instrumentation"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "compiler"
      , Space
      , Str "introduces"
      , Space
      , Str "redzones"
      , Space
      , Str "around"
      , Space
      , Str "each"
      , SoftBreak
      , Str "stack"
      , Space
      , Str "array"
      , Space
      , Str "allocation,"
      , Space
      , Str "and"
      , Space
      , Str "around"
      , Space
      , Str "globals."
      , Space
      , Str "It"
      , Space
      , Str "then"
      , Space
      , Str "instruments"
      , Space
      , Str "loads"
      , Space
      , Str "and"
      , SoftBreak
      , Str "stores"
      , Space
      , Str "to"
      , Space
      , Str "check"
      , Space
      , Str "whether"
      , Space
      , Str "the"
      , Space
      , Str "accessed"
      , Space
      , Str "memory"
      , Space
      , Str "is"
      , Space
      , Str "addressable,"
      , Space
      , Str "based"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , SoftBreak
      , Str "information"
      , Space
      , Str "stored"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "shadow"
      , Space
      , Str "memory,"
      , Space
      , Str "and"
      , Space
      , Str "reports"
      , Space
      , Str "an"
      , Space
      , Str "error"
      , Space
      , Str "if"
      , Space
      , Str "unaddressable"
      , SoftBreak
      , Str "memory"
      , Space
      , Str "is"
      , Space
      , Str "accessed."
      ]
  , Para
      [ Str "ASan"
      , Space
      , Str "doesn\8217t"
      , Space
      , Str "produce"
      , Space
      , Str "false"
      , Space
      , Str "positives"
      , Space
      , Str "and"
      , Space
      , Str "is"
      , Space
      , Str "easy"
      , Space
      , Str "to"
      , Space
      , Str "use."
      , Space
      , Str "It"
      , Space
      , Str "requires"
      , Space
      , Str "compiling"
      , SoftBreak
      , Str "and"
      , Space
      , Str "linking"
      , Space
      , Str "a"
      , Space
      , Str "program"
      , Space
      , Str "with"
      , Space
      , Str "the"
      , Space
      , Code ( "" , [] , [] ) "-fsanitize=address"
      , Space
      , Str "option."
      , Space
      , Str "It"
      , Space
      , Str "is"
      , Space
      , Str "used"
      , Space
      , Str "in"
      , SoftBreak
      , Str "practice"
      , Space
      , Str "for"
      , Space
      , Str "testing"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "large" , SoftBreak , Str "projects" ]
          ( "https://chromium.googlesource.com/chromium/src/+/HEAD/docs/asan.md"
          , ""
          )
      , Str "."
      , SoftBreak
      , Str "There"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "similar"
      , Space
      , Str "tool"
      , Space
      , Str "for"
      , Space
      , Str "dynamic"
      , Space
      , Str "memory"
      , Space
      , Str "error"
      , Space
      , Str "detection"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "Linux"
      , Space
      , Str "kernel,"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "KASAN" ]
          ( "https://www.kernel.org/doc/html/v5.0/dev-tools/kasan.html"
          , ""
          )
      , RawInline (Format "tex") "\\index{KASAN}"
      , Str "."
      ]
  , Para
      [ Str "ASan\8217s"
      , Space
      , Str "biggest"
      , Space
      , Str "drawback"
      , Space
      , Str "is"
      , Space
      , Str "its"
      , Space
      , Str "high"
      , Space
      , Str "runtime"
      , Space
      , Str "overhead"
      , Space
      , Str "and"
      , Space
      , Str "memory"
      , Space
      , Str "usage,"
      , Space
      , Str "due"
      , Space
      , Str "to"
      , SoftBreak
      , Str "the"
      , Space
      , Str "quarantine,"
      , Space
      , Str "redzones"
      , Space
      , Str "and"
      , Space
      , Str "shadow"
      , Space
      , Str "memory."
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "Hardware-assisted"
          , Space
          , Str "AddressSanitizer"
          , SoftBreak
          , Str "(HWASAN)"
          ]
          ( "https://clang.llvm.org/docs/HardwareAssistedAddressSanitizerDesign.html"
          , ""
          )
      , SoftBreak
      , RawInline (Format "tex") "\\index{HWASAN}"
      , Space
      , Str "works"
      , Space
      , Str "similarly"
      , Space
      , Str "to"
      , Space
      , Str "ASan,"
      , Space
      , Str "but"
      , Space
      , Str "with"
      , Space
      , Str "partial"
      , Space
      , Str "hardware"
      , Space
      , Str "assistance"
      , SoftBreak
      , Str "can"
      , Space
      , Str "result"
      , Space
      , Str "in"
      , Space
      , Str "lower"
      , Space
      , Str "memory"
      , Space
      , Str "overheads,"
      , Space
      , Str "at"
      , Space
      , Str "the"
      , Space
      , Str "cost"
      , Space
      , Str "of"
      , Space
      , Str "being"
      , Space
      , Str "less"
      , Space
      , Str "portable."
      ]
  , Para
      [ Str "On"
      , Space
      , Str "AArch64"
      , RawInline (Format "tex") "\\index{AArch64}"
      , Str ","
      , Space
      , Str "HWASAN"
      , Space
      , Str "uses"
      , Space
      , Str "Top-Byte"
      , Space
      , Str "Ignore"
      , Space
      , Str "(TBI)"
      , RawInline (Format "tex") "\\index{Top-Byte\nIgnore (TBI)}"
      , Str "."
      , Space
      , Str "When"
      , Space
      , Str "TBI"
      , Space
      , Str "is"
      , Space
      , Str "enabled,"
      , Space
      , Str "the"
      , Space
      , Str "top"
      , Space
      , Str "byte"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "pointer"
      , Space
      , Str "is"
      , Space
      , Str "ignored"
      , Space
      , Str "when"
      , SoftBreak
      , Str "performing"
      , Space
      , Str "a"
      , Space
      , Str "memory"
      , Space
      , Str "access,"
      , Space
      , Str "allowing"
      , Space
      , Str "software"
      , Space
      , Str "to"
      , Space
      , Str "use"
      , Space
      , Str "that"
      , Space
      , Str "top"
      , Space
      , Str "byte"
      , Space
      , Str "to"
      , Space
      , Str "store"
      , SoftBreak
      , Str "metadata,"
      , Space
      , Str "without"
      , Space
      , Str "affecting"
      , Space
      , Str "execution."
      , Space
      , Str "Each"
      , Space
      , Str "allocation"
      , Space
      , Str "is"
      , Space
      , Str "aligned"
      , Space
      , Str "to"
      , Space
      , Str "16"
      , Space
      , Str "bytes"
      , SoftBreak
      , Str "and"
      , Space
      , Str "each"
      , Space
      , Str "16-byte"
      , Space
      , Str "chunk"
      , Space
      , Str "of"
      , Space
      , Str "memory"
      , Space
      , Str "(called"
      , Space
      , Quoted DoubleQuote [ Str "granule" ]
      , Str ")"
      , Space
      , Str "is"
      , Space
      , Str "randomly"
      , Space
      , Str "assigned"
      , Space
      , Str "an"
      , SoftBreak
      , Str "8-bit"
      , Space
      , Str "tag."
      , Space
      , Str "The"
      , Space
      , Str "tag"
      , Space
      , Str "is"
      , Space
      , Str "stored"
      , Space
      , Str "in"
      , Space
      , Str "shadow"
      , Space
      , Str "memory"
      , Space
      , Str "and"
      , Space
      , Str "is"
      , Space
      , Str "also"
      , Space
      , Str "placed"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "top"
      , SoftBreak
      , Str "byte"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "pointer"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "object."
      , Space
      , Str "Memory"
      , Space
      , Str "loads"
      , Space
      , Str "and"
      , Space
      , Str "stores"
      , Space
      , Str "are"
      , Space
      , Str "then"
      , SoftBreak
      , Str "instrumented"
      , Space
      , Str "to"
      , Space
      , Str "check"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "tag"
      , Space
      , Str "stored"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "pointer"
      , Space
      , Str "matches"
      , Space
      , Str "the"
      , Space
      , Str "tag"
      , Space
      , Str "stored"
      , SoftBreak
      , Str "in"
      , Space
      , Str "memory,"
      , Space
      , Str "and"
      , Space
      , Str "report"
      , Space
      , Str "an"
      , Space
      , Str "error"
      , Space
      , Str "when"
      , Space
      , Str "a"
      , Space
      , Str "mismatch"
      , Space
      , Str "happens."
      , SoftBreak
      , Span
          ( "" , [ "todo" ] , [] )
          [ Str "Add"
          , Space
          , Str "diagram"
          , Space
          , Str "to"
          , Space
          , Str "demonstrate"
          , Space
          , Str "how"
          , Space
          , Str "HWASAN"
          , Space
          , Str "works"
          , Space
          , Span ( "" , [ "issue" ] , [] ) [ Str "168" ]
          ]
      ]
  , Para
      [ Str "For"
      , Space
      , Str "granules"
      , Space
      , Str "shorter"
      , Space
      , Str "than"
      , Space
      , Str "16"
      , Space
      , Str "bytes,"
      , Space
      , Str "the"
      , Space
      , Str "value"
      , Space
      , Str "stored"
      , Space
      , Str "in"
      , Space
      , Str "shadow"
      , Space
      , Str "memory"
      , Space
      , Str "is"
      , SoftBreak
      , Str "not"
      , Space
      , Str "the"
      , Space
      , Str "actual"
      , Space
      , Str "tag,"
      , Space
      , Str "but"
      , Space
      , Str "the"
      , Space
      , Str "length"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "granule."
      , Space
      , Str "The"
      , Space
      , Str "actual"
      , Space
      , Str "tag"
      , Space
      , Str "is"
      , Space
      , Str "stored"
      , SoftBreak
      , Str "at"
      , Space
      , Str "the"
      , Space
      , Str "last"
      , Space
      , Str "byte"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "granule"
      , Space
      , Str "itself."
      , Space
      , Str "For"
      , Space
      , Str "tags"
      , Space
      , Str "in"
      , Space
      , Str "shadow"
      , Space
      , Str "memory"
      , Space
      , Str "with"
      , Space
      , Str "values"
      , SoftBreak
      , Str "between"
      , Space
      , Str "1"
      , Space
      , Str "and"
      , Space
      , Str "15,"
      , Space
      , Str "HWASAN"
      , Space
      , Str "checks"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "access"
      , Space
      , Str "is"
      , Space
      , Str "within"
      , Space
      , Str "the"
      , Space
      , Str "bounds"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , SoftBreak
      , Str "granule"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , Space
      , Str "pointer"
      , Space
      , Str "tag"
      , Space
      , Str "matches"
      , Space
      , Str "the"
      , Space
      , Str "tag"
      , Space
      , Str "stored"
      , Space
      , Str "at"
      , Space
      , Str "the"
      , Space
      , Str "last"
      , Space
      , Str "byte"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , SoftBreak
      , Str "granule."
      ]
  , Para
      [ Str "HWASAN"
      , Space
      , Str "is"
      , Space
      , Str "also"
      , Space
      , Str "easy"
      , Space
      , Str "to"
      , Space
      , Str "use,"
      , Space
      , Str "and"
      , Space
      , Str "simply"
      , Space
      , Str "requires"
      , Space
      , Str "compiling"
      , Space
      , Str "and"
      , Space
      , Str "linking"
      , Space
      , Str "an"
      , SoftBreak
      , Str "application"
      , Space
      , Str "with"
      , Space
      , Str "the"
      , Space
      , Code ( "" , [] , [] ) "-fsanitize=hwaddress"
      , Space
      , Str "flag."
      ]
  , Para
      [ Link
          ( "" , [] , [] )
          [ Str "MemTagSanitizer" ]
          ( "https://llvm.org/docs/MemTagSanitizer.html" , "" )
      , RawInline (Format "tex") "\\index{MemTagSanitizer}"
      , SoftBreak
      , Str "goes"
      , Space
      , Str "one"
      , Space
      , Str "step"
      , Space
      , Str "further"
      , Space
      , Str "and"
      , Space
      , Str "uses"
      , Space
      , Str "the"
      , Space
      , Str "Armv8.5-A"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "Memory"
          , Space
          , Str "Tagging"
          , Space
          , Str "Extension"
          , SoftBreak
          , Str "(MTE)"
          ]
          ( "https://developer.arm.com/documentation/102925/0100"
          , ""
          )
      , RawInline
          (Format "tex") "\\index{Memory\nTagging Extension (MTE)}"
      , Str "."
      , Space
      , Str "With"
      , Space
      , Str "MTE,"
      , Space
      , Str "the"
      , Space
      , Str "tag"
      , Space
      , Str "checking"
      , Space
      , Str "is"
      , Space
      , Str "done"
      , Space
      , Str "automatically"
      , Space
      , Str "by"
      , SoftBreak
      , Str "hardware,"
      , Space
      , Str "and"
      , Space
      , Str "an"
      , Space
      , Str "exception"
      , Space
      , Str "is"
      , Space
      , Str "raised"
      , Space
      , Str "on"
      , Space
      , Str "mismatch."
      , Space
      , Str "MTE\8217s"
      , Space
      , Str "granule"
      , Space
      , Str "size"
      , Space
      , Str "is"
      , Space
      , Str "16"
      , SoftBreak
      , Str "bits,"
      , Space
      , Str "whereas"
      , Space
      , Str "tags"
      , Space
      , Str "are"
      , Space
      , Str "4-bit."
      , SoftBreak
      , Span
          ( "" , [ "todo" ] , [] )
          [ Str "Consider"
          , Space
          , Str "adding"
          , Space
          , Str "a"
          , Space
          , Str "whole"
          , Space
          , Str "section"
          , Space
          , Str "on"
          , Space
          , Str "MTE"
          , Space
          , Str "and"
          , Space
          , Str "its"
          , Space
          , Str "applications"
          , Space
          , Span ( "" , [ "issue" ] , [] ) [ Str "169" ]
          ]
      ]
  , Para
      [ Link
          ( "" , [] , [] )
          [ Str "UndefinedBehaviorSanitizer"
          , SoftBreak
          , Str "(UBSan)"
          ]
          ( "https://clang.llvm.org/docs/UndefinedBehaviorSanitizer.html#ubsan-checks"
          , ""
          )
      , SoftBreak
      , RawInline (Format "tex") "\\index{UBSan}"
      , Str "detects"
      , Space
      , Str "undefined"
      , Space
      , Str "behavior"
      , Space
      , Str "during"
      , Space
      , Str "program"
      , Space
      , Str "execution,"
      , Space
      , Str "for"
      , Space
      , Str "example"
      , SoftBreak
      , Str "array"
      , Space
      , Str "out-of-bounds"
      , Space
      , Str "accesses"
      , Space
      , Str "for"
      , Space
      , Str "statically"
      , Space
      , Str "determined"
      , Space
      , Str "array"
      , Space
      , Str "bounds,"
      , Space
      , Str "null"
      , SoftBreak
      , Str "pointer"
      , Space
      , Str "dereference,"
      , Space
      , Str "signed"
      , Space
      , Str "integer"
      , Space
      , Str "overflow"
      , Space
      , Str "and"
      , Space
      , Str "various"
      , Space
      , Str "kinds"
      , Space
      , Str "of"
      , Space
      , Str "integer"
      , SoftBreak
      , Str "conversions"
      , Space
      , Str "that"
      , Space
      , Str "result"
      , Space
      , Str "in"
      , Space
      , Str "data"
      , Space
      , Str "loss."
      , Space
      , Str "Although"
      , Space
      , Str "some"
      , Space
      , Str "of"
      , Space
      , Str "these"
      , Space
      , Str "checks"
      , Space
      , Str "are"
      , Space
      , Str "not"
      , SoftBreak
      , Str "directly"
      , Space
      , Str "related"
      , Space
      , Str "to"
      , Space
      , Str "memory"
      , Space
      , Str "errors,"
      , Space
      , Str "these"
      , Space
      , Str "kinds"
      , Space
      , Str "of"
      , Space
      , Str "errors"
      , Space
      , Str "can"
      , Space
      , Str "lead"
      , Space
      , Str "to"
      , Space
      , Str "incorrect"
      , SoftBreak
      , Str "pointer"
      , Space
      , Str "arithmetic,"
      , Space
      , Str "incorrect"
      , Space
      , Str "allocation"
      , Space
      , Str "sizes,"
      , Space
      , Str "and"
      , Space
      , Str "other"
      , Space
      , Str "issues"
      , Space
      , Str "that"
      , Space
      , Str "lead"
      , Space
      , Str "to"
      , SoftBreak
      , Str "memory"
      , Space
      , Str "errors,"
      , Space
      , Str "so"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , Space
      , Str "important"
      , Space
      , Str "to"
      , Space
      , Str "detect"
      , Space
      , Str "them"
      , Space
      , Str "and"
      , Space
      , Str "address"
      , Space
      , Str "them."
      ]
  , Para
      [ Str "UBSan\8217s"
      , Space
      , Str "documentation"
      , Space
      , Str "describes"
      , Space
      , Str "the"
      , Space
      , Str "full"
      , Space
      , Str "list"
      , Space
      , Str "of"
      , Space
      , Str "available"
      , Space
      , Str "checks."
      , Space
      , Str "The"
      , Space
      , Str "majority"
      , SoftBreak
      , Str "of"
      , Space
      , Str "these"
      , Space
      , Str "checks"
      , Space
      , Str "are"
      , Space
      , Str "enabled"
      , Space
      , Str "with"
      , Space
      , Str "the"
      , Space
      , Code ( "" , [] , [] ) "-fsanitize=undefined"
      , Space
      , Str "flag,"
      , Space
      , Str "but"
      , SoftBreak
      , Str "there"
      , Space
      , Str "are"
      , Space
      , Str "also"
      , Space
      , Str "other"
      , Space
      , Str "useful"
      , Space
      , Str "groupings"
      , Space
      , Str "of"
      , Space
      , Str "checks,"
      , Space
      , Str "for"
      , Space
      , Str "example"
      , Space
      , Code ( "" , [] , [] ) "-fsanitize=integer"
      , SoftBreak
      , Str "for"
      , Space
      , Str "checks"
      , Space
      , Str "related"
      , Space
      , Str "to"
      , Space
      , Str "integer"
      , Space
      , Str "conversions"
      , Space
      , Str "and"
      , Space
      , Str "arithmetic."
      ]
  , Para
      [ Str "There"
      , Space
      , Str "are"
      , Space
      , Str "many"
      , Space
      , Str "other"
      , Space
      , Str "sanitizers,"
      , Space
      , Str "more"
      , Space
      , Str "than"
      , Space
      , Str "can"
      , Space
      , Str "reasonably"
      , Space
      , Str "be"
      , Space
      , Str "covered"
      , Space
      , Str "in"
      , Space
      , Str "this"
      , SoftBreak
      , Str "section."
      , Space
      , Str "For"
      , Space
      , Str "the"
      , Space
      , Str "interested"
      , Space
      , Str "reader,"
      , Space
      , Str "we"
      , Space
      , Str "list"
      , Space
      , Str "a"
      , Space
      , Str "few"
      , Space
      , Str "more:"
      ]
  , BulletList
      [ [ Plain
            [ Link
                ( "" , [] , [] )
                [ Str "MemorySanitizer" ]
                ( "https://clang.llvm.org/docs/MemorySanitizer.html"
                , ""
                )
            , RawInline (Format "tex") "\\index{MemorySanitizer}"
            , Str ":"
            , SoftBreak
            , Str "detects"
            , Space
            , Str "uninitialized"
            , Space
            , Str "reads."
            ]
        ]
      , [ Plain
            [ Link
                ( "" , [] , [] )
                [ Str "ThreadSanitizer" ]
                ( "https://clang.llvm.org/docs/ThreadSanitizer.html"
                , ""
                )
            , RawInline (Format "tex") "\\index{ThreadSanitizer}"
            , Str ":"
            , SoftBreak
            , Str "detects"
            , Space
            , Str "data"
            , Space
            , Str "races."
            ]
        ]
      , [ Plain
            [ Link
                ( "" , [] , [] )
                [ Str "GWP-ASan" ]
                ( "https://llvm.org/docs/GwpAsan.html" , "" )
            , RawInline (Format "tex") "\\index{GWP-ASan}"
            , Str ":"
            , Space
            , Str "detects"
            , SoftBreak
            , Str "use-after-free"
            , Space
            , Str "and"
            , Space
            , Str "heap"
            , Space
            , Str "buffer"
            , Space
            , Str "overflows,"
            , Space
            , Str "with"
            , Space
            , Str "low"
            , Space
            , Str "overhead"
            , Space
            , Str "that"
            , Space
            , Str "makes"
            , Space
            , Str "it"
            , SoftBreak
            , Str "suitable"
            , Space
            , Str "for"
            , Space
            , Str "production"
            , Space
            , Str "environments."
            , Space
            , Str "It"
            , Space
            , Str "performs"
            , Space
            , Str "checks"
            , Space
            , Str "only"
            , Space
            , Str "on"
            , Space
            , Str "a"
            , Space
            , Str "sample"
            , Space
            , Str "of"
            , SoftBreak
            , Str "allocations."
            ]
        ]
      ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "Describe"
          , Space
          , Str "other"
          , Space
          , Str "mechanisms"
          , Space
          , Str "for"
          , Space
          , Str "detecting"
          , Space
          , Str "memory"
          , Space
          , Str "errors,"
          , Space
          , Str "both"
          , SoftBreak
          , Str "software-based"
          , Space
          , Str "(static"
          , Space
          , Str "analysis,"
          , Space
          , Str "library"
          , Space
          , Str "and"
          , Space
          , Str "buffer"
          , Space
          , Str "hardening)"
          , Space
          , Str "and"
          , SoftBreak
          , Str "hardware-based,"
          , Space
          , Str "e.g.\160PAuth-based"
          , Space
          , Str "pointer"
          , Space
          , Str "integrity"
          , Space
          , Str "schemes,"
          , Space
          , Str "MTE"
          , Space
          , Str "etc"
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "170" ]
          ]
      ]
  , Header
      3
      ( "bounds-checking" , [] , [] )
      [ Str "Bounds" , Space , Str "checking" ]
  , Para
      [ Str "Making"
      , Space
      , Str "sure"
      , Space
      , Str "that"
      , Space
      , Str "memory"
      , Space
      , Str "accesses"
      , Space
      , Str "happen"
      , Space
      , Str "within"
      , Space
      , Str "the"
      , Space
      , Str "bounds"
      , Space
      , Str "of"
      , Space
      , Str "each"
      , Space
      , Str "object\8217s"
      , SoftBreak
      , Str "allocation"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "very"
      , Space
      , Str "important"
      , Space
      , Str "part"
      , Space
      , Str "of"
      , Space
      , Str "memory"
      , Space
      , Str "safety."
      , Space
      , Str "This"
      , Space
      , Str "is"
      , Space
      , Str "usually"
      , Space
      , Str "described"
      , SoftBreak
      , Str "with"
      , Space
      , Str "the"
      , Space
      , Str "term"
      , Space
      , Quoted
          DoubleQuote
          [ Str "spatial"
          , Space
          , Str "memory"
          , Space
          , Str "safety"
          ]
      , RawInline (Format "tex") "\\index{spatial memory safety}"
      , Str "."
      , SoftBreak
      , Str "Out-of-bounds"
      , Space
      , Str "accesses"
      , Space
      , Str "result"
      , Space
      , Str "in"
      , Space
      , Str "restricted"
      , Space
      , Str "read/write"
      , Space
      , Str "primitives"
      , RawInline (Format "tex") "\\index{read\nprimitive}"
      , RawInline (Format "tex") "\\index{write primitive}"
      , Note
          [ Para
              [ Str "These"
              , Space
              , Str "primitives"
              , Space
              , Str "are"
              , Space
              , Str "restricted"
              , Space
              , Str "since"
              , Space
              , Str "they"
              , Space
              , Str "can"
              , Space
              , Str "only"
              , Space
              , Str "access"
              , Space
              , Str "a"
              , SoftBreak
              , Str "limited"
              , Space
              , Str "number"
              , Space
              , Str "of"
              , Space
              , Str "bytes"
              , Space
              , Str "past"
              , Space
              , Str "the"
              , Space
              , Str "end"
              , Space
              , Str "of"
              , Space
              , Str "the"
              , Space
              , Str "allocation."
              ]
          ]
      , Str "."
      , Space
      , Str "An"
      , Space
      , Str "attacker"
      , Space
      , Str "can"
      , Space
      , Str "often"
      , Space
      , Str "easily"
      , SoftBreak
      , Str "convert"
      , Space
      , Str "these"
      , Space
      , Str "into"
      , Space
      , Str "arbitrary"
      , Space
      , Str "read/write"
      , Space
      , Str "primitives."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "this"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , SoftBreak
      , Str "achieved"
      , Space
      , Str "by"
      , Space
      , Str "overwriting"
      , Space
      , Str "pointer"
      , Space
      , Str "fields"
      , Space
      , Str "in"
      , Space
      , Str "allocations"
      , Space
      , Str "following"
      , Space
      , Str "the"
      , Space
      , Str "object"
      , Space
      , Str "that"
      , SoftBreak
      , Str "was"
      , Space
      , Str "the"
      , Space
      , Str "target"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "problematic"
      , Space
      , Str "memory"
      , Space
      , Str "access."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "C"
      , Space
      , Str "and"
      , Space
      , Str "C++"
      , Space
      , Str "memory"
      , Space
      , Str "languages"
      , Space
      , Str "do"
      , Space
      , Str "not,"
      , Space
      , Str "as"
      , Space
      , Str "a"
      , Space
      , Str "general"
      , Space
      , Str "rule,"
      , Space
      , Str "perform"
      , Space
      , Str "bounds"
      , SoftBreak
      , Str "checking"
      , Note
          [ Para
              [ Str "Some"
              , Space
              , Str "C++"
              , Space
              , Str "containers"
              , Space
              , Str "have"
              , Space
              , Str "accessors"
              , Space
              , Str "that"
              , Space
              , Str "do"
              , Space
              , Str "perform"
              , Space
              , Str "bounds"
              , SoftBreak
              , Str "checking,"
              , Space
              , Str "for"
              , Space
              , Str "example"
              , Space
              , Code ( "" , [] , [] ) "std::array::at()"
              , Space
              , Str "and"
              , Space
              , Code ( "" , [] , [] ) "std::vector::at()"
              , Str "."
              ]
          ]
      , Str "."
      , Space
      , Str "This"
      , Space
      , Str "is"
      , Space
      , Str "one"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "sources"
      , Space
      , Str "of"
      , Space
      , Str "memory"
      , Space
      , Str "errors"
      , Space
      , Str "in"
      , Space
      , Str "C/C++"
      , SoftBreak
      , Str "programs."
      , Space
      , Str "However,"
      , Space
      , Str "compilers"
      , Space
      , Str "have"
      , Space
      , Str "a"
      , Space
      , Str "history"
      , Space
      , Str "of"
      , Space
      , Str "introducing"
      , Space
      , Str "bounds"
      , Space
      , Str "checks,"
      , Space
      , Str "even"
      , SoftBreak
      , Str "though"
      , Space
      , Str "the"
      , Space
      , Str "language"
      , Space
      , Str "does"
      , Space
      , Str "not"
      , Space
      , Str "require"
      , Space
      , Str "them,"
      , Space
      , Str "in"
      , Space
      , Str "an"
      , Space
      , Str "effort"
      , Space
      , Str "to"
      , Space
      , Str "improve"
      , Space
      , Str "security"
      , Space
      , Str "of"
      , SoftBreak
      , Str "existing"
      , Space
      , Str "C/C++"
      , Space
      , Str "codebases."
      ]
  , Para
      [ Str "One"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "simplest"
      , Space
      , Str "compiler"
      , Space
      , Str "options"
      , Space
      , Str "is"
      , Space
      , Code ( "" , [] , [] ) "-Warray-bounds"
      , Str ","
      , Space
      , Str "which"
      , Space
      , Str "warns"
      , Space
      , Str "when"
      , Space
      , Str "an"
      , SoftBreak
      , Str "array"
      , Space
      , Str "access"
      , Space
      , Str "is"
      , Space
      , Str "always"
      , Space
      , Str "out"
      , Space
      , Str "of"
      , Space
      , Str "bounds."
      , Space
      , Str "This"
      , Space
      , Str "is"
      , Space
      , Str "therefore"
      , Space
      , Str "restricted"
      , Space
      , Str "to"
      , Space
      , Str "arrays"
      , SoftBreak
      , Str "with"
      , Space
      , Str "statically"
      , Space
      , Str "known"
      , Space
      , Str "size."
      , Space
      , Str "This"
      , Space
      , Str "option"
      , Space
      , Str "is"
      , Space
      , Str "supported"
      , Space
      , Str "by"
      , Space
      , Str "both"
      , Space
      , Str "GCC"
      , Space
      , Str "and"
      , Space
      , Str "Clang."
      ]
  , Para
      [ Str "Another"
      , Space
      , Str "option"
      , Space
      , Str "supported"
      , Space
      , Str "by"
      , Space
      , Str "both"
      , Space
      , Str "compilers"
      , Space
      , Str "is"
      , Space
      , Code ( "" , [] , [] ) "-fsanitize=bounds"
      , Str ","
      , Space
      , Str "included"
      , Space
      , Str "in"
      , SoftBreak
      , Link
          ( "" , [] , [] ) [ Str "UBSan" ] ( "#sanitizers" , "" )
      , Str ","
      , Space
      , Str "which"
      , Space
      , Str "checks"
      , Space
      , Str "the"
      , Space
      , Str "bounds"
      , Space
      , Str "for"
      , Space
      , Str "accesses"
      , Space
      , Str "to"
      , Space
      , Str "statically"
      , Space
      , Str "sized"
      , SoftBreak
      , Str "arrays"
      , Space
      , Str "at"
      , Space
      , Str "runtime."
      , Space
      , Str "This"
      , Space
      , Str "handles"
      , Space
      , Str "more"
      , Space
      , Str "cases"
      , Space
      , Str "than"
      , Space
      , Code ( "" , [] , [] ) "-Warray-bounds"
      , Str ","
      , Space
      , Str "as"
      , Space
      , Str "it"
      , Space
      , Str "can"
      , SoftBreak
      , Str "also"
      , Space
      , Str "check"
      , Space
      , Str "accesses"
      , Space
      , Str "to"
      , Space
      , Str "dynamic"
      , Space
      , Str "indices."
      , Space
      , Str "However,"
      , Space
      , Str "it\8217s"
      , Space
      , Str "still"
      , Space
      , Str "limited,"
      , Space
      , Str "as"
      , Space
      , Str "it"
      , SoftBreak
      , Str "cannot"
      , Space
      , Str "perform"
      , Space
      , Str "bounds"
      , Space
      , Str "checks"
      , Space
      , Str "on"
      , Space
      , Str "dynamically"
      , Space
      , Str "sized"
      , Space
      , Str "arrays,"
      , Space
      , Str "and"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , Space
      , Str "still"
      , SoftBreak
      , Str "restricted"
      , Space
      , Str "to"
      , Space
      , Str "array"
      , Space
      , Str "bounds"
      , Space
      , Str "checking."
      , Space
      , Str "A"
      , Space
      , Str "more"
      , Space
      , Str "comprehensive"
      , Space
      , Str "solution"
      , Space
      , Str "would"
      , SoftBreak
      , Str "also"
      , Space
      , Str "cover"
      , Space
      , Str "pointers"
      , Space
      , Str "in"
      , Space
      , Str "general,"
      , Space
      , Str "especially"
      , Space
      , Str "if"
      , Space
      , Str "pointer"
      , Space
      , Str "arithmetic"
      , Space
      , Str "is"
      , SoftBreak
      , Str "performed."
      ]
  , Para
      [ Str "You"
      , Space
      , Str "may"
      , Space
      , Str "notice"
      , Space
      , Str "that"
      , Space
      , Str "there"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "bit"
      , Space
      , Str "of"
      , Space
      , Str "overlap"
      , Space
      , Str "between"
      , Space
      , Str "the"
      , Space
      , Str "bounds"
      , Space
      , Str "checks"
      , SoftBreak
      , Str "introduced"
      , Space
      , Str "by"
      , Space
      , Code ( "" , [] , [] ) "-fsanitize=bounds"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , Space
      , Str "Address"
      , Space
      , Str "Sanitizer."
      , Space
      , Str "Although"
      , Space
      , Str "the"
      , Space
      , Str "scope"
      , SoftBreak
      , Str "of"
      , Space
      , Code ( "" , [] , [] ) "-fsanitize=bounds"
      , Space
      , Str "is"
      , Space
      , Str "restricted"
      , Space
      , Str "to"
      , Space
      , Str "statically"
      , Space
      , Str "sized"
      , Space
      , Str "arrays,"
      , Space
      , Str "it\8217s"
      , SoftBreak
      , Str "interesting"
      , Space
      , Str "to"
      , Space
      , Str "note"
      , Space
      , Str "that"
      , Space
      , Str "it"
      , Space
      , Str "can"
      , Space
      , Str "still"
      , Space
      , Str "catch"
      , Space
      , Str "intra-object"
      , SoftBreak
      , Str "overflows"
      , RawInline (Format "tex") "\\index{intra-object overflow}"
      , Space
      , Str "on"
      , Space
      , Str "array"
      , Space
      , Str "member"
      , Space
      , Str "accesses"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , SoftBreak
      , Str "Address"
      , Space
      , Str "Sanitizer"
      , Space
      , Str "would"
      , Space
      , Str "not,"
      , Space
      , Str "because"
      , Space
      , Str "the"
      , Space
      , Str "access"
      , Space
      , Str "is"
      , Space
      , Str "still"
      , Space
      , Str "technically"
      , Space
      , Str "within"
      , Space
      , Str "the"
      , SoftBreak
      , Str "allocation."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "given"
      , Space
      , Str "the"
      , Space
      , Str "following"
      , Space
      , Str "code:"
      ]
  , CodeBlock
      ( "" , [] , [] )
      "struct foo {\n  int a[6];\n  int b;\n};\n\nint get(struct foo *x, int i) {\n  return x->a[i];\n}"
  , Para
      [ Str "a"
      , Space
      , Str "call"
      , Space
      , Str "to"
      , Space
      , Code ( "" , [] , [] ) "get(f, 6)"
      , Space
      , Str "will"
      , Space
      , Str "give"
      , Space
      , Str "an"
      , Space
      , Str "error"
      , Space
      , Str "with"
      , Space
      , Code ( "" , [] , [] ) "-fsanitize=bounds"
      , Str ","
      , SoftBreak
      , Str "but"
      , Space
      , Str "not"
      , Space
      , Str "with"
      , Space
      , Code ( "" , [] , [] ) "-fsanitize=address"
      , Str "."
      ]
  , Para
      [ Str "Clang"
      , Space
      , Str "and"
      , Space
      , Str "GCC"
      , Space
      , Str "also"
      , Space
      , Str "support"
      , Space
      , Str "two"
      , Space
      , Str "builtin"
      , Space
      , Str "functions"
      , Space
      , Str "that"
      , Space
      , Str "return"
      , Space
      , Str "information"
      , Space
      , Str "on"
      , SoftBreak
      , Str "the"
      , Space
      , Str "size"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "variable."
      , Space
      , Code ( "" , [] , [] ) "__builtin_object_size"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "used"
      , Space
      , Str "for"
      , Space
      , Str "objects"
      , Space
      , Str "of"
      , SoftBreak
      , Str "statically"
      , Space
      , Str "known"
      , Space
      , Str "size"
      , Space
      , Str "and"
      , Space
      , Str "always"
      , Space
      , Str "evaluates"
      , Space
      , Str "at"
      , Space
      , Str "compile"
      , Space
      , Str "time,"
      , Space
      , Str "whereas"
      , SoftBreak
      , Code ( "" , [] , [] ) "__builtin_dynamic_object_size"
      , Space
      , Str "can"
      , Space
      , Str "also"
      , Space
      , Str "propagate"
      , Space
      , Str "dynamic"
      , Space
      , Str "information"
      , Space
      , Str "from"
      , SoftBreak
      , Str "allocation"
      , Space
      , Str "functions"
      , Space
      , Str "that"
      , Space
      , Str "have"
      , Space
      , Str "been"
      , Space
      , Str "marked"
      , Space
      , Str "with"
      , Space
      , Str "the"
      , Space
      , Link
          ( "" , [] , [] )
          [ Code ( "" , [] , [] ) "alloc_size"
          , Space
          , Str "function"
          , SoftBreak
          , Str "attribute"
          ]
          ( "https://gcc.gnu.org/onlinedocs/gcc-4.7.2/gcc/Function-Attributes.html"
          , ""
          )
      , Str "."
      , SoftBreak
      , Str "These"
      , Space
      , Str "two"
      , Space
      , Str "builtins"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "then"
      , Space
      , Str "used"
      , Space
      , Str "to"
      , Space
      , Str "introduce"
      , Space
      , Str "bounds"
      , Space
      , Str "checks"
      , Space
      , Str "in"
      , Space
      , Str "user"
      , Space
      , Str "or"
      , SoftBreak
      , Str "library"
      , Space
      , Str "code."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "the"
      , Space
      , Link
          ( "" , [] , [] )
          [ Code ( "" , [] , [] ) "_FORTIFY_SOURCE"
          , SoftBreak
          , Str "macro"
          ]
          ( "https://man7.org/linux/man-pages/man7/feature_test_macros.7.html"
          , ""
          )
      , SoftBreak
      , Str "instructs"
      , Space
      , Code ( "" , [] , [] ) "glibc"
      , Space
      , Str "to"
      , Space
      , Str "introduce"
      , Space
      , Str "bounds"
      , Space
      , Str "checks"
      , Space
      , Str "in"
      , Space
      , Str "various"
      , Space
      , Str "string"
      , Space
      , Str "and"
      , Space
      , Str "memory"
      , SoftBreak
      , Str "manipulation"
      , Space
      , Str "functions,"
      , Space
      , Str "such"
      , Space
      , Str "as"
      , Space
      , Code ( "" , [] , [] ) "memcpy"
      , Str "."
      , Space
      , Str "The"
      , Space
      , Str "number"
      , Space
      , Str "of"
      , Space
      , Str "checks"
      , Space
      , Str "increases"
      , Space
      , Str "as"
      , Space
      , Str "the"
      , SoftBreak
      , Str "value"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "macro"
      , Space
      , Str "increases"
      , Space
      , Str "(the"
      , Space
      , Str "used"
      , Space
      , Str "values"
      , Space
      , Str "are"
      , Space
      , Str "currently"
      , Space
      , Str "1-3)."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , SoftBreak
      , Str "the"
      , Space
      , Str "lower"
      , Space
      , Str "two"
      , Space
      , Str "levels"
      , Space
      , Str "won\8217t"
      , Space
      , Str "use"
      , Space
      , Str "the"
      , Space
      , Code ( "" , [] , [] ) "__builtin_dynamic_object_size"
      , Space
      , Str "builtin,"
      , SoftBreak
      , Str "as"
      , Space
      , Str "it"
      , Space
      , Str "has"
      , Space
      , Str "a"
      , Space
      , Str "runtime"
      , Space
      , Str "overhead,"
      , Space
      , Str "additional"
      , Space
      , Str "to"
      , Space
      , Str "that"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "checks"
      , Space
      , Str "themselves."
      ]
  , Para
      [ Str "In"
      , Space
      , Str "order"
      , Space
      , Str "to"
      , Space
      , Str "support"
      , Space
      , Str "bounds"
      , Space
      , Str "checking"
      , Space
      , Str "for"
      , Space
      , Str "dynamically"
      , Space
      , Str "sized"
      , Space
      , Str "arrays,"
      , Space
      , Str "a"
      , Space
      , Str "recent"
      , SoftBreak
      , Str "proposal"
      , Space
      , Str "for"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "GCC" ]
          ( "https://gcc.gnu.org/bugzilla/show_bug.cgi?id=108896"
          , ""
          )
      , Space
      , Str "and"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "Clang" ]
          ( "https://reviews.llvm.org/D148381" , "" )
      , Space
      , Str "proposes"
      , Space
      , Str "the"
      , Space
      , Str "addition"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "struct"
      , SoftBreak
      , Str "member"
      , Space
      , Str "attribute,"
      , Space
      , Code ( "" , [] , [] ) "element_count"
      , Str "."
      , Space
      , Str "This"
      , Space
      , Str "attribute"
      , Space
      , Str "will"
      , Space
      , Str "apply"
      , Space
      , Str "to"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "flexible"
          , Space
          , Str "array"
          , SoftBreak
          , Str "members"
          ]
          ( "https://en.wikipedia.org/wiki/Flexible_array_member"
          , ""
          )
      , Space
      , Str "in"
      , Space
      , Str "structs,"
      , SoftBreak
      , Str "indicating"
      , Space
      , Str "another"
      , Space
      , Str "member"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "struct"
      , Space
      , Str "that"
      , Space
      , Str "expresses"
      , Space
      , Str "the"
      , Space
      , Str "array\8217s"
      , Space
      , Str "length."
      ]
  , Para
      [ Str "The"
      , Space
      , Link
          ( "" , [] , [] )
          [ Code ( "" , [] , [] ) "-fbounds-safety" ]
          ( "https://discourse.llvm.org/t/rfc-enforcing-bounds-safety-in-c-fbounds-safety/70854"
          , ""
          )
      , SoftBreak
      , Str "proposal"
      , Space
      , Str "goes"
      , Space
      , Str "a"
      , Space
      , Str "bit"
      , Space
      , Str "further,"
      , Space
      , Str "introducing"
      , Space
      , Str "a"
      , Space
      , Str "similar"
      , Space
      , Str "annotation"
      , Space
      , Str "that"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , SoftBreak
      , Str "applied"
      , Space
      , Str "to"
      , Space
      , Str "pointers"
      , Space
      , Str "more"
      , Space
      , Str "generally."
      , Space
      , Str "The"
      , Space
      , Str "proposal"
      , Space
      , Str "also"
      , Space
      , Str "aims"
      , Space
      , Str "to"
      , Space
      , Str "reduce"
      , Space
      , Str "the"
      , SoftBreak
      , Str "annotation"
      , Space
      , Str "burden"
      , Space
      , Str "placed"
      , Space
      , Str "on"
      , Space
      , Str "programmers"
      , Space
      , Str "by"
      , Space
      , Str "only"
      , Space
      , Str "requiring"
      , Space
      , Str "the"
      , Space
      , Str "annotations"
      , Space
      , Str "at"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "ABI" ]
          ( "https://en.wikipedia.org/wiki/Application_binary_interface"
          , ""
          )
      , RawInline
          (Format "tex")
          "\\index{Application\nbinary interface (ABI)}"
      , Space
      , Str "boundaries"
      , Note
          [ Para
              [ Str "This"
              , Space
              , Str "refers"
              , Space
              , Str "to"
              , Space
              , Str "the"
              , Space
              , Str "interface"
              , Space
              , Str "between"
              , Space
              , Str "different"
              , Space
              , Str "binary"
              , Space
              , Str "modules,"
              , SoftBreak
              , Str "typically"
              , Space
              , Str "a"
              , Space
              , Str "user"
              , Space
              , Str "program"
              , Space
              , Str "and"
              , Space
              , Str "a"
              , Space
              , Str "system"
              , Space
              , Str "library."
              , Space
              , Str "The"
              , Space
              , Str "ABI"
              , Space
              , Str "describes"
              , Space
              , Str "low-level"
              , SoftBreak
              , Str "details"
              , Space
              , Str "of"
              , Space
              , Str "that"
              , Space
              , Str "interface,"
              , Space
              , Str "for"
              , Space
              , Str "example"
              , Space
              , Str "the"
              , Space
              , Str "assignment"
              , Space
              , Str "of"
              , Space
              , Str "arguments"
              , Space
              , Str "and"
              , Space
              , Str "return"
              , SoftBreak
              , Str "values"
              , Space
              , Str "into"
              , Space
              , Str "registers"
              , Space
              , Str "or"
              , Space
              , Str "memory."
              , Space
              , Str "In"
              , Space
              , Str "many"
              , Space
              , Str "systems,"
              , Space
              , Str "the"
              , Space
              , Str "ABI"
              , Space
              , Str "is"
              , Space
              , Str "expected"
              , Space
              , Str "to"
              , Space
              , Str "change"
              , SoftBreak
              , Str "rarely,"
              , Space
              , Str "so"
              , Space
              , Str "programs"
              , Space
              , Str "and"
              , Space
              , Str "libraries"
              , Space
              , Str "can"
              , Space
              , Str "be"
              , Space
              , Str "updated"
              , Space
              , Str "independently"
              , Space
              , Str "and"
              , Space
              , Str "still"
              , Space
              , Str "work"
              , SoftBreak
              , Str "together."
              , Space
              , Str "This"
              , Space
              , Str "makes"
              , Space
              , Str "ABI"
              , Space
              , Str "changes"
              , Space
              , Str "undesirable,"
              , Space
              , Str "which"
              , Space
              , Str "is"
              , Space
              , Str "why"
              , Space
              , Str "this"
              , Space
              , Str "proposal"
              , Space
              , Str "aims"
              , SoftBreak
              , Str "to"
              , Space
              , Str "minimise"
              , Space
              , Str "them."
              ]
          ]
      , Str "."
      , Space
      , Str "Local"
      , Space
      , Str "variables"
      , Space
      , Str "which"
      , Space
      , Str "do"
      , SoftBreak
      , Str "not"
      , Space
      , Str "cross"
      , Space
      , Str "ABI"
      , Space
      , Str "boundaries"
      , Space
      , Str "are"
      , Space
      , Str "implicitly"
      , Space
      , Str "converted"
      , Space
      , Str "to"
      , Space
      , Str "use"
      , Space
      , Str "wide"
      , Space
      , Str "pointers."
      , Space
      , Str "These"
      , SoftBreak
      , Str "wide"
      , Space
      , Str "pointers"
      , Space
      , Str "store"
      , Space
      , Str "bounds"
      , Space
      , Str "information"
      , Space
      , Str "alongside"
      , Space
      , Str "the"
      , Space
      , Str "original"
      , Space
      , Str "pointer."
      ]
  , Para
      [ Str "There"
      , Space
      , Str "are"
      , Space
      , Str "also"
      , Space
      , Str "hardening"
      , Space
      , Str "efforts"
      , Space
      , Str "focusing"
      , Space
      , Str "on"
      , Space
      , Str "C++"
      , Space
      , Str "codebases."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "the"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Quoted DoubleQuote [ Str "safe" , Space , Str "libc++" ]
          , SoftBreak
          , Str "mode"
          ]
          ( "https://libcxx.llvm.org/UsingLibcxx.html#enabling-the-safe-libc-mode"
          , ""
          )
      , SoftBreak
      , Str "enables"
      , Space
      , Str "a"
      , Space
      , Str "number"
      , Space
      , Str "of"
      , Space
      , Str "assertions"
      , Space
      , Str "that"
      , Space
      , Str "aim"
      , Space
      , Str "to"
      , Space
      , Str "catch"
      , Space
      , Str "undefined"
      , Space
      , Str "behaviour"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , SoftBreak
      , Str "library."
      , Space
      , Str "The"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "C++"
          , Space
          , Str "Buffer"
          , Space
          , Str "Hardening"
          , SoftBreak
          , Str "proposal"
          ]
          ( "https://discourse.llvm.org/t/rfc-c-buffer-hardening/65734"
          , ""
          )
      , Space
      , Str "aims"
      , Space
      , Str "to"
      , SoftBreak
      , Str "extend"
      , Space
      , Str "this"
      , Space
      , Str "library"
      , Space
      , Str "hardening."
      , Space
      , Str "The"
      , Space
      , Str "proposal"
      , Space
      , Str "will"
      , Space
      , Str "also"
      , Space
      , Str "introduce"
      , Space
      , Str "a"
      , Space
      , Str "programming"
      , SoftBreak
      , Str "model"
      , Space
      , Str "in"
      , Space
      , Str "which"
      , Space
      , Str "all"
      , Space
      , Str "pointer"
      , Space
      , Str "arithmetic"
      , Space
      , Str "is"
      , Space
      , Str "considered"
      , Space
      , Str "unsafe."
      , Space
      , Str "Pointer"
      , Space
      , Str "arithmetic"
      , SoftBreak
      , Str "will"
      , Space
      , Str "have"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "replaced"
      , Space
      , Str "with"
      , Space
      , Str "alternatives"
      , Space
      , Str "from"
      , Space
      , Str "the"
      , Space
      , Str "C++"
      , Space
      , Str "library,"
      , Space
      , Str "for"
      , Space
      , Str "example"
      , SoftBreak
      , Code ( "" , [] , [] ) "std::array"
      , Str "."
      , Space
      , Str "The"
      , Space
      , Str "implementation"
      , Space
      , Str "of"
      , Space
      , Str "these"
      , Space
      , Str "alternatives"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "hardened"
      , Space
      , Str "library"
      , SoftBreak
      , Str "will"
      , Space
      , Str "include"
      , Space
      , Str "bounds"
      , Space
      , Str "checks."
      ]
  , Para
      [ Str "Successfully"
      , Space
      , Str "using"
      , Space
      , Str "bounds"
      , Space
      , Str "checking"
      , Space
      , Str "compiler"
      , Space
      , Str "features"
      , Space
      , Str "for"
      , Space
      , Str "a"
      , Space
      , Str "large"
      , Space
      , Str "codebase"
      , SoftBreak
      , Str "requires"
      , Space
      , Str "substantial"
      , Space
      , Str "effort."
      , Space
      , Str "An"
      , Space
      , Str "example"
      , Space
      , Str "of"
      , Space
      , Str "this"
      , Space
      , Str "is"
      , Space
      , Str "refactoring"
      , Space
      , Str "the"
      , Space
      , Str "Linux"
      , Space
      , Str "kernel"
      , SoftBreak
      , Str "to"
      , Space
      , Str "use"
      , Space
      , Str "bounds"
      , Space
      , Str "checks"
      , Space
      , Str "for"
      , Space
      , Str "flexible"
      , Space
      , Str "arrays,"
      , Space
      , Str "as"
      , Space
      , Str "described"
      , Space
      , Str "in"
      , Space
      , Cite
          [ Citation
              { citationId = "Cook2023"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 57
              , citationHash = 0
              }
          ]
          [ Str "[@Cook2023]" ]
      , Str "."
      ]
  , Para
      [ Str "There"
      , Space
      , Str "are"
      , Space
      , Str "also"
      , Space
      , Str "hardware-based"
      , Space
      , Str "mitigations"
      , Space
      , Str "for"
      , Space
      , Str "violations"
      , Space
      , Str "of"
      , Space
      , Str "spatial"
      , Space
      , Str "memory"
      , SoftBreak
      , Str "safety."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "CHERI" ]
          ( "https://www.cl.cam.ac.uk/research/security/ctsrd/cheri/"
          , ""
          )
      , Space
      , Str "introduces"
      , SoftBreak
      , Emph [ Str "capabilities" ]
      , RawInline (Format "tex") "\\index{capability}"
      , Space
      , Str "to"
      , Space
      , Str "conventional"
      , Space
      , Str "Instruction"
      , Space
      , Str "Set"
      , Space
      , Str "Architectures."
      , SoftBreak
      , Str "Capabilities"
      , Space
      , Str "combine"
      , Space
      , Str "a"
      , Space
      , Str "virtual"
      , Space
      , Str "address"
      , Space
      , Str "with"
      , Space
      , Str "metadata"
      , Space
      , Str "that"
      , Space
      , Str "describes"
      , Space
      , Str "its"
      , SoftBreak
      , Str "corresponding"
      , Space
      , Str "bounds"
      , Space
      , Str "and"
      , Space
      , Str "permissions."
      , Space
      , Str "Capabilities"
      , Space
      , Str "cannot"
      , Space
      , Str "be"
      , Space
      , Str "forged,"
      , Space
      , Str "and"
      , Space
      , Str "can"
      , SoftBreak
      , Str "thus"
      , Space
      , Str "provide"
      , Space
      , Str "very"
      , Space
      , Str "strong"
      , Space
      , Str "guarantees."
      , Space
      , Str "Arm"
      , Space
      , Str "has"
      , Space
      , Str "developed"
      , Space
      , Str "a"
      , Space
      , Str "prototype"
      , Space
      , Str "architecture"
      , SoftBreak
      , Str "that"
      , Space
      , Str "adapts"
      , Space
      , Str "CHERI,"
      , Space
      , Str "as"
      , Space
      , Str "well"
      , Space
      , Str "as"
      , Space
      , Str "a"
      , Space
      , Str "prototype"
      , Space
      , Str "SoC"
      , Space
      , Str "and"
      , Space
      , Str "development"
      , Space
      , Str "board,"
      , Space
      , Str "as"
      , Space
      , Str "part"
      , Space
      , Str "of"
      , SoftBreak
      , Str "the"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "Arm"
          , Space
          , Str "Morello"
          , Space
          , Str "Program"
          ]
          ( "https://www.arm.com/architecture/cpu/morello" , "" )
      , Str "."
      ]
  , Para
      [ Str "Of"
      , Space
      , Str "course,"
      , Space
      , Str "another"
      , Space
      , Str "approach"
      , Space
      , Str "to"
      , Space
      , Str "mitigating"
      , Space
      , Str "spatial"
      , Space
      , Str "memory"
      , Space
      , Str "safety"
      , Space
      , Str "vulnerabilities"
      , SoftBreak
      , Str "is"
      , Space
      , Str "using"
      , Space
      , Str "a"
      , Space
      , Str "language"
      , Space
      , Str "that"
      , Space
      , Str "has"
      , Space
      , Str "been"
      , Space
      , Str "designed"
      , Space
      , Str "with"
      , Space
      , Str "spatial"
      , Space
      , Str "memory"
      , Space
      , Str "safety"
      , Space
      , Str "in"
      , Space
      , Str "mind."
      , SoftBreak
      , Str "Such"
      , Space
      , Str "languages"
      , Space
      , Str "make"
      , Space
      , Str "sure"
      , Space
      , Str "that"
      , Space
      , Str "all"
      , Space
      , Str "memory"
      , Space
      , Str "accesses"
      , Space
      , Str "are"
      , Space
      , Str "checked,"
      , Space
      , Str "either"
      , Space
      , Str "at"
      , SoftBreak
      , Str "compile-time"
      , Space
      , Str "or"
      , Space
      , Str "runtime."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "the"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "Rust"
          , Space
          , Str "programming"
          , SoftBreak
          , Str "language"
          ]
          ( "https://www.rust-lang.org/" , "" )
      , Space
      , Str "introduces"
      , Space
      , Str "bounds"
      , Space
      , Str "checks"
      , Space
      , Str "whenever"
      , Space
      , Str "the"
      , SoftBreak
      , Str "compiler"
      , Space
      , Str "cannot"
      , Space
      , Str "prove"
      , Space
      , Str "that"
      , Space
      , Str "an"
      , Space
      , Str "access"
      , Space
      , Str "is"
      , Space
      , Str "within"
      , Space
      , Str "bounds"
      , Note
          [ Para
              [ Str "Rust"
              , Space
              , Str "also"
              , Space
              , Str "provides"
              , Space
              , Str "features"
              , Space
              , Str "that"
              , Space
              , Str "provide"
              , Space
              , Str "temporal"
              , Space
              , Str "memory"
              , Space
              , Str "safety"
              , SoftBreak
              , Str "and"
              , Space
              , Str "thread"
              , Space
              , Str "safety."
              ]
          ]
      , Str "."
      , Space
      , Str "There"
      , Space
      , Str "are"
      , Space
      , Str "many"
      , SoftBreak
      , Str "other"
      , Space
      , Str "memory"
      , Space
      , Str "safe"
      , Space
      , Str "languages,"
      , Space
      , Str "with"
      , Space
      , Str "different"
      , Space
      , Str "characteristics."
      , Space
      , Str "One"
      , Space
      , Str "example"
      , Space
      , Str "is"
      , SoftBreak
      , Str "JavaScript,"
      , Space
      , Str "a"
      , Space
      , Str "dynamically"
      , Space
      , Str "typed,"
      , Space
      , Str "usually"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "JIT-compiled" ]
          ( "#jit-compiler-vulnerabilities" , "" )
      , Space
      , Str "language."
      , Space
      , Str "We\8217ll"
      , Space
      , Str "discuss"
      , Space
      , Str "some"
      , Space
      , Str "of"
      , SoftBreak
      , Str "the"
      , Space
      , Str "issues"
      , Space
      , Str "that"
      , Space
      , Str "arise"
      , Space
      , Str "when"
      , Space
      , Str "implementing"
      , Space
      , Str "support"
      , Space
      , Str "for"
      , Space
      , Str "such"
      , Space
      , Str "a"
      , Space
      , Str "language"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "next"
      , SoftBreak
      , Str "section."
      ]
  , Header
      2
      ( "jit-compiler-vulnerabilities" , [] , [] )
      [ Str "JIT"
      , Space
      , Str "compiler"
      , Space
      , Str "vulnerabilities"
      ]
  , Para
      [ Str "Compiler"
      , Space
      , Str "correctness"
      , Space
      , Str "is"
      , Space
      , Str "obviously"
      , Space
      , Str "very"
      , Space
      , Str "important,"
      , Space
      , Str "as"
      , Space
      , Str "miscompilation"
      , Space
      , Str "creates"
      , SoftBreak
      , Str "buggy"
      , Space
      , Str "programs"
      , Space
      , Str "even"
      , Space
      , Str "when"
      , Space
      , Str "the"
      , Space
      , Str "source"
      , Space
      , Str "code"
      , Space
      , Str "has"
      , Space
      , Str "no"
      , Space
      , Str "bugs."
      , Space
      , Str "What"
      , Space
      , Str "might"
      , Space
      , Str "be"
      , Space
      , Str "less"
      , Space
      , Str "obvious"
      , SoftBreak
      , Str "is"
      , Space
      , Str "that"
      , Space
      , Str "these"
      , Space
      , Str "bugs"
      , Space
      , Str "can"
      , Space
      , Str "have"
      , Space
      , Str "security"
      , Space
      , Str "implications."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "they"
      , Space
      , Str "can"
      , Space
      , Str "introduce"
      , SoftBreak
      , Str "memory"
      , Space
      , Str "safety"
      , Space
      , Str "errors"
      , Space
      , Str "in"
      , Space
      , Str "languages"
      , Space
      , Str "that"
      , Space
      , Str "are"
      , Space
      , Str "otherwise"
      , Space
      , Str "memory"
      , Space
      , Str "safe."
      , Space
      , Str "In"
      , Space
      , Str "some"
      , SoftBreak
      , Str "cases,"
      , Space
      , Str "a"
      , Space
      , Str "bug"
      , Space
      , Str "might"
      , Space
      , Str "leave"
      , Space
      , Str "most"
      , Space
      , Str "programs"
      , Space
      , Str "unaffected"
      , Space
      , Str "and"
      , Space
      , Str "not"
      , Space
      , Str "cause"
      , Space
      , Str "security"
      , Space
      , Str "issues"
      , SoftBreak
      , Str "in"
      , Space
      , Str "practice"
      , Space
      , Str "before"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , Space
      , Str "detected"
      , Space
      , Str "and"
      , Space
      , Str "fixed."
      , Space
      , Str "This"
      , Space
      , Str "is,"
      , Space
      , Str "of"
      , Space
      , Str "course,"
      , Space
      , Str "assuming"
      , Space
      , Str "that"
      , SoftBreak
      , Str "the"
      , Space
      , Str "bug"
      , Space
      , Str "has"
      , Space
      , Str "not"
      , Space
      , Str "been"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "intentionally"
          , Space
          , Str "injected"
          , Space
          , Str "in"
          , Space
          , Str "the"
          , SoftBreak
          , Str "compiler"
          ]
          ( "#supply-chain-attacks" , "" )
      , Str "."
      ]
  , Para
      [ Str "Compiler"
      , Space
      , Str "bugs"
      , Space
      , Str "are"
      , Space
      , Str "an"
      , Space
      , Str "interesting"
      , Space
      , Str "source"
      , Space
      , Str "of"
      , Space
      , Str "security"
      , Space
      , Str "issues"
      , Space
      , Str "for"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "just-in-time" , SoftBreak , Str "(JIT)" ]
          ( "https://en.wikipedia.org/wiki/Just-in-time_compilation"
          , ""
          )
      , SoftBreak
      , Str "compilers"
      , RawInline (Format "tex") "\\index{JIT compilers}"
      , Note
          [ Para
              [ Str "JIT"
              , Space
              , Str "compilers"
              , Space
              , Str "compile"
              , Space
              , Str "code"
              , Space
              , Str "during"
              , Space
              , Str "execution"
              , Space
              , Str "of"
              , Space
              , Str "a"
              , Space
              , Str "program,"
              , Space
              , Str "as"
              , Space
              , Str "opposed"
              , Space
              , Str "to"
              , SoftBreak
              , Str "the"
              , Space
              , Str "more"
              , Space
              , Str "traditional"
              , Space
              , Str "compilation"
              , Space
              , Str "where"
              , Space
              , Str "code"
              , Space
              , Str "is"
              , Space
              , Str "compiled"
              , Space
              , Str "before"
              , Space
              , Str "the"
              , Space
              , Str "program"
              , Space
              , Str "is"
              , SoftBreak
              , Str "executed."
              ]
          ]
      , Str "."
      , Space
      , Str "JIT"
      , Space
      , Str "compilation"
      , Space
      , Str "is"
      , Space
      , Str "often"
      , Space
      , Str "used"
      , Space
      , Str "in"
      , SoftBreak
      , Str "programs"
      , Space
      , Str "that"
      , Space
      , Str "receive"
      , Space
      , Str "source"
      , Space
      , Str "code"
      , Space
      , Str "as"
      , Space
      , Str "input"
      , Space
      , Str "during"
      , Space
      , Str "program"
      , Space
      , Str "execution,"
      , Space
      , Str "for"
      , SoftBreak
      , Str "example"
      , Space
      , Str "in"
      , Space
      , Str "web"
      , Space
      , Str "browsers,"
      , Space
      , Str "for"
      , Space
      , Str "executing"
      , Space
      , Str "JavaScript"
      , Space
      , Str "code"
      , Space
      , Str "included"
      , Space
      , Str "in"
      , Space
      , Str "web"
      , Space
      , Str "pages."
      , SoftBreak
      , Str "In"
      , Space
      , Str "this"
      , Space
      , Str "context,"
      , Space
      , Str "the"
      , Space
      , Str "input"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "JIT"
      , Space
      , Str "compiler"
      , Space
      , Str "comes"
      , Space
      , Str "from"
      , Space
      , Str "arbitrary"
      , Space
      , Str "websites"
      , SoftBreak
      , Str "and"
      , Space
      , Str "is"
      , Space
      , Str "therefore"
      , Space
      , Str "untrusted."
      , Space
      , Str "Bugs"
      , Space
      , Str "in"
      , Space
      , Str "such"
      , Space
      , Str "JIT"
      , Space
      , Str "compilers"
      , Space
      , Str "can"
      , Space
      , Str "lead"
      , Space
      , Str "to"
      , Space
      , Str "compromise"
      , SoftBreak
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "whole"
      , Space
      , Str "program"
      , Space
      , Str "(here,"
      , Space
      , Str "the"
      , Space
      , Str "browser)"
      , Space
      , Str "if"
      , Space
      , Str "a"
      , Space
      , Str "malicious"
      , Space
      , Str "input"
      , Space
      , Str "(e.g.\160coming"
      , Space
      , Str "from"
      , SoftBreak
      , Str "a"
      , Space
      , Str "malicious"
      , Space
      , Str "website)"
      , Space
      , Str "deliberately"
      , Space
      , Str "triggers"
      , Space
      , Str "miscompilation"
      , Space
      , Str "in"
      , Space
      , Str "order"
      , Space
      , Str "to"
      , Space
      , Str "break"
      , SoftBreak
      , Str "memory"
      , Space
      , Str "safety"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "language"
      , Space
      , Str "being"
      , Space
      , Str "implemented."
      ]
  , Para
      [ Str "For"
      , Space
      , Str "this"
      , Space
      , Str "section,"
      , Space
      , Str "we"
      , Space
      , Str "focus"
      , Space
      , Str "on"
      , Space
      , Str "JavaScript,"
      , Space
      , Str "which"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "dynamically"
      , Space
      , Str "typed,"
      , SoftBreak
      , Str "memory"
      , Space
      , Str "safe"
      , Space
      , Str "language,"
      , Space
      , Str "but"
      , Space
      , Str "the"
      , Space
      , Str "concerns"
      , Space
      , Str "we"
      , Space
      , Str "discuss"
      , Space
      , Str "also"
      , Space
      , Str "apply"
      , Space
      , Str "to"
      , Space
      , Str "other"
      , SoftBreak
      , Str "languages"
      , Space
      , Str "that"
      , Space
      , Str "are"
      , Space
      , Str "compiled"
      , Space
      , Str "dynamically."
      ]
  , Para
      [ Str "Without"
      , Space
      , Str "statically"
      , Space
      , Str "known"
      , Space
      , Str "types,"
      , Space
      , Str "in"
      , Space
      , Str "order"
      , Space
      , Str "to"
      , Space
      , Str "optimize"
      , Space
      , Str "JavaScript"
      , Space
      , Str "code,"
      , SoftBreak
      , Str "JavaScript"
      , Space
      , Str "engines"
      , Space
      , Str "resort"
      , Space
      , Str "to"
      , Space
      , Str "type"
      , Space
      , Str "profiling"
      , Space
      , Cite
          [ Citation
              { citationId = "Pizlo2020"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 60
              , citationHash = 0
              }
          ]
          [ Str "[@Pizlo2020]" ]
      , Str ","
      , Space
      , Str "recording"
      , Space
      , Str "the"
      , Space
      , Str "types"
      , SoftBreak
      , Str "encountered"
      , Space
      , Str "while"
      , Space
      , Str "executing"
      , Space
      , Str "code."
      , Space
      , Str "These"
      , Space
      , Str "types"
      , Space
      , Str "are"
      , Space
      , Str "then"
      , Space
      , Str "used"
      , Space
      , Str "during"
      , SoftBreak
      , Str "optimization,"
      , Space
      , Str "which"
      , Space
      , Str "speculates"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "same"
      , Space
      , Str "types"
      , Space
      , Str "will"
      , Space
      , Str "be"
      , Space
      , Str "encountered"
      , Space
      , Str "in"
      , SoftBreak
      , Str "future"
      , Space
      , Str "runs"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "code,"
      , Space
      , Str "and"
      , Space
      , Str "inserts"
      , Space
      , Str "checks"
      , Space
      , Str "to"
      , Space
      , Str "validate"
      , Space
      , Str "that"
      , Space
      , Str "these"
      , SoftBreak
      , Str "assumptions"
      , Space
      , Str "about"
      , Space
      , Str "types"
      , Space
      , Str "still"
      , Space
      , Str "hold."
      , Space
      , Str "When"
      , Space
      , Str "a"
      , Space
      , Str "check"
      , Space
      , Str "fails,"
      , Space
      , Str "the"
      , Space
      , Str "optimized"
      , Space
      , Str "code"
      , Space
      , Str "is"
      , SoftBreak
      , Str "replaced"
      , Space
      , Str "by"
      , Space
      , Str "unoptimized"
      , Space
      , Str "code"
      , Space
      , Str "that"
      , Space
      , Str "can"
      , Space
      , Str "handle"
      , Space
      , Str "all"
      , Space
      , Str "types,"
      , Space
      , Str "a"
      , Space
      , Str "process"
      , Space
      , Str "known"
      , Space
      , Str "as"
      , SoftBreak
      , Str "deoptimization"
      , RawInline (Format "tex") "\\index{deoptimization}"
      , Space
      , Str "or"
      , Space
      , Str "on-stack"
      , Space
      , Str "replacement"
      , SoftBreak
      , Str "(OSR)"
      , RawInline
          (Format "tex") "\\index{on-stack replacement (OSR)}"
      , Str "."
      , Space
      , Str "Deoptimization"
      , Space
      , Str "makes"
      , Space
      , Str "sure"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , SoftBreak
      , Str "state"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "deoptimized"
      , Space
      , Str "function"
      , Space
      , Str "is"
      , Space
      , Str "recreated"
      , Space
      , Str "correctly"
      , Space
      , Str "for"
      , Space
      , Str "the"
      , Space
      , Str "point"
      , Space
      , Str "of"
      , SoftBreak
      , Str "execution"
      , Space
      , Str "where"
      , Space
      , Str "the"
      , Space
      , Str "type"
      , Space
      , Str "check"
      , Space
      , Str "failed."
      ]
  , Para
      [ Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "a"
      , Space
      , Str "function"
      , Space
      , Str "such"
      , Space
      , Str "as:"
      ]
  , CodeBlock
      ( "" , [] , [] ) "function foo(x, y) {\n  return x + y;\n}"
  , Para
      [ Str "will"
      , Space
      , Str "return"
      , Space
      , Str "a"
      , Space
      , Str "number"
      , Space
      , Str "when"
      , Space
      , Code ( "" , [] , [] ) "x"
      , Space
      , Str "and"
      , Space
      , Code ( "" , [] , [] ) "y"
      , Space
      , Str "are"
      , Space
      , Str "numbers,"
      , Space
      , Str "but"
      , Space
      , Str "a"
      , Space
      , Str "string"
      , Space
      , Str "when"
      , Space
      , Str "either"
      , Space
      , Str "is"
      , SoftBreak
      , Str "a"
      , Space
      , Str "string."
      , Space
      , Str "An"
      , Space
      , Str "optimizing"
      , Space
      , Str "compiler"
      , Space
      , Str "can"
      , Space
      , Str "use"
      , Space
      , Str "the"
      , Space
      , Str "results"
      , Space
      , Str "of"
      , Space
      , Str "profiling"
      , Space
      , Str "to"
      , Space
      , Str "generate"
      , SoftBreak
      , Str "optimized"
      , Space
      , Str "code."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "when"
      , Space
      , Str "both"
      , Space
      , Str "arguments"
      , Space
      , Str "are"
      , Space
      , Str "integers"
      , Space
      , Str "during"
      , Space
      , Str "profiling,"
      , SoftBreak
      , Str "it"
      , Space
      , Str "can"
      , Space
      , Str "generate"
      , Space
      , Str "code"
      , Space
      , Str "that"
      , Space
      , Str "looks"
      , Space
      , Str "like"
      , Space
      , Str "this"
      , Space
      , Str "in"
      , Space
      , Str "pseudocode:"
      ]
  , CodeBlock
      ( "" , [] , [] )
      "foo:\n  if x not integer, deoptimize\n  if y not integer, deoptimize\n  result = x + y\n  if overflowed, deoptimize\n  return result"
  , Para
      [ Str "You"
      , Space
      , Str "may"
      , Space
      , Str "be"
      , Space
      , Str "wondering"
      , Space
      , Str "how"
      , Space
      , Str "the"
      , Space
      , Str "type"
      , Space
      , Str "checks"
      , Space
      , Str "are"
      , Space
      , Str "implemented,"
      , Space
      , Str "and"
      , Space
      , Str "this"
      , Space
      , Str "is"
      , Space
      , Str "closely"
      , SoftBreak
      , Str "related"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "representation"
      , Space
      , Str "of"
      , Space
      , Str "values"
      , Space
      , Str "in"
      , Space
      , Str "a"
      , Space
      , Str "JavaScript"
      , Space
      , Str "engine"
      , Space
      , Cite
          [ Citation
              { citationId = "Wingo2011"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 61
              , citationHash = 0
              }
          ]
          [ Str "[@Wingo2011]" ]
      , Str "."
      , Space
      , Str "In"
      , SoftBreak
      , Str "short,"
      , Space
      , Str "JavaScript"
      , Space
      , Str "engines"
      , Space
      , Str "use"
      , Space
      , Str "specific"
      , Space
      , Str "bit"
      , Space
      , Str "patterns"
      , Space
      , Str "to"
      , Space
      , Str "indicate"
      , Space
      , Str "whether"
      , Space
      , Str "a"
      , Space
      , Str "value"
      , SoftBreak
      , Str "should"
      , Space
      , Str "be"
      , Space
      , Str "interpreted"
      , Space
      , Str "as"
      , Space
      , Str "a"
      , Space
      , Str "pointer,"
      , Space
      , Str "or"
      , Space
      , Str "as"
      , Space
      , Str "an"
      , Space
      , Str "integer"
      , Space
      , Str "or"
      , Space
      , Str "floating-point"
      , Space
      , Str "value."
      , SoftBreak
      , Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "the"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "V8"
          , Space
          , Str "JavaScript"
          , Space
          , Str "engine"
          ]
          ( "https://v8.dev/" , "" )
      , Space
      , Str "uses"
      , Space
      , Str "the"
      , Space
      , Str "least"
      , SoftBreak
      , Str "significant"
      , Space
      , Str "bit"
      , Space
      , Str "to"
      , Space
      , Str "denote"
      , Space
      , Str "that"
      , Space
      , Str "a"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "value"
          , Space
          , Str "is"
          , Space
          , Str "a"
          , SoftBreak
          , Str "pointer"
          ]
          ( "https://v8.dev/blog/pointer-compression#value-tagging-in-v8"
          , ""
          )
      , Str ","
      , SoftBreak
      , Str "otherwise"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "small"
      , Space
      , Str "integer"
      , Space
      , Str "(which"
      , Space
      , Str "needs"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "shifted"
      , Space
      , Str "down"
      , Space
      , Str "to"
      , Space
      , Str "access"
      , Space
      , Str "its"
      , SoftBreak
      , Str "value)."
      , Space
      , Str "Pointers"
      , Space
      , Str "then"
      , Space
      , Str "point"
      , Space
      , Str "to"
      , Space
      , Str "objects"
      , Space
      , Str "that"
      , Space
      , Str "contain"
      , Space
      , Str "a"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "hidden" , SoftBreak , Str "class" ]
          ( "https://v8.dev/docs/hidden-classes" , "" )
      , Space
      , Str "member"
      , Space
      , Str "which"
      , Space
      , Str "is"
      , Space
      , Str "used"
      , Space
      , Str "for"
      , Space
      , Str "type"
      , SoftBreak
      , Str "checking."
      ]
  , Para
      [ Str "In"
      , Space
      , Str "addition"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "values"
      , Space
      , Str "for"
      , Space
      , Str "which"
      , Space
      , Str "typing"
      , Space
      , Str "information"
      , Space
      , Str "is"
      , Space
      , Str "gathered"
      , Space
      , Str "during"
      , SoftBreak
      , Str "profiling,"
      , Space
      , Str "optimizing"
      , Space
      , Str "JavaScript"
      , Space
      , Str "compilers"
      , Space
      , Str "propagate"
      , Space
      , Str "the"
      , Space
      , Str "profiled"
      , Space
      , Str "types"
      , Space
      , Str "to"
      , SoftBreak
      , Str "dependent"
      , Space
      , Str "values."
      , Space
      , Str "For"
      , Space
      , Str "example"
      , Space
      , Str "if"
      , Space
      , Str "a"
      , Space
      , Str "value"
      , Space
      , Code ( "" , [] , [] ) "x"
      , Space
      , Str "is"
      , Space
      , Str "expected"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "a"
      , Space
      , Str "string,"
      , Space
      , Str "and"
      , Space
      , Str "we"
      , SoftBreak
      , Str "check"
      , Space
      , Str "this"
      , Space
      , Str "assumption,"
      , Space
      , Str "then"
      , Space
      , Code ( "" , [] , [] ) "x + 1"
      , Space
      , Str "will"
      , Space
      , Str "also"
      , Space
      , Str "be"
      , Space
      , Str "a"
      , Space
      , Str "string"
      , Space
      , Str "(and"
      , Space
      , Str "no"
      , Space
      , Str "additional"
      , SoftBreak
      , Str "check"
      , Space
      , Str "is"
      , Space
      , Str "needed"
      , Space
      , Str "in"
      , Space
      , Str "this"
      , Space
      , Str "case)."
      , Space
      , Str "In"
      , Space
      , Str "addition"
      , Space
      , Str "to"
      , Space
      , Str "simple"
      , Space
      , Str "type"
      , Space
      , Str "propagation,"
      , Space
      , Str "they"
      , SoftBreak
      , Str "usually"
      , Space
      , Str "perform"
      , Space
      , Str "range"
      , Space
      , Str "analysis"
      , RawInline (Format "tex") "\\index{range analysis}"
      , Space
      , Str "to"
      , Space
      , Str "determine"
      , Space
      , Str "as"
      , Space
      , Str "precise"
      , Space
      , Str "a"
      , SoftBreak
      , Str "range"
      , Space
      , Str "for"
      , Space
      , Str "a"
      , Space
      , Str "value"
      , Space
      , Str "as"
      , Space
      , Str "possible,"
      , Space
      , Str "which"
      , Space
      , Str "is"
      , Space
      , Str "useful"
      , Space
      , Str "for"
      , Space
      , Str "bounds"
      , Space
      , Str "check"
      , SoftBreak
      , Str "elimination"
      , RawInline
          (Format "tex") "\\index{bounds check elimination}"
      , Str "."
      ]
  , Para
      [ Str "Bounds"
      , Space
      , Str "check"
      , Space
      , Str "elimination"
      , Space
      , Str "(BCE)"
      , RawInline
          (Format "tex") "\\index{bounds check elimination}"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "common"
      , SoftBreak
      , Str "optimization"
      , Space
      , Str "in"
      , Space
      , Str "languages"
      , Space
      , Str "that"
      , Space
      , Str "perform"
      , Space
      , Str "bounds"
      , Space
      , Str "checks"
      , Space
      , Str "on"
      , Space
      , Str "array"
      , Space
      , Str "accesses"
      , Space
      , Str "to"
      , SoftBreak
      , Str "ensure"
      , Space
      , Str "every"
      , Space
      , Str "accessed"
      , Space
      , Str "index"
      , Space
      , Str "is"
      , Space
      , Str "within"
      , Space
      , Str "the"
      , Space
      , Str "bounds"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "array."
      , Space
      , Str "BCE"
      , Space
      , Str "gets"
      , Space
      , Str "rid"
      , Space
      , Str "of"
      , SoftBreak
      , Str "bounds"
      , Space
      , Str "checks"
      , Space
      , Str "when"
      , Space
      , Str "they"
      , Space
      , Str "are"
      , Space
      , Str "proven"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "redundant,"
      , Space
      , Str "e.g.\160when"
      , Space
      , Str "the"
      , Space
      , Str "array"
      , Space
      , Str "access"
      , SoftBreak
      , Str "uses"
      , Space
      , Str "a"
      , Space
      , Str "constant"
      , Space
      , Str "index"
      , Space
      , Str "that\8217s"
      , Space
      , Str "known"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "smaller"
      , Space
      , Str "than"
      , Space
      , Str "the"
      , Space
      , Str "length"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "array."
      , SoftBreak
      , Str "See"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "here" ]
          ( "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/length"
          , ""
          )
      , SoftBreak
      , Str "for"
      , Space
      , Str "details"
      , Space
      , Str "on"
      , Space
      , Str "how"
      , Space
      , Str "out-of-bounds"
      , Space
      , Str "array"
      , Space
      , Str "accesses"
      , Space
      , Str "behave"
      , Space
      , Str "in"
      , Space
      , Str "JavaScript."
      ]
  , Para
      [ Str "Range"
      , Space
      , Str "analysis"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "good"
      , Space
      , Str "example"
      , Space
      , Str "of"
      , Space
      , Str "an"
      , Space
      , Str "analysis"
      , Space
      , Str "where"
      , Space
      , Str "a"
      , Space
      , Str "JIT"
      , Space
      , Str "compiler"
      , Space
      , Str "bug"
      , Space
      , Str "can"
      , SoftBreak
      , Str "introduce"
      , Space
      , Str "a"
      , Space
      , Str "vulnerability."
      , Space
      , Str "Incorrect"
      , Space
      , Str "range"
      , Space
      , Str "analysis"
      , Space
      , Str "results"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "used"
      , Space
      , Str "by"
      , SoftBreak
      , Str "bounds"
      , Space
      , Str "check"
      , Space
      , Str "elimination"
      , Space
      , Str "to"
      , Space
      , Str "incorrectly"
      , Space
      , Str "eliminate"
      , Space
      , Str "bounds"
      , Space
      , Str "checks"
      , Space
      , Str "that"
      , Space
      , Str "should"
      , SoftBreak
      , Str "actually"
      , Space
      , Str "have"
      , Space
      , Str "been"
      , Space
      , Str "maintained"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "optimized"
      , Space
      , Str "code."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "for"
      , Space
      , Str "the"
      , SoftBreak
      , Str "following"
      , Space
      , Str "function:"
      ]
  , CodeBlock
      ( "" , [] , [] )
      "function foo(x) {\n  y = bar(x);\n  var a = [0, 1, 2];\n  return a[y];\n}"
  , Para
      [ Str "If"
      , Space
      , Str "range"
      , Space
      , Str "analysis"
      , Space
      , Str "decides"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "value"
      , Space
      , Str "of"
      , Space
      , Code ( "" , [] , [] ) "y"
      , Space
      , Str "is"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "range"
      , Space
      , Code ( "" , [] , [] ) "[0, 2]"
      , Str ","
      , Space
      , Str "but"
      , SoftBreak
      , Str "in"
      , Space
      , Str "reality"
      , Space
      , Str "the"
      , Space
      , Str "value"
      , Space
      , Str "is"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "range"
      , Space
      , Code ( "" , [] , [] ) "[0, 3]"
      , Str ","
      , Space
      , Str "the"
      , Space
      , Str "bounds"
      , Space
      , Str "check"
      , Space
      , Str "for"
      , Space
      , Str "the"
      , Space
      , Str "access"
      , SoftBreak
      , Code ( "" , [] , [] ) "a[y]"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "eliminated"
      , Space
      , Str "incorrectly,"
      , Space
      , Str "assuming"
      , Space
      , Str "the"
      , Space
      , Str "access"
      , Space
      , Str "is"
      , Space
      , Str "in-bounds."
      , SoftBreak
      , Cite
          [ Citation
              { citationId = "Glazunov2021"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 62
              , citationHash = 0
              }
          ]
          [ Str "[@Glazunov2021]" ]
      , Space
      , Str "lists"
      , Space
      , Str "a"
      , Space
      , Str "few"
      , Space
      , Str "examples"
      , Space
      , Str "of"
      , Space
      , Str "similar"
      , Space
      , Str "hypothetical"
      , Space
      , Str "vulnerabilities,"
      , SoftBreak
      , Str "along"
      , Space
      , Str "with"
      , Space
      , Str "examples"
      , Space
      , Str "of"
      , Space
      , Str "vulnerabilities"
      , Space
      , Str "of"
      , Space
      , Str "this"
      , Space
      , Str "type"
      , Space
      , Str "that"
      , Space
      , Str "affected"
      , Space
      , Str "widely-used"
      , SoftBreak
      , Str "JavaScript"
      , Space
      , Str "engines."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "type"
      , Space
      , Str "of"
      , Space
      , Str "bug"
      , Space
      , Str "described"
      , Space
      , Str "above"
      , Space
      , Str "provides"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "with"
      , Space
      , Str "a"
      , Space
      , Str "limited"
      , Space
      , Str "read"
      , Space
      , Str "or"
      , SoftBreak
      , Str "write"
      , Space
      , Str "primitive,"
      , Space
      , Str "as"
      , Space
      , Str "a"
      , Space
      , Str "linear"
      , Space
      , Str "overflow"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "array"
      , Space
      , Str "allocation"
      , Space
      , Str "occurs."
      , Space
      , Str "The"
      , SoftBreak
      , Str "attacker"
      , Space
      , Str "can"
      , Space
      , Str "then"
      , Space
      , Str "build"
      , Space
      , Str "on"
      , Space
      , Str "this"
      , Space
      , Str "primitive"
      , Space
      , Str "to"
      , Space
      , Str "get"
      , Space
      , Str "to"
      , Space
      , Str "an"
      , Space
      , Str "arbitrary"
      , Space
      , Str "read/write"
      , SoftBreak
      , Str "primitive."
      , Space
      , Str "As"
      , Space
      , Str "JIT"
      , Space
      , Str "compilers"
      , Space
      , Str "generate"
      , Space
      , Str "executable"
      , Space
      , Str "code"
      , Space
      , Str "at"
      , Space
      , Str "runtime,"
      , Space
      , Str "they"
      , Space
      , Str "often"
      , Space
      , Str "use"
      , SoftBreak
      , Str "memory"
      , Space
      , Str "that"
      , Space
      , Str "is"
      , Space
      , Str "writable"
      , Space
      , Str "and"
      , Space
      , Str "executable"
      , Space
      , Str "at"
      , Space
      , Str "the"
      , Space
      , Str "same"
      , Space
      , Str "time."
      , Space
      , Str "Such"
      , Space
      , Str "memory"
      , Space
      , Str "is"
      , Space
      , Str "very"
      , SoftBreak
      , Str "useful"
      , Space
      , Str "to"
      , Space
      , Str "attackers,"
      , Space
      , Str "who"
      , Space
      , Str "can"
      , Space
      , Str "use"
      , Space
      , Str "an"
      , Space
      , Str "arbitrary"
      , Space
      , Str "write"
      , Space
      , Str "primitive"
      , Space
      , Str "to"
      , Space
      , Str "copy"
      , Space
      , Str "their"
      , SoftBreak
      , Str "payload"
      , Space
      , Str "into"
      , Space
      , Str "this"
      , Space
      , Str "code"
      , Space
      , Str "memory,"
      , Space
      , Str "and"
      , Space
      , Str "then"
      , Space
      , Str "jump"
      , Space
      , Str "to"
      , Space
      , Str "it."
      , Space
      , Str "Writable"
      , Space
      , Str "and"
      , Space
      , Str "executable"
      , SoftBreak
      , Str "memory,"
      , Space
      , Str "therefore,"
      , Space
      , Str "makes"
      , Space
      , Str "JITs"
      , Space
      , Str "lucrative"
      , Space
      , Str "targets"
      , Space
      , Str "for"
      , Space
      , Str "attackers."
      ]
  , Para
      [ Str "Bugs"
      , Space
      , Str "related"
      , Space
      , Str "to"
      , Space
      , Str "range"
      , Space
      , Str "analysis"
      , Space
      , Str "are"
      , Space
      , Str "just"
      , Space
      , Str "one"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "common"
      , Space
      , Str "types"
      , Space
      , Str "of"
      , Space
      , Str "bugs"
      , SoftBreak
      , Str "encountered"
      , Space
      , Str "in"
      , Space
      , Str "a"
      , Space
      , Str "JavaScript"
      , Space
      , Str "engine."
      , Space
      , Cite
          [ Citation
              { citationId = "Gro\223\&2022"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 63
              , citationHash = 0
              }
          ]
          [ Str "[@Gro\223\&2022]" ]
      , Space
      , Str "lists"
      , Space
      , Str "some"
      , Space
      , Str "other"
      , Space
      , Str "common"
      , Space
      , Str "types"
      , SoftBreak
      , Str "of"
      , Space
      , Str "bugs"
      , Space
      , Str "that"
      , Space
      , Str "result"
      , Space
      , Str "in"
      , Space
      , Str "violations"
      , Space
      , Str "of"
      , Space
      , Str "temporal"
      , Space
      , Str "and"
      , Space
      , Str "spatial"
      , Space
      , Str "memory"
      , Space
      , Str "safety,"
      , Space
      , Str "as"
      , SoftBreak
      , Str "well"
      , Space
      , Str "as"
      , Space
      , Str "type"
      , Space
      , Str "safety,"
      , Space
      , Str "in"
      , Space
      , Str "JavaScript"
      , Space
      , Str "engines."
      ]
  , Para
      [ Str "How"
      , Space
      , Str "can"
      , Space
      , Str "we"
      , Space
      , Str "defend"
      , Space
      , Str "against"
      , Space
      , Str "such"
      , Space
      , Str "vulnerabilities?"
      , Space
      , Str "There"
      , Space
      , Str "are"
      , Space
      , Str "several"
      , Space
      , Str "complementary"
      , SoftBreak
      , Str "approaches,"
      , Space
      , Str "for"
      , Space
      , Str "example:"
      ]
  , OrderedList
      ( 1 , Decimal , Period )
      [ [ Plain
            [ Str "Use"
            , Space
            , Str "fuzzing"
            , Space
            , Str "to"
            , Space
            , Str "discover"
            , Space
            , Str "compiler"
            , Space
            , Str "bugs."
            , Space
            , Str "For"
            , Space
            , Str "JavaScript,"
            , Space
            , Str "a"
            , Space
            , Str "useful"
            , Space
            , Str "fuzzing"
            , Space
            , Str "tool"
            , SoftBreak
            , Str "is"
            , Space
            , Link
                ( "" , [] , [] )
                [ Str "Fuzzilli" ]
                ( "https://github.com/googleprojectzero/fuzzilli" , "" )
            , Str "."
            ]
        ]
      , [ Plain
            [ Str "Be"
            , Space
            , Str "more"
            , Space
            , Str "conservative"
            , Space
            , Str "when"
            , Space
            , Str "it"
            , Space
            , Str "comes"
            , Space
            , Str "to"
            , Space
            , Str "error-prone"
            , Space
            , Str "compiler"
            , Space
            , Str "optimizations"
            , SoftBreak
            , Str "such"
            , Space
            , Str "as"
            , Space
            , Str "bounds"
            , Space
            , Str "check"
            , Space
            , Str "elimination."
            , Space
            , Str "For"
            , Space
            , Str "example,"
            , Space
            , Str "the"
            , SoftBreak
            , Link
                ( "" , [] , [] )
                [ Str "V8"
                , Space
                , Str "JavaScript"
                , Space
                , Str "engine"
                ]
                ( "https://v8.dev/" , "" )
            , Space
            , Str "has"
            , Space
            , Str "introduced"
            , SoftBreak
            , Link
                ( "" , [] , [] )
                [ Str "hardening"
                , Space
                , Str "of"
                , Space
                , Str "bounds"
                , Space
                , Str "checks"
                , Space
                , Str "against"
                , Space
                , Str "typer"
                , Space
                , Str "bugs"
                ]
                ( "https://bugs.chromium.org/p/v8/issues/detail?id=8806"
                , ""
                )
            , SoftBreak
            , Note
                [ Para
                    [ Str "This"
                    , Space
                    , Str "naturally"
                    , Space
                    , Str "leads"
                    , Space
                    , Str "to"
                    , Space
                    , Str "attempts"
                    , Space
                    , Str "to"
                    , Space
                    , Str "bypass"
                    , Space
                    , Str "the"
                    , Space
                    , Str "hardening"
                    , Space
                    , Str "too"
                    , SoftBreak
                    , Cite
                        [ Citation
                            { citationId = "Fetiveau2019"
                            , citationPrefix = []
                            , citationSuffix = []
                            , citationMode = NormalCitation
                            , citationNoteNum = 64
                            , citationHash = 0
                            }
                        ]
                        [ Str "[@Fetiveau2019]" ]
                    , Str "."
                    ]
                ]
            , Str "."
            ]
        ]
      , [ Plain
            [ Str "Instead"
            , Space
            , Str "of"
            , Space
            , Str "trying"
            , Space
            , Str "to"
            , Space
            , Str "prevent"
            , Space
            , Str "compiler"
            , Space
            , Str "(and"
            , Space
            , Str "other)"
            , Space
            , Str "bugs,"
            , Space
            , Str "assume"
            , Space
            , Str "they"
            , Space
            , Str "will"
            , Space
            , Str "be"
            , SoftBreak
            , Str "present"
            , Space
            , Str "and"
            , Space
            , Str "introduce"
            , Space
            , Str "mitigations"
            , Space
            , Str "that"
            , Space
            , Str "prevent"
            , Space
            , Str "attackers"
            , Space
            , Str "from"
            , Space
            , Str "building"
            , Space
            , Str "arbitrary"
            , SoftBreak
            , Str "read/write"
            , Space
            , Str "primitives"
            , Space
            , Str "on"
            , Space
            , Str "top"
            , Space
            , Str "of"
            , Space
            , Str "the"
            , Space
            , Str "initial"
            , Space
            , Str "limited"
            , Space
            , Str "primitives"
            , Space
            , Str "that"
            , Space
            , Str "bugs"
            , SoftBreak
            , Str "provide."
            , Space
            , Str "For"
            , Space
            , Str "example,"
            , Space
            , Str "for"
            , Space
            , Str "64-bit"
            , Space
            , Str "architectures,"
            , Space
            , Str "V8"
            , Space
            , Str "implements"
            , Space
            , Str "a"
            , SoftBreak
            , Link
                ( "" , [] , [] )
                [ Str "sandbox" ]
                ( "https://docs.google.com/document/d/1FM4fQmIhEqPG8uGp5o9A-mnPB5BOeScZYpkHjo0KKA8/edit"
                , ""
                )
            , Str ","
            , SoftBreak
            , Str "built"
            , Space
            , Str "on"
            , Space
            , Str "top"
            , Space
            , Str "of"
            , Space
            , Link
                ( "" , [] , [] )
                [ Str "pointer" , Space , Str "compression" ]
                ( "https://v8.dev/blog/pointer-compression" , "" )
            , SoftBreak
            , RawInline (Format "tex") "\\index{pointer compression}"
            , Str "."
            , SoftBreak
            , Str "With"
            , Space
            , Str "pointer"
            , Space
            , Str "compression,"
            , Space
            , Str "pointers"
            , Space
            , Str "are"
            , Space
            , Str "represented"
            , Space
            , Str "by"
            , Space
            , Str "32-bit"
            , Space
            , Str "indices"
            , Space
            , Str "off"
            , Space
            , Str "a"
            , Space
            , Str "base"
            , SoftBreak
            , Str "pointer"
            , Space
            , Str "instead"
            , Space
            , Str "of"
            , Space
            , Str "as"
            , Space
            , Str "full"
            , Space
            , Str "64-bit"
            , Space
            , Str "values."
            , Space
            , Str "By"
            , Space
            , Str "making"
            , Space
            , Str "sure"
            , Space
            , Str "that"
            , Space
            , Str "all"
            , Space
            , Str "pointers"
            , SoftBreak
            , Str "inside"
            , Space
            , Str "the"
            , Space
            , Str "sandbox"
            , Space
            , Str "(where"
            , Space
            , Str "the"
            , Space
            , Str "JavaScript"
            , Space
            , Str "heap"
            , Space
            , Str "is"
            , Space
            , Str "located)"
            , Space
            , Str "are"
            , Space
            , Str "compressed,"
            , SoftBreak
            , Str "and"
            , Space
            , Str "that"
            , Space
            , Str "compressed"
            , Space
            , Str "pointers"
            , Space
            , Str "always"
            , Space
            , Str "point"
            , Space
            , Str "inside"
            , Space
            , Str "the"
            , Space
            , Str "sandbox,"
            , SoftBreak
            , Str "a"
            , Space
            , Str "limited"
            , Space
            , Str "primitive"
            , Space
            , Str "that"
            , Space
            , Str "allows"
            , Space
            , Str "overwriting"
            , Space
            , Str "memory"
            , Space
            , Str "within"
            , Space
            , Str "the"
            , Space
            , Str "sandbox"
            , SoftBreak
            , Str "cannot"
            , Space
            , Str "be"
            , Space
            , Str "used"
            , Space
            , Str "to"
            , Space
            , Str "build"
            , Space
            , Str "an"
            , Space
            , Str "arbitrary"
            , Space
            , Str "read/write"
            , Space
            , Str "primitive"
            , Space
            , Str "by"
            , Space
            , Str "overwriting"
            , SoftBreak
            , Str "pointer"
            , Space
            , Str "values."
            ]
        ]
      , [ Plain
            [ Str "Preventing"
            , Space
            , Str "code"
            , Space
            , Str "memory"
            , Space
            , Str "from"
            , Space
            , Str "being"
            , Space
            , Str "executable"
            , Space
            , Str "and"
            , Space
            , Str "writable"
            , Space
            , Str "at"
            , Space
            , Str "the"
            , Space
            , Str "same"
            , Space
            , Str "time"
            , SoftBreak
            , Str "is"
            , Space
            , Str "also"
            , Space
            , Str "desirable."
            , Space
            , Str "This"
            , Space
            , Str "is"
            , Space
            , Str "known"
            , Space
            , Str "as"
            , Space
            , Link
                ( "" , [] , [] )
                [ Str "W^X" ]
                ( "https://en.wikipedia.org/wiki/W%5EX" , "" )
            , SoftBreak
            , RawInline (Format "tex") "\\index{W\\^{}X}"
            , Str "."
            , SoftBreak
            , Str "A"
            , Space
            , Str "naive"
            , Space
            , Str "implementation"
            , Space
            , Str "of"
            , Space
            , Str "W^X"
            , Space
            , Str "that"
            , Space
            , Str "simply"
            , Space
            , Str "switches"
            , Space
            , Str "memory"
            , Space
            , Str "permissions"
            , SoftBreak
            , Str "based"
            , Space
            , Str "on"
            , Space
            , Str "page"
            , Space
            , Str "tables"
            , Space
            , Str "temporarily"
            , Space
            , Str "is"
            , Space
            , Str "not"
            , Space
            , Str "enough"
            , Space
            , Str "to"
            , Space
            , Str "prevent"
            , Space
            , Str "attackers"
            , Space
            , Str "from"
            , SoftBreak
            , Str "writing"
            , Space
            , Str "to"
            , Space
            , Str "code"
            , Space
            , Str "memory"
            , Space
            , Cite
                [ Citation
                    { citationId = "Song2015"
                    , citationPrefix = []
                    , citationSuffix = []
                    , citationMode = NormalCitation
                    , citationNoteNum = 65
                    , citationHash = 0
                    }
                ]
                [ Str "[@Song2015]" ]
            , Str ","
            , Space
            , Str "when"
            , Space
            , Str "multiple"
            , Space
            , Str "threads"
            , Space
            , Str "are"
            , Space
            , Str "involved."
            , SoftBreak
            , Str "A"
            , Space
            , Str "more"
            , Space
            , Str "effective"
            , Space
            , Str "solution"
            , Space
            , Str "would"
            , Space
            , Str "use"
            , Space
            , Str "a"
            , Space
            , Str "separate"
            , Space
            , Str "compilation"
            , Space
            , Str "process,"
            , Space
            , Str "which"
            , SoftBreak
            , Str "is"
            , Space
            , Str "the"
            , Space
            , Str "only"
            , Space
            , Str "process"
            , Space
            , Str "that"
            , Space
            , Str "has"
            , Space
            , Str "write"
            , Space
            , Str "access"
            , Space
            , Str "to"
            , Space
            , Str "the"
            , Space
            , Str "JIT\8217s"
            , Space
            , Str "code"
            , Space
            , Str "memory."
            , SoftBreak
            , Str "Alternatively,"
            , Space
            , Str "some"
            , Space
            , Str "architectures"
            , Space
            , Str "provide"
            , Space
            , Str "special"
            , Space
            , Str "features"
            , Space
            , Str "that"
            , Space
            , Str "can"
            , SoftBreak
            , Str "restrict"
            , Space
            , Str "page-based"
            , Space
            , Str "memory"
            , Space
            , Str "permissions"
            , Space
            , Str "from"
            , Space
            , Str "userspace,"
            , Space
            , Str "effectively"
            , SoftBreak
            , Str "allowing"
            , Space
            , Str "permissions"
            , Space
            , Str "to"
            , Space
            , Str "be"
            , Space
            , Str "different"
            , Space
            , Str "for"
            , Space
            , Str "different"
            , Space
            , Str "threads."
            , Space
            , Str "Such"
            , Space
            , Str "features"
            , SoftBreak
            , Str "can"
            , Space
            , Str "also"
            , Space
            , Str "be"
            , Space
            , Str "of"
            , Space
            , Str "use"
            , Space
            , Str "in"
            , Space
            , Str "implementing"
            , Space
            , Str "W^X."
            , Space
            , Str "For"
            , Space
            , Str "AArch64,"
            , Space
            , Str "this"
            , Space
            , Str "feature"
            , Space
            , Str "is"
            , Space
            , Str "called"
            , SoftBreak
            , Link
                ( "" , [] , [] )
                [ Str "permission" , Space , Str "overlays" ]
                ( "https://developer.arm.com/documentation/102376/0200/Permission-indirection-and-permission-overlay-extensions"
                , ""
                )
            , Str "."
            ]
        ]
      ]
  , Para
      [ Str "In"
      , Space
      , Str "this"
      , Space
      , Str "section,"
      , Space
      , Str "we"
      , Space
      , Str "have"
      , Space
      , Str "discussed"
      , Space
      , Str "JIT"
      , Space
      , Str "compiler"
      , Space
      , Str "security"
      , Space
      , Str "and"
      , Space
      , Str "described"
      , SoftBreak
      , Str "JavaScript"
      , Space
      , Str "compiler"
      , Space
      , Str "bugs"
      , Space
      , Str "that"
      , Space
      , Str "lead"
      , Space
      , Str "to"
      , Space
      , Str "vulnerabilities."
      , Space
      , Str "Although"
      , Space
      , Str "we"
      , Space
      , Str "haven\8217t"
      , SoftBreak
      , Str "focused"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "details"
      , Space
      , Str "of"
      , Space
      , Str "JavaScript"
      , Space
      , Str "exploitation,"
      , Space
      , Str "an"
      , Space
      , Str "interested"
      , Space
      , Str "reader"
      , Space
      , Str "could"
      , SoftBreak
      , Str "take"
      , Space
      , Str "a"
      , Space
      , Str "look"
      , Space
      , Str "at"
      , Space
      , Cite
          [ Citation
              { citationId = "saelo2021a"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 66
              , citationHash = 0
              }
          ]
          [ Str "[@saelo2021a]" ]
      , Space
      , Str "and"
      , Space
      , Cite
          [ Citation
              { citationId = "saelo2021b"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 67
              , citationHash = 0
              }
          ]
          [ Str "[@saelo2021b]" ]
      , Str "."
      ]
  , Header
      1
      ( "covert-channels-and-side-channels" , [] , [] )
      [ Str "Covert"
      , Space
      , Str "channels"
      , Space
      , Str "and"
      , Space
      , Str "side-channels"
      ]
  , Para
      [ Str "Side-channels"
      , Space
      , Str "and"
      , Space
      , Str "covert"
      , Space
      , Str "channels"
      , Space
      , Str "are"
      , Space
      , Str "communication"
      , Space
      , Str "channels"
      , Space
      , Str "between"
      , Space
      , Str "two"
      , SoftBreak
      , Str "entities"
      , Space
      , Str "in"
      , Space
      , Str "a"
      , Space
      , Str "system,"
      , Space
      , Str "where"
      , Space
      , Str "the"
      , Space
      , Str "entities"
      , Space
      , Str "should"
      , Space
      , Str "not"
      , Space
      , Str "be"
      , Space
      , Str "able"
      , Space
      , Str "to"
      , Space
      , Str "communicate"
      , Space
      , Str "that"
      , SoftBreak
      , Str "way."
      ]
  , Para
      [ Str "A"
      , Space
      , Strong [ Str "covert" , Space , Str "channel" ]
      , RawInline (Format "tex") "\\index{covert channel}"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "channel"
      , Space
      , Str "where"
      , Space
      , Str "both"
      , Space
      , Str "entities"
      , SoftBreak
      , Str "intend"
      , Space
      , Str "to"
      , Space
      , Str "communicate."
      , Space
      , Str "A"
      , Space
      , Strong [ Str "side-channel" ]
      , RawInline (Format "tex") "\\index{side-channel}"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "channel"
      , Space
      , Str "where"
      , SoftBreak
      , Str "one"
      , Space
      , Str "entity"
      , Space
      , Str "is"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "of"
      , Space
      , Str "an"
      , Space
      , Str "attack"
      , Space
      , Str "using"
      , Space
      , Str "the"
      , Space
      , Str "channel."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "difference"
      , Space
      , Str "between"
      , Space
      , Str "a"
      , Space
      , Str "covert"
      , Space
      , Str "channel"
      , Space
      , Str "and"
      , Space
      , Str "a"
      , Space
      , Str "side-channel"
      , Space
      , Str "is"
      , Space
      , Str "whether"
      , Space
      , Str "both"
      , SoftBreak
      , Str "entities"
      , Space
      , Str "intend"
      , Space
      , Str "to"
      , Space
      , Str "communicate."
      , Space
      , Str "In"
      , Space
      , Str "a"
      , Space
      , Str "side-channel"
      , Space
      , Str "attack,"
      , Space
      , Str "the"
      , Space
      , Str "entity"
      , Space
      , Str "not"
      , SoftBreak
      , Str "intending"
      , Space
      , Str "to"
      , Space
      , Str "communicate"
      , Space
      , Str "is"
      , Space
      , Str "called"
      , Space
      , Str "the"
      , Space
      , Strong [ Str "victim" ]
      , RawInline (Format "tex") "\\index{victim}"
      , Str "."
      , Space
      , Str "The"
      , Space
      , Str "other"
      , SoftBreak
      , Str "entity"
      , Space
      , Str "is"
      , Space
      , Str "sometimes"
      , Space
      , Str "called"
      , Space
      , Str "the"
      , Space
      , Strong [ Str "spy" ]
      , RawInline (Format "tex") "\\index{spy}"
      , Str "."
      ]
  , Para
      [ Str "As"
      , Space
      , Str "we"
      , Space
      , Str "focus"
      , Space
      , Str "on"
      , Space
      , Str "attacks"
      , Space
      , Str "in"
      , Space
      , Str "this"
      , Space
      , Str "book,"
      , Space
      , Str "we\8217ll"
      , Space
      , Str "mostly"
      , Space
      , Str "use"
      , Space
      , Str "the"
      , Space
      , Str "term"
      , Space
      , Str "side-channels"
      , SoftBreak
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "rest"
      , Space
      , Str "of"
      , Space
      , Str "this"
      , Space
      , Str "chapter."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "next"
      , Space
      , Str "few"
      , Space
      , Str "sections"
      , Space
      , Str "describe"
      , Space
      , Str "a"
      , Space
      , Str "variety"
      , Space
      , Str "of"
      , Space
      , Str "side-channels."
      , Space
      , Str "Each"
      , Space
      , Str "section"
      , Space
      , Str "focusses"
      , SoftBreak
      , Str "on"
      , Space
      , Str "leakage"
      , Space
      , Str "through"
      , Space
      , Str "a"
      , Space
      , Str "specific"
      , Space
      , Str "so-called"
      , Space
      , Str "micro-architectural"
      , SoftBreak
      , Str "aspect"
      , RawInline (Format "tex") "\\index{micro-architectural}"
      , Str ","
      , Space
      , Str "such"
      , Space
      , Str "as"
      , Space
      , Str "execution"
      , Space
      , Str "time,"
      , Space
      , Str "cache"
      , Space
      , Str "state"
      , Space
      , Str "or"
      , Space
      , Str "branch"
      , SoftBreak
      , Str "predictor"
      , Space
      , Str "state."
      ]
  , Header
      2
      ( "timing-side-channels" , [] , [] )
      [ Str "Timing" , Space , Str "side-channels" ]
  , Para
      [ Str "An"
      , Space
      , Str "implementation"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "cryptographic"
      , Space
      , Str "algorithm"
      , Space
      , Str "can"
      , Space
      , Str "leak"
      , Space
      , Str "information"
      , Space
      , Str "about"
      , Space
      , Str "the"
      , SoftBreak
      , Str "data"
      , Space
      , Str "it"
      , Space
      , Str "processes"
      , Space
      , Str "if"
      , Space
      , Str "its"
      , Space
      , Str "run"
      , Space
      , Str "time"
      , Space
      , Str "is"
      , Space
      , Str "influenced"
      , Space
      , Str "by"
      , Space
      , Str "the"
      , Space
      , Str "value"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "processed"
      , SoftBreak
      , Str "data."
      , Space
      , Str "Attacks"
      , Space
      , Str "making"
      , Space
      , Str "use"
      , Space
      , Str "of"
      , Space
      , Str "this"
      , Space
      , Str "are"
      , Space
      , Str "called"
      , Space
      , Str "timing"
      , Space
      , Str "attacks"
      , RawInline (Format "tex") "\\index{timing\nattacks}"
      , Str "."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "main"
      , Space
      , Str "mitigation"
      , Space
      , Str "against"
      , Space
      , Str "such"
      , Space
      , Str "attacks"
      , Space
      , Str "consists"
      , Space
      , Str "of"
      , Space
      , Str "carefully"
      , Space
      , Str "implementing"
      , Space
      , Str "the"
      , SoftBreak
      , Str "algorithm"
      , Space
      , Str "such"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "execution"
      , Space
      , Str "time"
      , Space
      , Str "remains"
      , Space
      , Str "independent"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "processed"
      , SoftBreak
      , Str "data."
      , Space
      , Str "This"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "done"
      , Space
      , Str "by"
      , Space
      , Str "making"
      , Space
      , Str "sure"
      , Space
      , Str "that"
      , Space
      , Str "both:"
      ]
  , OrderedList
      ( 1 , LowerAlpha , OneParen )
      [ [ Para
            [ Str "The"
            , Space
            , Str "control"
            , Space
            , Str "flow,"
            , Space
            , Str "i.e.\160the"
            , Space
            , Str "trace"
            , Space
            , Str "of"
            , Space
            , Str "instructions"
            , Space
            , Str "executed,"
            , Space
            , Str "does"
            , Space
            , Str "not"
            , Space
            , Str "change"
            , SoftBreak
            , Str "depending"
            , Space
            , Str "on"
            , Space
            , Str "the"
            , Space
            , Str "processed"
            , Space
            , Str "data."
            , Space
            , Str "This"
            , Space
            , Str "guarantees"
            , Space
            , Str "that"
            , Space
            , Str "every"
            , Space
            , Str "time"
            , Space
            , Str "the"
            , SoftBreak
            , Str "algorithm"
            , Space
            , Str "runs,"
            , Space
            , Str "exactly"
            , Space
            , Str "the"
            , Space
            , Str "same"
            , Space
            , Str "sequence"
            , Space
            , Str "of"
            , Space
            , Str "instructions"
            , Space
            , Str "is"
            , Space
            , Str "executed,"
            , SoftBreak
            , Str "independent"
            , Space
            , Str "of"
            , Space
            , Str "the"
            , Space
            , Str "processed"
            , Space
            , Str "data."
            ]
        ]
      , [ Para
            [ Str "The"
            , Space
            , Str "instructions"
            , Space
            , Str "used"
            , Space
            , Str "to"
            , Space
            , Str "implement"
            , Space
            , Str "the"
            , Space
            , Str "algorithm"
            , Space
            , Str "are"
            , Space
            , Str "from"
            , Space
            , Str "the"
            , Space
            , Str "subset"
            , Space
            , Str "of"
            , SoftBreak
            , Str "instructions"
            , Space
            , Str "for"
            , Space
            , Str "which"
            , Space
            , Str "the"
            , Space
            , Str "execution"
            , Space
            , Str "time"
            , Space
            , Str "is"
            , Space
            , Str "known"
            , Space
            , Str "to"
            , Space
            , Str "not"
            , Space
            , Str "depend"
            , Space
            , Str "on"
            , Space
            , Str "the"
            , Space
            , Str "data"
            , SoftBreak
            , Str "values"
            , Space
            , Str "it"
            , Space
            , Str "processes."
            ]
        , Para
            [ Str "For"
            , Space
            , Str "example,"
            , Space
            , Str "in"
            , Space
            , Str "the"
            , Space
            , Str "Arm"
            , Space
            , Str "architecture,"
            , Space
            , Str "the"
            , Space
            , Str "Armv8.4-A"
            , SoftBreak
            , Link
                ( "" , [] , [] )
                [ Str "DIT" , Space , Str "extension" ]
                ( "https://developer.arm.com/documentation/ddi0595/2021-06/AArch64-Registers/DIT--Data-Independent-Timing"
                , ""
                )
            , SoftBreak
            , Str "guarantees"
            , Space
            , Str "that"
            , Space
            , Str "execution"
            , Space
            , Str "time"
            , Space
            , Str "is"
            , Space
            , Str "data-independent"
            , Space
            , Str "for"
            , Space
            , Str "a"
            , Space
            , Str "subset"
            , Space
            , Str "of"
            , Space
            , Str "the"
            , SoftBreak
            , Str "AArch64"
            , Space
            , Str "instructions."
            ]
        , Para
            [ Str "By"
            , Space
            , Str "ensuring"
            , Space
            , Str "that"
            , Space
            , Str "the"
            , Space
            , Str "extension"
            , Space
            , Str "is"
            , Space
            , Str "enabled"
            , Space
            , Str "and"
            , Space
            , Str "only"
            , Space
            , Str "instructions"
            , Space
            , Str "in"
            , Space
            , Str "the"
            , Space
            , Str "subset"
            , SoftBreak
            , Str "are"
            , Space
            , Str "used,"
            , Space
            , Str "data-independent"
            , Space
            , Str "execution"
            , Space
            , Str "time"
            , Space
            , Str "is"
            , Space
            , Str "guaranteed."
            ]
        ]
      ]
  , Para
      [ Str "At"
      , Space
      , Str "the"
      , Space
      , Str "moment,"
      , Space
      , Str "we"
      , Space
      , Str "do"
      , Space
      , Str "not"
      , Space
      , Str "know"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "compiler"
      , Space
      , Str "implementation"
      , Space
      , Str "that"
      , Space
      , Str "actively"
      , Space
      , Str "helps"
      , SoftBreak
      , Str "to"
      , Space
      , Str "guarantee"
      , Space
      , Str "both"
      , Space
      , Str "(a)"
      , Space
      , Str "and"
      , Space
      , Str "(b)."
      ]
  , Para
      [ Str "Using"
      , Space
      , Str "compiler"
      , Space
      , Str "techniques"
      , Space
      , Str "to"
      , Space
      , Str "transform"
      , Space
      , Str "a"
      , Space
      , Str "function"
      , Space
      , Str "such"
      , Space
      , Str "that"
      , Space
      , Str "it"
      , Space
      , Str "respects"
      , Space
      , Str "property"
      , SoftBreak
      , Str "(a)"
      , Space
      , Str "is"
      , Space
      , Str "an"
      , Space
      , Str "active"
      , Space
      , Str "research"
      , Space
      , Str "area."
      , Space
      , Cite
          [ Citation
              { citationId = "Wu2018"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 68
              , citationHash = 0
              }
          ]
          [ Str "[@Wu2018]" ]
      , Space
      , Str "provides"
      , Space
      , Str "a"
      , Space
      , Str "method"
      , Space
      , Str "to"
      , Space
      , Str "convert"
      , Space
      , Str "a"
      , Space
      , Str "program"
      , SoftBreak
      , Str "such"
      , Space
      , Str "that"
      , Space
      , Str "it"
      , Space
      , Str "respects"
      , Space
      , Str "property"
      , Space
      , Str "(a),"
      , Space
      , Str "albeit"
      , Space
      , Str "by"
      , Space
      , Str "potentially"
      , Space
      , Str "introducing"
      , Space
      , Str "unsafe"
      , SoftBreak
      , Str "memory"
      , Space
      , Str "accesses."
      , Space
      , Cite
          [ Citation
              { citationId = "Soares2021"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 69
              , citationHash = 0
              }
          ]
          [ Str "[@Soares2021]" ]
      , Space
      , Str "improves"
      , Space
      , Str "on"
      , Space
      , Str "that"
      , Space
      , Str "result"
      , Space
      , Str "by"
      , Space
      , Str "not"
      , Space
      , Str "introducing"
      , Space
      , Str "unsafe"
      , SoftBreak
      , Str "memory"
      , Space
      , Str "accesses,"
      , Space
      , Str "albeit"
      , Space
      , Str "by"
      , Space
      , Str "potentially"
      , Space
      , Str "needing"
      , Space
      , Str "to"
      , Space
      , Str "change"
      , Space
      , Str "the"
      , Space
      , Str "interface"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , SoftBreak
      , Str "transformed"
      , Space
      , Str "function."
      , Span
          ( "" , [ "todo" ] , [] )
          [ Str "Also"
          , Space
          , Str "discuss"
          , Space
          , Str "the"
          , Space
          , Str "techniques"
          , Space
          , Str "implemented"
          , Space
          , Str "in"
          , Space
          , Str "the"
          , SoftBreak
          , Link
              ( "" , [] , [] )
              [ Str "Constatine" , Space , Str "compiler" ]
              ( "https://github.com/pietroborrello/constantine" , "" )
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "172" ]
          ]
      , SoftBreak
      , Span
          ( "" , [ "todo" ] , [] )
          [ Str "Also"
          , Space
          , Str "discuss"
          , Space
          , Str "the"
          , Space
          , Str "Jasmin"
          , Space
          , Str "language"
          , Space
          , Str "and"
          , Space
          , Str "compiler"
          , SoftBreak
          , Link
              ( "" , [] , [] )
              [ Str "1" ]
              ( "https://members.loria.fr/VLaporte/files/CCS2021_StructuredLeakage.pdf"
              , ""
              )
          , SoftBreak
          , Link
              ( "" , [] , [] )
              [ Str "2" ]
              ( "https://dl.acm.org/doi/10.1145/3548606.3560689" , "" )
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "213" ]
          ]
      ]
  , Para
      [ Str "A"
      , Space
      , Str "great"
      , Space
      , Str "reference"
      , Space
      , Str "giving"
      , Space
      , Str "practical"
      , Space
      , Str "advice"
      , Space
      , Str "on"
      , Space
      , Str "how"
      , Space
      , Str "to"
      , Space
      , Str "achieve"
      , Space
      , Str "(a),"
      , Space
      , Str "(b)"
      , Space
      , Str "and"
      , Space
      , Str "more"
      , SoftBreak
      , Str "security"
      , Space
      , Str "hardening"
      , Space
      , Str "properties"
      , Space
      , Str "specific"
      , Space
      , Str "for"
      , Space
      , Str "cryptographic"
      , Space
      , Str "kernels"
      , Space
      , Str "is"
      , Space
      , Str "found"
      , Space
      , Str "in"
      , SoftBreak
      , Cite
          [ Citation
              { citationId = "Pornin2018"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 70
              , citationHash = 0
              }
          ]
          [ Str "[@Pornin2018]" ]
      , Str "."
      ]
  , Para
      [ Str "As"
      , Space
      , Str "discussed"
      , Space
      , Str "in"
      , Space
      , Cite
          [ Citation
              { citationId = "Pornin2018"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 71
              , citationHash = 0
              }
          ]
          [ Str "[@Pornin2018]" ]
      , Str ","
      , Space
      , Str "when"
      , Space
      , Str "implementing"
      , Space
      , Str "cryptographic"
      , Space
      , Str "algorithms,"
      , Space
      , Str "you"
      , SoftBreak
      , Str "also"
      , Space
      , Str "need"
      , Space
      , Str "to"
      , Space
      , Str "keep"
      , Space
      , Str "cache"
      , Space
      , Str "side-channel"
      , Space
      , Str "attacks"
      , Space
      , Str "in"
      , Space
      , Str "mind,"
      , Space
      , Str "which"
      , Space
      , Str "are"
      , Space
      , Str "discussed"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "section"
          , Space
          , Str "on"
          , Space
          , Str "cache"
          , Space
          , Str "side-channel"
          , Space
          , Str "attacks"
          ]
          ( "#cache-side-channel-attacks" , "" )
      , Str "."
      ]
  , Header
      2
      ( "cache-side-channels" , [] , [] )
      [ Str "Cache" , Space , Str "side-channels" ]
  , Para
      [ Link
          ( "" , [] , [] )
          [ Str "Caches" ]
          ( "https://en.wikipedia.org/wiki/Cache_(computing)" , "" )
      , RawInline (Format "tex") "\\index{cache}"
      , Space
      , Str "are"
      , Space
      , Str "used"
      , SoftBreak
      , Str "in"
      , Space
      , Str "almost"
      , Space
      , Str "every"
      , Space
      , Str "computing"
      , Space
      , Str "system."
      , Space
      , Str "They"
      , Space
      , Str "are"
      , Space
      , Str "small"
      , Space
      , Str "memories"
      , Space
      , Str "that"
      , Space
      , Str "are"
      , Space
      , Str "much"
      , Space
      , Str "faster"
      , SoftBreak
      , Str "than"
      , Space
      , Str "the"
      , Space
      , Str "main"
      , Space
      , Str "memory."
      , Space
      , Str "They"
      , Space
      , Str "automatically"
      , Space
      , Str "keep"
      , Space
      , Str "the"
      , Space
      , Str "most"
      , Space
      , Str "frequently"
      , Space
      , Str "used"
      , Space
      , Str "data,"
      , Space
      , Str "so"
      , SoftBreak
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "average"
      , Space
      , Str "memory"
      , Space
      , Str "access"
      , Space
      , Str "time"
      , Space
      , Str "improves."
      ]
  , Para
      [ Str "When"
      , Space
      , Str "processes"
      , Space
      , Str "share"
      , Space
      , Str "a"
      , Space
      , Str "cache,"
      , Space
      , Str "various"
      , Space
      , Str "techniques"
      , Space
      , Str "exist"
      , Space
      , Str "to"
      , Space
      , Str "establish"
      , Space
      , Str "a"
      , Space
      , Str "covert"
      , SoftBreak
      , Str "communication"
      , Space
      , Str "channel."
      , Space
      , Str "These"
      , Space
      , Str "let"
      , Space
      , Str "the"
      , Space
      , Str "processes"
      , Space
      , Str "communicate"
      , Space
      , Str "through"
      , Space
      , Str "memory"
      , SoftBreak
      , Str "accesses"
      , Space
      , Str "even"
      , Space
      , Str "when"
      , Space
      , Str "they"
      , Space
      , Str "do"
      , Space
      , Str "not"
      , Space
      , Str "share"
      , Space
      , Str "any"
      , Space
      , Str "memory"
      , Space
      , Str "location."
      , Space
      , Str "We"
      , Space
      , Str "first"
      , Space
      , Str "describe"
      , Space
      , Str "how"
      , SoftBreak
      , Str "caches"
      , Space
      , Str "work"
      , Space
      , Str "before"
      , Space
      , Str "exploring"
      , Space
      , Str "these"
      , Space
      , Str "techniques."
      ]
  , Header
      3
      ( "typical-cpu-cache-architecture" , [] , [] )
      [ Str "Typical"
      , Space
      , Str "CPU"
      , Space
      , Str "cache"
      , Space
      , Str "architecture"
      ]
  , Para
      [ Str "There"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "wide"
      , Space
      , Str "variety"
      , Space
      , Str "in"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "CPU"
          , Space
          , Str "cache"
          , Space
          , Str "micro-architecture"
          ]
          ( "https://en.wikipedia.org/wiki/CPU_cache" , "" )
      , Space
      , Str "details,"
      , SoftBreak
      , Str "but"
      , Space
      , Str "the"
      , Space
      , Str "main"
      , Space
      , Str "characteristics"
      , Space
      , Str "that"
      , Space
      , Str "are"
      , Space
      , Str "important"
      , Space
      , Str "to"
      , Space
      , Str "set"
      , Space
      , Str "up"
      , Space
      , Str "a"
      , Space
      , Str "covert"
      , Space
      , Str "channel"
      , Space
      , Str "tend"
      , SoftBreak
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "similar"
      , Space
      , Str "across"
      , Space
      , Str "most"
      , Space
      , Str "popular"
      , Space
      , Str "implementations."
      ]
  , Para
      [ Str "Caches"
      , Space
      , Str "are"
      , Space
      , Str "small"
      , Space
      , Str "and"
      , Space
      , Str "much"
      , Space
      , Str "faster"
      , Space
      , Str "memories"
      , Space
      , Str "than"
      , Space
      , Str "the"
      , Space
      , Str "main"
      , Space
      , Str "memory"
      , Space
      , Str "that"
      , Space
      , Str "aim"
      , Space
      , Str "to"
      , Space
      , Str "keep"
      , SoftBreak
      , Str "a"
      , Space
      , Str "copy"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "data"
      , Space
      , Str "at"
      , Space
      , Str "the"
      , Space
      , Str "most"
      , Space
      , Str "frequently"
      , Space
      , Str "accessed"
      , Space
      , Str "main"
      , Space
      , Str "memory"
      , Space
      , Str "addresses."
      , Space
      , Str "The"
      , SoftBreak
      , Str "set"
      , Space
      , Str "of"
      , Space
      , Str "addresses"
      , Space
      , Str "that"
      , Space
      , Str "are"
      , Space
      , Str "used"
      , Space
      , Str "most"
      , Space
      , Str "frequently"
      , Space
      , Str "changes"
      , Space
      , Str "quickly"
      , Space
      , Str "over"
      , Space
      , Str "time"
      , Space
      , Str "as"
      , Space
      , Str "a"
      , SoftBreak
      , Str "program"
      , Space
      , Str "executes."
      , Space
      , Str "Therefore,"
      , Space
      , Str "the"
      , Space
      , Str "addresses"
      , Space
      , Str "that"
      , Space
      , Str "are"
      , Space
      , Str "present"
      , Space
      , Str "in"
      , Space
      , Str "CPU"
      , Space
      , Str "caches"
      , Space
      , Str "also"
      , SoftBreak
      , Str "evolve"
      , Space
      , Str "quickly"
      , Space
      , Str "over"
      , Space
      , Str "time."
      , Space
      , Str "The"
      , Space
      , Str "content"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "cache"
      , Space
      , Str "may"
      , Space
      , Str "change"
      , Space
      , Str "with"
      , Space
      , Str "every"
      , SoftBreak
      , Str "executed"
      , Space
      , Str "read"
      , Space
      , Str "or"
      , Space
      , Str "write"
      , Space
      , Str "instruction."
      ]
  , Para
      [ Str "On"
      , Space
      , Str "every"
      , Space
      , Str "read"
      , Space
      , Str "and"
      , Space
      , Str "write"
      , Space
      , Str "instruction,"
      , Space
      , Str "the"
      , Space
      , Str "cache"
      , Space
      , Str "micro-architecture"
      , Space
      , Str "looks"
      , Space
      , Str "up"
      , Space
      , Str "if"
      , SoftBreak
      , Str "the"
      , Space
      , Str "data"
      , Space
      , Str "for"
      , Space
      , Str "the"
      , Space
      , Str "requested"
      , Space
      , Str "address"
      , Space
      , Str "happens"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "present"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "cache."
      , Space
      , Str "If"
      , Space
      , Str "it"
      , Space
      , Str "is,"
      , SoftBreak
      , Str "the"
      , Space
      , Str "CPU"
      , Space
      , Str "can"
      , Space
      , Str "continue"
      , Space
      , Str "executing"
      , Space
      , Str "quickly;"
      , Space
      , Str "if"
      , Space
      , Str "not,"
      , Space
      , Str "dependent"
      , Space
      , Str "operations"
      , Space
      , Str "will"
      , Space
      , Str "have"
      , SoftBreak
      , Str "to"
      , Space
      , Str "wait"
      , Space
      , Str "until"
      , Space
      , Str "the"
      , Space
      , Str "data"
      , Space
      , Str "returns"
      , Space
      , Str "from"
      , Space
      , Str "the"
      , Space
      , Str "slower"
      , Space
      , Str "main"
      , Space
      , Str "memory."
      , Space
      , Str "A"
      , Space
      , Str "typical"
      , Space
      , Str "access"
      , SoftBreak
      , Str "time"
      , Space
      , Str "is"
      , Space
      , Str "3"
      , Space
      , Str "to"
      , Space
      , Str "5"
      , Space
      , Str "CPU"
      , Space
      , Str "cycles"
      , Space
      , Str "for"
      , Space
      , Str "the"
      , Space
      , Str "fastest"
      , Space
      , Str "cache"
      , Space
      , Str "on"
      , Space
      , Str "a"
      , Space
      , Str "CPU"
      , Space
      , Str "versus"
      , Space
      , Str "hundreds"
      , Space
      , Str "of"
      , SoftBreak
      , Str "cycles"
      , Space
      , Str "for"
      , Space
      , Str "a"
      , Space
      , Str "main"
      , Space
      , Str "memory"
      , Space
      , Str "access."
      , RawInline (Format "tex") "\\index{memory access time}"
      , Space
      , Str "When"
      , Space
      , Str "data"
      , Space
      , Str "is"
      , Space
      , Str "present"
      , SoftBreak
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "cache"
      , Space
      , Str "for"
      , Space
      , Str "a"
      , Space
      , Str "read"
      , Space
      , Str "or"
      , Space
      , Str "write,"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , Space
      , Str "said"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "a"
      , Space
      , Strong [ Str "cache" , Space , Str "hit" ]
      , RawInline (Format "tex") "\\index{cache\nhit}"
      , Str "."
      , Space
      , Str "Otherwise,"
      , Space
      , Str "it\8217s"
      , Space
      , Str "called"
      , Space
      , Str "a"
      , Space
      , Strong [ Str "cache" , Space , Str "miss" ]
      , RawInline (Format "tex") "\\index{cache miss}"
      , Str "."
      ]
  , Para
      [ Str "Most"
      , Space
      , Str "systems"
      , Space
      , Str "have"
      , Space
      , Str "multiple"
      , Space
      , Str "levels"
      , Space
      , Str "of"
      , Space
      , Str "cache"
      , RawInline (Format "tex") "\\index{multi-level cache}"
      , Str ","
      , Space
      , Str "each"
      , Space
      , Str "with"
      , Space
      , Str "a"
      , SoftBreak
      , Str "different"
      , Space
      , Str "trade-off"
      , Space
      , Str "between"
      , Space
      , Str "cache"
      , Space
      , Str "size"
      , RawInline (Format "tex") "\\index{cache size}"
      , Space
      , Str "and"
      , Space
      , Str "access"
      , SoftBreak
      , Str "time"
      , RawInline (Format "tex") "\\index{cache access time}"
      , Str "."
      , Space
      , Str "Some"
      , Space
      , Str "typical"
      , Space
      , Str "characteristics"
      , Space
      , Str "might"
      , Space
      , Str "be:"
      ]
  , BulletList
      [ [ Plain
            [ Str "L1"
            , Space
            , Str "(level"
            , Space
            , Str "1)"
            , Space
            , Str "cache,"
            , Space
            , Str "32KB"
            , Space
            , Str "in"
            , Space
            , Str "size,"
            , Space
            , Str "with"
            , Space
            , Str "an"
            , Space
            , Str "access"
            , Space
            , Str "time"
            , Space
            , Str "of"
            , Space
            , Str "4"
            , Space
            , Str "cycles."
            ]
        ]
      , [ Plain
            [ Str "L2"
            , Space
            , Str "cache,"
            , Space
            , Str "256KB"
            , Space
            , Str "in"
            , Space
            , Str "size,"
            , Space
            , Str "with"
            , Space
            , Str "an"
            , Space
            , Str "access"
            , Space
            , Str "time"
            , Space
            , Str "of"
            , Space
            , Str "10"
            , Space
            , Str "cycles."
            ]
        ]
      , [ Plain
            [ Str "L3"
            , Space
            , Str "cache,"
            , Space
            , Str "16MB"
            , Space
            , Str "in"
            , Space
            , Str "size,"
            , Space
            , Str "with"
            , Space
            , Str "an"
            , Space
            , Str "access"
            , Space
            , Str "time"
            , Space
            , Str "of"
            , Space
            , Str "40"
            , Space
            , Str "cycles."
            ]
        ]
      , [ Plain
            [ Str "Main"
            , Space
            , Str "memory,"
            , Space
            , Str "gigabytes"
            , Space
            , Str "in"
            , Space
            , Str "size,"
            , Space
            , Str "with"
            , Space
            , Str "an"
            , Space
            , Str "access"
            , Space
            , Str "time"
            , Space
            , Str "of"
            , Space
            , Str "more"
            , Space
            , Str "than"
            , Space
            , Str "100"
            , Space
            , Str "cycles."
            ]
        ]
      ]
  , Figure
      ( "" , [] , [] )
      (Caption
         Nothing
         [ Plain
             [ Str "Illustration"
             , Space
             , Str "of"
             , Space
             , Str "cache"
             , Space
             , Str "levels"
             , Space
             , Str "in"
             , Space
             , Str "a"
             , Space
             , Str "typical"
             , Space
             , Str "system"
             ]
         ])
      [ Plain
          [ Image
              ( "" , [] , [ ( "width" , "40%" ) ] )
              [ Str "Illustration"
              , Space
              , Str "of"
              , Space
              , Str "cache"
              , Space
              , Str "levels"
              , Space
              , Str "in"
              , Space
              , Str "a"
              , Space
              , Str "typical"
              , Space
              , Str "system"
              ]
              ( "img/CacheLevels" , "" )
          ]
      ]
  , Para
      [ Str "If"
      , Space
      , Str "data"
      , Space
      , Str "is"
      , Space
      , Str "not"
      , Space
      , Str "already"
      , Space
      , Str "present"
      , Space
      , Str "in"
      , Space
      , Str "a"
      , Space
      , Str "cache"
      , Space
      , Str "layer,"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , Space
      , Str "typically"
      , Space
      , Str "stored"
      , Space
      , Str "there"
      , SoftBreak
      , Str "after"
      , Space
      , Str "it"
      , Space
      , Str "has"
      , Space
      , Str "been"
      , Space
      , Str "fetched"
      , Space
      , Str "from"
      , Space
      , Str "a"
      , Space
      , Str "slower"
      , Space
      , Str "cache"
      , Space
      , Str "level"
      , Space
      , Str "or"
      , Space
      , Str "main"
      , Space
      , Str "memory."
      , Space
      , Str "This"
      , Space
      , Str "is"
      , SoftBreak
      , Str "often"
      , Space
      , Str "a"
      , Space
      , Str "good"
      , Space
      , Str "decision"
      , Space
      , Str "to"
      , Space
      , Str "make"
      , Space
      , Str "as"
      , Space
      , Str "there\8217s"
      , Space
      , Str "a"
      , Space
      , Str "high"
      , Space
      , Str "likelihood"
      , Space
      , Str "the"
      , Space
      , Str "same"
      , Space
      , Str "address"
      , Space
      , Str "will"
      , SoftBreak
      , Str "be"
      , Space
      , Str "accessed"
      , Space
      , Str "by"
      , Space
      , Str "the"
      , Space
      , Str "program"
      , Space
      , Str "soon"
      , Space
      , Str "after."
      , Space
      , Str "This"
      , Space
      , Str "high"
      , Space
      , Str "likelihood"
      , Space
      , Str "is"
      , Space
      , Str "known"
      , Space
      , Str "as"
      , Space
      , Str "the"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "principle"
          , Space
          , Str "of"
          , Space
          , Str "locality"
          ]
          ( "https://en.wikipedia.org/wiki/Locality_of_reference"
          , ""
          )
      , RawInline (Format "tex") "\\index{principle\nof locality}"
      , RawInline (Format "tex") "\\index{locality of reference}"
      , Str "."
      ]
  , Para
      [ Str "Data"
      , Space
      , Str "is"
      , Space
      , Str "stored"
      , Space
      , Str "and"
      , Space
      , Str "transferred"
      , Space
      , Str "between"
      , Space
      , Str "cache"
      , Space
      , Str "levels"
      , Space
      , Str "in"
      , Space
      , Str "blocks"
      , Space
      , Str "of"
      , Space
      , Str "aligned"
      , Space
      , Str "memory."
      , SoftBreak
      , Str "Such"
      , Space
      , Str "a"
      , Space
      , Str "block"
      , Space
      , Str "is"
      , Space
      , Str "called"
      , Space
      , Str "a"
      , Space
      , Strong [ Str "cache" , Space , Str "block" ]
      , RawInline (Format "tex") "\\index{cache block}"
      , Space
      , Str "or"
      , Space
      , Strong [ Str "cache" , SoftBreak , Str "line" ]
      , RawInline (Format "tex") "\\index{cache line}"
      , Str "."
      , Space
      , Str "Typical"
      , Space
      , Str "sizes"
      , Space
      , Str "are"
      , Space
      , Str "32,"
      , Space
      , Str "64"
      , Space
      , Str "or"
      , Space
      , Str "128"
      , Space
      , Str "bytes"
      , Space
      , Str "per"
      , Space
      , Str "cache"
      , Space
      , Str "line."
      ]
  , Para
      [ Str "When"
      , Space
      , Str "data"
      , Space
      , Str "that"
      , Space
      , Str "wasn\8217t"
      , Space
      , Str "previously"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "cache"
      , Space
      , Str "needs"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "stored"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "cache,"
      , SoftBreak
      , Str "room"
      , Space
      , Str "has"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "made"
      , Space
      , Str "for"
      , Space
      , Str "it"
      , Space
      , Str "by"
      , Space
      , Str "removing,"
      , Space
      , Str "or"
      , Space
      , Strong [ Str "evicting" ]
      , RawInline (Format "tex") "\\index{cache eviction}"
      , Str ","
      , SoftBreak
      , Str "some"
      , Space
      , Str "other"
      , Space
      , Str "address/data"
      , Space
      , Str "from"
      , Space
      , Str "it."
      , Space
      , Str "How"
      , Space
      , Str "that"
      , Space
      , Str "choice"
      , Space
      , Str "gets"
      , Space
      , Str "made"
      , Space
      , Str "is"
      , Space
      , Str "decided"
      , Space
      , Str "by"
      , Space
      , Str "the"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "cache"
          , Space
          , Str "replacement"
          , Space
          , Str "policy"
          ]
          ( "https://en.wikipedia.org/wiki/Cache_replacement_policies"
          , ""
          )
      , RawInline
          (Format "tex") "\\index{cache\nreplacement policy}"
      , Str "."
      , Space
      , Str "Popular"
      , Space
      , Str "replacement"
      , Space
      , Str "algorithms"
      , Space
      , Str "are"
      , Space
      , Str "Least"
      , Space
      , Str "Recently"
      , Space
      , Str "Used"
      , SoftBreak
      , Str "(LRU)"
      , RawInline (Format "tex") "\\index{LRU replacement policy}"
      , Str ","
      , Space
      , Str "Random"
      , RawInline
          (Format "tex") "\\index{random replacement policy}"
      , Space
      , Str "and"
      , SoftBreak
      , Str "pseudo-LRU"
      , RawInline
          (Format "tex") "\\index{pseudo-LRU replacement policy}"
      , Str "."
      , Space
      , Str "As"
      , Space
      , Str "the"
      , Space
      , Str "names"
      , Space
      , Str "suggest,"
      , Space
      , Str "LRU"
      , SoftBreak
      , Str "evicts"
      , Space
      , Str "the"
      , Space
      , Str "cache"
      , Space
      , Str "line"
      , Space
      , Str "that"
      , Space
      , Str "is"
      , Space
      , Str "least"
      , Space
      , Str "recently"
      , Space
      , Str "used;"
      , Space
      , Str "random"
      , Space
      , Str "picks"
      , Space
      , Str "a"
      , Space
      , Str "random"
      , Space
      , Str "cache"
      , SoftBreak
      , Str "line;"
      , Space
      , Str "and"
      , Space
      , Str "pseudo-LRU"
      , Space
      , Str "approximates"
      , Space
      , Str "choosing"
      , Space
      , Str "the"
      , Space
      , Str "least"
      , Space
      , Str "recently"
      , Space
      , Str "used"
      , Space
      , Str "line."
      ]
  , Para
      [ Str "If"
      , Space
      , Str "a"
      , Space
      , Str "cache"
      , Space
      , Str "line"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "stored"
      , Space
      , Str "in"
      , Space
      , Str "all"
      , Space
      , Str "locations"
      , Space
      , Str "available"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "cache,"
      , Space
      , Str "the"
      , Space
      , Str "cache"
      , SoftBreak
      , Str "is"
      , Space
      , Strong [ Str "fully-associative" ]
      , RawInline
          (Format "tex") "\\index{fully-associative cache}"
      , Str "."
      , Space
      , Str "Most"
      , Space
      , Str "caches"
      , Space
      , Str "are"
      , Space
      , Str "however"
      , SoftBreak
      , Str "not"
      , Space
      , Str "fully-associative,"
      , Space
      , Str "as"
      , Space
      , Str "it\8217s"
      , Space
      , Str "too"
      , Space
      , Str "costly"
      , Space
      , Str "to"
      , Space
      , Str "implement."
      , Space
      , Str "Instead,"
      , Space
      , Str "most"
      , Space
      , Str "caches"
      , Space
      , Str "are"
      , SoftBreak
      , Strong [ Str "set-associative" ]
      , RawInline (Format "tex") "\\index{set-associative cache}"
      , Str "."
      , Space
      , Str "In"
      , Space
      , Str "an"
      , Space
      , Str "N-way"
      , Space
      , Str "set-associative"
      , SoftBreak
      , Str "cache,"
      , Space
      , Str "a"
      , Space
      , Str "specific"
      , Space
      , Str "line"
      , Space
      , Str "can"
      , Space
      , Str "only"
      , Space
      , Str "be"
      , Space
      , Str "stored"
      , Space
      , Str "in"
      , Space
      , Str "one"
      , Space
      , Str "of"
      , Space
      , Str "N"
      , Space
      , Str "cache"
      , Space
      , Str "locations."
      , Space
      , Str "For"
      , SoftBreak
      , Str "example,"
      , Space
      , Str "if"
      , Space
      , Str "a"
      , Space
      , Str "line"
      , Space
      , Str "can"
      , Space
      , Str "potentially"
      , Space
      , Str "be"
      , Space
      , Str "stored"
      , Space
      , Str "in"
      , Space
      , Str "one"
      , Space
      , Str "of"
      , Space
      , Str "2"
      , Space
      , Str "locations,"
      , Space
      , Str "the"
      , Space
      , Str "cache"
      , Space
      , Str "is"
      , SoftBreak
      , Str "said"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "2-way"
      , Space
      , Str "set-associative."
      , Space
      , Str "If"
      , Space
      , Str "it"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "stored"
      , Space
      , Str "in"
      , Space
      , Str "one"
      , Space
      , Str "of"
      , Space
      , Str "4"
      , Space
      , Str "locations,"
      , SoftBreak
      , Str "it\8217s"
      , Space
      , Str "called"
      , Space
      , Str "4-way"
      , Space
      , Str "set-associative,"
      , Space
      , Str "and"
      , Space
      , Str "so"
      , Space
      , Str "on."
      , Space
      , Str "When"
      , Space
      , Str "an"
      , Space
      , Str "address"
      , Space
      , Str "can"
      , Space
      , Str "only"
      , Space
      , Str "be"
      , Space
      , Str "stored"
      , SoftBreak
      , Str "in"
      , Space
      , Str "one"
      , Space
      , Str "location"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "cache,"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , Space
      , Str "said"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , SoftBreak
      , Strong [ Str "direct-mapped" ]
      , RawInline (Format "tex") "\\index{direct-mapped cache}"
      , Str ","
      , Space
      , Str "rather"
      , Space
      , Str "than"
      , Space
      , Str "1-way"
      , Space
      , Str "set-associative."
      , SoftBreak
      , Str "Typical"
      , Space
      , Str "organizations"
      , Space
      , Str "are"
      , Space
      , Str "direct-mapped,"
      , Space
      , Str "2-way,"
      , Space
      , Str "4-way,"
      , Space
      , Str "8-way,"
      , Space
      , Str "16-way"
      , Space
      , Str "or"
      , Space
      , Str "32-way"
      , SoftBreak
      , Str "set-associative."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "set"
      , Space
      , Str "of"
      , Space
      , Str "cache"
      , Space
      , Str "locations"
      , Space
      , Str "that"
      , Space
      , Str "a"
      , Space
      , Str "particular"
      , Space
      , Str "cache"
      , Space
      , Str "line"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "stored"
      , Space
      , Str "at"
      , Space
      , Str "is"
      , SoftBreak
      , Str "called"
      , Space
      , Str "a"
      , Space
      , Strong [ Str "cache" , Space , Str "set" ]
      , RawInline (Format "tex") "\\index{cache set}"
      , Str "."
      ]
  , Header
      4
      ( "indexing-in-a-set-associative-cache" , [] , [] )
      [ Str "Indexing"
      , Space
      , Str "in"
      , Space
      , Str "a"
      , Space
      , Str "set-associative"
      , Space
      , Str "cache"
      ]
  , Para
      [ Str "For"
      , Space
      , Str "some"
      , Space
      , Str "cache"
      , Space
      , Str "covert"
      , Space
      , Str "channels,"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , Space
      , Str "essential"
      , Space
      , Str "to"
      , Space
      , Str "know"
      , Space
      , Str "exactly"
      , Space
      , Str "how"
      , Space
      , Str "a"
      , Space
      , Str "memory"
      , SoftBreak
      , Str "address"
      , Space
      , Str "maps"
      , Space
      , Str "to"
      , Space
      , Str "a"
      , Space
      , Str "specific"
      , Space
      , Str "cache"
      , Space
      , Str "set."
      ]
  , Figure
      ( "fig:cache-indexing" , [] , [] )
      (Caption
         Nothing
         [ Plain
             [ Str "Illustration"
             , Space
             , Str "of"
             , Space
             , Str "indexing"
             , Space
             , Str "into"
             , Space
             , Str "a"
             , Space
             , Str "set-associative"
             , Space
             , Str "cache."
             , SoftBreak
             , Str "In"
             , Space
             , Str "this"
             , Space
             , Str "example:"
             , SoftBreak
             , Math InlineMath "L"
             , Space
             , Str "="
             , Space
             , Str "6"
             , Space
             , Str "bits,"
             , Space
             , Str "hence"
             , Space
             , Str "the"
             , Space
             , Str "cache"
             , Space
             , Str "line"
             , Space
             , Str "size"
             , Space
             , Str "is"
             , Space
             , Math InlineMath "2^6=64"
             , Space
             , Str "bytes."
             , SoftBreak
             , Math InlineMath "S"
             , Space
             , Str "="
             , Space
             , Str "5"
             , Space
             , Str "bits,"
             , Space
             , Str "so"
             , Space
             , Str "there"
             , Space
             , Str "are"
             , Space
             , Math InlineMath "2^5=32"
             , Space
             , Str "cache"
             , Space
             , Str "sets."
             , SoftBreak
             , Math InlineMath "N"
             , Space
             , Str "can"
             , Space
             , Str "be"
             , Space
             , Str "independent"
             , Space
             , Str "of"
             , Space
             , Str "address"
             , Space
             , Str "bits"
             , Space
             , Str "used"
             , Space
             , Str "to"
             , Space
             , Str "index"
             , Space
             , Str "the"
             , Space
             , Str "cache."
             , Space
             , Str "If"
             , Space
             , Str "we"
             , SoftBreak
             , Str "assume"
             , Space
             , Math InlineMath "N=12"
             , Space
             , Str "for"
             , Space
             , Str "a"
             , Space
             , Str "12-way"
             , Space
             , Str "set-associative"
             , Space
             , Str "cache,"
             , Space
             , Str "the"
             , Space
             , Str "total"
             , Space
             , Str "cache"
             , Space
             , Str "size"
             , Space
             , Str "is"
             , SoftBreak
             , Math InlineMath "N*2^L*2^S=12*64*32=24"
             , Str "KB."
             ]
         ])
      [ Plain
          [ Image
              ( "" , [] , [ ( "width" , "100%" ) ] )
              [ Str "Illustration"
              , Space
              , Str "of"
              , Space
              , Str "indexing"
              , Space
              , Str "into"
              , Space
              , Str "a"
              , Space
              , Str "set-associative"
              , Space
              , Str "cache."
              , SoftBreak
              , Str "In"
              , Space
              , Str "this"
              , Space
              , Str "example:"
              , SoftBreak
              , Math InlineMath "L"
              , Space
              , Str "="
              , Space
              , Str "6"
              , Space
              , Str "bits,"
              , Space
              , Str "hence"
              , Space
              , Str "the"
              , Space
              , Str "cache"
              , Space
              , Str "line"
              , Space
              , Str "size"
              , Space
              , Str "is"
              , Space
              , Math InlineMath "2^6=64"
              , Space
              , Str "bytes."
              , SoftBreak
              , Math InlineMath "S"
              , Space
              , Str "="
              , Space
              , Str "5"
              , Space
              , Str "bits,"
              , Space
              , Str "so"
              , Space
              , Str "there"
              , Space
              , Str "are"
              , Space
              , Math InlineMath "2^5=32"
              , Space
              , Str "cache"
              , Space
              , Str "sets."
              , SoftBreak
              , Math InlineMath "N"
              , Space
              , Str "can"
              , Space
              , Str "be"
              , Space
              , Str "independent"
              , Space
              , Str "of"
              , Space
              , Str "address"
              , Space
              , Str "bits"
              , Space
              , Str "used"
              , Space
              , Str "to"
              , Space
              , Str "index"
              , Space
              , Str "the"
              , Space
              , Str "cache."
              , Space
              , Str "If"
              , Space
              , Str "we"
              , SoftBreak
              , Str "assume"
              , Space
              , Math InlineMath "N=12"
              , Space
              , Str "for"
              , Space
              , Str "a"
              , Space
              , Str "12-way"
              , Space
              , Str "set-associative"
              , Space
              , Str "cache,"
              , Space
              , Str "the"
              , Space
              , Str "total"
              , Space
              , Str "cache"
              , Space
              , Str "size"
              , Space
              , Str "is"
              , SoftBreak
              , Math InlineMath "N*2^L*2^S=12*64*32=24"
              , Str "KB."
              ]
              ( "img/CacheIndexing" , "" )
          ]
      ]
  , Para
      [ Str "Specific"
      , Space
      , Str "bits"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "memory"
      , Space
      , Str "address"
      , Space
      , Str "are"
      , Space
      , Str "used"
      , Space
      , Str "for"
      , Space
      , Str "different"
      , Space
      , Str "cache"
      , Space
      , Str "indexing"
      , SoftBreak
      , Str "purposes,"
      , Space
      , Str "as"
      , Space
      , Str "illustrated"
      , Space
      , Str "in"
      , Space
      , Str "figure"
      , Space
      , Cite
          [ Citation
              { citationId = "fig:cache-indexing"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = AuthorInText
              , citationNoteNum = 72
              , citationHash = 0
              }
          ]
          [ Str "@fig:cache-indexing" ]
      , Str "."
      , Space
      , Str "The"
      , Space
      , Str "least-significant"
      , SoftBreak
      , Math InlineMath "L"
      , Space
      , Str "bits,"
      , Space
      , Str "where"
      , Space
      , Math InlineMath "2^L"
      , Space
      , Str "is"
      , Space
      , Str "the"
      , Space
      , Str "cache"
      , Space
      , Str "line"
      , Space
      , Str "size,"
      , Space
      , Str "are"
      , Space
      , Str "used"
      , Space
      , Str "to"
      , Space
      , Str "compute"
      , Space
      , Str "an"
      , Space
      , Str "address\8217s"
      , SoftBreak
      , Str "offset"
      , Space
      , Str "within"
      , Space
      , Str "a"
      , Space
      , Str "cache"
      , Space
      , Str "line."
      , Space
      , Str "The"
      , Space
      , Str "next"
      , Space
      , Math InlineMath "S"
      , Space
      , Str "bits,"
      , Space
      , Str "where"
      , Space
      , Math InlineMath "2^S"
      , Space
      , Str "is"
      , Space
      , Str "the"
      , Space
      , Str "number"
      , Space
      , Str "of"
      , SoftBreak
      , Str "cache"
      , Space
      , Str "sets,"
      , Space
      , Str "are"
      , Space
      , Str "used"
      , Space
      , Str "to"
      , Space
      , Str "determine"
      , Space
      , Str "which"
      , Space
      , Str "cache"
      , Space
      , Str "set"
      , Space
      , Str "an"
      , Space
      , Str "address"
      , Space
      , Str "maps"
      , Space
      , Str "to."
      , Space
      , Str "The"
      , SoftBreak
      , Str "remaining"
      , Space
      , Str "top"
      , Space
      , Str "bits"
      , Space
      , Str "are"
      , Space
      , Quoted DoubleQuote [ Str "tag" , Space , Str "bits" ]
      , Str "."
      , Space
      , Str "They"
      , Space
      , Str "are"
      , Space
      , Str "stored"
      , Space
      , Str "alongside"
      , Space
      , Str "a"
      , Space
      , Str "line"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "cache"
      , SoftBreak
      , Str "so"
      , Space
      , Str "later"
      , Space
      , Str "operations"
      , Space
      , Str "can"
      , Space
      , Str "detect"
      , Space
      , Str "which"
      , Space
      , Str "specific"
      , Space
      , Str "memory"
      , Space
      , Str "address"
      , Space
      , Str "is"
      , Space
      , Str "replicated"
      , Space
      , Str "in"
      , SoftBreak
      , Str "that"
      , Space
      , Str "cache"
      , Space
      , Str "line."
      ]
  , Para
      [ Str "For"
      , Space
      , Str "direct-mapped"
      , Space
      , Str "and"
      , Space
      , Str "fully-associative"
      , Space
      , Str "caches,"
      , Space
      , Str "the"
      , Space
      , Str "mapping"
      , Space
      , Str "of"
      , Space
      , Str "an"
      , Space
      , Str "address"
      , Space
      , Str "to"
      , SoftBreak
      , Str "cache"
      , Space
      , Str "locations"
      , Space
      , Str "also"
      , Space
      , Str "works"
      , Space
      , Str "as"
      , Space
      , Str "described"
      , Space
      , Str "above."
      , Space
      , Str "In"
      , Space
      , Str "fully-associative"
      , Space
      , Str "caches"
      , Space
      , Str "the"
      , SoftBreak
      , Str "number"
      , Space
      , Str "of"
      , Space
      , Str "cache"
      , Space
      , Str "sets"
      , Space
      , Str "is"
      , Space
      , Str "1,"
      , Space
      , Str "so"
      , Space
      , Math InlineMath "S"
      , Str "=0."
      ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "Also"
          , Space
          , Str "explain"
          , Space
          , Str "cache"
          , Space
          , Str "coherency"
          , Space
          , RawInline (Format "tex") "\\index{cache coherency}"
          , Str "?"
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "173" ]
          ]
      ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "Also"
          , Space
          , Str "say"
          , Space
          , Str "something"
          , Space
          , Str "about"
          , Space
          , Str "TLBs"
          , Space
          , Str "and"
          , Space
          , Str "prefetching?"
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "174" ]
          ]
      ]
  , Header
      3
      ( "operation-of-cache-side-channels" , [] , [] )
      [ Str "Operation"
      , Space
      , Str "of"
      , Space
      , Str "cache"
      , Space
      , Str "side-channels"
      ]
  , Para
      [ Str "Cache"
      , Space
      , Str "side-channels"
      , Space
      , Str "typically"
      , Space
      , Str "work"
      , Space
      , Str "by"
      , Space
      , Str "the"
      , Space
      , Str "spy"
      , Space
      , Str "determining"
      , Space
      , Str "whether"
      , Space
      , Str "a"
      , Space
      , Str "memory"
      , SoftBreak
      , Str "access"
      , Space
      , Str "was"
      , Space
      , Str "a"
      , Space
      , Str "cache"
      , Space
      , Str "hit"
      , Space
      , Str "or"
      , Space
      , Str "a"
      , Space
      , Str "cache"
      , Space
      , Str "miss."
      , Space
      , Str "From"
      , Space
      , Str "that"
      , Space
      , Str "information,"
      , Space
      , Str "the"
      , Space
      , Str "spy"
      , Space
      , Str "may"
      , Space
      , Str "be"
      , SoftBreak
      , Str "able"
      , Space
      , Str "to"
      , Space
      , Str "deduce"
      , Space
      , Str "bits"
      , Space
      , Str "of"
      , Space
      , Str "data"
      , Space
      , Str "that"
      , Space
      , Str "only"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "should"
      , Space
      , Str "have"
      , Space
      , Str "access"
      , Space
      , Str "to."
      ]
  , Para
      [ Str "Let\8217s"
      , Space
      , Str "illustrate"
      , Space
      , Str "this"
      , Space
      , Str "by"
      , Space
      , Str "describing"
      , Space
      , Str "a"
      , Space
      , Str "few"
      , Space
      , Str "well-known"
      , Space
      , Str "cache"
      , Space
      , Str "side-channels:"
      ]
  , Header
      4 ( "flushreload" , [] , [] ) [ Str "Flush+Reload" ]
  , Para
      [ Str "In"
      , Space
      , Str "a"
      , Space
      , Str "so-called"
      , Space
      , Strong [ Str "Flush+Reload" ]
      , RawInline (Format "tex") "\\index{Flush+Reload}"
      , Space
      , Str "attack"
      , Cite
          [ Citation
              { citationId = "Yarom2014"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 73
              , citationHash = 0
              }
          ]
          [ Str "[@Yarom2014]" ]
      , Str ","
      , Space
      , Str "the"
      , Space
      , Str "spy"
      , SoftBreak
      , Str "process"
      , Space
      , Str "shares"
      , Space
      , Str "memory"
      , Space
      , Str "with"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "process."
      , Space
      , Str "The"
      , Space
      , Str "attack"
      , Space
      , Str "works"
      , Space
      , Str "in"
      , Space
      , Str "3"
      , Space
      , Str "steps:"
      ]
  , OrderedList
      ( 1 , Decimal , Period )
      [ [ Plain
            [ Str "The"
            , Space
            , Str "Flush"
            , Space
            , Str "step:"
            , Space
            , Str "The"
            , Space
            , Str "spy"
            , Space
            , Str "flushes"
            , Space
            , Str "a"
            , Space
            , Str "specific"
            , Space
            , Str "address"
            , Space
            , Str "from"
            , Space
            , Str "the"
            , Space
            , Str "cache."
            ]
        ]
      , [ Plain
            [ Str "The"
            , Space
            , Str "spy"
            , Space
            , Str "waits"
            , Space
            , Str "for"
            , Space
            , Str "some"
            , Space
            , Str "time"
            , Space
            , Str "to"
            , Space
            , Str "give"
            , Space
            , Str "the"
            , Space
            , Str "victim"
            , Space
            , Str "time"
            , Space
            , Str "to"
            , Space
            , Str "potentially"
            , Space
            , Str "access"
            , SoftBreak
            , Str "that"
            , Space
            , Str "address,"
            , Space
            , Str "resulting"
            , Space
            , Str "in"
            , Space
            , Str "bringing"
            , Space
            , Str "it"
            , Space
            , Str "back"
            , Space
            , Str "into"
            , Space
            , Str "the"
            , Space
            , Str "cache."
            ]
        ]
      , [ Plain
            [ Str "The"
            , Space
            , Str "Reload"
            , Space
            , Str "step:"
            , Space
            , Str "The"
            , Space
            , Str "spy"
            , Space
            , Str "accesses"
            , Space
            , Str "the"
            , Space
            , Str "address"
            , Space
            , Str "and"
            , Space
            , Str "measures"
            , Space
            , Str "the"
            , Space
            , Str "access"
            , Space
            , Str "time."
            , SoftBreak
            , Str "A"
            , Space
            , Str "short"
            , Space
            , Str "access"
            , Space
            , Str "time"
            , Space
            , Str "means"
            , Space
            , Str "the"
            , Space
            , Str "address"
            , Space
            , Str "is"
            , Space
            , Str "in"
            , Space
            , Str "the"
            , Space
            , Str "cache;"
            , Space
            , Str "a"
            , Space
            , Str "long"
            , Space
            , Str "access"
            , Space
            , Str "time"
            , SoftBreak
            , Str "means"
            , Space
            , Str "it\8217s"
            , Space
            , Str "not"
            , Space
            , Str "in"
            , Space
            , Str "the"
            , Space
            , Str "cache."
            , Space
            , Str "In"
            , Space
            , Str "other"
            , Space
            , Str "words,"
            , Space
            , Str "a"
            , Space
            , Str "short"
            , Space
            , Str "access"
            , Space
            , Str "time"
            , Space
            , Str "means"
            , Space
            , Str "that"
            , SoftBreak
            , Str "in"
            , Space
            , Str "step"
            , Space
            , Str "2"
            , Space
            , Str "the"
            , Space
            , Str "victim"
            , Space
            , Str "accessed"
            , Space
            , Str "the"
            , Space
            , Str "address;"
            , Space
            , Str "a"
            , Space
            , Str "long"
            , Space
            , Str "access"
            , Space
            , Str "time"
            , Space
            , Str "means"
            , Space
            , Str "it"
            , Space
            , Str "did"
            , SoftBreak
            , Str "not"
            , Space
            , Str "access"
            , Space
            , Str "the"
            , Space
            , Str "address."
            ]
        ]
      ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "Should"
          , Space
          , Str "there"
          , Space
          , Str "be"
          , Space
          , Str "a"
          , Space
          , Str "more"
          , Space
          , Str "elaborate"
          , Space
          , Str "example"
          , Space
          , Str "with"
          , Space
          , Str "code"
          , Space
          , Str "that"
          , SoftBreak
          , Str "demonstrates"
          , Space
          , Str "in"
          , Space
          , Str "more"
          , Space
          , Str "detail"
          , Space
          , Str "how"
          , Space
          , Str "a"
          , Space
          , Str "flush+reload"
          , Space
          , Str "attack"
          , Space
          , Str "works?"
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "175" ]
          ]
      ]
  , Para
      [ Str "Knowing"
      , Space
      , Str "if"
      , Space
      , Str "a"
      , Space
      , Str "victim"
      , Space
      , Str "accessed"
      , Space
      , Str "a"
      , Space
      , Str "specific"
      , Space
      , Str "address"
      , Space
      , Str "can"
      , Space
      , Str "leak"
      , Space
      , Str "sensitive"
      , Space
      , Str "information."
      , SoftBreak
      , Str "Such"
      , Space
      , Str "as"
      , Space
      , Str "when"
      , Space
      , Str "accessing"
      , Space
      , Str "a"
      , Space
      , Str "specific"
      , Space
      , Str "array"
      , Space
      , Str "element"
      , Space
      , Str "depends"
      , Space
      , Str "on"
      , Space
      , Str "whether"
      , Space
      , Str "a"
      , Space
      , Str "specific"
      , SoftBreak
      , Str "bit"
      , Space
      , Str "is"
      , Space
      , Str "set"
      , Space
      , Str "in"
      , Space
      , Str "secret"
      , Space
      , Str "data."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , Space
      , Cite
          [ Citation
              { citationId = "Yarom2014"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 74
              , citationHash = 0
              }
          ]
          [ Str "[@Yarom2014]" ]
      , Space
      , Str "demonstrates"
      , Space
      , Str "that"
      , Space
      , Str "a"
      , SoftBreak
      , Str "Flush+Reload"
      , Space
      , Str "attack"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "used"
      , Space
      , Str "to"
      , Space
      , Str "leak"
      , Space
      , Str "GnuPG"
      , Space
      , Str "private"
      , Space
      , Str "keys."
      ]
  , Header 4 ( "primeprobe" , [] , [] ) [ Str "Prime+Probe" ]
  , Para
      [ Str "In"
      , Space
      , Str "a"
      , Space
      , Strong [ Str "Prime+Probe" ]
      , Space
      , Str "attack"
      , RawInline (Format "tex") "\\index{Prime+Probe}"
      , Str ","
      , Space
      , Str "there"
      , Space
      , Str "is"
      , Space
      , Str "no"
      , Space
      , Str "need"
      , Space
      , Str "for"
      , Space
      , Str "memory"
      , Space
      , Str "to"
      , SoftBreak
      , Str "be"
      , Space
      , Str "shared"
      , Space
      , Str "between"
      , Space
      , Str "victim"
      , Space
      , Str "and"
      , Space
      , Str "spy."
      , Space
      , Str "The"
      , Space
      , Str "attack"
      , Space
      , Str "works"
      , Space
      , Str "in"
      , Space
      , Str "3"
      , Space
      , Str "steps:"
      ]
  , OrderedList
      ( 1 , Decimal , Period )
      [ [ Plain
            [ Str "The"
            , Space
            , Str "Prime"
            , Space
            , Str "step:"
            , Space
            , Str "The"
            , Space
            , Str "spy"
            , Space
            , Str "fills"
            , Space
            , Str "one"
            , Space
            , Str "or"
            , Space
            , Str "more"
            , Space
            , Str "cache"
            , Space
            , Str "sets"
            , Space
            , Str "with"
            , Space
            , Str "its"
            , Space
            , Str "data,"
            , Space
            , Str "for"
            , SoftBreak
            , Str "example,"
            , Space
            , Str "by"
            , Space
            , Str "accessing"
            , Space
            , Str "data"
            , Space
            , Str "that"
            , Space
            , Str "maps"
            , Space
            , Str "to"
            , Space
            , Str "those"
            , Space
            , Str "cache"
            , Space
            , Str "sets."
            ]
        ]
      , [ Plain
            [ Str "The"
            , Space
            , Str "spy"
            , Space
            , Str "waits"
            , Space
            , Str "for"
            , Space
            , Str "some"
            , Space
            , Str "time"
            , Space
            , Str "to"
            , Space
            , Str "let"
            , Space
            , Str "the"
            , Space
            , Str "victim"
            , Space
            , Str "potentially"
            , Space
            , Str "access"
            , Space
            , Str "data"
            , Space
            , Str "that"
            , SoftBreak
            , Str "maps"
            , Space
            , Str "to"
            , Space
            , Str "those"
            , Space
            , Str "same"
            , Space
            , Str "cache"
            , Space
            , Str "sets."
            ]
        ]
      , [ Plain
            [ Str "The"
            , Space
            , Str "Probe"
            , Space
            , Str "step:"
            , Space
            , Str "The"
            , Space
            , Str "spy"
            , Space
            , Str "accesses"
            , Space
            , Str "that"
            , Space
            , Str "same"
            , Space
            , Str "data"
            , Space
            , Str "as"
            , Space
            , Str "in"
            , Space
            , Str "the"
            , Space
            , Str "prime"
            , Space
            , Str "step."
            , SoftBreak
            , Str "Measuring"
            , Space
            , Str "the"
            , Space
            , Str "time"
            , Space
            , Str "it"
            , Space
            , Str "takes"
            , Space
            , Str "to"
            , Space
            , Str "load"
            , Space
            , Str "the"
            , Space
            , Str "data,"
            , Space
            , Str "it"
            , Space
            , Str "can"
            , Space
            , Str "derive"
            , Space
            , Str "how"
            , Space
            , Str "many"
            , Space
            , Str "cache"
            , SoftBreak
            , Str "lines"
            , Space
            , Str "the"
            , Space
            , Str "victim"
            , Space
            , Str "evicted"
            , Space
            , Str "from"
            , Space
            , Str "each"
            , Space
            , Str "cache"
            , Space
            , Str "set"
            , Space
            , Str "in"
            , Space
            , Str "step"
            , Space
            , Str "2,"
            , Space
            , Str "and"
            , Space
            , Str "from"
            , Space
            , Str "that"
            , SoftBreak
            , Str "derive"
            , Space
            , Str "information"
            , Space
            , Str "about"
            , Space
            , Str "addresses"
            , Space
            , Str "the"
            , Space
            , Str "victim"
            , Space
            , Str "accessed."
            ]
        ]
      ]
  , Para
      [ Cite
          [ Citation
              { citationId = "Osvik2005"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 75
              , citationHash = 0
              }
          ]
          [ Str "[@Osvik2005]" ]
      , Space
      , Str "first"
      , Space
      , Str "documented"
      , Space
      , Str "this"
      , Space
      , Str "technique"
      , Space
      , Str "in"
      , Space
      , Str "2005"
      , Space
      , Str "and"
      , Space
      , Str "demonstrates"
      , Space
      , Str "extracting"
      , SoftBreak
      , Str "AES"
      , Space
      , Str "keys"
      , Space
      , Str "in"
      , Space
      , Str "just"
      , Space
      , Str "a"
      , Space
      , Str "few"
      , Space
      , Str "milliseconds."
      ]
  , Header
      4
      ( "general-schema-for-cache-covert-channels" , [] , [] )
      [ Str "General"
      , Space
      , Str "schema"
      , Space
      , Str "for"
      , Space
      , Str "cache"
      , Space
      , Str "covert"
      , Space
      , Str "channels"
      ]
  , Para
      [ Str "An"
      , Space
      , Str "attentive"
      , Space
      , Str "reader"
      , Space
      , Str "may"
      , Space
      , Str "have"
      , Space
      , Str "noticed"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "attacks"
      , Space
      , Str "described"
      , Space
      , Str "above"
      , Space
      , Str "follow"
      , Space
      , Str "a"
      , SoftBreak
      , Str "similar"
      , Space
      , Str "3-step"
      , Space
      , Str "pattern."
      , Space
      , Cite
          [ Citation
              { citationId = "Weber2021"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 76
              , citationHash = 0
              }
          ]
          [ Str "[@Weber2021]" ]
      , Space
      , Str "describes"
      , Space
      , Str "this"
      , Space
      , Str "general"
      , Space
      , Str "pattern"
      , Space
      , Str "and"
      , Space
      , Str "uses"
      , Space
      , Str "it"
      , SoftBreak
      , Str "to"
      , Space
      , Str "automatically"
      , Space
      , Str "discover"
      , Space
      , Str "more"
      , Space
      , Str "side-channels"
      , Space
      , Str "that"
      , Space
      , Str "follow"
      , Space
      , Str "this"
      , Space
      , Str "3-step"
      , Space
      , Str "pattern."
      , SoftBreak
      , Str "They"
      , Space
      , Str "describe"
      , Space
      , Str "the"
      , Space
      , Str "general"
      , Space
      , Str "pattern"
      , Space
      , Str "as"
      , Space
      , Str "being:"
      ]
  , OrderedList
      ( 1 , Decimal , Period )
      [ [ Plain
            [ Str "An"
            , Space
            , Str "instruction"
            , Space
            , Str "sequence"
            , Space
            , Str "that"
            , Space
            , Str "resets"
            , Space
            , Str "the"
            , Space
            , Str "inner"
            , Space
            , Str "CPU"
            , Space
            , Str "state"
            , Space
            , Str "("
            , Strong [ Str "reset" , SoftBreak , Str "sequence" ]
            , Str ")."
            , RawInline (Format "tex") "\\index{reset sequence}"
            ]
        ]
      , [ Plain
            [ Str "An"
            , Space
            , Str "instruction"
            , Space
            , Str "sequence"
            , Space
            , Str "that"
            , Space
            , Str "triggers"
            , Space
            , Str "a"
            , Space
            , Str "state"
            , Space
            , Str "change"
            , Space
            , Str "("
            , Strong [ Str "trigger" , SoftBreak , Str "sequence" ]
            , Str ")."
            , RawInline (Format "tex") "\\index{trigger sequence}"
            ]
        ]
      , [ Plain
            [ Str "An"
            , Space
            , Str "instruction"
            , Space
            , Str "sequence"
            , Space
            , Str "that"
            , Space
            , Str "leaks"
            , Space
            , Str "the"
            , Space
            , Str "inner"
            , Space
            , Str "state"
            , Space
            , Str "("
            , Strong [ Str "measurement" , SoftBreak , Str "sequence" ]
            , Str ")."
            , RawInline (Format "tex") "\\index{measurement sequence}"
            ]
        ]
      ]
  , Para
      [ Str "Other"
      , Space
      , Str "cache-based"
      , Space
      , Str "side"
      , Space
      , Str "channel"
      , Space
      , Str "attacks"
      , Space
      , Str "following"
      , Space
      , Str "this"
      , Space
      , Str "general"
      , Space
      , Str "3-step"
      , Space
      , Str "approach"
      , SoftBreak
      , Str "include:"
      , Space
      , Str "Flush+Flush"
      , RawInline (Format "tex") "\\index{Flush+Flush}"
      , Cite
          [ Citation
              { citationId = "Gruss2016a"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 77
              , citationHash = 0
              }
          ]
          [ Str "[@Gruss2016a]" ]
      , Str ","
      , SoftBreak
      , Str "Flush+Prefetch"
      , RawInline (Format "tex") "\\index{Flush+Prefetch}"
      , Cite
          [ Citation
              { citationId = "Gruss2016"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 78
              , citationHash = 0
              }
          ]
          [ Str "[@Gruss2016]" ]
      , Str ","
      , SoftBreak
      , Str "Evict+Reload"
      , RawInline (Format "tex") "\\index{Evict+Reload}"
      , Cite
          [ Citation
              { citationId = "Percival2005"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 79
              , citationHash = 0
              }
          ]
          [ Str "[@Percival2005]" ]
      , Str ","
      , SoftBreak
      , Str "Evict+Time"
      , RawInline (Format "tex") "\\index{Evict+Time}"
      , Cite
          [ Citation
              { citationId = "Osvik2005"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 80
              , citationHash = 0
              }
          ]
          [ Str "[@Osvik2005]" ]
      , Str ","
      , SoftBreak
      , Str "Reload+Refresh"
      , RawInline (Format "tex") "\\index{Reload+Refresh}"
      , Cite
          [ Citation
              { citationId = "Briongos2020"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 81
              , citationHash = 0
              }
          ]
          [ Str "[@Briongos2020]" ]
      , Str ","
      , SoftBreak
      , Str "Collide+Probe"
      , RawInline (Format "tex") "\\index{Collide+Probe}"
      , Cite
          [ Citation
              { citationId = "Lipp2020"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 82
              , citationHash = 0
              }
          ]
          [ Str "[@Lipp2020]" ]
      , Str ","
      , Space
      , Str "etc."
      ]
  , Header
      3
      ( "mitigating-cache-side-channel-attacks" , [] , [] )
      [ Str "Mitigating"
      , Space
      , Str "cache"
      , Space
      , Str "side-channel"
      , Space
      , Str "attacks"
      ]
  , Para
      [ Str "As"
      , Space
      , Str "described"
      , Space
      , Str "in"
      , Space
      , Cite
          [ Citation
              { citationId = "Su2021"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 83
              , citationHash = 0
              }
          ]
          [ Str "[@Su2021]" ]
      , Str ","
      , Space
      , Str "3"
      , Space
      , Str "conditions"
      , Space
      , Str "need"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "met"
      , Space
      , Str "for"
      , Space
      , Str "a"
      , Space
      , Str "cache-based"
      , SoftBreak
      , Str "side-channel"
      , Space
      , Str "attack"
      , Space
      , Str "to"
      , Space
      , Str "succeed:"
      ]
  , OrderedList
      ( 1 , Decimal , Period )
      [ [ Plain
            [ Str "There"
            , Space
            , Str "is"
            , Space
            , Str "a"
            , Space
            , Str "mapping"
            , Space
            , Str "between"
            , Space
            , Str "a"
            , Space
            , Str "state"
            , Space
            , Str "change"
            , Space
            , Str "in"
            , Space
            , Str "the"
            , Space
            , Str "cache"
            , Space
            , Str "and"
            , Space
            , Str "sensitive"
            , SoftBreak
            , Str "information"
            , Space
            , Str "in"
            , Space
            , Str "the"
            , Space
            , Str "victim"
            , Space
            , Str "program."
            ]
        ]
      , [ Plain
            [ Str "The"
            , Space
            , Str "spy"
            , Space
            , Str "runs"
            , Space
            , Str "on"
            , Space
            , Str "a"
            , Space
            , Str "CPU"
            , Space
            , Str "that"
            , Space
            , Str "shares"
            , Space
            , Str "a"
            , Space
            , Str "cache"
            , Space
            , Str "level"
            , Space
            , Str "with"
            , Space
            , Str "the"
            , Space
            , Str "CPU"
            , Space
            , Str "the"
            , Space
            , Str "victim"
            , Space
            , Str "runs"
            , SoftBreak
            , Str "on."
            ]
        ]
      , [ Plain
            [ Str "The"
            , Space
            , Str "spy"
            , Space
            , Str "can"
            , Space
            , Str "infer"
            , Space
            , Str "a"
            , Space
            , Str "cache"
            , Space
            , Str "status"
            , Space
            , Str "change"
            , Space
            , Str "caused"
            , Space
            , Str "by"
            , Space
            , Str "the"
            , Space
            , Str "victim"
            , Space
            , Str "through"
            , Space
            , Str "its"
            , Space
            , Str "own"
            , SoftBreak
            , Str "cache"
            , Space
            , Str "status."
            ]
        ]
      ]
  , Para
      [ Str "Mitigations"
      , Space
      , Str "against"
      , Space
      , Str "cache"
      , Space
      , Str "side-channel"
      , Space
      , Str "attacks"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "categorized"
      , Space
      , Str "according"
      , Space
      , Str "to"
      , SoftBreak
      , Str "which"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "3"
      , Space
      , Str "conditions"
      , Space
      , Str "above"
      , Space
      , Str "they"
      , Space
      , Str "aim"
      , Space
      , Str "to"
      , Space
      , Str "prevent"
      , Space
      , Str "from"
      , Space
      , Str "happening:"
      ]
  , Header
      4
      ( "mitigations-de-correlating-cache-state-change-with-sensitive-information-in-the-victim-program"
      , []
      , []
      )
      [ Str "Mitigations"
      , Space
      , Str "de-correlating"
      , Space
      , Str "cache"
      , Space
      , Str "state"
      , Space
      , Str "change"
      , Space
      , Str "with"
      , Space
      , Str "sensitive"
      , Space
      , Str "information"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "program"
      ]
  , Para
      [ Str "A"
      , Space
      , Str "typical"
      , Space
      , Str "example"
      , Space
      , Str "of"
      , Space
      , Str "when"
      , Space
      , Str "a"
      , Space
      , Str "cache"
      , Space
      , Str "state"
      , Space
      , Str "change"
      , Space
      , Str "could"
      , Space
      , Str "be"
      , Space
      , Str "correlated"
      , Space
      , Str "to"
      , Space
      , Str "sensitive"
      , SoftBreak
      , Str "information"
      , Space
      , Str "is"
      , Space
      , Str "when"
      , Space
      , Str "a"
      , Space
      , Str "program"
      , Space
      , Str "uses"
      , Space
      , Str "secret"
      , Space
      , Str "information"
      , Space
      , Str "to"
      , Space
      , Str "index"
      , Space
      , Str "into"
      , Space
      , Str "an"
      , Space
      , Str "array."
      , Space
      , Str "An"
      , SoftBreak
      , Str "attacker"
      , Space
      , Str "could"
      , Space
      , Str "derive"
      , Space
      , Str "bits"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "secret"
      , Space
      , Str "information"
      , Space
      , Str "by"
      , Space
      , Str "observing"
      , Space
      , Str "which"
      , Space
      , Str "cache"
      , SoftBreak
      , Str "line"
      , Space
      , Str "was"
      , Space
      , Str "fetched."
      ]
  , Para
      [ Str "Especially"
      , Space
      , Str "in"
      , Space
      , Str "crypto"
      , Space
      , Str "kernels,"
      , Space
      , Str "indexing"
      , Space
      , Str "into"
      , Space
      , Str "an"
      , Space
      , Str "array"
      , Space
      , Str "using"
      , Space
      , Str "a"
      , Space
      , Str "secret"
      , Space
      , Str "value"
      , Space
      , Str "is"
      , SoftBreak
      , Str "generally"
      , Space
      , Str "avoided."
      , Space
      , Str "An"
      , Space
      , Str "alternative"
      , Space
      , Str "mitigation"
      , Space
      , Str "is"
      , Space
      , Str "to"
      , Space
      , Str "always"
      , Space
      , Str "access"
      , Space
      , Str "all"
      , Space
      , Str "array"
      , SoftBreak
      , Str "indices,"
      , Space
      , Str "independent"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "secret"
      , Space
      , Str "value,"
      , Space
      , Str "e.g.\160as"
      , Space
      , Str "done"
      , Space
      , Str "in"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "commit" , SoftBreak , Str "46fbe375" ]
          ( "https://git.tartarus.org/?p=simon/putty.git;a=commitdiff;h=46fbe375bf"
          , ""
          )
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "PuTTY"
      , Space
      , Str "project,"
      , Space
      , Str "which"
      , Space
      , Str "contains"
      , Space
      , Str "this"
      , Space
      , Str "comment:"
      ]
  , BlockQuote
      [ CodeBlock
          ( "" , [] , [] )
          "* Side-channel considerations: the exponent is secret, so\n* actually doing a single table lookup by using a chunk of\n* exponent bits as an array index would be an obvious leak of\n* secret information into the cache. So instead, in each\n* iteration, we read _all_ the table entries, and do a sequence\n* of mp_select operations to leave just the one we wanted in the\n* variable"
      ]
  , Header
      4
      ( "mitigations-disallowing-spy-programs-to-share-the-cache-with-the-victim-program"
      , []
      , []
      )
      [ Str "Mitigations"
      , Space
      , Str "disallowing"
      , Space
      , Str "spy"
      , Space
      , Str "programs"
      , Space
      , Str "to"
      , Space
      , Str "share"
      , Space
      , Str "the"
      , Space
      , Str "cache"
      , Space
      , Str "with"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "program"
      ]
  , Para
      [ Str "If"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , Space
      , Str "spy"
      , Space
      , Str "do"
      , Space
      , Str "not"
      , Space
      , Str "share"
      , Space
      , Str "a"
      , Space
      , Str "common"
      , Space
      , Str "channel"
      , Space
      , Str "\8211"
      , Space
      , Str "in"
      , Space
      , Str "this"
      , Space
      , Str "case"
      , Space
      , Str "a"
      , Space
      , Str "cache"
      , SoftBreak
      , Str "level"
      , Space
      , Str "\8211"
      , Space
      , Str "then"
      , Space
      , Str "a"
      , Space
      , Str "side"
      , Space
      , Str "channel"
      , Space
      , Str "cannot"
      , Space
      , Str "be"
      , Space
      , Str "created."
      ]
  , Para
      [ Str "One"
      , Space
      , Str "way"
      , Space
      , Str "to"
      , Space
      , Str "achieve"
      , Space
      , Str "this"
      , Space
      , Str "is"
      , Space
      , Str "to"
      , Space
      , Str "only"
      , Space
      , Str "allow"
      , Space
      , Str "one"
      , Space
      , Str "program"
      , Space
      , Str "to"
      , Space
      , Str "run"
      , Space
      , Str "at"
      , Space
      , Str "the"
      , Space
      , Str "same"
      , Space
      , Str "time,"
      , SoftBreak
      , Str "and"
      , Space
      , Str "when"
      , Space
      , Str "a"
      , Space
      , Str "context"
      , Space
      , Str "switch"
      , Space
      , Str "does"
      , Space
      , Str "happen,"
      , Space
      , Str "to"
      , Space
      , Str "clear"
      , Space
      , Str "all"
      , Space
      , Str "cache"
      , Space
      , Str "content."
      , Space
      , Str "Obviously,"
      , SoftBreak
      , Str "this"
      , Space
      , Str "has"
      , Space
      , Str "a"
      , Space
      , Str "huge"
      , Space
      , Str "performance"
      , Space
      , Str "impact,"
      , Space
      , Str "especially"
      , Space
      , Str "in"
      , Space
      , Str "systems"
      , Space
      , Str "with"
      , Space
      , Str "multiple"
      , Space
      , Str "cores"
      , SoftBreak
      , Str "and"
      , Space
      , Str "with"
      , Space
      , Str "large"
      , Space
      , Str "caches."
      , Space
      , Str "Therefore,"
      , Space
      , Str "a"
      , Space
      , Str "wide"
      , Space
      , Str "variety"
      , Space
      , Str "of"
      , Space
      , Str "mitigations"
      , Space
      , Str "have"
      , Space
      , Str "been"
      , SoftBreak
      , Str "proposed"
      , Space
      , Str "that"
      , Space
      , Str "aim"
      , Space
      , Str "to"
      , Space
      , Str "make"
      , Space
      , Str "attacks"
      , Space
      , Str "somewhat"
      , Space
      , Str "harder"
      , Space
      , Str "without"
      , Space
      , Str "losing"
      , Space
      , Str "too"
      , Space
      , Str "much"
      , Space
      , Str "system"
      , SoftBreak
      , Str "efficiency."
      , Space
      , Cite
          [ Citation
              { citationId = "Mushtaq2020"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 84
              , citationHash = 0
              }
          ]
          [ Str "[@Mushtaq2020]" ]
      , Space
      , Str "and"
      , Space
      , Cite
          [ Citation
              { citationId = "Su2021"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 85
              , citationHash = 0
              }
          ]
          [ Str "[@Su2021]" ]
      , Space
      , Str "summarize"
      , Space
      , Str "dozens"
      , Space
      , Str "of"
      , Space
      , Str "proposals"
      , Space
      , Str "and"
      , SoftBreak
      , Str "implementations"
      , Space
      , Str "\8211"
      , Space
      , Str "too"
      , Space
      , Str "many"
      , Space
      , Str "to"
      , Space
      , Str "try"
      , Space
      , Str "to"
      , Space
      , Str "describe"
      , Space
      , Str "them"
      , Space
      , Str "all"
      , Space
      , Str "here."
      ]
  , Para
      [ Str "One"
      , Space
      , Str "popular"
      , Space
      , Str "such"
      , Space
      , Str "mitigation"
      , Space
      , Str "is"
      , Space
      , Str "disabling"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "cpu" , SoftBreak , Str "multithreading" ]
          ( "https://en.wikipedia.org/wiki/Multithreading_(computer_architecture)"
          , ""
          )
      , RawInline (Format "tex") "\\index{multithreading}"
      , Str "."
      , SoftBreak
      , Str "For"
      , Space
      , Str "example,"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "Azure"
          , Space
          , Str "suggests"
          , Space
          , Str "that"
          , Space
          , Str "users"
          , Space
          , Str "who"
          , Space
          , Str "run"
          , Space
          , Str "untrusted"
          , Space
          , Str "code"
          , Space
          , Str "should"
          , Space
          , Str "consider"
          , Space
          , Str "disabling"
          , Space
          , Str "cpu"
          , Space
          , Str "multithreading"
          ]
          ( "https://learn.microsoft.com/en-us/azure/virtual-machines/mitigate-se"
          , ""
          )
      , Str "."
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "The"
          , Space
          , Str "linux"
          , Space
          , Str "kernel\8217s"
          , Space
          , Str "core"
          , Space
          , Str "scheduling"
          , Space
          , Str "documentation"
          ]
          ( "https://www.kernel.org/doc/Documentation/admin-guide/hw-vuln/core-scheduling.rst"
          , ""
          )
      , SoftBreak
      , Str "also"
      , Space
      , Str "states"
      , Space
      , Str "mutually"
      , Space
      , Str "untrusted"
      , Space
      , Str "code"
      , Space
      , Str "should"
      , Space
      , Str "not"
      , Space
      , Str "run"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "same"
      , Space
      , Str "core"
      , SoftBreak
      , Str "concurrently."
      , Space
      , Str "It"
      , Space
      , Str "implements"
      , Space
      , Str "a"
      , Space
      , Str "scheduler"
      , Space
      , Str "that"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "takes"
          , Space
          , Str "into"
          , Space
          , Str "account"
          , Space
          , Str "which"
          , Space
          , Str "processes"
          , Space
          , Str "are"
          , Space
          , Str "mutually-trusting"
          ]
          ( "https://lwn.net/Articles/861251/" , "" )
      , SoftBreak
      , Str "and"
      , Space
      , Str "only"
      , Space
      , Str "allows"
      , Space
      , Str "those"
      , Space
      , Str "to"
      , Space
      , Str "run"
      , Space
      , Str "simultaneously"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "same"
      , Space
      , Str "core."
      ]
  , Para
      [ Str "One"
      , Space
      , Str "could"
      , Space
      , Str "argue"
      , Space
      , Str "that"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "site" , Space , Str "isolation" ]
          ( "https://developer.chrome.com/blog/site-isolation/" , "" )
      , RawInline (Format "tex") "\\index{site\nisolation}"
      , Space
      , Str "as"
      , Space
      , Str "implemented"
      , Space
      , Str "in"
      , Space
      , Str "many"
      , Space
      , Str "web"
      , Space
      , Str "browsers"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "mitigation"
      , Space
      , Str "that"
      , Space
      , Str "also"
      , Space
      , Str "falls"
      , SoftBreak
      , Str "into"
      , Space
      , Str "this"
      , Space
      , Str "category."
      , Space
      , Str "Site"
      , Space
      , Str "isolation"
      , Space
      , Str "is"
      , Space
      , Str "described"
      , Space
      , Str "in"
      , Space
      , Str "more"
      , Space
      , Str "detail"
      , Space
      , Str "in"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "its" , Space , Str "own" , Space , Str "section" ]
          ( "#site-isolation" , "" )
      , Str "."
      ]
  , Header
      4
      ( "mitigations-disabling-the-spy-program-to-infer-a-cache-status-change-in-the-victim-program-through-its-own-cache-status"
      , []
      , []
      )
      [ Str "Mitigations"
      , Space
      , Str "disabling"
      , Space
      , Str "the"
      , Space
      , Str "spy"
      , Space
      , Str "program"
      , Space
      , Str "to"
      , Space
      , Str "infer"
      , Space
      , Str "a"
      , Space
      , Str "cache"
      , Space
      , Str "status"
      , Space
      , Str "change"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "program"
      , Space
      , Str "through"
      , Space
      , Str "its"
      , Space
      , Str "own"
      , Space
      , Str "cache"
      , Space
      , Str "status"
      ]
  , Para
      [ Str "In"
      , Space
      , Str "some"
      , Space
      , Str "contexts,"
      , Space
      , Str "the"
      , Space
      , Str "resolution"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "smallest"
      , Space
      , Str "time"
      , Space
      , Str "increment"
      , Space
      , Str "measurable"
      , Space
      , Str "by"
      , SoftBreak
      , Str "the"
      , Space
      , Str "spy"
      , Space
      , Str "program"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "reduced"
      , Space
      , Str "so"
      , Space
      , Str "much"
      , Space
      , Str "that"
      , Space
      , Str "it"
      , Space
      , Str "becomes"
      , Space
      , Str "much"
      , Space
      , Str "harder"
      , Space
      , Str "to"
      , SoftBreak
      , Str "distinguish"
      , Space
      , Str "between"
      , Space
      , Str "a"
      , Space
      , Str "cache"
      , Space
      , Str "hit"
      , Space
      , Str "and"
      , Space
      , Str "a"
      , Space
      , Str "cache"
      , Space
      , Str "miss."
      , Space
      , Str "Injecting"
      , Space
      , Str "noise"
      , Space
      , Str "and"
      , Space
      , Str "jitter"
      , SoftBreak
      , Str "into"
      , Space
      , Str "the"
      , Space
      , Str "timer"
      , Space
      , Str "also"
      , Space
      , Str "makes"
      , Space
      , Str "it"
      , Space
      , Str "harder"
      , Space
      , Str "to"
      , Space
      , Str "distinguish"
      , Space
      , Str "between"
      , Space
      , Str "a"
      , Space
      , Str "cache"
      , Space
      , Str "hit"
      , Space
      , Str "and"
      , Space
      , Str "cache"
      , SoftBreak
      , Str "miss."
      , Space
      , Str "This"
      , Space
      , Str "is"
      , Space
      , Str "one"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "mitigations"
      , Space
      , Str "in"
      , Space
      , Str "javascript"
      , Space
      , Str "engines"
      , Space
      , Str "against"
      , Space
      , Str "Spectre"
      , SoftBreak
      , Str "attacks."
      , Space
      , Str "For"
      , Space
      , Str "more"
      , Space
      , Str "information"
      , Space
      , Str "see"
      , Space
      , Str "this"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "v8" , Space , Str "blog" , Space , Str "post" ]
          ( "https://v8.dev/blog/spectre" , "" )
      , Space
      , Str "or"
      , Space
      , Str "this"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "Firefox"
          , Space
          , Str "documentation"
          , Space
          , Str "of"
          , Space
          , Str "the"
          , Space
          , Str "performance.now()"
          , Space
          , Str "method"
          ]
          ( "https://developer.mozilla.org/en-US/docs/Web/API/Performance/now"
          , ""
          )
      , RawInline (Format "tex") "\\index{Spectre}"
      , Str "."
      ]
  , Para
      [ Str "Note"
      , Space
      , Str "that"
      , Space
      , Str "this"
      , Space
      , Str "is"
      , Space
      , Str "not"
      , Space
      , Str "a"
      , Space
      , Str "perfect"
      , Space
      , Str "mitigation"
      , Space
      , Str "-"
      , Space
      , Str "there"
      , Space
      , Str "are"
      , Space
      , Str "often"
      , Space
      , Str "surprising"
      , Space
      , Str "ways"
      , SoftBreak
      , Str "that"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "can"
      , Space
      , Str "get"
      , Space
      , Str "a"
      , Space
      , Str "fine-grained"
      , Space
      , Str "enough"
      , Space
      , Str "timer"
      , Space
      , Str "or"
      , Space
      , Str "use"
      , Space
      , Str "statistical"
      , Space
      , Str "methods"
      , SoftBreak
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "able"
      , Space
      , Str "to"
      , Space
      , Str "detect"
      , Space
      , Str "the"
      , Space
      , Str "difference"
      , Space
      , Str "between"
      , Space
      , Str "a"
      , Space
      , Str "cache"
      , Space
      , Str "hit"
      , Space
      , Str "or"
      , Space
      , Str "miss."
      , Space
      , Str "One"
      , Space
      , Str "extreme"
      , SoftBreak
      , Str "example"
      , Space
      , Str "is"
      , Space
      , Str "the"
      , Space
      , Str "NetSpectre"
      , RawInline (Format "tex") "\\index{NetSpectre}"
      , Space
      , Str "attack"
      , Space
      , Cite
          [ Citation
              { citationId = "Schwarz2019"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 86
              , citationHash = 0
              }
          ]
          [ Str "[@Schwarz2019]" ]
      , Space
      , Str "where"
      , Space
      , Str "the"
      , SoftBreak
      , Str "difference"
      , Space
      , Str "between"
      , Space
      , Str "cache"
      , Space
      , Str "hit"
      , Space
      , Str "and"
      , Space
      , Str "cache"
      , Space
      , Str "miss"
      , Space
      , Str "is"
      , Space
      , Str "measured"
      , Space
      , Str "over"
      , Space
      , Str "a"
      , Space
      , Str "network,"
      , Space
      , Str "by"
      , SoftBreak
      , Str "statistically"
      , Space
      , Str "analyzing"
      , Space
      , Str "delays"
      , Space
      , Str "on"
      , Space
      , Str "network"
      , Space
      , Str "packet"
      , Space
      , Str "responses."
      , Space
      , Str "Furthermore,"
      , SoftBreak
      , Cite
          [ Citation
              { citationId = "Schwarz2017"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 87
              , citationHash = 0
              }
          ]
          [ Str "[@Schwarz2017]" ]
      , Space
      , Str "demonstrates"
      , Space
      , Str "how"
      , Space
      , Str "to"
      , Space
      , Str "construct"
      , Space
      , Str "high-resolution"
      , Space
      , Str "timers"
      , Space
      , Str "in"
      , Space
      , Str "various"
      , SoftBreak
      , Str "indirect"
      , Space
      , Str "ways"
      , Space
      , Str "in"
      , Space
      , Str "all"
      , Space
      , Str "browsers"
      , Space
      , Str "that"
      , Space
      , Str "have"
      , Space
      , Str "removed"
      , Space
      , Str "explicit"
      , Space
      , Str "fine-grained"
      , Space
      , Str "timers."
      ]
  , Para
      [ Str "Another"
      , Space
      , Str "possibility"
      , Space
      , Str "is"
      , Space
      , Str "to"
      , Space
      , Str "clear"
      , Space
      , Str "the"
      , Space
      , Str "cache"
      , Space
      , Str "between"
      , Space
      , Str "times"
      , Space
      , Str "when"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "runs"
      , Space
      , Str "and"
      , SoftBreak
      , Str "the"
      , Space
      , Str "spy"
      , Space
      , Str "runs."
      , Space
      , Str "This"
      , Space
      , Str "is"
      , Space
      , Str "probably"
      , Space
      , Str "going"
      , Space
      , Str "to"
      , Space
      , Str "incur"
      , Space
      , Str "quite"
      , Space
      , Str "a"
      , Space
      , Str "bit"
      , Space
      , Str "of"
      , Space
      , Str "performance"
      , SoftBreak
      , Str "overhead,"
      , Space
      , Str "and"
      , Space
      , Str "may"
      , Space
      , Str "also"
      , Space
      , Str "not"
      , Space
      , Str "always"
      , Space
      , Str "possible"
      , Space
      , Str "e.g.\160when"
      , Space
      , Str "victim"
      , Space
      , Str "and"
      , Space
      , Str "spy"
      , Space
      , Str "are"
      , Space
      , Str "running"
      , SoftBreak
      , Str "at"
      , Space
      , Str "the"
      , Space
      , Str "same"
      , Space
      , Str "time"
      , Space
      , Str "on"
      , Space
      , Str "2"
      , Space
      , Str "CPUs"
      , Space
      , Str "sharing"
      , Space
      , Str "a"
      , Space
      , Str "cache"
      , Space
      , Str "level."
      ]
  , Header
      2
      ( "branch-predictor-based-side-channels" , [] , [] )
      [ Str "Branch-predictor"
      , Space
      , Str "based"
      , Space
      , Str "side-channels"
      ]
  , Header
      3
      ( "branch-predictors" , [] , [] )
      [ Str "Branch" , Space , Str "predictors" ]
  , Para
      [ Str "Most"
      , Space
      , Str "CPUs"
      , Space
      , Str "implement"
      , Space
      , Str "one"
      , Space
      , Str "or"
      , Space
      , Str "more"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "instruction" , Space , Str "pipelines" ]
          ( "https://en.wikipedia.org/wiki/Instruction_pipelining"
          , ""
          )
      , Str "."
      , SoftBreak
      , RawInline (Format "tex") "\\index{pipeline}"
      , RawInline (Format "tex") "\\index{instruction pipeline}"
      , Space
      , Str "In"
      , Space
      , Str "an"
      , Space
      , Str "instruction"
      , Space
      , Str "pipeline,"
      , Space
      , Str "the"
      , SoftBreak
      , Str "next"
      , Space
      , Str "instruction"
      , Space
      , Str "is"
      , Space
      , Str "started"
      , Space
      , Str "before"
      , Space
      , Str "the"
      , Space
      , Str "previous"
      , Space
      , Str "instruction"
      , Space
      , Str "has"
      , Space
      , Str "finished"
      , SoftBreak
      , Str "executing."
      , Space
      , Str "When"
      , Space
      , Str "the"
      , Space
      , Str "previous"
      , Space
      , Str "instruction"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "branch"
      , Space
      , Str "instruction,"
      , Space
      , Str "the"
      , Space
      , Str "next"
      , SoftBreak
      , Str "instruction"
      , Space
      , Str "that"
      , Space
      , Str "needs"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "executed"
      , Space
      , Str "is"
      , Space
      , Str "only"
      , Space
      , Str "known"
      , Space
      , Str "when"
      , Space
      , Str "that"
      , Space
      , Str "branch"
      , Space
      , Str "instruction"
      , SoftBreak
      , Str "completes."
      , Space
      , Str "However,"
      , Space
      , Str "waiting"
      , Space
      , Str "for"
      , Space
      , Str "the"
      , Space
      , Str "branch"
      , Space
      , Str "instruction"
      , Space
      , Str "to"
      , Space
      , Str "finish"
      , Space
      , Str "before"
      , Space
      , Str "starting"
      , SoftBreak
      , Str "the"
      , Space
      , Str "next"
      , Space
      , Str "instruction"
      , Space
      , Str "leads"
      , Space
      , Str "to"
      , Space
      , Str "a"
      , Space
      , Str "big"
      , Space
      , Str "performance"
      , SoftBreak
      , Str "loss."
      , Note
          [ Para
              [ Str "Over"
              , Space
              , Str "time,"
              , Space
              , Str "new"
              , Space
              , Str "CPU"
              , Space
              , Str "designs"
              , Space
              , Str "tend"
              , Space
              , Str "to"
              , Space
              , Str "support"
              , SoftBreak
              , Str "having"
              , Space
              , Str "more"
              , Space
              , Str "instructions"
              , Space
              , Str "in"
              , Space
              , Str "flight."
              , Space
              , Cite
                  [ Citation
                      { citationId = "Eyerman2009"
                      , citationPrefix = []
                      , citationSuffix =
                          [ Str ","
                          , Space
                          , Str "section"
                          , Space
                          , Str "4.2.3"
                          ]
                      , citationMode = NormalCitation
                      , citationNoteNum = 88
                      , citationHash = 0
                      }
                  ]
                  [ Str "[@Eyerman2009,"
                  , Space
                  , Str "section"
                  , Space
                  , Str "4.2.3]"
                  ]
              , Space
              , Str "suggests"
              , Space
              , Str "that"
              , SoftBreak
              , Str "branch"
              , Space
              , Str "prediction"
              , Space
              , Str "accuracy"
              , Space
              , Str "has"
              , Space
              , Str "to"
              , Space
              , Str "grow"
              , Space
              , Str "more"
              , Space
              , Str "than"
              , Space
              , Str "linearly"
              , Space
              , Str "when"
              , Space
              , Str "the"
              , Space
              , Str "number"
              , Space
              , Str "of"
              , SoftBreak
              , Str "pipelines,"
              , Space
              , Str "or"
              , Space
              , Str "the"
              , Space
              , Str "depth"
              , Space
              , Str "of"
              , Space
              , Str "the"
              , Space
              , Str "pipeline"
              , Space
              , Str "grows."
              , Space
              , Str "Therefore,"
              , Space
              , Str "there"
              , Space
              , Str "is"
              , Space
              , Str "a"
              , Space
              , Str "constant"
              , SoftBreak
              , Str "push"
              , Space
              , Str "to"
              , Space
              , Str "increase"
              , Space
              , Str "the"
              , Space
              , Str "accuracy"
              , Space
              , Str "of"
              , Space
              , Str "branch"
              , Space
              , Str "predictors."
              ]
          ]
      , Space
      , Str "Therefore,"
      , Space
      , Str "most"
      , Space
      , Str "CPUs"
      , SoftBreak
      , Str "predict"
      , RawInline (Format "tex") "\\index{predict}"
      , Space
      , Str "which"
      , Space
      , Str "instruction"
      , Space
      , Str "needs"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "executed"
      , Space
      , Str "after"
      , Space
      , Str "a"
      , Space
      , Str "branch,"
      , SoftBreak
      , Str "before"
      , Space
      , Str "the"
      , Space
      , Str "branch"
      , Space
      , Str "instruction"
      , Space
      , Str "has"
      , Space
      , Str "completed."
      , Space
      , Str "Correctly"
      , Space
      , Str "and"
      , Space
      , Str "quickly"
      , Space
      , Str "predicting"
      , SoftBreak
      , Str "the"
      , Space
      , Str "instruction"
      , Space
      , Str "after"
      , Space
      , Str "a"
      , Space
      , Str "branch"
      , Space
      , Str "instruction"
      , Space
      , Str "is"
      , Space
      , Str "so"
      , Space
      , Str "important"
      , Space
      , Str "for"
      , Space
      , Str "performance"
      , Space
      , Str "that"
      , SoftBreak
      , Str "most"
      , Space
      , Str "CPUs"
      , Space
      , Str "have"
      , Space
      , Str "multiple"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "branch" , Space , Str "predictors" ]
          ( "https://en.wikipedia.org/wiki/Branch_predictor" , "" )
      , RawInline (Format "tex") "\\index{branch\npredictor}"
      , Str ","
      , Space
      , Str "such"
      , Space
      , Str "as:"
      ]
  , BulletList
      [ [ Plain
            [ Str "A"
            , Space
            , Str "predictor"
            , Space
            , Str "of"
            , Space
            , Str "the"
            , Space
            , Str "outcome"
            , Space
            , Str "of"
            , Space
            , Str "a"
            , Space
            , Str "conditional"
            , Space
            , Str "branch"
            , RawInline
                (Format "tex")
                "\\index{conditional branch\ndirection predictor}"
            , Str ":"
            , Space
            , Str "taken"
            , Space
            , Str "or"
            , Space
            , Str "not"
            , Space
            , Str "taken"
            , RawInline (Format "tex") "\\index{taken branch}"
            , Str "."
            , Space
            , Str "The"
            , Space
            , Str "prediction"
            , SoftBreak
            , Str "is"
            , Space
            , Str "typically"
            , Space
            , Str "history-based"
            , RawInline
                (Format "tex") "\\index{history-based prediction}"
            , Str ","
            , Space
            , Str "i.e.\160based"
            , Space
            , Str "on"
            , Space
            , Str "the"
            , SoftBreak
            , Str "outcome"
            , Space
            , Str "of"
            , Space
            , Str "this"
            , Space
            , Str "and"
            , Space
            , Str "other"
            , Space
            , Str "branches"
            , Space
            , Str "in"
            , Space
            , Str "the"
            , Space
            , Str "recent"
            , Space
            , Str "past."
            ]
        ]
      , [ Plain
            [ Str "A"
            , Space
            , Str "predictor"
            , Space
            , Str "of"
            , Space
            , Str "the"
            , Space
            , Str "target"
            , Space
            , Str "of"
            , Space
            , Str "a"
            , Space
            , Str "taken"
            , Space
            , Str "branch"
            , RawInline
                (Format "tex") "\\index{branch target predictor}"
            , Str ","
            , SoftBreak
            , Str "i.e.\160the"
            , Space
            , Str "address"
            , Space
            , Str "of"
            , Space
            , Str "the"
            , Space
            , Str "next"
            , Space
            , Str "instruction"
            , Space
            , Str "after"
            , Space
            , Str "a"
            , Space
            , Str "taken"
            , Space
            , Str "branch."
            ]
        ]
      , [ Plain
            [ Str "A"
            , Space
            , Str "predictor"
            , Space
            , Str "that"
            , Space
            , Str "is"
            , Space
            , Str "specialized"
            , Space
            , Str "to"
            , Space
            , Str "predict"
            , Space
            , Str "the"
            , Space
            , Str "next"
            , Space
            , Str "instruction"
            , Space
            , Str "after"
            , Space
            , Str "a"
            , SoftBreak
            , Str "function"
            , Space
            , Str "return"
            , Space
            , Str "instruction."
            , RawInline
                (Format "tex") "\\index{return address predictor}"
            ]
        ]
      ]
  , Header
      3
      ( "side-channels-through-branch-predictors" , [] , [] )
      [ Str "Side-channels"
      , Space
      , Str "through"
      , Space
      , Str "branch"
      , Space
      , Str "predictors"
      ]
  , Para
      [ Str "A"
      , Space
      , Str "number"
      , Space
      , Str "of"
      , Space
      , Str "attacks"
      , Space
      , Str "have"
      , Space
      , Str "been"
      , Space
      , Str "described"
      , Space
      , Str "over"
      , Space
      , Str "the"
      , Space
      , Str "past"
      , Space
      , Str "few"
      , Space
      , Str "years."
      , Space
      , Str "The"
      , Space
      , Str "following"
      , SoftBreak
      , Str "sections"
      , Space
      , Str "list"
      , Space
      , Str "a"
      , Space
      , Str "few"
      , Space
      , Str "examples,"
      , Space
      , Str "categorized"
      , Space
      , Str "per"
      , Space
      , Str "branch"
      , Space
      , Str "predictor"
      , Space
      , Str "component"
      , Space
      , Str "they"
      , SoftBreak
      , Str "target."
      ]
  , Header
      4
      ( "conditional-branch-direction-predictor-side-channel-attacks"
      , []
      , []
      )
      [ Str "Conditional"
      , Space
      , Str "branch"
      , Space
      , Str "direction"
      , Space
      , Str "predictor"
      , Space
      , Str "side-channel"
      , Space
      , Str "attacks"
      ]
  , Para
      [ RawInline
          (Format "tex")
          "\\index{conditional branch direction predictor}"
      ]
  , Para
      [ Str "Two"
      , Space
      , Str "examples"
      , Space
      , Str "are"
      , Space
      , Str "BranchScope"
      , Space
      , Cite
          [ Citation
              { citationId = "Evtyushkin2018"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 89
              , citationHash = 0
              }
          ]
          [ Str "[@Evtyushkin2018]" ]
      , RawInline (Format "tex") "\\index{BranchScope}"
      , Space
      , Str "and"
      , SoftBreak
      , Str "BlueThunder"
      , Space
      , Cite
          [ Citation
              { citationId = "Huo2019"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 90
              , citationHash = 0
              }
          ]
          [ Str "[@Huo2019]" ]
      , RawInline (Format "tex") "\\index{BlueThunder}"
      , Str "."
      , Space
      , Str "These"
      , Space
      , Str "attacks"
      , Space
      , Str "infer"
      , Space
      , Str "whether"
      , Space
      , Str "a"
      , Space
      , Str "branch"
      , SoftBreak
      , Str "is"
      , Space
      , Str "taken"
      , Space
      , Str "or"
      , Space
      , Str "not"
      , Space
      , Str "taken"
      , Space
      , Str "in"
      , Space
      , Str "a"
      , Space
      , Str "victim"
      , Space
      , Str "process."
      , Space
      , Str "They"
      , Space
      , Str "do"
      , Space
      , Str "so"
      , Space
      , Str "by"
      , Space
      , Str "carefully"
      , Space
      , Str "making"
      , Space
      , Str "sure"
      , SoftBreak
      , Str "that"
      , Space
      , Str "a"
      , Space
      , Str "branch"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "spy"
      , Space
      , Str "process"
      , Space
      , Str "uses"
      , Space
      , Str "the"
      , Space
      , Str "same"
      , Space
      , Str "branch"
      , Space
      , Str "predictor"
      , Space
      , Str "entry"
      , Space
      , Str "as"
      , Space
      , Str "the"
      , SoftBreak
      , Str "targeted"
      , Space
      , Str "branch"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "process."
      , Space
      , Str "By"
      , Space
      , Str "measuring"
      , Space
      , Str "whether"
      , Space
      , Str "the"
      , Space
      , Str "branch"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , SoftBreak
      , Str "spy"
      , Space
      , Str "process"
      , Space
      , Str "gets"
      , Space
      , Str "predicted"
      , Space
      , Str "correctly,"
      , Space
      , Str "one"
      , Space
      , Str "can"
      , Space
      , Str "derive"
      , Space
      , Str "whether"
      , Space
      , Str "the"
      , Space
      , Str "branch"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , SoftBreak
      , Str "victim"
      , Space
      , Str "process"
      , Space
      , Str "was"
      , Space
      , Str "taken"
      , Space
      , Str "or"
      , Space
      , Str "not."
      ]
  , Para
      [ Str "This"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "thought"
      , Space
      , Str "of"
      , Space
      , Str "as"
      , Space
      , Str "somewhat"
      , Space
      , Str "akin"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "Prime+Probe"
          , Space
          , Str "cache-based"
          , Space
          , Str "side"
          , SoftBreak
          , Str "channel"
          , Space
          , Str "attacks"
          ]
          ( "#primeprobe" , "" )
      , Str "."
      ]
  , Para
      [ Str "When"
      , Space
      , Str "the"
      , Space
      , Str "outcome"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "branch"
      , Space
      , Str "depends"
      , Space
      , Str "on"
      , Space
      , Str "a"
      , Space
      , Str "bit"
      , Space
      , Str "in"
      , Space
      , Str "a"
      , Space
      , Str "secret"
      , Space
      , Str "key,"
      , Space
      , Str "this"
      , Space
      , Str "can"
      , Space
      , Str "enable"
      , SoftBreak
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "to"
      , Space
      , Str "derive"
      , Space
      , Str "the"
      , Space
      , Str "value"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "secret"
      , Space
      , Str "key."
      , Space
      , Str "These"
      , Space
      , Str "papers"
      , Space
      , Str "demonstrate"
      , SoftBreak
      , Str "deriving"
      , Space
      , Str "the"
      , Space
      , Str "secret"
      , Space
      , Str "key"
      , Space
      , Str "from"
      , Space
      , Str "implementations"
      , Space
      , Str "of"
      , Space
      , Str "specific"
      , Space
      , Str "cryptographic"
      , Space
      , Str "kernels."
      , SoftBreak
      , Str "It"
      , Space
      , Str "can"
      , Space
      , Str "also"
      , Space
      , Str "be"
      , Space
      , Str "used"
      , Space
      , Str "to"
      , Space
      , Str "break"
      , Space
      , Link ( "" , [] , [] ) [ Str "ASLR" ] ( "#aslr" , "" )
      , RawInline (Format "tex") "\\index{ASLR}"
      , Str "."
      ]
  , Header
      4
      ( "branch-target-predictor-side-channel-attacks" , [] , [] )
      [ Str "Branch"
      , Space
      , Str "target"
      , Space
      , Str "predictor"
      , Space
      , Str "side-channel"
      , Space
      , Str "attacks"
      ]
  , Para
      [ RawInline
          (Format "tex") "\\index{Branch target predictor}"
      ]
  , Para
      [ Str "Two"
      , Space
      , Str "examples"
      , Space
      , Str "are"
      , Space
      , Str "SBPA"
      , Space
      , Cite
          [ Citation
              { citationId = "Aciicmez2007"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 91
              , citationHash = 0
              }
          ]
          [ Str "[@Aciicmez2007]" ]
      , RawInline (Format "tex") "\\index{SBPA}"
      , Space
      , Str "and"
      , Space
      , Str "BranchShadow"
      , SoftBreak
      , Cite
          [ Citation
              { citationId = "Lee2017"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 92
              , citationHash = 0
              }
          ]
          [ Str "[@Lee2017]" ]
      , RawInline (Format "tex") "\\index{BranchShadow}"
      , Str "."
      , Space
      , Str "These"
      , Space
      , Str "earlier"
      , Space
      , Str "attacks"
      , Space
      , Str "are"
      , Space
      , Str "based"
      , Space
      , Str "on"
      , Space
      , Str "making"
      , Space
      , Str "a"
      , SoftBreak
      , Str "branch"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "spy"
      , Space
      , Str "process"
      , Space
      , Str "alias"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "BTB"
      , RawInline (Format "tex") "\\index{BTB}"
      , Space
      , Str "with"
      , Space
      , Str "a"
      , Space
      , Str "targeted"
      , Space
      , Str "branch"
      , Space
      , Str "in"
      , SoftBreak
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "process."
      , Space
      , Str "They"
      , Space
      , Str "use"
      , Space
      , Str "methods"
      , Space
      , Str "such"
      , Space
      , Str "as"
      , Space
      , Str "timing"
      , Space
      , Str "difference,"
      , Space
      , Str "last"
      , Space
      , Str "branch"
      , SoftBreak
      , Str "records"
      , RawInline (Format "tex") "\\index{last branch record}"
      , Str ","
      , Space
      , Str "instruction"
      , Space
      , Str "traces"
      , RawInline (Format "tex") "\\index{instruction trace}"
      , SoftBreak
      , Str "or"
      , Space
      , Str "performance"
      , Space
      , Str "counters"
      , RawInline (Format "tex") "\\index{performance counter}"
      , Space
      , Str "to"
      , Space
      , Str "measure"
      , Space
      , Str "whether"
      , Space
      , Str "the"
      , Space
      , Str "branch"
      , SoftBreak
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "spy"
      , Space
      , Str "process"
      , Space
      , Str "caused"
      , Space
      , Str "a"
      , Space
      , Str "specific"
      , Space
      , Str "state"
      , Space
      , Str "change"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "BTB."
      ]
  , Header
      4
      ( "return-address-predictor-side-channel-attacks"
      , []
      , []
      )
      [ Str "Return"
      , Space
      , Str "address"
      , Space
      , Str "predictor"
      , Space
      , Str "side-channel"
      , Space
      , Str "attacks"
      ]
  , Para
      [ RawInline
          (Format "tex") "\\index{return address predictor}"
      ]
  , Para
      [ Str "One"
      , Space
      , Str "example"
      , Space
      , Str "is"
      , Space
      , Str "Hyper-Channel"
      , Space
      , Cite
          [ Citation
              { citationId = "Bulygin2008"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 93
              , citationHash = 0
              }
          ]
          [ Str "[@Bulygin2008]" ]
      , RawInline (Format "tex") "\\index{Hyper-Channel}"
      , Str "."
      , Space
      , Str "In"
      , Space
      , Str "this"
      , Space
      , Str "case,"
      , SoftBreak
      , Str "a"
      , Space
      , Str "spy"
      , Space
      , Str "process"
      , Space
      , Str "invokes"
      , Space
      , Math InlineMath "N"
      , Space
      , Str "calls"
      , Space
      , Str "to"
      , Space
      , Str "fill"
      , Space
      , Str "up"
      , Space
      , Str "the"
      , Space
      , Str "return"
      , Space
      , Str "stack"
      , Space
      , Str "predictor."
      , Space
      , Str "Then"
      , Space
      , Str "it"
      , SoftBreak
      , Str "lets"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , Space
      , Str "process"
      , Space
      , Str "execute."
      , Space
      , Str "Then,"
      , Space
      , Str "the"
      , Space
      , Str "spy"
      , Space
      , Str "process"
      , Space
      , Str "can"
      , Space
      , Str "measure"
      , Space
      , Str "how"
      , Space
      , Str "many"
      , Space
      , Str "of"
      , SoftBreak
      , Str "its"
      , Space
      , Str "return"
      , Space
      , Str "stack"
      , Space
      , Str "entries"
      , Space
      , Str "have"
      , Space
      , Str "been"
      , Space
      , Str "removed"
      , Space
      , Str "from"
      , Space
      , Str "the"
      , Space
      , Str "RSB,"
      , Space
      , Str "by"
      , Space
      , Str "measuring"
      , Space
      , Str "the"
      , Space
      , Str "number"
      , SoftBreak
      , Str "of"
      , Space
      , Math InlineMath "N"
      , Space
      , Str "returns"
      , Space
      , Str "that"
      , Space
      , Str "get"
      , Space
      , Str "mis-predicted."
      , Space
      , Str "If"
      , Space
      , Str "the"
      , Space
      , Str "number"
      , Space
      , Str "of"
      , Space
      , Str "calls"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "victim"
      , SoftBreak
      , Str "process"
      , Space
      , Str "is"
      , Space
      , Str "dependent"
      , Space
      , Str "on"
      , Space
      , Str "secret"
      , Space
      , Str "information,"
      , Space
      , Str "this"
      , Space
      , Str "could"
      , Space
      , Str "leak"
      , Space
      , Str "it."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "papers"
      , Space
      , Str "referred"
      , Space
      , Str "to"
      , Space
      , Str "above"
      , Space
      , Str "contain"
      , Space
      , Str "detailed"
      , Space
      , Str "explanations"
      , Space
      , Str "of"
      , Space
      , Str "how"
      , Space
      , Str "they"
      , Space
      , Str "set"
      , Space
      , Str "up"
      , SoftBreak
      , Str "the"
      , Space
      , Str "attack."
      , Space
      , Str "All"
      , Space
      , Str "of"
      , Space
      , Str "these"
      , Space
      , Str "attacks"
      , Space
      , Str "use"
      , Space
      , Str "a"
      , Space
      , Str "general"
      , Space
      , Str "3-step"
      , Space
      , Str "approach,"
      , Space
      , Str "similar"
      , Space
      , Str "to"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "cache"
          , Space
          , Str "side"
          , Space
          , Str "channels"
          ]
          ( "#general-schema-for-cache-covert-channels" , "" )
      , Str ":"
      ]
  , OrderedList
      ( 1 , Decimal , Period )
      [ [ Plain
            [ Str "An"
            , Space
            , Str "instruction"
            , Space
            , Str "sequence"
            , Space
            , Str "that"
            , Space
            , Str "resets"
            , Space
            , Str "the"
            , Space
            , Str "branch"
            , Space
            , Str "predictor"
            , Space
            , Str "state"
            , Space
            , Str "("
            , Emph [ Str "reset" , SoftBreak , Str "sequence" ]
            , Str "),"
            , Space
            , Str "run"
            , Space
            , Str "by"
            , Space
            , Str "the"
            , Space
            , Str "spy"
            , Space
            , Str "process."
            , RawInline (Format "tex") "\\index{reset sequence}"
            ]
        ]
      , [ Plain
            [ Str "An"
            , Space
            , Str "instruction"
            , Space
            , Str "sequence"
            , Space
            , Str "that"
            , Space
            , Str "triggers"
            , Space
            , Str "a"
            , Space
            , Str "branch"
            , Space
            , Str "predictor"
            , Space
            , Str "state"
            , Space
            , Str "change"
            , Space
            , Str "("
            , Emph [ Str "trigger" , SoftBreak , Str "sequence" ]
            , Str "),"
            , Space
            , Str "run"
            , Space
            , Str "by"
            , Space
            , Str "the"
            , Space
            , Str "victim"
            , Space
            , Str "process."
            , RawInline (Format "tex") "\\index{trigger sequence}"
            ]
        ]
      , [ Plain
            [ Str "An"
            , Space
            , Str "instruction"
            , Space
            , Str "sequence"
            , Space
            , Str "that"
            , Space
            , Str "leaks"
            , Space
            , Str "the"
            , Space
            , Str "branch"
            , Space
            , Str "predictor"
            , Space
            , Str "state"
            , Space
            , Str "("
            , Emph [ Str "measurement" , SoftBreak , Str "sequence" ]
            , Str "),"
            , Space
            , Str "run"
            , Space
            , Str "by"
            , Space
            , Str "the"
            , Space
            , Str "spy"
            , Space
            , Str "process"
            , RawInline (Format "tex") "\\index{measurement sequence}"
            ]
        ]
      ]
  , Header 3 ( "mitigations" , [] , [] ) [ Str "Mitigations" ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "Describe"
          , Space
          , Str "the"
          , Space
          , Str "mitigations"
          , Space
          , Str "proposed"
          , Space
          , Str "against"
          , Space
          , Str "these"
          , Space
          , Str "side-channel"
          , Space
          , Str "attacks."
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "203" ]
          ]
      ]
  , Header
      2
      ( "resource-contention-channels" , [] , [] )
      [ Str "Resource"
      , Space
      , Str "contention"
      , Space
      , Str "channels"
      ]
  , Header
      2
      ( "channels-making-use-of-aliasing-in-other-predictors"
      , []
      , []
      )
      [ Str "Channels"
      , Space
      , Str "making"
      , Space
      , Str "use"
      , Space
      , Str "of"
      , Space
      , Str "aliasing"
      , Space
      , Str "in"
      , Space
      , Str "other"
      , Space
      , Str "predictors"
      ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "Should"
          , Space
          , Str "we"
          , Space
          , Str "also"
          , Space
          , Str "discuss"
          , Space
          , Str "more"
          , Space
          , Quoted DoubleQuote [ Str "covert" ]
          , Space
          , Str "channels"
          , Space
          , Str "here"
          , Space
          , Str "such"
          , Space
          , Str "as"
          , Space
          , Str "power"
          , Space
          , Str "analysis,"
          , Space
          , Str "etc?"
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "176" ]
          ]
      ]
  , Header
      2
      ( "transient-execution-attacks" , [] , [] )
      [ Str "Transient"
      , Space
      , Str "execution"
      , Space
      , Str "attacks"
      ]
  , Header
      3
      ( "transient-execution" , [] , [] )
      [ Str "Transient" , Space , Str "execution" ]
  , Header
      4
      ( "speculative-execution" , [] , [] )
      [ Str "Speculative" , Space , Str "execution" ]
  , Para
      [ Str "CPUs"
      , Space
      , Str "execute"
      , Space
      , Str "sequences"
      , Space
      , Str "of"
      , Space
      , Str "instructions."
      , Space
      , Str "There"
      , Space
      , Str "are"
      , Space
      , Str "often"
      , Space
      , Str "dependencies"
      , Space
      , Str "between"
      , SoftBreak
      , Str "instructions"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "sequence."
      , Space
      , Str "That"
      , Space
      , Str "means"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "outcome"
      , Space
      , Str "of"
      , Space
      , Str "one"
      , Space
      , Str "instruction"
      , SoftBreak
      , Str "influences"
      , Space
      , Str "the"
      , Space
      , Str "execution"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "later"
      , Space
      , Str "instruction."
      ]
  , Para
      [ Str "Apart"
      , Space
      , Str "from"
      , Space
      , Str "the"
      , Space
      , Str "smallest"
      , Space
      , Str "micro-controllers,"
      , Space
      , Str "all"
      , Space
      , Str "CPUs"
      , Space
      , Str "execute"
      , Space
      , Str "multiple"
      , SoftBreak
      , Str "instructions"
      , Space
      , Str "in"
      , Space
      , Str "parallel."
      , Space
      , Str "Sometimes"
      , Space
      , Str "even"
      , Space
      , Str "multiple"
      , Space
      , Str "hundreds"
      , Space
      , Str "of"
      , Space
      , Str "them"
      , Space
      , Str "at"
      , Space
      , Str "the"
      , Space
      , Str "same"
      , SoftBreak
      , Str "time,"
      , Space
      , Str "all"
      , Space
      , Str "in"
      , Space
      , Str "various"
      , Space
      , Str "stages"
      , Space
      , Str "of"
      , Space
      , Str "execution."
      , Space
      , Str "Instructions"
      , Space
      , Str "start"
      , Space
      , Str "executing"
      , Space
      , Str "while"
      , SoftBreak
      , Str "potentially"
      , Space
      , Str "hundreds"
      , Space
      , Str "of"
      , Space
      , Str "previous"
      , Space
      , Str "instructions"
      , Space
      , Str "haven\8217t"
      , Space
      , Str "produced"
      , Space
      , Str "their"
      , Space
      , Str "results"
      , SoftBreak
      , Str "yet."
      , Space
      , Str "How"
      , Space
      , Str "can"
      , Space
      , Str "a"
      , Space
      , Str "CPU"
      , Space
      , Str "achieve"
      , Space
      , Str "this"
      , Space
      , Str "when"
      , Space
      , Str "the"
      , Space
      , Str "output"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "previous"
      , Space
      , Str "instruction,"
      , Space
      , Str "which"
      , SoftBreak
      , Str "might"
      , Space
      , Str "not"
      , Space
      , Str "have"
      , Space
      , Str "fully"
      , Space
      , Str "executed"
      , Space
      , Str "yet,"
      , Space
      , Str "and"
      , Space
      , Str "hence"
      , Space
      , Str "whose"
      , Space
      , Str "output"
      , Space
      , Str "may"
      , Space
      , Str "not"
      , Space
      , Str "yet"
      , Space
      , Str "be"
      , Space
      , Str "ready,"
      , SoftBreak
      , Str "may"
      , Space
      , Str "affect"
      , Space
      , Str "the"
      , Space
      , Str "execution"
      , Space
      , Str "of"
      , Space
      , Str "that"
      , Space
      , Str "later"
      , Space
      , Str "instruction?"
      , Space
      , Str "In"
      , Space
      , Str "other"
      , Space
      , Str "words,"
      , Space
      , Str "there"
      , Space
      , Str "may"
      , Space
      , Str "be"
      , SoftBreak
      , Str "a"
      , Space
      , Strong [ Str "dependency" ]
      , Space
      , Str "between"
      , Space
      , Str "an"
      , Space
      , Str "instruction"
      , Space
      , Str "that"
      , Space
      , Str "has"
      , Space
      , Str "not"
      , Space
      , Str "finished"
      , Space
      , Str "yet"
      , Space
      , Str "and"
      , Space
      , Str "a"
      , Space
      , Str "later"
      , SoftBreak
      , Str "instruction"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "CPU"
      , Space
      , Str "also"
      , Space
      , Str "already"
      , Space
      , Str "started"
      , Space
      , Str "executing."
      ]
  , Para
      [ Str "There"
      , Space
      , Str "are"
      , Space
      , Str "various"
      , Space
      , Str "kinds"
      , Space
      , Str "of"
      , Space
      , Str "dependencies."
      , Space
      , Str "One"
      , Space
      , Str "kind"
      , Space
      , Str "is"
      , Space
      , Strong [ Str "control" , SoftBreak , Str "dependencies" ]
      , RawInline (Format "tex") "\\index{control dependencies}"
      , Str ","
      , Space
      , Str "where"
      , Space
      , Str "whether"
      , Space
      , Str "the"
      , Space
      , Str "later"
      , Space
      , Str "instruction"
      , SoftBreak
      , Str "should"
      , Space
      , Str "be"
      , Space
      , Str "executed"
      , Space
      , Str "at"
      , Space
      , Str "all"
      , Space
      , Str "is"
      , Space
      , Str "dependent"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "outcome"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "earlier"
      , SoftBreak
      , Str "instruction."
      , Space
      , Str "Other"
      , Space
      , Str "kinds"
      , Space
      , Str "are"
      , Space
      , Strong
          [ Str "true"
          , Space
          , Str "data"
          , Space
          , Str "dependencies"
          ]
      , RawInline (Format "tex") "\\index{true data\ndependency}"
      , Str ","
      , Space
      , Strong [ Str "anti-dependencies" ]
      , RawInline (Format "tex") "\\index{anti dependency}"
      , Space
      , Str "and"
      , Space
      , Strong [ Str "output" , SoftBreak , Str "dependencies" ]
      , RawInline (Format "tex") "\\index{output dependency}"
      , Str "."
      , Space
      , Str "More"
      , Space
      , Str "details"
      , Space
      , Str "about"
      , Space
      , Str "these"
      , Space
      , Str "kinds"
      , Space
      , Str "of"
      , SoftBreak
      , Str "dependencies"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "found"
      , Space
      , Str "on"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "the"
          , Space
          , Str "wikipedia"
          , Space
          , Str "page"
          , Space
          , Str "about"
          , Space
          , Str "them"
          ]
          ( "https://en.wikipedia.org/wiki/Data_dependency" , "" )
      , Str "."
      ]
  , Para
      [ Str "CPUs"
      , Space
      , Str "overcome"
      , Space
      , Str "parallel"
      , Space
      , Str "execution"
      , Space
      , Str "limitations"
      , Space
      , Str "imposed"
      , Space
      , Str "by"
      , Space
      , Str "dependencies"
      , Space
      , Str "by"
      , Space
      , Str "making"
      , SoftBreak
      , Str "massive"
      , Space
      , Str "numbers"
      , Space
      , Str "of"
      , Space
      , Strong [ Str "predictions" ]
      , RawInline (Format "tex") "\\index{prediction}"
      , Str "."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "most"
      , Space
      , Str "CPUs"
      , SoftBreak
      , Str "predict"
      , Space
      , Str "whether"
      , Space
      , Str "conditional"
      , Space
      , Str "branches"
      , Space
      , Str "are"
      , Space
      , Str "taken"
      , Space
      , Str "or"
      , Space
      , Str "not,"
      , Space
      , Str "which"
      , Space
      , Str "is"
      , Space
      , Str "making"
      , Space
      , Str "a"
      , SoftBreak
      , Str "prediction"
      , Space
      , Str "on"
      , Space
      , Str "control"
      , Space
      , Str "dependencies."
      , Space
      , Str "Another"
      , Space
      , Str "example"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "CPU"
      , Space
      , Str "making"
      , Space
      , Str "a"
      , Space
      , Str "prediction"
      , SoftBreak
      , Str "on"
      , Space
      , Str "whether"
      , Space
      , Str "a"
      , Space
      , Str "load"
      , Space
      , Str "accesses"
      , Space
      , Str "the"
      , Space
      , Str "same"
      , Space
      , Str "memory"
      , Space
      , Str "address"
      , Space
      , Str "as"
      , Space
      , Str "a"
      , Space
      , Str "preceding"
      , Space
      , Str "store."
      , Space
      , Str "If"
      , Space
      , Str "they"
      , SoftBreak
      , Str "do"
      , Space
      , Str "not"
      , Space
      , Str "access"
      , Space
      , Str "the"
      , Space
      , Str "same"
      , Space
      , Str "memory"
      , Space
      , Str "locations,"
      , Space
      , Str "the"
      , Space
      , Str "load"
      , Space
      , Str "can"
      , Space
      , Str "run"
      , Space
      , Str "in"
      , Space
      , Str "parallel"
      , Space
      , Str "with"
      , Space
      , Str "the"
      , SoftBreak
      , Str "store,"
      , Space
      , Str "as"
      , Space
      , Str "there"
      , Space
      , Str "is"
      , Space
      , Str "no"
      , Space
      , Str "data"
      , Space
      , Str "dependency"
      , Space
      , Str "between"
      , Space
      , Str "them."
      , Space
      , Str "If"
      , Space
      , Str "they"
      , Space
      , Str "do"
      , Space
      , Str "access"
      , SoftBreak
      , Str "overlapping"
      , Space
      , Str "memory"
      , Space
      , Str "locations,"
      , Space
      , Str "there"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "dependency"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , Space
      , Str "store"
      , Space
      , Str "should"
      , SoftBreak
      , Str "complete"
      , Space
      , Str "before"
      , Space
      , Str "the"
      , Space
      , Str "load"
      , Space
      , Str "can"
      , Space
      , Str "start"
      , Space
      , Str "executing."
      ]
  , Para
      [ Str "Starting"
      , Space
      , Str "to"
      , Space
      , Str "execute"
      , Space
      , Str "later"
      , Space
      , Str "instructions"
      , Space
      , Str "before"
      , Space
      , Str "all"
      , Space
      , Str "of"
      , Space
      , Str "their"
      , Space
      , Str "dependencies"
      , Space
      , Str "have"
      , Space
      , Str "been"
      , SoftBreak
      , Str "resolved,"
      , Space
      , Str "based"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "predictions,"
      , Space
      , Str "is"
      , Space
      , Str "called"
      , Space
      , Strong [ Str "speculation" ]
      , RawInline (Format "tex") "\\index{speculation}"
      , Str "."
      ]
  , Para
      [ Str "Let\8217s"
      , Space
      , Str "illustrate"
      , Space
      , Str "that"
      , Space
      , Str "with"
      , Space
      , Str "an"
      , Space
      , Str "example."
      , Space
      , Str "The"
      , Space
      , Str "following"
      , Space
      , Str "C"
      , Space
      , Str "code"
      ]
  , CodeBlock
      ( "" , [ "c" ] , [] )
      "long abs(long a) {\n  if (a>=0)\n    return a;\n  else\n    return -a;\n  }"
  , Para
      [ Str "can"
      , Space
      , Str "be"
      , Space
      , Str "translated"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "following"
      , Space
      , Str "AArch64"
      , Space
      , Str "assembly"
      , Space
      , Str "code:"
      ]
  , CodeBlock
      ( "" , [ "asm" ] , [] )
      "        cmp     x0, #0\n        b.ge    Lbb2\nLbb1:\n        neg     x0, x0\nLbb2:\n        ret"
  , Para
      [ Str "The"
      , Space
      , Code ( "" , [] , [] ) "b.ge"
      , Space
      , Str "instruction"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "conditional"
      , Space
      , Str "branch"
      , Space
      , Str "instruction."
      , Space
      , Str "It"
      , Space
      , Str "computes"
      , Space
      , Str "whether"
      , SoftBreak
      , Str "the"
      , Space
      , Str "next"
      , Space
      , Str "instruction"
      , Space
      , Str "should"
      , Space
      , Str "be"
      , Space
      , Str "the"
      , Space
      , Str "one"
      , Space
      , Str "immediately"
      , Space
      , Str "after,"
      , Space
      , Str "or"
      , Space
      , Str "the"
      , Space
      , Str "one"
      , Space
      , Str "pointed"
      , Space
      , Str "to"
      , SoftBreak
      , Str "by"
      , Space
      , Str "label"
      , Space
      , Code ( "" , [] , [] ) "Lbb2"
      , Str "."
      , Space
      , Str "In"
      , Space
      , Str "case"
      , Space
      , Str "it\8217s"
      , Space
      , Str "the"
      , Space
      , Str "instruction"
      , Space
      , Str "immediately"
      , Space
      , Str "after,"
      , Space
      , Str "the"
      , Space
      , Str "branch"
      , Space
      , Str "is"
      , SoftBreak
      , Str "said"
      , Space
      , Str "to"
      , Space
      , Str "not"
      , Space
      , Str "be"
      , Space
      , Str "taken."
      , Space
      , Str "Instead,"
      , Space
      , Str "if"
      , Space
      , Str "it\8217s"
      , Space
      , Str "the"
      , Space
      , Str "instruction"
      , Space
      , Str "pointed"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "label"
      , SoftBreak
      , Code ( "" , [] , [] ) "Lbb2"
      , Str ","
      , Space
      , Str "the"
      , Space
      , Str "branch"
      , Space
      , Str "is"
      , Space
      , Str "said"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "taken."
      , Space
      , Str "When"
      , Space
      , Str "the"
      , Space
      , Str "condition"
      , Space
      , Code ( "" , [] , [] ) ".ge"
      , Space
      , Str "(greater"
      , Space
      , Str "or"
      , SoftBreak
      , Str "equal)"
      , Space
      , Str "is"
      , Space
      , Str "true,"
      , Space
      , Str "the"
      , Space
      , Str "branch"
      , Space
      , Str "is"
      , Space
      , Str "taken."
      , Space
      , Str "That"
      , Space
      , Str "condition"
      , Space
      , Str "is"
      , Space
      , Str "defined"
      , Space
      , Str "or"
      , Space
      , Str "set"
      , Space
      , Str "by"
      , Space
      , Str "the"
      , SoftBreak
      , Str "previous"
      , Space
      , Str "instruction,"
      , Space
      , Str "the"
      , Space
      , Code ( "" , [] , [] ) "cmp x0, #0"
      , Space
      , Str "instruction,"
      , Space
      , Str "which"
      , Space
      , Str "compares"
      , Space
      , Str "the"
      , Space
      , Str "value"
      , Space
      , Str "in"
      , SoftBreak
      , Str "register"
      , Space
      , Code ( "" , [] , [] ) "x0"
      , Space
      , Str "with"
      , Space
      , Str "0."
      , Space
      , Str "Therefore,"
      , Space
      , Str "there"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "dependency"
      , Space
      , Str "between"
      , Space
      , Str "the"
      , Space
      , Code ( "" , [] , [] ) "cmp"
      , SoftBreak
      , Str "instruction"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , Space
      , Code ( "" , [] , [] ) "b.ge"
      , Space
      , Str "instruction."
      , Space
      , Str "To"
      , Space
      , Str "overcome"
      , Space
      , Str "this"
      , Space
      , Str "dependency,"
      , Space
      , Str "and"
      , Space
      , Str "be"
      , Space
      , Str "able"
      , SoftBreak
      , Str "to"
      , Space
      , Str "execute"
      , Space
      , Str "the"
      , Space
      , Code ( "" , [] , [] ) "cmp"
      , Str ","
      , Space
      , Code ( "" , [] , [] ) "b.ge"
      , Space
      , Str "and"
      , Space
      , Str "potentially"
      , Space
      , Str "more"
      , Space
      , Str "instructions"
      , Space
      , Str "in"
      , Space
      , Str "parallel,"
      , Space
      , Str "the"
      , SoftBreak
      , Str "CPU"
      , Space
      , Str "predicts"
      , Space
      , Str "the"
      , Space
      , Str "outcome"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "branch"
      , Space
      , Str "instruction."
      , Space
      , Str "In"
      , Space
      , Str "other"
      , Space
      , Str "words,"
      , Space
      , Str "it"
      , Space
      , Str "predicts"
      , SoftBreak
      , Str "whether"
      , Space
      , Str "the"
      , Space
      , Str "branch"
      , Space
      , Str "is"
      , Space
      , Str "taken"
      , Space
      , Str "or"
      , Space
      , Str "not."
      , Space
      , Str "The"
      , Space
      , Str "CPU"
      , Space
      , Str "will"
      , Space
      , Str "pick"
      , Space
      , Str "up"
      , Space
      , Str "either"
      , Space
      , Str "the"
      , Space
      , Code ( "" , [] , [] ) "neg"
      , Space
      , Str "or"
      , Space
      , Str "the"
      , SoftBreak
      , Code ( "" , [] , [] ) "ret"
      , Space
      , Str "instruction"
      , Space
      , Str "to"
      , Space
      , Str "start"
      , Space
      , Str "executing"
      , Space
      , Str "next."
      , Space
      , Str "This"
      , Space
      , Str "is"
      , Space
      , Str "called"
      , Space
      , Emph [ Str "speculation" ]
      , Str ","
      , Space
      , Str "as"
      , Space
      , Str "the"
      , SoftBreak
      , Str "CPU"
      , Space
      , Emph [ Str "speculatively" , Space , Str "executes" ]
      , Space
      , Str "either"
      , Space
      , Str "instruction"
      , Space
      , Code ( "" , [] , [] ) "neg"
      , Str ","
      , Space
      , Str "or"
      , Space
      , Code ( "" , [] , [] ) "ret"
      , Str "."
      ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "Show"
          , Space
          , Str "a"
          , Space
          , Str "second"
          , Space
          , Str "example"
          , Space
          , Str "of"
          , Space
          , Str "cpu"
          , Space
          , Str "speculation"
          , Space
          , Str "that"
          , Space
          , Str "is"
          , Space
          , Str "not"
          , Space
          , Str "based"
          , Space
          , Str "on"
          , SoftBreak
          , Str "branch"
          , Space
          , Str "prediction."
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "177" ]
          ]
      ]
  , Para
      [ Str "Of"
      , Space
      , Str "course,"
      , Space
      , Str "as"
      , Space
      , Str "with"
      , Space
      , Str "all"
      , Space
      , Str "predictions,"
      , Space
      , Str "the"
      , Space
      , Str "CPU"
      , Space
      , Str "gets"
      , Space
      , Str "the"
      , Space
      , Str "prediction"
      , Space
      , Str "wrong"
      , Space
      , Str "from"
      , Space
      , Str "time"
      , SoftBreak
      , Str "to"
      , Space
      , Str "time."
      , Space
      , Str "In"
      , Space
      , Str "that"
      , Space
      , Str "case,"
      , Space
      , Str "all"
      , Space
      , Str "changes"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "system"
      , Space
      , Str "state"
      , Space
      , Str "that"
      , Space
      , Str "affect"
      , Space
      , Str "the"
      , Space
      , Str "correct"
      , SoftBreak
      , Str "execution"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "program"
      , Space
      , Str "need"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "undone."
      , Space
      , Str "In"
      , Space
      , Str "the"
      , Space
      , Str "above"
      , Space
      , Str "example,"
      , Space
      , Str "if"
      , Space
      , Str "the"
      , Space
      , Str "branch"
      , SoftBreak
      , Str "should"
      , Space
      , Str "have"
      , Space
      , Str "been"
      , Space
      , Str "taken,"
      , Space
      , Str "but"
      , Space
      , Str "the"
      , Space
      , Str "CPU"
      , Space
      , Str "predicted"
      , Space
      , Str "it"
      , Space
      , Str "to"
      , Space
      , Str "not"
      , Space
      , Str "be"
      , Space
      , Str "taken,"
      , Space
      , Str "the"
      , Space
      , Code ( "" , [] , [] ) "neg"
      , SoftBreak
      , Str "instruction"
      , Space
      , Str "is"
      , Space
      , Str "executed"
      , Space
      , Str "incorrectly"
      , Space
      , Str "and"
      , Space
      , Str "changes"
      , Space
      , Str "the"
      , Space
      , Str "value"
      , Space
      , Str "in"
      , Space
      , Str "register"
      , Space
      , Code ( "" , [] , [] ) "x0"
      , Str "."
      , SoftBreak
      , Str "After"
      , Space
      , Str "discovering"
      , Space
      , Str "the"
      , Space
      , Str "branch"
      , Space
      , Str "was"
      , Space
      , Str "mis-predicted,"
      , Space
      , Str "the"
      , Space
      , Str "CPU"
      , Space
      , Str "would"
      , Space
      , Str "have"
      , Space
      , Str "to"
      , Space
      , Str "restore"
      , SoftBreak
      , Str "the"
      , Space
      , Str "correct,"
      , Space
      , Str "non-negated,"
      , Space
      , Str "value"
      , Space
      , Str "in"
      , Space
      , Str "register"
      , Space
      , Code ( "" , [] , [] ) "x0"
      , Str "."
      ]
  , Para
      [ Str "Any"
      , Space
      , Str "instructions"
      , Space
      , Str "that"
      , Space
      , Str "are"
      , Space
      , Str "executed"
      , Space
      , Str "under"
      , Space
      , Str "so-called"
      , SoftBreak
      , Strong [ Str "mis-speculation" ]
      , RawInline (Format "tex") "\\index{mis-speculation}"
      , Str ","
      , Space
      , Str "are"
      , Space
      , Str "called"
      , Space
      , Strong
          [ Str "transient" , SoftBreak , Str "instructions" ]
      , RawInline (Format "tex") "\\index{transient instructions}"
      , Str "."
      , Note
          [ Para
              [ Str "Transient"
              , Space
              , Str "instructions"
              , Space
              , Str "caused"
              , Space
              , Str "by"
              , SoftBreak
              , Str "incorrect"
              , Space
              , Str "branch-direction"
              , Space
              , Str "prediction"
              , Space
              , Str "have"
              , Space
              , Str "also"
              , Space
              , Str "been"
              , Space
              , Str "called"
              , Space
              , Strong
                  [ Str "wrong-path" , SoftBreak , Str "instructions" ]
              , RawInline
                  (Format "tex") "\\index{wrong-patch instructions}"
              , Space
              , Cite
                  [ Citation
                      { citationId = "Mutlu2004"
                      , citationPrefix = []
                      , citationSuffix = []
                      , citationMode = AuthorInText
                      , citationNoteNum = 94
                      , citationHash = 0
                      }
                  ]
                  [ Str "@Mutlu2004" ]
              ]
          ]
      ]
  , Para
      [ Str "The"
      , Space
      , Str "paragraph"
      , Space
      , Str "above"
      , Space
      , Str "says"
      , Space
      , Quoted
          DoubleQuote
          [ Emph
              [ Str "the"
              , Space
              , Str "system"
              , Space
              , Str "state"
              , Space
              , Str "that"
              , Space
              , Str "affects"
              , Space
              , Str "the"
              , Space
              , Str "correct"
              , Space
              , Str "execution"
              , SoftBreak
              , Str "of"
              , Space
              , Str "the"
              , Space
              , Str "program,"
              , Space
              , Str "needs"
              , Space
              , Str "to"
              , Space
              , Str "be"
              , Space
              , Str "undone"
              ]
          ]
      , Str "."
      , Space
      , Str "There"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "lot"
      , Space
      , Str "of"
      , Space
      , Str "system"
      , Space
      , Str "state"
      , Space
      , Str "that"
      , Space
      , Str "does"
      , SoftBreak
      , Str "not"
      , Space
      , Str "affect"
      , Space
      , Str "the"
      , Space
      , Str "correct"
      , Space
      , Str "execution"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "program."
      , Space
      , Str "And"
      , Space
      , Str "the"
      , Space
      , Str "changes"
      , Space
      , Str "to"
      , Space
      , Str "such"
      , Space
      , Str "system"
      , SoftBreak
      , Str "state"
      , Space
      , Str "by"
      , Space
      , Str "transient"
      , Space
      , Str "instructions"
      , Space
      , Str "is"
      , Space
      , Str "often"
      , Space
      , Str "not"
      , Space
      , Str "undone."
      ]
  , Para
      [ Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "a"
      , Space
      , Str "transient"
      , Space
      , Str "load"
      , Space
      , Str "instruction"
      , Space
      , Str "can"
      , Space
      , Str "fetch"
      , Space
      , Str "a"
      , Space
      , Str "value"
      , Space
      , Str "into"
      , Space
      , Str "the"
      , Space
      , Str "cache"
      , Space
      , Str "that"
      , SoftBreak
      , Str "was"
      , Space
      , Str "not"
      , Space
      , Str "there"
      , Space
      , Str "before."
      , Space
      , Str "By"
      , Space
      , Str "bringing"
      , Space
      , Str "that"
      , Space
      , Str "value"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "cache,"
      , Space
      , Str "it"
      , Space
      , Str "could"
      , Space
      , Str "have"
      , Space
      , Str "evicted"
      , SoftBreak
      , Str "another"
      , Space
      , Str "value"
      , Space
      , Str "from"
      , Space
      , Str "the"
      , Space
      , Str "cache."
      , Space
      , Str "Whether"
      , Space
      , Str "a"
      , Space
      , Str "value"
      , Space
      , Str "is"
      , Space
      , Str "present"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "cache"
      , Space
      , Str "does"
      , Space
      , Str "not"
      , SoftBreak
      , Str "influence"
      , Space
      , Str "the"
      , Space
      , Str "correct"
      , Space
      , Str "execution"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "program;"
      , Space
      , Str "it"
      , Space
      , Str "merely"
      , Space
      , Str "influences"
      , Space
      , Str "its"
      , Space
      , Str "execution"
      , SoftBreak
      , Str "speed."
      , Space
      , Str "Therefore,"
      , Space
      , Str "the"
      , Space
      , Str "effect"
      , Space
      , Str "of"
      , Space
      , Str "transient"
      , Space
      , Str "execution"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "content"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "cache"
      , SoftBreak
      , Str "is"
      , Space
      , Str "typically"
      , Space
      , Str "not"
      , Space
      , Str "undone"
      , Space
      , Str "when"
      , Space
      , Str "detecting"
      , Space
      , Str "mis-speculation."
      ]
  , Para
      [ Str "Sometimes,"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , Space
      , Str "said"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Strong [ Str "architectural" , Space , Str "effects" ]
      , RawInline (Format "tex") "\\index{architectural\neffects}"
      , Space
      , Str "of"
      , Space
      , Str "transient"
      , Space
      , Str "instructions"
      , Space
      , Str "need"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "undone,"
      , Space
      , Str "but"
      , Space
      , Str "the"
      , SoftBreak
      , Strong
          [ Str "micro-architectural" , Space , Str "effects" ]
      , RawInline
          (Format "tex") "\\index{micro-architectural effects}"
      , Space
      , Str "do"
      , Space
      , Str "not"
      , Space
      , Str "need"
      , SoftBreak
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "undone."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "above"
      , Space
      , Str "explanation"
      , Space
      , Str "describes"
      , Space
      , Str "architectural"
      , Space
      , Str "effects"
      , Space
      , Str "as"
      , Space
      , Str "changes"
      , Space
      , Str "in"
      , Space
      , Str "system"
      , Space
      , Str "state"
      , SoftBreak
      , Str "that"
      , Space
      , Str "need"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "undone"
      , Space
      , Str "after"
      , Space
      , Str "detecting"
      , Space
      , Str "mis-speculation."
      , Space
      , Str "In"
      , Space
      , Str "reality,"
      , Space
      , Str "most"
      , Space
      , Str "systems"
      , SoftBreak
      , Str "will"
      , Space
      , Str "implement"
      , Space
      , Str "techniques"
      , Space
      , Str "that"
      , Space
      , Str "keep"
      , Space
      , Str "all"
      , Space
      , Str "state"
      , Space
      , Str "changes"
      , Space
      , Str "in"
      , Space
      , Str "micro-architectural"
      , SoftBreak
      , Str "buffers"
      , Space
      , Str "until"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , Space
      , Str "clear"
      , Space
      , Str "that"
      , Space
      , Str "all"
      , Space
      , Str "predictions"
      , Space
      , Str "made"
      , Space
      , Str "to"
      , Space
      , Str "execute"
      , Space
      , Str "that"
      , Space
      , Str "instruction"
      , SoftBreak
      , Str "were"
      , Space
      , Str "correct."
      , Space
      , Str "At"
      , Space
      , Str "that"
      , Space
      , Str "point"
      , Space
      , Str "the"
      , Space
      , Str "micro-architectural"
      , Space
      , Str "state"
      , Space
      , Str "is"
      , Space
      , Strong [ Str "committed" ]
      , Space
      , Str "to"
      , SoftBreak
      , Str "become"
      , Space
      , Str "architectural"
      , Space
      , Str "state."
      , Space
      , Str "In"
      , Space
      , Str "that"
      , Space
      , Str "way,"
      , Space
      , Str "mis-predictions"
      , Space
      , Str "naturally"
      , Space
      , Str "do"
      , Space
      , Str "not"
      , Space
      , Str "affect"
      , SoftBreak
      , Str "architectural"
      , Space
      , Str "state."
      , Space
      , Span
          ( "" , [ "todo" ] , [] )
          [ Str "Could"
          , Space
          , Str "we"
          , Space
          , Str "find"
          , Space
          , Str "a"
          , Space
          , Str "good"
          , Space
          , Str "reference"
          , Space
          , Str "that"
          , Space
          , Str "explains"
          , SoftBreak
          , Str "micro-architectural"
          , Space
          , Str "versus"
          , Space
          , Str "architectural"
          , Space
          , Str "state"
          , Space
          , Str "in"
          , Space
          , Str "more"
          , Space
          , Str "detail?"
          , Space
          , Str "Is"
          , Space
          , Quoted
              DoubleQuote
              [ Str "Computer"
              , SoftBreak
              , Str "Architecture:"
              , Space
              , Str "A"
              , Space
              , Str "Quantitative"
              , Space
              , Str "Approach"
              ]
          , Space
          , Str "the"
          , Space
          , Str "best"
          , Space
          , Str "reference"
          , Space
          , Str "available?"
          ]
      ]
  , Para
      [ Strong [ Str "Faulting" , Space , Str "instructions" ]
      , RawInline (Format "tex") "\\index{faulting instructions}"
      , Space
      , Str "are"
      , Space
      , Str "instructions"
      , Space
      , Str "that"
      , SoftBreak
      , Str "generate"
      , Space
      , Str "an"
      , Space
      , Str "exception"
      , Space
      , Str "at"
      , Space
      , Str "run-time."
      , Space
      , Str "Many"
      , Space
      , Str "instructions"
      , Space
      , Str "can"
      , Space
      , Str "generate"
      , Space
      , Str "an"
      , Space
      , Str "exception,"
      , SoftBreak
      , Str "and"
      , Space
      , Str "are"
      , Space
      , Str "hence"
      , Space
      , Strong [ Str "potentially" , Space , Str "faulting" ]
      , Str "."
      , Space
      , Str "For"
      , Space
      , Str "example"
      , Space
      , Str "most"
      , Space
      , Str "load"
      , Space
      , Str "and"
      , Space
      , Str "store"
      , SoftBreak
      , Str "instructions"
      , Space
      , Str "generate"
      , Space
      , Str "an"
      , Space
      , Str "exception"
      , Space
      , Str "when"
      , Space
      , Str "the"
      , Space
      , Str "accessed"
      , Space
      , Str "address"
      , Space
      , Str "is"
      , Space
      , Str "not"
      , Space
      , Str "mapped."
      , SoftBreak
      , Str "Since"
      , Space
      , Str "so"
      , Space
      , Str "many"
      , Space
      , Str "instructions"
      , Space
      , Str "can"
      , Space
      , Str "generate"
      , Space
      , Str "an"
      , Space
      , Str "exception,"
      , Space
      , Str "processors"
      , Space
      , Str "typically"
      , SoftBreak
      , Str "speculate"
      , Space
      , Str "that"
      , Space
      , Str "they"
      , Space
      , Str "do"
      , Space
      , Str "not"
      , Space
      , Str "generate"
      , Space
      , Str "an"
      , Space
      , Str "exception"
      , Space
      , Str "to"
      , Space
      , Str "enable"
      , Space
      , Str "more"
      , Space
      , Str "parallel"
      , SoftBreak
      , Str "execution."
      ]
  , Para
      [ Str "When"
      , Space
      , Str "an"
      , Space
      , Str "instruction"
      , Space
      , Str "faults,"
      , Space
      , Str "the"
      , Space
      , Str "execution"
      , Space
      , Str "typically"
      , Space
      , Str "continues"
      , Space
      , Str "at"
      , Space
      , Str "another"
      , SoftBreak
      , Str "location."
      , Space
      , Str "Any"
      , Space
      , Str "instructions"
      , Space
      , Str "later"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "instruction"
      , Space
      , Str "stream"
      , Space
      , Str "which"
      , Space
      , Str "are"
      , SoftBreak
      , Str "speculatively"
      , Space
      , Str "executed"
      , Space
      , Str "before"
      , Space
      , Str "the"
      , Space
      , Str "fault"
      , Space
      , Str "is"
      , Space
      , Str "detected"
      , Space
      , Str "are"
      , Space
      , Str "also"
      , Space
      , Str "called"
      , Space
      , Strong
          [ Str "transient" , SoftBreak , Str "instructions" ]
      , RawInline (Format "tex") "\\index{transient instructions}"
      , Str "."
      ]
  , Para
      [ Str "There"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "kind"
      , Space
      , Str "of"
      , Space
      , Str "control"
      , Space
      , Str "dependency"
      , Space
      , Str "between"
      , Space
      , Str "every"
      , Space
      , Str "potentially-faulting"
      , SoftBreak
      , Str "instruction"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , Space
      , Str "next"
      , Space
      , Str "one,"
      , Space
      , Str "as"
      , Space
      , Str "the"
      , Space
      , Str "next"
      , Space
      , Str "instruction"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "executed"
      , Space
      , Str "depends"
      , Space
      , Str "on"
      , SoftBreak
      , Str "whether"
      , Space
      , Str "the"
      , Space
      , Str "instruction"
      , Space
      , Str "generates"
      , Space
      , Str "an"
      , Space
      , Str "exception"
      , Space
      , Str "or"
      , Space
      , Str "not."
      , Space
      , Str "We"
      , Space
      , Str "call"
      , Space
      , Str "out"
      , Space
      , Str "this"
      , SoftBreak
      , Str "dependency"
      , Space
      , Str "separately"
      , Space
      , Str "here"
      , Space
      , Str "as"
      , Space
      , Str "the"
      , Space
      , Str "transient"
      , Space
      , Str "execution"
      , Space
      , Str "attacks"
      , Space
      , Str "we\8217ll"
      , Space
      , Str "describe"
      , SoftBreak
      , Str "next"
      , Space
      , Str "get"
      , Space
      , Str "classified"
      , Space
      , Str "based"
      , Space
      , Str "on"
      , Space
      , Str "whether"
      , Space
      , Str "they"
      , Space
      , Str "make"
      , Space
      , Str "use"
      , Space
      , Str "of"
      , Space
      , Str "transient"
      , Space
      , Str "instructions"
      , SoftBreak
      , Str "after"
      , Space
      , Str "a"
      , Space
      , Str "misprediction,"
      , Space
      , Str "or"
      , Space
      , Str "transient"
      , Space
      , Str "instructions"
      , Space
      , Str "after"
      , Space
      , Str "a"
      , Space
      , Str "faulting"
      , Space
      , Str "instruction."
      ]
  , Header
      3
      ( "transient-execution-attacks-1" , [] , [] )
      [ Str "Transient"
      , Space
      , Str "Execution"
      , Space
      , Str "Attacks"
      ]
  , Para
      [ Strong
          [ Str "Transient"
          , Space
          , Str "execution"
          , Space
          , Str "attacks"
          ]
      , RawInline
          (Format "tex") "\\index{transient execution attacks}"
      , Space
      , Str "are"
      , Space
      , Str "a"
      , SoftBreak
      , Str "category"
      , Space
      , Str "of"
      , Space
      , Str "side-channel"
      , Space
      , Str "attacks"
      , Space
      , Str "that"
      , Space
      , Str "use"
      , Space
      , Str "the"
      , Space
      , Str "micro-architectural"
      , Space
      , Str "side-effects"
      , SoftBreak
      , Str "of"
      , Space
      , Str "transient"
      , Space
      , Str "execution"
      , Space
      , Str "as"
      , Space
      , Str "a"
      , Space
      , Str "side"
      , Space
      , Str "channel."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "publication"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "Spectre"
      , RawInline (Format "tex") "\\index{Spectre}"
      , Space
      , Cite
          [ Citation
              { citationId = "Kocher2019"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 95
              , citationHash = 0
              }
          ]
          [ Str "[@Kocher2019]" ]
      , Space
      , Str "and"
      , SoftBreak
      , Str "Meltdown"
      , RawInline (Format "tex") "\\index{Meltdown}"
      , Space
      , Cite
          [ Citation
              { citationId = "Lipp2018"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 96
              , citationHash = 0
              }
          ]
          [ Str "[@Lipp2018]" ]
      , Space
      , Str "attacks"
      , Space
      , Str "in"
      , Space
      , Str "2018"
      , Space
      , Str "started"
      , Space
      , Str "a"
      , Space
      , Str "period"
      , Space
      , Str "in"
      , Space
      , Str "which"
      , Space
      , Str "a"
      , SoftBreak
      , Str "large"
      , Space
      , Str "number"
      , Space
      , Str "of"
      , Space
      , Str "transient"
      , Space
      , Str "attacks"
      , Space
      , Str "were"
      , Space
      , Str "discovered"
      , Space
      , Str "and"
      , Space
      , Str "published."
      , Space
      , Str "Most"
      , Space
      , Str "of"
      , Space
      , Str "them"
      , SoftBreak
      , Str "were"
      , Space
      , Str "given"
      , Space
      , Str "specific"
      , Space
      , Str "names,"
      , Space
      , Str "such"
      , Space
      , Str "as"
      , Space
      , Str "ZombieLoad,"
      , Space
      , Str "NetSpectre,"
      , Space
      , Str "LVI,"
      , Space
      , Str "Straight-line"
      , SoftBreak
      , Str "Speculation,"
      , Space
      , Str "etc."
      , Space
      , Str "New"
      , Space
      , Str "variants"
      , Space
      , Str "continue"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "published"
      , Space
      , Str "regularly."
      ]
  , Para
      [ Str "Covering"
      , Space
      , Str "each"
      , Space
      , Str "one"
      , Space
      , Str "of"
      , Space
      , Str "them"
      , Space
      , Str "in"
      , Space
      , Str "detail"
      , Space
      , Str "here"
      , Space
      , Str "would"
      , Space
      , Str "make"
      , Space
      , Str "the"
      , Space
      , Str "book"
      , Space
      , Str "overly"
      , Space
      , Str "lengthy,"
      , Space
      , Str "and"
      , SoftBreak
      , Str "may"
      , Space
      , Str "not"
      , Space
      , Str "necessarily"
      , Space
      , Str "help"
      , Space
      , Str "much"
      , Space
      , Str "with"
      , Space
      , Str "gaining"
      , Space
      , Str "a"
      , Space
      , Str "better"
      , Space
      , Str "insight"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "common"
      , SoftBreak
      , Str "characteristics"
      , Space
      , Str "of"
      , Space
      , Str "transient"
      , Space
      , Str "attacks."
      , Space
      , Str "Therefore,"
      , Space
      , Str "we\8217ll"
      , Space
      , Str "try"
      , Space
      , Str "to"
      , Space
      , Str "put"
      , Space
      , Str "them"
      , Space
      , Str "into"
      , Space
      , Str "a"
      , SoftBreak
      , Str "few"
      , Space
      , Str "categories"
      , Space
      , Str "and"
      , Space
      , Str "describe"
      , Space
      , Str "the"
      , Space
      , Str "characteristics"
      , Space
      , Str "of"
      , Space
      , Str "each"
      , Space
      , Str "category."
      ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "Decide"
          , Space
          , Str "whether"
          , Space
          , Str "it\8217s"
          , Space
          , Str "useful"
          , Space
          , Str "to"
          , Space
          , Str "talk"
          , Space
          , Str "about"
          , Space
          , Str "alternative"
          , Space
          , Str "categorizations"
          , Space
          , Str "of"
          , SoftBreak
          , Str "transient"
          , Space
          , Str "execution"
          , Space
          , Str "attacks,"
          , Space
          , Str "and"
          , Space
          , Str "if"
          , Space
          , Str "so,"
          , Space
          , Str "do"
          , Space
          , Str "add"
          , Space
          , Str "content."
          , Space
          , Str "Consider"
          , Space
          , Str "pointing"
          , Space
          , Str "to"
          , SoftBreak
          , Link
              ( "" , [] , [] )
              [ Str
                  "https://github.com/MattPD/cpplinks/blob/master/comparch.micro.channels.md"
              ]
              ( "https://github.com/MattPD/cpplinks/blob/master/comparch.micro.channels.md"
              , ""
              )
          ]
      ]
  , Para
      [ Str "The"
      , Space
      , Str "categorization"
      , Space
      , Str "below"
      , Space
      , Str "is"
      , Space
      , Str "based"
      , Space
      , Str "on"
      , Space
      , Str "one"
      , Space
      , Str "proposed"
      , Space
      , Str "in"
      , Space
      , Cite
          [ Citation
              { citationId = "Bulck2020"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 97
              , citationHash = 0
              }
          ]
          [ Str "[@Bulck2020]" ]
      , Str "."
      , Space
      , Str "There"
      , Space
      , Str "are"
      , SoftBreak
      , Str "alternative"
      , Space
      , Str "categorizations."
      , Space
      , Cite
          [ Citation
              { citationId = "Bulck2020"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 98
              , citationHash = 0
              }
          ]
          [ Str "[@Bulck2020]" ]
      , Space
      , Str "defines"
      , Space
      , Str "4"
      , Space
      , Str "big"
      , Space
      , Str "classes"
      , Space
      , Str "of"
      , Space
      , Str "transient"
      , SoftBreak
      , Str "side-channel"
      , Space
      , Str "attack"
      , Space
      , Str "categories,"
      , Space
      , Str "based"
      , Space
      , Str "on"
      , Space
      , Str "whether:"
      ]
  , OrderedList
      ( 1 , Decimal , Period )
      [ [ Plain
            [ Str "The"
            , Space
            , Str "transient"
            , Space
            , Str "execution"
            , Space
            , Str "happens"
            , Space
            , Str "because"
            , Space
            , Str "of"
            , Space
            , Str "a"
            , Space
            , Str "misprediction,"
            , Space
            , Str "or"
            , Space
            , Str "a"
            , Space
            , Str "faulting"
            , SoftBreak
            , Str "instruction."
            ]
        ]
      , [ Plain
            [ Str "The"
            , Space
            , Str "attacker"
            , Space
            , Str "actively"
            , Space
            , Str "steers"
            , Space
            , Str "data"
            , Space
            , Str "or"
            , Space
            , Str "control"
            , Space
            , Str "flow"
            , Space
            , Str "of"
            , Space
            , Str "the"
            , Space
            , Str "transient"
            , Space
            , Str "execution"
            , SoftBreak
            , Str "or"
            , Space
            , Str "not."
            ]
        ]
      ]
  , Para
      [ Str "This"
      , Space
      , Str "gives"
      , Space
      , Str "the"
      , Space
      , Str "following"
      , Space
      , Str "4"
      , Space
      , Str "categories:"
      ]
  , Table
      ( "" , [] , [] )
      (Caption Nothing [])
      [ ( AlignDefault , ColWidth 0.2361111111111111 )
      , ( AlignDefault , ColWidth 0.3611111111111111 )
      , ( AlignDefault , ColWidth 0.3472222222222222 )
      ]
      (TableHead
         ( "" , [] , [] )
         [ Row
             ( "" , [] , [] )
             [ Cell
                 ( "" , [] , [] )
                 AlignDefault
                 (RowSpan 2)
                 (ColSpan 1)
                 []
             , Cell
                 ( "" , [] , [] )
                 AlignDefault
                 (RowSpan 1)
                 (ColSpan 2)
                 [ Plain
                     [ Str "Steering"
                     , Space
                     , Str "of"
                     , Space
                     , Str "transient"
                     , Space
                     , Str "execution"
                     , Space
                     , Str "by"
                     , Space
                     , Str "attacker?"
                     ]
                 ]
             ]
         , Row
             ( "" , [] , [] )
             [ Cell
                 ( "" , [] , [] )
                 AlignDefault
                 (RowSpan 1)
                 (ColSpan 1)
                 [ Plain [ Str "No" , Space , Str "(Leakage)" ] ]
             , Cell
                 ( "" , [] , [] )
                 AlignDefault
                 (RowSpan 1)
                 (ColSpan 1)
                 [ Plain [ Str "Yes" , Space , Str "(Injection)" ] ]
             ]
         ])
      [ TableBody
          ( "" , [] , [] )
          (RowHeadColumns 0)
          []
          [ Row
              ( "" , [] , [] )
              [ Cell
                  ( "" , [] , [] )
                  AlignDefault
                  (RowSpan 1)
                  (ColSpan 1)
                  [ Plain [ Str "Misprediction" ] ]
              , Cell
                  ( "" , [] , [] )
                  AlignDefault
                  (RowSpan 1)
                  (ColSpan 1)
                  [ Plain
                      [ Str "Branch-predictor"
                      , Space
                      , Str "based"
                      , SoftBreak
                      , Str "side-channels"
                      ]
                  ]
              , Cell
                  ( "" , [] , [] )
                  AlignDefault
                  (RowSpan 1)
                  (ColSpan 1)
                  [ Plain
                      [ Str "Spectre-style" , Space , Str "attacks" ]
                  ]
              ]
          , Row
              ( "" , [] , [] )
              [ Cell
                  ( "" , [] , [] )
                  AlignDefault
                  (RowSpan 1)
                  (ColSpan 1)
                  [ Plain [ Str "Faulting" ] ]
              , Cell
                  ( "" , [] , [] )
                  AlignDefault
                  (RowSpan 1)
                  (ColSpan 1)
                  [ Plain
                      [ Str "Meltdown-style" , Space , Str "attacks" ]
                  ]
              , Cell
                  ( "" , [] , [] )
                  AlignDefault
                  (RowSpan 1)
                  (ColSpan 1)
                  [ Plain [ Str "LVI-style" , Space , Str "attacks" ] ]
              ]
          ]
      ]
      (TableFoot ( "" , [] , [] ) [])
  , Header
      4
      ( "branch-predictor-based-side-channel-attacks" , [] , [] )
      [ Str "Branch"
      , Space
      , Str "predictor-based"
      , Space
      , Str "side-channel"
      , Space
      , Str "attacks"
      ]
  , Para
      [ Str "We"
      , Space
      , Str "discussed"
      , Space
      , Str "this"
      , Space
      , Str "category"
      , Space
      , Str "already"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "section"
      , Space
      , Str "on"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "Side-channels"
          , Space
          , Str "through"
          , Space
          , Str "branch"
          , Space
          , Str "predictors"
          ]
          ( "#side-channels-through-branch-predictors" , "" )
      , Str "."
      ]
  , Header
      4
      ( "spectre-style-attacks" , [] , [] )
      [ Str "Spectre-style" , Space , Str "attacks" ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "Add"
          , Space
          , Str "a"
          , Space
          , Str "description"
          , Space
          , Str "of"
          , Space
          , Str "Spectre-style"
          , Space
          , Str "attacks"
          , Space
          , Str "such"
          , Space
          , Str "as"
          , Space
          , Str "Spectre-PHT,"
          , Space
          , Str "Spectre-BTB,"
          , SoftBreak
          , Str "Spectre-RSB,"
          , Space
          , Str "Spectre-STL,"
          , Space
          , Str "SpectreV1,"
          , Space
          , Str "SpectreV2,"
          , Space
          , Str "SpectreV3,"
          , Space
          , Str "SpectreV4,"
          , SoftBreak
          , Str "NetSpectre."
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "178" ]
          ]
      ]
  , Header
      4
      ( "meltdown-style-attacks" , [] , [] )
      [ Str "Meltdown-style" , Space , Str "attacks" ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "Add"
          , Space
          , Str "a"
          , Space
          , Str "description"
          , Space
          , Str "of"
          , Space
          , Str "Meltdown-style"
          , Space
          , Str "attacks"
          , Space
          , Str "such"
          , Space
          , Str "as"
          , Space
          , Str "Meltdown,"
          , Space
          , Str "Foreshadow,"
          , SoftBreak
          , Str "LazyFP,"
          , Space
          , Str "Fallout,"
          , Space
          , Str "ZombieLoad,"
          , Space
          , Str "RIDL."
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "178" ]
          ]
      ]
  , Header
      4
      ( "lvi-style-attacks" , [] , [] )
      [ Str "LVI-style" , Space , Str "attacks" ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "Add"
          , Space
          , Str "a"
          , Space
          , Str "description"
          , Space
          , Str "of"
          , Space
          , Str "LVI-style"
          , Space
          , Str "attacks."
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "178" ]
          ]
      ]
  , Header
      3
      ( "mitigations-against-transient-execution-attacks"
      , []
      , []
      )
      [ Str "Mitigations"
      , Space
      , Str "against"
      , Space
      , Str "transient"
      , Space
      , Str "execution"
      , Space
      , Str "attacks"
      ]
  , Header
      4
      ( "site-isolation" , [] , [] )
      [ Str "Site" , Space , Str "isolation" ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "Write"
          , Space
          , Str "section"
          , Space
          , Str "on"
          , Space
          , Str "site"
          , Space
          , Str "isolation"
          , Space
          , Str "as"
          , Space
          , Str "a"
          , Space
          , Str "SpectreV1"
          , Space
          , Str "mitigation"
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "179" ]
          ]
      ]
  , Header
      2
      ( "physical-access-side-channel-attacks" , [] , [] )
      [ Str "Physical"
      , Space
      , Str "access"
      , Space
      , Str "side-channel"
      , Space
      , Str "attacks"
      ]
  , Header
      1
      ( "supply-chain-attacks" , [] , [] )
      [ Str "Supply"
      , Space
      , Str "chain"
      , Space
      , Str "attacks"
      ]
  , Para
      [ Str "A"
      , Space
      , Str "software"
      , Space
      , Emph
          [ Str "supply"
          , Space
          , Str "chain"
          , Space
          , Str "attack"
          ]
      , Space
      , Str "occurs"
      , Space
      , Str "when"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "interferes"
      , Space
      , Str "with"
      , Space
      , Str "the"
      , SoftBreak
      , Str "software"
      , Space
      , Str "development"
      , Space
      , Str "or"
      , Space
      , Str "distribution"
      , Space
      , Str "processes"
      , Space
      , Str "with"
      , Space
      , Str "the"
      , Space
      , Str "intention"
      , Space
      , Str "to"
      , Space
      , Str "impact"
      , SoftBreak
      , Str "users"
      , Space
      , Str "of"
      , Space
      , Str "that"
      , Space
      , Str "software."
      ]
  , Para
      [ Str "Supply"
      , Space
      , Str "chain"
      , Space
      , Str "attacks"
      , Space
      , Str "and"
      , Space
      , Str "their"
      , Space
      , Str "possible"
      , Space
      , Str "mitigations"
      , Space
      , Str "are"
      , Space
      , Str "not"
      , Space
      , Str "specific"
      , Space
      , Str "to"
      , SoftBreak
      , Str "compilers."
      , Space
      , Str "However,"
      , Space
      , Str "compilers"
      , Space
      , Str "are"
      , Space
      , Str "an"
      , Space
      , Str "attractive"
      , Space
      , Str "target"
      , Space
      , Str "for"
      , Space
      , Str "attack"
      , Space
      , Str "because"
      , Space
      , Str "they"
      , SoftBreak
      , Str "are"
      , Space
      , Str "widely"
      , Space
      , Str "deployed"
      , Space
      , Str "to"
      , Space
      , Str "developers,"
      , Space
      , Str "in"
      , Space
      , Str "continuous"
      , Space
      , Str "integration"
      , Space
      , Str "systems"
      , Space
      , Str "and"
      , Space
      , Str "as"
      , SoftBreak
      , Str "JITs."
      , Space
      , Str "Also,"
      , Space
      , Str "an"
      , Space
      , Str "infected"
      , Space
      , Str "compiler"
      , Space
      , Str "has"
      , Space
      , Str "the"
      , Space
      , Str "possibility"
      , Space
      , Str "to"
      , Space
      , Str "make"
      , Space
      , Str "a"
      , Space
      , Str "much"
      , Space
      , Str "larger"
      , SoftBreak
      , Str "impact"
      , Space
      , Str "if"
      , Space
      , Str "it"
      , Space
      , Str "can"
      , Space
      , Str "silently"
      , Space
      , Str "spread"
      , Space
      , Str "the"
      , Space
      , Str "infection"
      , Space
      , Str "to"
      , Space
      , Str "other"
      , Space
      , Str "software"
      , Space
      , Str "created"
      , Space
      , Str "with"
      , SoftBreak
      , Str "or"
      , Space
      , Str "run"
      , Space
      , Str "using"
      , Space
      , Str "it."
      ]
  , Para
      [ Str "This"
      , Space
      , Str "chapter"
      , Space
      , Str "explores"
      , Space
      , Str "the"
      , Space
      , Str "history"
      , Space
      , Str "of"
      , Space
      , Str "supply"
      , Space
      , Str "chain"
      , Space
      , Str "attacks"
      , Space
      , Str "that"
      , Space
      , Str "involve"
      , SoftBreak
      , Str "compilers"
      , Space
      , Str "and"
      , Space
      , Str "what"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "done"
      , Space
      , Str "to"
      , Space
      , Str "prevent"
      , Space
      , Str "them."
      ]
  , Header
      2
      ( "history-of-supply-chain-attacks" , [] , [] )
      [ Str "History"
      , Space
      , Str "of"
      , Space
      , Str "supply"
      , Space
      , Str "chain"
      , Space
      , Str "attacks"
      ]
  , Para
      [ Str "As"
      , Space
      , Str "far"
      , Space
      , Str "back"
      , Space
      , Str "as"
      , Space
      , Str "1974"
      , Space
      , Str "Karger"
      , Space
      , Str "&"
      , Space
      , Str "Schell"
      , Space
      , Str "theorized"
      , Space
      , Str "about"
      , Space
      , Str "an"
      , Space
      , Str "attack"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "Multics"
      , SoftBreak
      , Str "operating"
      , Space
      , Str "system"
      , Space
      , Str "via"
      , Space
      , Str "the"
      , Space
      , Str "PL/I"
      , Space
      , Str "compiler"
      , Space
      , Cite
          [ Citation
              { citationId = "Karger1974"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 99
              , citationHash = 0
              }
          ]
          [ Str "[@Karger1974]" ]
      , Str "."
      , Space
      , Str "In"
      , Space
      , Str "this"
      , Space
      , Str "attack,"
      , Space
      , Str "a"
      , Space
      , Str "trap"
      , SoftBreak
      , Str "door"
      , Space
      , Str "is"
      , Space
      , Str "inserted"
      , Space
      , Str "into"
      , Space
      , Str "the"
      , Space
      , Str "compiler,"
      , Space
      , Str "which"
      , Space
      , Str "then"
      , Space
      , Str "injects"
      , Space
      , Str "malicious"
      , Space
      , Str "code"
      , Space
      , Str "into"
      , SoftBreak
      , Str "generated"
      , Space
      , Str "object"
      , Space
      , Str "code."
      , Space
      , Str "Furthermore,"
      , Space
      , Str "the"
      , Space
      , Str "trap"
      , Space
      , Str "door"
      , Space
      , Str "could"
      , Space
      , Str "be"
      , Space
      , Str "designed"
      , Space
      , Str "to"
      , Space
      , Str "reinsert"
      , SoftBreak
      , Str "itself"
      , Space
      , Str "into"
      , Space
      , Str "the"
      , Space
      , Str "compiler"
      , Space
      , Str "binary"
      , Space
      , Str "so"
      , Space
      , Str "that"
      , Space
      , Str "future"
      , Space
      , Str "compilers"
      , Space
      , Str "are"
      , Space
      , Str "silently"
      , Space
      , Str "infected"
      , SoftBreak
      , Str "without"
      , Space
      , Str "needing"
      , Space
      , Str "changes"
      , Space
      , Str "to"
      , Space
      , Str "their"
      , Space
      , Str "source"
      , Space
      , Str "code."
      , Space
      , Str "This"
      , Space
      , Str "attack"
      , Space
      , Str "method"
      , Space
      , Str "was"
      , SoftBreak
      , Str "subsequently"
      , Space
      , Str "popularized"
      , Space
      , Str "by"
      , Space
      , Str "Ken"
      , Space
      , Str "Thompson"
      , Space
      , Str "in"
      , Space
      , Str "his"
      , Space
      , Str "1984"
      , Space
      , Str "ACM"
      , Space
      , Str "Turing"
      , Space
      , Str "Award"
      , SoftBreak
      , Str "acceptance"
      , Space
      , Str "speech"
      , Space
      , Emph
          [ Str "Reflections"
          , Space
          , Str "on"
          , Space
          , Str "Trusting"
          , Space
          , Str "Trust"
          ]
      , Space
      , Cite
          [ Citation
              { citationId = "Thompson1984"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 100
              , citationHash = 0
              }
          ]
          [ Str "[@Thompson1984]" ]
      , Str "."
      ]
  , Para
      [ Str "If"
      , Space
      , Str "these"
      , Space
      , Str "cases"
      , Space
      , Str "seem"
      , Space
      , Str "far-fetched"
      , Space
      , Str "then"
      , Space
      , Str "consider"
      , Space
      , Str "that"
      , Space
      , Str "there"
      , Space
      , Str "have"
      , Space
      , Str "been"
      , Space
      , Str "several"
      , Space
      , Str "real"
      , SoftBreak
      , Str "examples"
      , Space
      , Str "of"
      , Space
      , Str "supply"
      , Space
      , Str "chain"
      , Space
      , Str "attacks"
      , Space
      , Str "on"
      , Space
      , Str "development"
      , Space
      , Str "tools."
      ]
  , Para
      [ Str "Induc"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "family"
      , Space
      , Str "of"
      , Space
      , Str "viruses"
      , Space
      , Str "that"
      , Space
      , Str "infects"
      , Space
      , Str "a"
      , Space
      , Str "pre-compiled"
      , Space
      , Str "library"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "Delphi"
      , SoftBreak
      , Str "toolchain"
      , Space
      , Str "with"
      , Space
      , Str "malicious"
      , Space
      , Str "code"
      , Space
      , Cite
          [ Citation
              { citationId = "Gostev2009"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 101
              , citationHash = 0
              }
          ]
          [ Str "[@Gostev2009]" ]
      , Str "."
      , Space
      , Str "When"
      , Space
      , Str "Delphi"
      , Space
      , Str "compiles"
      , Space
      , Str "a"
      , Space
      , Str "project"
      , Space
      , Str "the"
      , SoftBreak
      , Str "malicious"
      , Space
      , Str "library"
      , Space
      , Str "is"
      , Space
      , Str "included"
      , Space
      , Str "into"
      , Space
      , Str "the"
      , Space
      , Str "resulting"
      , Space
      , Str "executable,"
      , Space
      , Str "thus"
      , Space
      , Str "enabling"
      , Space
      , Str "the"
      , SoftBreak
      , Str "virus"
      , Space
      , Str "to"
      , Space
      , Str "spread."
      , Space
      , Str "The"
      , Space
      , Str "virus"
      , Space
      , Str "was"
      , Space
      , Str "first"
      , Space
      , Str "detected"
      , Space
      , Str "in"
      , Space
      , Str "2009"
      , Space
      , Str "and"
      , Space
      , Str "was"
      , Space
      , Str "circulating"
      , SoftBreak
      , Str "undetected"
      , Space
      , Str "for"
      , Space
      , Str "at"
      , Space
      , Str "least"
      , Space
      , Str "a"
      , Space
      , Str "year"
      , Space
      , Str "beforehand."
      , Space
      , Str "Several"
      , Space
      , Str "popular"
      , Space
      , Str "applications"
      , Space
      , Str "are"
      , SoftBreak
      , Str "known"
      , Space
      , Str "to"
      , Space
      , Str "have"
      , Space
      , Str "been"
      , Space
      , Str "infected,"
      , Space
      , Str "including"
      , Space
      , Str "a"
      , Space
      , Str "chat"
      , Space
      , Str "client"
      , Space
      , Str "and"
      , Space
      , Str "a"
      , Space
      , Str "media"
      , Space
      , Str "player."
      , SoftBreak
      , Str "Overall,"
      , Space
      , Str "in"
      , Space
      , Str "excess"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "hundred"
      , Space
      , Str "thousand"
      , Space
      , Str "infected"
      , Space
      , Str "computers"
      , Space
      , Str "were"
      , Space
      , Str "detected"
      , SoftBreak
      , Str "world-wide"
      , Space
      , Str "by"
      , Space
      , Str "anti-virus"
      , Space
      , Str "solutions."
      ]
  , Para
      [ Str "XcodeGhost"
      , Space
      , Str "is"
      , Space
      , Str "the"
      , Space
      , Str "name"
      , Space
      , Str "given"
      , Space
      , Str "to"
      , Space
      , Str "malware"
      , Space
      , Str "first"
      , Space
      , Str "detected"
      , Space
      , Str "in"
      , Space
      , Str "2015"
      , Space
      , Str "that"
      , Space
      , Str "infected"
      , SoftBreak
      , Str "thousands"
      , Space
      , Str "of"
      , Space
      , Str "iOS"
      , Space
      , Str "applications"
      , Space
      , Cite
          [ Citation
              { citationId = "Cox2015"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 102
              , citationHash = 0
              }
          ]
          [ Str "[@Cox2015]" ]
      , Str "."
      , Space
      , Str "The"
      , Space
      , Str "source"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "infection"
      , Space
      , Str "was"
      , SoftBreak
      , Str "tracked"
      , Space
      , Str "down"
      , Space
      , Str "to"
      , Space
      , Str "a"
      , Space
      , Str "trojanized"
      , Space
      , Str "version"
      , Space
      , Str "of"
      , Space
      , Str "Xcode"
      , Space
      , Str "tools."
      , Space
      , Str "The"
      , Space
      , Str "malware"
      , Space
      , Str "exists"
      , SoftBreak
      , Str "in"
      , Space
      , Str "an"
      , Space
      , Str "extra"
      , Space
      , Str "object"
      , Space
      , Str "file"
      , Space
      , Str "within"
      , Space
      , Str "the"
      , Space
      , Str "Xcode"
      , Space
      , Str "tools"
      , Space
      , Str "and"
      , Space
      , Str "is"
      , Space
      , Str "silently"
      , Space
      , Str "linked"
      , Space
      , Str "into"
      , Space
      , Str "each"
      , SoftBreak
      , Str "application"
      , Space
      , Str "as"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , Space
      , Str "built."
      , Space
      , Str "File"
      , Space
      , Str "sharing"
      , Space
      , Str "sites"
      , Space
      , Str "were"
      , Space
      , Str "used"
      , Space
      , Str "to"
      , Space
      , Str "spread"
      , Space
      , Str "the"
      , SoftBreak
      , Str "trojanized"
      , Space
      , Str "Xcode"
      , Space
      , Str "tools"
      , Space
      , Str "to"
      , Space
      , Str "unwitting"
      , Space
      , Str "developers."
      ]
  , Para
      [ Str "A"
      , Space
      , Str "trojanized"
      , Space
      , Str "linker"
      , Space
      , Str "was"
      , Space
      , Str "found"
      , Space
      , Str "to"
      , Space
      , Str "be"
      , Space
      , Str "involved"
      , Space
      , Str "in"
      , Space
      , Str "a"
      , Space
      , Str "supply"
      , Space
      , Str "chain"
      , Space
      , Str "attack"
      , Space
      , Str "discovered"
      , SoftBreak
      , Str "in"
      , Space
      , Str "2017"
      , Space
      , Str "named"
      , Space
      , Str "ShadowPad"
      , Space
      , Cite
          [ Citation
              { citationId = "Greenberg2019"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 103
              , citationHash = 0
              }
          ]
          [ Str "[@Greenberg2019]" ]
      , Str "."
      , Space
      , Str "Some"
      , Space
      , Str "instances"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "attack"
      , Space
      , Str "were"
      , SoftBreak
      , Str "perpetrated"
      , Space
      , Str "using"
      , Space
      , Str "a"
      , Space
      , Str "trojanized"
      , Space
      , Str "Visual"
      , Space
      , Str "Studio"
      , Space
      , Str "linker"
      , Space
      , Str "that"
      , Space
      , Str "silently"
      , Space
      , Str "incorporates"
      , SoftBreak
      , Str "a"
      , Space
      , Str "malicious"
      , Space
      , Str "library"
      , Space
      , Str "into"
      , Space
      , Str "applications"
      , Space
      , Str "as"
      , Space
      , Str "they"
      , Space
      , Str "are"
      , Space
      , Str "built."
      , Space
      , Str "Related"
      , Space
      , Str "attacks"
      , Space
      , Str "named"
      , SoftBreak
      , Str "CCleaner"
      , Space
      , Str "and"
      , Space
      , Str "ShadowHammer"
      , Space
      , Str "used"
      , Space
      , Str "the"
      , Space
      , Str "same"
      , Space
      , Str "approach"
      , Space
      , Str "of"
      , Space
      , Str "a"
      , Space
      , Str "trojanized"
      , Space
      , Str "linker"
      , Space
      , Str "to"
      , SoftBreak
      , Str "infect"
      , Space
      , Str "built"
      , Space
      , Str "applications."
      , Space
      , Str "Infected"
      , Space
      , Str "applications"
      , Space
      , Str "from"
      , Space
      , Str "these"
      , Space
      , Str "attacks"
      , Space
      , Str "were"
      , SoftBreak
      , Str "distributed"
      , Space
      , Str "to"
      , Space
      , Str "millions"
      , Space
      , Str "of"
      , Space
      , Str "users"
      , Space
      , Str "world-wide."
      ]
  , Para
      [ Str "These"
      , Space
      , Str "cases"
      , Space
      , Str "highlight"
      , Space
      , Str "that"
      , Space
      , Str "attacks"
      , Space
      , Str "on"
      , Space
      , Str "compilers,"
      , Space
      , Str "and"
      , Space
      , Str "especially"
      , Space
      , Str "linkers"
      , Space
      , Str "and"
      , SoftBreak
      , Str "libraries,"
      , Space
      , Str "are"
      , Space
      , Str "a"
      , Space
      , Str "viable"
      , Space
      , Str "route"
      , Space
      , Str "to"
      , Space
      , Str "silently"
      , Space
      , Str "infect"
      , Space
      , Str "many"
      , Space
      , Str "other"
      , Space
      , Str "applications,"
      , Space
      , Str "and"
      , SoftBreak
      , Str "there"
      , Space
      , Str "is"
      , Space
      , Str "no"
      , Space
      , Str "doubt"
      , Space
      , Str "that"
      , Space
      , Str "there"
      , Space
      , Str "will"
      , Space
      , Str "be"
      , Space
      , Str "more"
      , Space
      , Str "such"
      , Space
      , Str "attacks"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "future."
      , Space
      , Str "Let"
      , Space
      , Str "us"
      , SoftBreak
      , Str "now"
      , Space
      , Str "explore"
      , Space
      , Str "what"
      , Space
      , Str "we"
      , Space
      , Str "can"
      , Space
      , Str "do"
      , Space
      , Str "about"
      , Space
      , Str "these."
      ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "Explain"
          , Space
          , Str "how"
          , Space
          , Str "these"
          , Space
          , Str "vulnerabilities"
          , Space
          , Str "arise"
          , Space
          , Str "and"
          , Space
          , Str "how"
          , Space
          , Str "to"
          , Space
          , Str "mitigate"
          , Space
          , Str "them."
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "180" ]
          ]
      ]
  , Header
      1
      ( "compiler-introduced-security-vulnerabilities" , [] , [] )
      [ Str "Compiler"
      , Space
      , Str "introduced"
      , Space
      , Str "security"
      , Space
      , Str "vulnerabilities"
      ]
  , Para
      [ Str "Security"
      , Space
      , Str "vulnerabilities"
      , Space
      , Str "introduced"
      , Space
      , Str "by"
      , Space
      , Str "compilers"
      , Space
      , Str "have"
      , Space
      , Str "a"
      , Space
      , Str "long"
      , Space
      , Str "history."
      , Space
      , Str "Thompson"
      , SoftBreak
      , Cite
          [ Citation
              { citationId = "Thompson1984"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 104
              , citationHash = 0
              }
          ]
          [ Str "[@Thompson1984]" ]
      , Space
      , Str "provides"
      , Space
      , Str "one"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "oldest"
      , Space
      , Str "and"
      , Space
      , Str "most"
      , Space
      , Str "popular"
      , Space
      , Str "examples"
      , Space
      , Str "in"
      , Space
      , Str "this"
      , SoftBreak
      , Str "area."
      , Space
      , Str "In"
      , Space
      , Str "his"
      , Space
      , Str "paper,"
      , Space
      , Str "he"
      , Space
      , Str "talks"
      , Space
      , Str "about"
      , Space
      , Str "a"
      , Space
      , Str "compiler"
      , Space
      , Str "that"
      , Space
      , Str "can"
      , Space
      , Str "detect"
      , Space
      , Str "when"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , SoftBreak
      , Str "compiling"
      , Space
      , Str "the"
      , Space
      , Str "login"
      , Space
      , Str "program"
      , Space
      , Str "and"
      , Space
      , Str "can"
      , Space
      , Str "insert"
      , Space
      , Str "a"
      , Space
      , Str "backdoor"
      , Space
      , Str "so"
      , Space
      , Str "that"
      , Space
      , Str "he"
      , Space
      , Str "can"
      , Space
      , Str "use"
      , Space
      , Str "the"
      , SoftBreak
      , Str "system"
      , Space
      , Str "as"
      , Space
      , Str "any"
      , Space
      , Str "user."
      , Space
      , Str "However"
      , Space
      , Str "most"
      , Space
      , Str "common"
      , Space
      , Str "cases"
      , Space
      , Str "are"
      , Space
      , Str "where"
      , Space
      , Str "involuntary"
      , Space
      , Str "security"
      , SoftBreak
      , Str "vulnerabilities"
      , Space
      , Str "are"
      , Space
      , Str "added"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "generated"
      , Space
      , Str "binary"
      , Space
      , Str "by"
      , Space
      , Str "the"
      , Space
      , Str "compiler."
      ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "Explain"
          , Space
          , Str "how"
          , Space
          , Str "code"
          , Space
          , Str "that"
          , Space
          , Str "results"
          , Space
          , Str "in"
          , Space
          , Str "undefined"
          , Space
          , Str "behaviour"
          , Space
          , Str "can"
          , Space
          , Str "often"
          , Space
          , Str "work"
          , Space
          , Str "as"
          , Space
          , Str "the"
          , SoftBreak
          , Str "programmer"
          , Space
          , Str "expected"
          , Space
          , Str "until"
          , Space
          , Str "some"
          , Space
          , Str "optimisation"
          , Space
          , Str "is"
          , Space
          , Str "applied,"
          , Space
          , Str "and"
          , Space
          , Str "perhaps"
          , Space
          , Str "even"
          , Space
          , Str "talk"
          , Space
          , Str "a"
          , SoftBreak
          , Str "bit"
          , Space
          , Str "about"
          , Space
          , Str "why"
          , Space
          , Str "compilers"
          , Space
          , Str "rely"
          , Space
          , Str "on"
          , Space
          , Str "the"
          , Space
          , Str "absence"
          , Space
          , Str "of"
          , Space
          , Str "undefined"
          , Space
          , Str "behaviour"
          , Space
          , Str "in"
          , Space
          , Str "ways"
          , Space
          , Str "that"
          , SoftBreak
          , Str "appear"
          , Space
          , Str "aggressive"
          , Space
          , Str "in"
          , Space
          , Str "some"
          , Space
          , Str "occasions."
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "202" ]
          ]
      ]
  , Para
      [ Str "When"
      , Space
      , Str "discussing"
      , Space
      , Str "compiler"
      , Space
      , Str "introduced"
      , Space
      , Str "security"
      , Space
      , Str "vulnerabilities,"
      , Space
      , Str "undefined"
      , Space
      , Str "behavior"
      , SoftBreak
      , Str "plays"
      , Space
      , Str "a"
      , Space
      , Str "major"
      , Space
      , Str "role."
      , Space
      , Str "Its"
      , Space
      , Str "implications"
      , Space
      , Str "were"
      , Space
      , Str "thoroughly"
      , Space
      , Str "discussed"
      , Space
      , Str "by"
      , Space
      , Str "various"
      , Space
      , Str "works"
      , SoftBreak
      , Str "such"
      , Space
      , Str "as"
      , Space
      , Cite
          [ Citation
              { citationId = "wang2012undefined"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 105
              , citationHash = 0
              }
          ]
          [ Str "[@wang2012undefined]" ]
      , Space
      , Cite
          [ Citation
              { citationId = "d2015correctness"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 106
              , citationHash = 0
              }
          ]
          [ Str "[@d2015correctness]" ]
      , Space
      , Cite
          [ Citation
              { citationId = "dusilent"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 107
              , citationHash = 0
              }
          ]
          [ Str "[@dusilent]" ]
      , Str "."
      , Space
      , Str "By"
      , Space
      , Str "reading"
      , Space
      , Str "the"
      , SoftBreak
      , Str "works"
      , Space
      , Str "of"
      , Space
      , Str "these"
      , Space
      , Str "authors,"
      , Space
      , Str "one"
      , Space
      , Str "can"
      , Space
      , Str "see"
      , Space
      , Str "that"
      , Space
      , Str "even"
      , Space
      , Str "projects"
      , Space
      , Str "that"
      , Space
      , Str "went"
      , Space
      , Str "through"
      , Space
      , Str "careful"
      , SoftBreak
      , Str "testing,"
      , Space
      , Str "such"
      , Space
      , Str "as"
      , Space
      , Str "Linux,"
      , Space
      , Str "FreeBSD"
      , Space
      , Str "or"
      , Space
      , Str "PostgreSQL,"
      , Space
      , Str "could"
      , Space
      , Str "not"
      , Space
      , Str "escape"
      , Space
      , Str "from"
      , Space
      , Str "this"
      , Space
      , Str "class"
      , SoftBreak
      , Str "of"
      , Space
      , Str "vulnerabilities."
      , Space
      , Str "To"
      , Space
      , Str "better"
      , Space
      , Str "understand"
      , Space
      , Str "them,"
      , Space
      , Str "this"
      , Space
      , Str "chapter"
      , Space
      , Str "contains"
      , Space
      , Str "several"
      , SoftBreak
      , Str "examples"
      , Space
      , Str "of"
      , Space
      , Str "such"
      , Space
      , Str "vulnerabilities,"
      , Space
      , Str "their"
      , Space
      , Str "implications"
      , Space
      , Str "and"
      , Space
      , Str "how"
      , Space
      , Str "they"
      , Space
      , Str "got"
      , Space
      , Str "fixed."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "first"
      , Space
      , Str "example"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "15"
      , Space
      , Str "years"
      , Space
      , Str "old"
      , Space
      , Str "vulnerability"
      , Space
      , Str "that"
      , Space
      , Str "affected"
      , Space
      , Str "the"
      , Space
      , Str "random"
      , SoftBreak
      , Str "number"
      , Space
      , Str "generator"
      , Space
      , Str "(RNG)"
      , Space
      , Str "in"
      , Space
      , Str "Mac"
      , Space
      , Str "OS"
      , Space
      , Str "X"
      , Space
      , Cite
          [ Citation
              { citationId = "Wang2015"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 108
              , citationHash = 0
              }
          ]
          [ Str "[@Wang2015]" ]
      , Str "."
      , Space
      , Str "At"
      , Space
      , Str "some"
      , Space
      , Str "point"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "past,"
      , Space
      , Str "this"
      , SoftBreak
      , Str "vulnerability"
      , Space
      , Str "affected"
      , Space
      , Str "all"
      , Space
      , Str "*BSD"
      , Space
      , Str "operating"
      , Space
      , Str "systems,"
      , Space
      , Str "as"
      , Space
      , Str "they"
      , Space
      , Str "have"
      , Space
      , Str "a"
      , Space
      , Str "common"
      , SoftBreak
      , Str "ancestor"
      , Space
      , Str "with"
      , Space
      , Str "Mac"
      , Space
      , Str "OS."
      ]
  , Para
      [ Str "In"
      , Space
      , Str "the"
      , Space
      , Str "random"
      , Space
      , Str "number"
      , Space
      , Str "generator"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "system,"
      , Space
      , Str "more"
      , Space
      , Str "specifically"
      , Space
      , Str "in"
      , SoftBreak
      , Code ( "" , [] , [] ) "srandomdev(3)"
      , Str ","
      , Space
      , Str "we"
      , Space
      , Str "can"
      , Space
      , Str "spot"
      , Space
      , Str "the"
      , Space
      , Str "following"
      , Space
      , Str "piece"
      , Space
      , Str "of"
      , Space
      , Str "code"
      , Space
      , Str "used"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "seeding"
      , SoftBreak
      , Str "logic:"
      ]
  , CodeBlock
      ( "" , [ "c" ] , [] )
      "struct timeval tv;\nunsigned long junk;\n\ngettimeofday(&tv, NULL);\nsrandom((getpid() << 16) ^ tv.tv_sec ^ tv.tv_usec ^ junk);"
  , Para
      [ Str "For"
      , Space
      , Str "generating"
      , Space
      , Str "a"
      , Space
      , Str "seed"
      , Space
      , Str "for"
      , Space
      , Str "the"
      , Space
      , Str "RNG,"
      , Space
      , Str "the"
      , Space
      , Str "code"
      , Space
      , Str "uses"
      , Space
      , Str "the"
      , Space
      , Str "current"
      , Space
      , Str "time"
      , Space
      , Str "and"
      , Space
      , Str "an"
      , SoftBreak
      , Str "uninitialized"
      , Space
      , Str "value"
      , Space
      , Str "from"
      , Space
      , Str "the"
      , Space
      , Str "stack,"
      , Space
      , Str "i.e.\160"
      , Code ( "" , [] , [] ) "junk"
      , Str "."
      , Space
      , Str "This"
      , Space
      , Str "triggers"
      , Space
      , Str "undefined"
      , SoftBreak
      , Str "behavior"
      , Space
      , Str "as"
      , Space
      , Str "the"
      , Space
      , Str "C"
      , Space
      , Str "standard"
      , Space
      , Str "has"
      , Space
      , Str "no"
      , Space
      , Str "clear"
      , Space
      , Str "semantics"
      , Space
      , Str "for"
      , Space
      , Str "uninitialized"
      , Space
      , Str "loads."
      , SoftBreak
      , Str "Because"
      , Space
      , Str "of"
      , Space
      , Str "that,"
      , Space
      , Str "there"
      , Space
      , Str "was"
      , Space
      , Str "a"
      , Space
      , Str "huge"
      , Space
      , Str "difference"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "generated"
      , Space
      , Str "assembly"
      , Space
      , Str "code"
      , Space
      , Str "for"
      , SoftBreak
      , Str "two"
      , Space
      , Str "different"
      , Space
      , Str "Mac"
      , Space
      , Str "OS"
      , Space
      , Str "X"
      , Space
      , Str "releases."
      ]
  , Para
      [ Str "In"
      , Space
      , Str "Mac"
      , Space
      , Str "OS"
      , Space
      , Str "X"
      , Space
      , Str "10.6"
      , Space
      , Str "the"
      , Space
      , Str "generated"
      , Space
      , Str "code"
      , Space
      , Str "looked"
      , Space
      , Str "like"
      , Space
      , Str "this:"
      ]
  , CodeBlock
      ( "" , [ "asm" ] , [] )
      "leaq    0xe0(%rbp),%rdi\nxorl    %esi,%esi\ncallq   0x001422ca      ; symbol stub for: _gettimeofday\ncallq   0x00142270      ; symbol stub for: _getpid\nmovq    0xe0(%rbp),%rdx\nmovl    0xe8(%rbp),%edi\nxorl    %edx,%edi\nshll    $0x10,%eax\nxorl    %eax,%edi\nxorl    %ebx,%edi\ncallq   0x00142d68      ; symbol stub for: _srandom"
  , Para
      [ Str "While"
      , Space
      , Str "for"
      , Space
      , Str "Mac"
      , Space
      , Str "OS"
      , Space
      , Str "X"
      , Space
      , Str "10.7"
      , Space
      , Str "the"
      , Space
      , Str "code"
      , Space
      , Str "looked"
      , Space
      , Str "like"
      , Space
      , Str "this:"
      ]
  , CodeBlock
      ( "" , [ "asm" ] , [] )
      "leaq    0xd8(%rbp),%rdi\nxorl    %esi,%esi\ncallq   0x000a427e      ; symbol stub for: _gettimeofday\ncallq   0x000a3882      ; symbol stub for: _getpid\ncallq   0x000a4752      ; symbol stub for: _srandom"
  , Para
      [ Str "In"
      , Space
      , Str "the"
      , Space
      , Str "shorter"
      , Space
      , Str "version"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "generated"
      , Space
      , Str "assembly"
      , Space
      , Str "code,"
      , Space
      , Str "the"
      , Space
      , Str "compiler"
      , Space
      , Str "dropped"
      , Space
      , Str "the"
      , SoftBreak
      , Str "whole"
      , Space
      , Str "argument"
      , Space
      , Str "of"
      , Space
      , Code ( "" , [] , [] ) "srandom"
      , Space
      , Str "as"
      , Space
      , Str "an"
      , Space
      , Str "optimization."
      , Space
      , Str "While"
      , Space
      , Str "the"
      , Space
      , Str "optimised"
      , Space
      , Str "code"
      , SoftBreak
      , Str "respects"
      , Space
      , Str "the"
      , Space
      , Str "standard,"
      , Space
      , Str "it"
      , Space
      , Str "leaves"
      , Space
      , Str "room"
      , Space
      , Str "for"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "to"
      , Space
      , Str "exploit"
      , Space
      , Str "the"
      , Space
      , Str "system"
      , SoftBreak
      , Str "because"
      , Space
      , Str "the"
      , Space
      , Str "seed"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "RNG"
      , Space
      , Str "can"
      , Space
      , Str "now"
      , Space
      , Str "be"
      , Space
      , Str "predicted."
      ]
  , Para
      [ Str "In"
      , Space
      , Str "the"
      , Space
      , Str "meantime,"
      , Space
      , Str "this"
      , Space
      , Str "problem"
      , Space
      , Str "has"
      , Space
      , Str "been"
      , Space
      , Str "resolved"
      , Space
      , Str "in"
      , Space
      , Str "FreeBSD"
      , Space
      , Cite
          [ Citation
              { citationId = "FbsdJunk"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 109
              , citationHash = 0
              }
          ]
          [ Str "[@FbsdJunk]" ]
      , Space
      , Str "and"
      , SoftBreak
      , Str "OpenBSD"
      , Space
      , Cite
          [ Citation
              { citationId = "ObsdJunk"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 110
              , citationHash = 0
              }
          ]
          [ Str "[@ObsdJunk]" ]
      , Str "."
      ]
  , Para
      [ Str "Current"
      , Space
      , Str "solutions"
      , Space
      , Str "for"
      , Space
      , Str "detecting"
      , Space
      , Str "this"
      , Space
      , Str "class"
      , Space
      , Str "of"
      , Space
      , Str "vulnerabilities"
      , Space
      , Str "include"
      , Space
      , Str "LLVM\8217s"
      , SoftBreak
      , Str "MemorySanitizer"
      , Space
      , Str "and"
      , Space
      , Str "Valgrind."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "next"
      , Space
      , Str "example"
      , Space
      , Str "covers"
      , Space
      , Str "a"
      , Space
      , Str "new"
      , Space
      , Str "type"
      , Space
      , Str "of"
      , Space
      , Str "undefined"
      , Space
      , Str "behavior"
      , Space
      , Str "that"
      , Space
      , Str "can"
      , Space
      , Str "easily"
      , SoftBreak
      , Str "introduce"
      , Space
      , Str "security"
      , Space
      , Str "vulnerabilities."
      , Space
      , Str "This"
      , Space
      , Str "time"
      , Space
      , Str "we"
      , Space
      , Str "talk"
      , Space
      , Str "about"
      , Space
      , Str "dereferencing"
      , Space
      , Str "NULL"
      , SoftBreak
      , Str "pointers"
      , Space
      , Str "and"
      , Space
      , Str "what"
      , Space
      , Str "might"
      , Space
      , Str "go"
      , Space
      , Str "wrong"
      , Space
      , Str "with"
      , Space
      , Str "this"
      , Space
      , Str "operation."
      , Space
      , Str "The"
      , Space
      , Str "following"
      , Space
      , Str "piece"
      , Space
      , Str "of"
      , SoftBreak
      , Str "code"
      , Space
      , Str "is"
      , Space
      , Str "taken"
      , Space
      , Str "from"
      , Space
      , Str "Linux"
      , Space
      , Str "and"
      , Space
      , Str "introduces"
      , Space
      , Str "a"
      , Space
      , Str "vulnerability"
      , Space
      , Str "by"
      , Space
      , Str "dereferencing"
      , Space
      , Str "the"
      , SoftBreak
      , Code ( "" , [] , [] ) "tun"
      , Space
      , Str "pointer"
      , Space
      , Str "before"
      , Space
      , Str "it"
      , Space
      , Str "checks"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "pointer"
      , Space
      , Str "is"
      , Space
      , Str "valid:"
      ]
  , CodeBlock
      ( "" , [ "c" ] , [] )
      "unsigned int\ntun_chr_poll(struct file *file, poll_table * wait)\n{\n  struct tun_file *tfile = file->private_data;\n  struct tun_struct *tun = __tun_get(tfile);\n  struct sock *sk = tun->sk;\n  if (!tun)\n    return POLLERR;\n  ...\n}"
  , Para
      [ Str "Normally,"
      , Space
      , Str "this"
      , Space
      , Str "would"
      , Space
      , Str "cause"
      , Space
      , Str "a"
      , Space
      , Str "crash"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "kernel"
      , Space
      , Str "or"
      , Space
      , Str "the"
      , Space
      , Str "function"
      , Space
      , Str "would"
      , Space
      , Str "return"
      , SoftBreak
      , Str "POLLERR"
      , Space
      , Str "if"
      , Space
      , Str "address"
      , Space
      , Str "0"
      , Space
      , Str "was"
      , Space
      , Str "mapped"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "address"
      , Space
      , Str "space."
      , Space
      , Str "However"
      , Space
      , Str "the"
      , Space
      , Str "compiler"
      , SoftBreak
      , Str "assumes"
      , Space
      , Str "that"
      , Space
      , Code ( "" , [] , [] ) "tun"
      , Space
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "valid"
      , Space
      , Str "pointer"
      , Space
      , Str "when"
      , Space
      , Str "the"
      , Space
      , Str "execution"
      , Space
      , Str "reaches"
      , Space
      , Str "the"
      , Space
      , Str "if"
      , SoftBreak
      , Str "statement."
      , Space
      , Str "This"
      , Space
      , Str "happens"
      , Space
      , Str "because"
      , Space
      , Str "it"
      , Space
      , Str "saw"
      , Space
      , Str "an"
      , Space
      , Str "earlier"
      , Space
      , Str "dereference"
      , Space
      , Str "just"
      , Space
      , Str "before"
      , Space
      , Str "the"
      , SoftBreak
      , Str "if"
      , Space
      , Str "statement."
      , Space
      , Str "In"
      , Space
      , Str "this"
      , Space
      , Str "situation,"
      , Space
      , Str "the"
      , Space
      , Str "check"
      , Space
      , Str "is"
      , Space
      , Str "considered"
      , Space
      , Str "redundant"
      , Space
      , Str "and"
      , Space
      , Str "deleted"
      , SoftBreak
      , Str "from"
      , Space
      , Str "the"
      , Space
      , Str "final"
      , Space
      , Str "binary."
      , Space
      , Str "This"
      , Space
      , Str "allows"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "to"
      , Space
      , Str "continue"
      , Space
      , Str "executing"
      , Space
      , Str "code"
      , Space
      , Str "from"
      , SoftBreak
      , Code ( "" , [] , [] ) "tun_chr_poll"
      , Space
      , Str "when"
      , Space
      , Str "address"
      , Space
      , Str "0"
      , Space
      , Str "is"
      , Space
      , Str "mapped."
      ]
  , Para
      [ Str "To"
      , Space
      , Str "mitigate"
      , Space
      , Str "against"
      , Space
      , Str "this"
      , Space
      , Str "situation,"
      , Space
      , Str "GCC"
      , Space
      , Str "developers"
      , Space
      , Str "added"
      , Space
      , Str "a"
      , Space
      , Str "flag"
      , Space
      , Str "called"
      , SoftBreak
      , Code ( "" , [] , [] ) "-fno-delete-null-pointer-checks"
      , Space
      , Str "that"
      , Space
      , Str "Linux"
      , Space
      , Str "integrated"
      , Space
      , Str "in"
      , Space
      , Str "its"
      , Space
      , Str "compiler"
      , SoftBreak
      , Str "configuration."
      ]
  , Para
      [ Str "Linux"
      , Space
      , Str "was"
      , Space
      , Str "not"
      , Space
      , Str "the"
      , Space
      , Str "only"
      , Space
      , Str "project"
      , Space
      , Str "that"
      , Space
      , Str "suffered"
      , Space
      , Str "from"
      , Space
      , Str "this"
      , Space
      , Str "problem."
      , Space
      , Str "Chromium"
      , SoftBreak
      , Cite
          [ Citation
              { citationId = "ChromiumIssue"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 111
              , citationHash = 0
              }
          ]
          [ Str "[@ChromiumIssue]" ]
      , Space
      , Str "and"
      , Space
      , Str "Mozilla"
      , Space
      , Cite
          [ Citation
              { citationId = "MozillaIssue"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 112
              , citationHash = 0
              }
          ]
          [ Str "[@MozillaIssue]" ]
      , Space
      , Str "had"
      , Space
      , Str "problems"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "past"
      , Space
      , Str "with"
      , Space
      , Str "this."
      ]
  , Para
      [ Str "There"
      , Space
      , Str "are"
      , Space
      , Str "also"
      , Space
      , Str "cases"
      , Space
      , Str "of"
      , Space
      , Str "security"
      , Space
      , Str "vulnerabilities"
      , Space
      , Str "that"
      , Space
      , Str "are"
      , Space
      , Str "not"
      , Space
      , Str "introduced"
      , Space
      , Str "by"
      , SoftBreak
      , Str "undefined"
      , Space
      , Str "behavior,"
      , Space
      , Str "the"
      , Space
      , Str "following"
      , Space
      , Str "piece"
      , Space
      , Str "of"
      , Space
      , Str "code"
      , Space
      , Str "is"
      , Space
      , Str "such"
      , Space
      , Str "an"
      , Space
      , Str "example."
      , Space
      , Str "This"
      , Space
      , Str "was"
      , SoftBreak
      , Str "taken"
      , Space
      , Str "from"
      , Space
      , Str "the"
      , Space
      , Str "Linux"
      , Space
      , Str "kernel."
      , Space
      , Str "Because"
      , Space
      , Str "the"
      , Space
      , Str "compiler"
      , Space
      , Str "sees"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "pointer"
      , Space
      , Str "hash"
      , Space
      , Str "is"
      , SoftBreak
      , Str "never"
      , Space
      , Str "used"
      , Space
      , Str "after"
      , Space
      , Str "this"
      , Space
      , Str "point,"
      , Space
      , Str "it"
      , Space
      , Str "decides"
      , Space
      , Str "to"
      , Space
      , Str "delete"
      , Space
      , Str "the"
      , Space
      , Str "memset"
      , Space
      , Str "operation."
      , Space
      , Str "We"
      , Space
      , Str "call"
      , SoftBreak
      , Str "this"
      , Space
      , Str "dead"
      , Space
      , Str "store"
      , Space
      , Str "optimization"
      , Space
      , Str "(DSO)"
      , Space
      , RawInline
          (Format "tex") "\\index{dead store optimization}"
      , Str "."
      , Space
      , Str "This"
      , Space
      , Str "has"
      , SoftBreak
      , Str "serious"
      , Space
      , Str "security"
      , Space
      , Str "implications"
      , Space
      , Str "because"
      , Space
      , Str "the"
      , Space
      , Str "intention"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "programmer"
      , Space
      , Str "was"
      , Space
      , Str "to"
      , SoftBreak
      , Str "delete"
      , Space
      , Str "the"
      , Space
      , Code ( "" , [] , [] ) "hash"
      , Space
      , Str "information"
      , Space
      , Str "from"
      , Space
      , Str "memory."
      ]
  , CodeBlock
      ( "" , [ "c" ] , [] )
      "static void extract_buf(struct entropy_store *r, __u8 *out) {\n  ...\n  - memset(&hash, 0, sizeof(hash));\n  + memzero_explicit(&hash, sizeof(hash));\n}"
  , Para
      [ Str "The"
      , Space
      , Str "solution"
      , Space
      , Str "Linux"
      , Space
      , Str "came"
      , Space
      , Str "with"
      , Space
      , Str "was"
      , Space
      , Str "to"
      , Space
      , Str "add"
      , Space
      , Str "a"
      , Space
      , Str "new"
      , Space
      , Str "function"
      , Space
      , Str "called"
      , Space
      , Code ( "" , [] , [] ) "memzero_explicit"
      , SoftBreak
      , Str "which"
      , Space
      , Str "under"
      , Space
      , Str "the"
      , Space
      , Str "hood"
      , Space
      , Str "looks"
      , Space
      , Str "like"
      , Space
      , Str "this:"
      ]
  , CodeBlock
      ( "" , [ "c" ] , [] )
      "void memzero_explicit(void *s, size_t count)\n{\n  memset(s, 0, count);\n  OPTIMIZER_HIDE_VAR(s);\n}"
  , Para
      [ Str "It"
      , Space
      , Str "still"
      , Space
      , Str "uses"
      , Space
      , Code ( "" , [] , [] ) "memset"
      , Space
      , RawInline (Format "tex") "\\index{memset}"
      , Space
      , Str "to"
      , Space
      , Str "delete"
      , Space
      , Str "the"
      , Space
      , Str "associated"
      , Space
      , Str "security"
      , SoftBreak
      , Str "sensitive"
      , Space
      , Str "data,"
      , Space
      , Str "but"
      , Space
      , Str "it"
      , Space
      , Str "also"
      , Space
      , Str "tries"
      , Space
      , Str "to"
      , Space
      , Str "eliminate"
      , Space
      , Str "the"
      , Space
      , Str "risk"
      , Space
      , Str "of"
      , Space
      , Str "DSO"
      , Space
      , Str "by"
      , Space
      , Str "using"
      , Space
      , Str "the"
      , SoftBreak
      , Str "OPTIMIZER_HIDE_VAR"
      , Space
      , Str "macro."
      , Space
      , Str "This,"
      , Space
      , Str "however,"
      , Space
      , Str "is"
      , Space
      , Str "not"
      , Space
      , Str "enough"
      , Space
      , Str "to"
      , Space
      , Str "fully"
      , Space
      , Str "eliminate"
      , SoftBreak
      , Str "dead"
      , Space
      , Str "stores"
      , Space
      , Cite
          [ Citation
              { citationId = "MemZeroBarrier"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 113
              , citationHash = 0
              }
          ]
          [ Str "[@MemZeroBarrier]" ]
      , Str "."
      , Space
      , Str "In"
      , Space
      , Str "case"
      , Space
      , Str "of"
      , Space
      , Str "using"
      , Space
      , Str "LTO,"
      , Space
      , Str "the"
      , Space
      , Str "buffer"
      , Space
      , Code ( "" , [] , [] ) "s"
      , Space
      , Str "is"
      , Space
      , Str "still"
      , SoftBreak
      , Str "vulnerable."
      , Space
      , Str "For"
      , Space
      , Str "this"
      , Space
      , Str "reason,"
      , Space
      , Str "Linux"
      , Space
      , Str "maintainers"
      , Space
      , Str "added"
      , Space
      , Str "a"
      , Space
      , Str "further"
      , Space
      , Str "hardening"
      , SoftBreak
      , Str "mechanism"
      , Space
      , Str "by"
      , Space
      , Str "using"
      , Space
      , Str "a"
      , Space
      , Str "compiler"
      , Space
      , Str "barrier"
      , Space
      , Str "instead:"
      ]
  , CodeBlock
      ( "" , [ "c" ] , [] )
      "void memzero_explicit(void *s, size_t count)\n{\n  memset(s, 0, count);\n  - OPTIMIZER_HIDE_VAR(s);\n  + barrier();\n}"
  , Para
      [ Str "There"
      , Space
      , Str "is"
      , Space
      , Str "still"
      , Space
      , Str "room"
      , Space
      , Str "for"
      , Space
      , Str "improvement"
      , Space
      , Str "regarding"
      , Space
      , Str "the"
      , Space
      , Str "introduced"
      , Space
      , Str "barrier"
      , SoftBreak
      , Cite
          [ Citation
              { citationId = "MemZeroDataBarrier"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 114
              , citationHash = 0
              }
          ]
          [ Str "[@MemZeroDataBarrier]" ]
      , Str "."
      , Space
      , Str "If"
      , Space
      , Str "the"
      , Space
      , Str "content"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "buffer"
      , Space
      , Str "is"
      , Space
      , Str "present"
      , Space
      , Str "in"
      , Space
      , Str "registers,"
      , SoftBreak
      , Str "then"
      , Space
      , Str "the"
      , Space
      , Str "compiler"
      , Space
      , Str "blindly"
      , Space
      , Str "proves"
      , Space
      , Str "again"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "DSO"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "triggered"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , SoftBreak
      , Code ( "" , [] , [] ) "memset"
      , Space
      , Str "will"
      , Space
      , Str "be"
      , Space
      , Str "again"
      , Space
      , Str "deleted."
      , Space
      , Str "To"
      , Space
      , Str "mitigate"
      , Space
      , Str "against"
      , Space
      , Str "this,"
      , Space
      , Str "the"
      , Space
      , Str "following"
      , Space
      , Str "patch"
      , SoftBreak
      , Str "was"
      , Space
      , Str "proposed:"
      ]
  , CodeBlock
      ( "" , [ "c" ] , [] )
      "+ #define barrier_data(ptr) \\\n+  __asm__ __volatile__(\"\": :\"r\"(ptr) :\"memory\")\n\nvoid memzero_explicit(void *s, size_t count)\n{\n  memset(s, 0, count);\n  - barrier();\n  + barrier_data(s);\n}"
  , Para
      [ Str "In"
      , Space
      , Str "this"
      , Space
      , Str "patch"
      , Space
      , Str "we"
      , Space
      , Str "create"
      , Space
      , Str "a"
      , Space
      , Str "new"
      , Space
      , Str "barrier"
      , Space
      , Str "that"
      , Space
      , Str "will"
      , Space
      , Str "be"
      , Space
      , Str "guaranted"
      , Space
      , Str "to"
      , Space
      , Str "put"
      , Space
      , Str "the"
      , Space
      , Str "content"
      , SoftBreak
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "buffer"
      , Space
      , Str "in"
      , Space
      , Str "memory"
      , Space
      , Str "so"
      , Space
      , Str "that"
      , Space
      , Str "DSO"
      , Space
      , Str "can"
      , Space
      , Str "take"
      , Space
      , Str "no"
      , Space
      , Str "further"
      , Space
      , Str "effect."
      ]
  , Para
      [ Str "Similar"
      , Space
      , Str "efforts"
      , Space
      , Str "were"
      , Space
      , Str "conducted"
      , Space
      , Str "in"
      , Space
      , Str "other"
      , Space
      , Str "projects"
      , Space
      , Str "such"
      , Space
      , Str "as"
      , Space
      , Str "OpenSSL"
      , SoftBreak
      , Cite
          [ Citation
              { citationId = "OpenSSLMemClr"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 115
              , citationHash = 0
              }
          ]
          [ Str "[@OpenSSLMemClr]" ]
      , Str "."
      , Space
      , Str "The"
      , Space
      , Str "approach"
      , Space
      , Str "OpenSSL"
      , Space
      , Str "used"
      , Space
      , Str "is"
      , Space
      , Str "rather"
      , Space
      , Str "different"
      , Space
      , Str "but"
      , Space
      , Str "it"
      , Space
      , Str "achieves"
      , SoftBreak
      , Str "the"
      , Space
      , Str "same"
      , Space
      , Str "end"
      , Space
      , Str "goal,"
      , Space
      , Str "i.e.\160eliminating"
      , Space
      , Str "the"
      , Space
      , Str "effect"
      , Space
      , Str "of"
      , Space
      , Str "DSO."
      , Space
      , Str "By"
      , Space
      , Str "making"
      , Space
      , Code ( "" , [] , [] ) "memset_func"
      , Space
      , Str "a"
      , SoftBreak
      , Str "volatile"
      , Space
      , Str "pointer"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "actual"
      , Space
      , Str "implementation"
      , Space
      , Str "of"
      , Space
      , Code ( "" , [] , [] ) "memset"
      , Str ","
      , Space
      , Str "the"
      , Space
      , Str "compiler"
      , Space
      , Str "is"
      , SoftBreak
      , Str "forced"
      , Space
      , Str "to"
      , Space
      , Str "dereference"
      , Space
      , Str "the"
      , Space
      , Str "pointer"
      , Space
      , Str "to"
      , Space
      , Str "get"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "actual"
      , Space
      , Code ( "" , [] , [] ) "memset"
      , Str ","
      , Space
      , Str "thus"
      , SoftBreak
      , Str "eliminating"
      , Space
      , Str "the"
      , Space
      , Str "risk"
      , Space
      , Str "of"
      , Space
      , Str "optimizing"
      , Space
      , Str "it"
      , Space
      , Str "out."
      ]
  , Para
      [ Str "The"
      , Space
      , Str "C23"
      , Space
      , Str "committee"
      , Space
      , Str "decided"
      , Space
      , Str "to"
      , Space
      , Str "tackle"
      , Space
      , Str "this"
      , Space
      , Str "problem"
      , Space
      , Str "from"
      , Space
      , Str "another"
      , Space
      , Str "angle,"
      , Space
      , Str "i.e.\160by"
      , SoftBreak
      , Str "adding"
      , Space
      , Str "a"
      , Space
      , Str "library"
      , Space
      , Str "function"
      , Space
      , Str "called"
      , Space
      , Code ( "" , [] , [] ) "memset_explicit"
      , Space
      , Cite
          [ Citation
              { citationId = "MemSetProposal"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 116
              , citationHash = 0
              }
          ]
          [ Str "[@MemSetProposal]" ]
      , Str "."
      , Space
      , Str "This"
      , SoftBreak
      , Str "function"
      , Space
      , Str "requires"
      , Space
      , Str "the"
      , Space
      , Str "compiler"
      , Space
      , Str "to"
      , Space
      , Str "not"
      , Space
      , Str "optimize"
      , Space
      , Str "the"
      , Space
      , Str "memory"
      , Space
      , Str "overwrite"
      , Space
      , Str "away."
      , SoftBreak
      , Str "However"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , Space
      , Str "not"
      , Space
      , Str "trivial"
      , Space
      , Str "to"
      , Space
      , Str "implement"
      , Space
      , Str "such"
      , Space
      , Str "a"
      , Space
      , Str "functionality,"
      , Space
      , Str "as"
      , Space
      , Str "GNU"
      , Space
      , Str "presents"
      , Space
      , Str "in"
      , SoftBreak
      , Cite
          [ Citation
              { citationId = "GNUMemSet"
              , citationPrefix = []
              , citationSuffix = []
              , citationMode = NormalCitation
              , citationNoteNum = 117
              , citationHash = 0
              }
          ]
          [ Str "[@GNUMemSet]" ]
      , Str "."
      , Space
      , Str "The"
      , Space
      , Str "information"
      , Space
      , Str "may"
      , Space
      , Str "be"
      , Space
      , Str "present"
      , Space
      , Str "somewhere"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "machine,"
      , Space
      , Str "even"
      , Space
      , Str "if"
      , SoftBreak
      , Str "it"
      , Space
      , Str "was"
      , Space
      , Str "erased"
      , Space
      , Str "from"
      , Space
      , Str "memory."
      ]
  , Header
      1
      ( "physical-attacks" , [] , [] )
      [ Str "Physical" , Space , Str "attacks" ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "This"
          , Space
          , Str "chapter"
          , Space
          , Str "should"
          , Space
          , Str "probably"
          , Space
          , Str "be"
          , Space
          , Str "moved"
          , Space
          , Str "under"
          , Space
          , Str "section"
          , Space
          , Quoted
              SingleQuote
              [ Str "Physical"
              , Space
              , Str "access"
              , SoftBreak
              , Str "side-channel"
              , Space
              , Str "attacks"
              ]
          , Space
          , Str "higher-up"
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "181" ]
          ]
      ]
  , Header 2 ( "overview" , [] , [] ) [ Str "Overview" ]
  , Para
      [ Str "There"
      , Space
      , Str "are"
      , Space
      , Str "many"
      , Space
      , Str "types"
      , Space
      , Str "of"
      , Space
      , Str "physical"
      , Space
      , Str "attacks"
      , Space
      , Str "\8211"
      , Space
      , Str "these"
      , Space
      , Str "attack"
      , Space
      , Str "methods"
      , Space
      , Str "focus"
      , Space
      , Str "on"
      , Space
      , Str "one"
      , Space
      , Str "or"
      , SoftBreak
      , Str "multiple"
      , Space
      , Str "physical"
      , Space
      , Str "properties"
      , Space
      , Str "of"
      , Space
      , Str "systems"
      , Space
      , Str "("
      , Space
      , Str "e.g.\160CPU,"
      , Space
      , Str "GPU,"
      , Space
      , Str "crypto"
      , Space
      , Str "hardware),"
      , Space
      , Str "and"
      , SoftBreak
      , Str "can"
      , Space
      , Str "either"
      , Space
      , Str "be"
      ]
  , BulletList
      [ [ Plain
            [ Str "Passive"
            , Space
            , Str "\8211"
            , Space
            , Str "just"
            , Space
            , Str "monitoring"
            , Space
            , Str "physical"
            , Space
            , Str "quantities"
            , Space
            , Str "(e.g.\160side"
            , Space
            , Str "channel"
            , Space
            , Str "information"
            , SoftBreak
            , Str "leakage),"
            , Space
            , Str "or"
            ]
        ]
      , [ Plain
            [ Str "Active"
            , Space
            , Str "\8211"
            , Space
            , Str "modification"
            , Space
            , Str "of"
            , Space
            , Str "physical"
            , Space
            , Str "quantities,"
            , Space
            , Str "for"
            , Space
            , Str "example,"
            , Space
            , Str "by"
            ]
        , BulletList
            [ [ Plain
                  [ Str "changing"
                  , Space
                  , Str "the"
                  , Space
                  , Str "operation"
                  , Space
                  , Str "conditions"
                  , Space
                  , Str "of"
                  , Space
                  , Str "the"
                  , Space
                  , Str "system"
                  , Space
                  , Str "so"
                  , Space
                  , Str "that"
                  , Space
                  , Str "the"
                  , Space
                  , Str "circuit"
                  , SoftBreak
                  , Str "operates"
                  , Space
                  , Str "outside"
                  , Space
                  , Str "its"
                  , Space
                  , Str "specifications"
                  , Space
                  , Str "(e.g.\160by"
                  , Space
                  , Str "changing"
                  , Space
                  , Str "temperature,"
                  , Space
                  , Str "or"
                  , Space
                  , Str "by"
                  , SoftBreak
                  , Str "applying"
                  , Space
                  , Str "glitches"
                  , Space
                  , Str "to"
                  , Space
                  , Str "supply"
                  , Space
                  , Str "voltage/clock"
                  , Space
                  , Str "source)"
                  ]
              ]
            , [ Plain
                  [ Str "injecting"
                  , Space
                  , Str "faults"
                  , Space
                  , Str "to"
                  , Space
                  , Str "the"
                  , Space
                  , Str "system"
                  , Space
                  , Str "(e.g.\160altering"
                  , Space
                  , Str "the"
                  , Space
                  , Str "electrical"
                  , Space
                  , Str "state"
                  , Space
                  , Str "of"
                  , Space
                  , Str "the"
                  , SoftBreak
                  , Str "system"
                  , Space
                  , Str "using"
                  , Space
                  , Str "Electromagnetic"
                  , Space
                  , Str "pulse"
                  , Space
                  , Str "injection,"
                  , Space
                  , Str "or"
                  , Space
                  , Str "laser"
                  , Space
                  , Str "beam)"
                  ]
              ]
            , [ Plain
                  [ Str "physically"
                  , Space
                  , Str "modifying"
                  , Space
                  , Str "the"
                  , Space
                  , Str "system/chip"
                  ]
              ]
            ]
        ]
      ]
  , Para
      [ Str "In"
      , Space
      , Str "the"
      , Space
      , Str "rest"
      , Space
      , Str "of"
      , Space
      , Str "this"
      , Space
      , Str "section,"
      , Space
      , Str "we"
      , Space
      , Str "will"
      , Space
      , Str "focus"
      , Space
      , Str "on"
      , Space
      , Str "a"
      , Space
      , Str "subset"
      , Space
      , Str "of"
      , Space
      , Str "physical"
      , Space
      , Str "attacks:"
      ]
  , BulletList
      [ [ Plain
            [ Str "Side"
            , Space
            , Str "channel"
            , Space
            , Str "information"
            , Space
            , Str "leakage"
            ]
        ]
      , [ Plain
            [ Str "Physical"
            , Space
            , Str "attack"
            , Space
            , Str "using"
            , Space
            , Str "glitches"
            ]
        ]
      ]
  , Para
      [ Str "These"
      , Space
      , Str "two"
      , Space
      , Str "forms"
      , Space
      , Str "of"
      , Space
      , Str "attacks"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "carried"
      , Space
      , Str "out"
      , Space
      , Str "using"
      , Space
      , Str "low"
      , Space
      , Str "cost"
      , Space
      , Str "hardware,"
      , Space
      , Str "and"
      , Space
      , Str "have"
      , SoftBreak
      , Str "been"
      , Space
      , Str "widely"
      , Space
      , Str "demonstrated"
      , Space
      , Str "by"
      , Space
      , Str "researchers"
      , Space
      , Str "on"
      , Space
      , Str "SoCs"
      , Space
      , Str "or"
      , Space
      , Str "microcontrollers"
      , Space
      , Str "developed"
      , Space
      , Str "for"
      , SoftBreak
      , Str "IoT"
      , Space
      , Str "(Internet-of-Things)"
      , Space
      , Str "applications."
      ]
  , Header
      2
      ( "physical-access-side-channel-attacks-1" , [] , [] )
      [ Str "Physical"
      , Space
      , Str "access"
      , Space
      , Str "side-channel"
      , Space
      , Str "attacks"
      ]
  , Para
      [ Str "If"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "has"
      , Space
      , Str "physical"
      , Space
      , Str "access"
      , Space
      , Str "to"
      , Space
      , Str "a"
      , Space
      , Str "device,"
      , Space
      , Str "even"
      , Space
      , Str "without"
      , Space
      , Str "debug"
      , Space
      , Str "access,"
      , Space
      , Str "the"
      , SoftBreak
      , Str "attacker"
      , Space
      , Str "can"
      , Space
      , Str "collect"
      , Space
      , Str "side"
      , Space
      , Str "channel"
      , Space
      , Str "information"
      , Space
      , Str "about"
      , Space
      , Str "the"
      , Space
      , Str "program"
      , Space
      , Str "execution"
      , Space
      , Str "on"
      , Space
      , Str "a"
      , SoftBreak
      , Str "processor."
      , Space
      , Str "If"
      , Space
      , Str "the"
      , Space
      , Str "processor"
      , Space
      , Str "is"
      , Space
      , Str "used"
      , Space
      , Str "to"
      , Space
      , Str "handle"
      , Space
      , Str "cryptographic"
      , Space
      , Str "operations,"
      , Space
      , Str "the"
      , Space
      , Str "side"
      , SoftBreak
      , Str "channel"
      , Space
      , Str "information"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "used"
      , Space
      , Str "to"
      , Space
      , Str "deduce"
      , Space
      , Str "the"
      , Space
      , Str "crypto"
      , Space
      , Str "key(s)"
      , Space
      , Str "or"
      , Space
      , Str "the"
      , Space
      , Str "data"
      , Space
      , Str "being"
      , SoftBreak
      , Str "processed."
      , Space
      , Str "Please"
      , Space
      , Str "note"
      , Space
      , Str "that"
      , Space
      , Str "some"
      , Space
      , Str "forms"
      , Space
      , Str "of"
      , Space
      , Str "physical"
      , Space
      , Str "attacks"
      , Space
      , Str "(e.g.\160fault"
      , Space
      , Str "injection"
      , SoftBreak
      , Str "attacks"
      , Space
      , Str "like"
      , Space
      , Str "rowhammer"
      , Space
      , Str "and"
      , Space
      , Str "voltjockey)"
      , Space
      , Str "do"
      , Space
      , Str "not"
      , Space
      , Str "require"
      , Space
      , Str "physical"
      , Space
      , Str "access,"
      , Space
      , Str "but"
      , SoftBreak
      , Str "those"
      , Space
      , Str "attacks"
      , Space
      , Str "are"
      , Space
      , Str "not"
      , Space
      , Str "covered"
      , Space
      , Str "in"
      , Space
      , Str "this"
      , Space
      , Str "section."
      ]
  , Header
      3
      ( "how-is-information-leaked" , [] , [] )
      [ Str "How"
      , Space
      , Str "is"
      , Space
      , Str "information"
      , Space
      , Str "leaked?"
      ]
  , Para
      [ Str "The"
      , Space
      , Str "most"
      , Space
      , Str "common"
      , Space
      , Str "physical"
      , Space
      , Str "access"
      , Space
      , Str "side"
      , Space
      , Str "channel"
      , Space
      , Str "attack"
      , Space
      , Str "method"
      , Space
      , Str "is"
      , Space
      , Str "to"
      , Space
      , Str "capture"
      , Space
      , Str "the"
      , SoftBreak
      , Str "voltage"
      , Space
      , Str "or"
      , Space
      , Str "current"
      , Space
      , Str "consumption"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "device"
      , Space
      , Str "during"
      , Space
      , Str "its"
      , Space
      , Str "operation."
      , Space
      , Str "Every"
      , Space
      , Str "time"
      , SoftBreak
      , Str "a"
      , Space
      , Str "flip-flop"
      , Space
      , Str "toggles,"
      , Space
      , Str "the"
      , Space
      , Str "switching"
      , Space
      , Str "activity"
      , Space
      , Str "results"
      , Space
      , Str "in"
      , Space
      , Str "a"
      , Space
      , Str "small"
      , Space
      , Str "current"
      , Space
      , Str "spike."
      , SoftBreak
      , Str "Even"
      , Space
      , Str "though"
      , Space
      , Str "there"
      , Space
      , Str "is"
      , Space
      , Str "capacitance"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "power"
      , Space
      , Str "distribution"
      , Space
      , Str "connections"
      , Space
      , Str "inside"
      , SoftBreak
      , Str "the"
      , Space
      , Str "chip,"
      , Space
      , Str "the"
      , Space
      , Str "toggling"
      , Space
      , Str "of"
      , Space
      , Str "registers"
      , Space
      , Str "(composed"
      , Space
      , Str "of"
      , Space
      , Str "flip-flops)"
      , Space
      , Str "still"
      , Space
      , Str "results"
      , Space
      , Str "in"
      , SoftBreak
      , Str "variations"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "power"
      , Space
      , Str "supply"
      , Space
      , Str "current,"
      , Space
      , Str "which"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "observed"
      , Space
      , Str "easily."
      , SoftBreak
      , Str "Because"
      , Space
      , Str "the"
      , Space
      , Str "connections"
      , Space
      , Str "for"
      , Space
      , Str "delivering"
      , Space
      , Str "power"
      , Space
      , Str "(at"
      , Space
      , Str "the"
      , Space
      , Str "power"
      , Space
      , Str "supply,"
      , Space
      , Str "printed"
      , SoftBreak
      , Str "circuit"
      , Space
      , Str "board,"
      , Space
      , Str "on"
      , Space
      , Str "chip"
      , Space
      , Str "packages"
      , Space
      , Str "as"
      , Space
      , Str "well"
      , Space
      , Str "as"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "silicon"
      , Space
      , Str "dies)"
      , Space
      , Str "also"
      , Space
      , Str "contain"
      , SoftBreak
      , Str "resistance,"
      , Space
      , Str "the"
      , Space
      , Str "variation"
      , Space
      , Str "of"
      , Space
      , Str "electrical"
      , Space
      , Str "current"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "chip\8217s"
      , Space
      , Str "power"
      , Space
      , Str "supply"
      , Space
      , Str "also"
      , SoftBreak
      , Str "results"
      , Space
      , Str "in"
      , Space
      , Str "variations"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "power"
      , Space
      , Str "supply"
      , Space
      , Str "voltage."
      , Space
      , Str "Again,"
      , Space
      , Str "this"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "observed"
      , SoftBreak
      , Str "easily"
      , Space
      , Str "if"
      , Space
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "has"
      , Space
      , Str "physical"
      , Space
      , Str "access"
      , Space
      , Str "to"
      , Space
      , Str "the"
      , Space
      , Str "device."
      , SoftBreak
      , Str "If"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "has"
      , Space
      , Str "access"
      , Space
      , Str "to"
      , Space
      , Str "data"
      , Space
      , Str "acquisition"
      , Space
      , Str "equipment"
      , Space
      , Str "that"
      , Space
      , Str "can"
      , Space
      , Str "record"
      , Space
      , Str "the"
      , SoftBreak
      , Str "current/voltage/power"
      , Space
      , Str "patterns,"
      , Space
      , Str "he/she"
      , Space
      , Str "can"
      , Space
      , Str "record"
      , Space
      , Str "the"
      , Space
      , Quoted
          DoubleQuote [ Str "power" , Space , Str "signature" ]
      , SoftBreak
      , Str "for"
      , Space
      , Str "different"
      , Space
      , Str "crypto"
      , Space
      , Str "operations,"
      , Space
      , Str "including"
      , Space
      , Str "the"
      , Space
      , Str "power"
      , Space
      , Str "signature"
      , Space
      , Str "using"
      , Space
      , Str "different"
      , SoftBreak
      , Str "data"
      , Space
      , Str "inputs."
      , Space
      , Str "By"
      , Space
      , Str "applying"
      , Space
      , Str "analysis"
      , Space
      , Str "techniques"
      , Space
      , Str "like"
      , Space
      , Str "differential"
      , Space
      , Str "power"
      , Space
      , Str "analysis,"
      , SoftBreak
      , Str "the"
      , Space
      , Str "attacker"
      , Space
      , Str "can"
      , Space
      , Str "extract"
      , Space
      , Str "the"
      , Space
      , Str "information"
      , Space
      , Str "being"
      , Space
      , Str "processed."
      , SoftBreak
      , Str "One"
      , Space
      , Str "additional"
      , Space
      , Str "form"
      , Space
      , Str "of"
      , Space
      , Str "side-channel"
      , Space
      , Str "leakage"
      , Space
      , Str "is"
      , Space
      , Str "electro-magnetic"
      , Space
      , Str "radiation."
      , SoftBreak
      , Str "Because"
      , Space
      , Str "the"
      , Space
      , Str "processor\8217s"
      , Space
      , Str "clock"
      , Space
      , Str "frequency"
      , Space
      , Str "is"
      , Space
      , Str "usually"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "radio"
      , Space
      , Str "frequency"
      , Space
      , Str "(RF)"
      , SoftBreak
      , Str "range,"
      , Space
      , Str "the"
      , Space
      , Str "wires"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "die"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , Space
      , Str "tracks"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "PCB"
      , Space
      , Str "become"
      , Space
      , Str "small"
      , Space
      , Str "antennas,"
      , SoftBreak
      , Str "and"
      , Space
      , Str "the"
      , Space
      , Str "ripples"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "processor\8217s"
      , Space
      , Str "voltage/current"
      , Space
      , Str "results"
      , Space
      , Str "in"
      , Space
      , Str "radio"
      , Space
      , Str "frequency"
      , SoftBreak
      , Str "signals."
      , Space
      , Str "Although"
      , Space
      , Str "the"
      , Space
      , Str "RF"
      , Space
      , Str "power"
      , Space
      , Str "radiated"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "tiny,"
      , Space
      , Str "it"
      , Space
      , Str "still"
      , Space
      , Str "means"
      , Space
      , Str "that"
      , Space
      , Str "an"
      , SoftBreak
      , Str "attacker"
      , Space
      , Str "can"
      , Space
      , Str "observe"
      , Space
      , Str "the"
      , Space
      , Str "side-channel"
      , Space
      , Str "leakage"
      , Space
      , Str "if"
      , Space
      , Str "he/she"
      , Space
      , Str "is"
      , Space
      , Str "in"
      , Space
      , Str "close"
      , Space
      , Str "proximity"
      , SoftBreak
      , Str "from"
      , Space
      , Str "the"
      , Space
      , Str "device"
      , Space
      , Str "and"
      , Space
      , Str "has"
      , Space
      , Str "the"
      , Space
      , Str "right"
      , Space
      , Str "equipment"
      , Space
      , Str "to"
      , Space
      , Str "amplify"
      , Space
      , Str "and"
      , Space
      , Str "record"
      , Space
      , Str "the"
      , Space
      , Str "RF"
      , Space
      , Str "power"
      , SoftBreak
      , Str "signature."
      , Space
      , Str "However,"
      , Space
      , Str "the"
      , Space
      , Str "risk"
      , Space
      , Str "of"
      , Space
      , Str "such"
      , Space
      , Str "attack"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "reduced"
      , Space
      , Str "by"
      , Space
      , Str "reducing"
      , Space
      , Str "the"
      , SoftBreak
      , Str "radiation"
      , Space
      , Str "energy"
      , Space
      , Str "level"
      , Space
      , Str "using:"
      ]
  , BulletList
      [ [ Plain
            [ Str "Shielding"
            , Space
            , Str "around"
            , Space
            , Str "the"
            , Space
            , Str "device,"
            , Space
            , Str "including"
            , Space
            , Str "ground"
            , Space
            , Str "plate"
            , Space
            , Str "on"
            , Space
            , Str "the"
            , Space
            , Str "circuit"
            , Space
            , Str "board."
            ]
        ]
      , [ Plain
            [ Str "Coupling"
            , Space
            , Str "capacitors"
            , Space
            , Str "on"
            , Space
            , Str "power"
            , Space
            , Str "supply"
            , Space
            , Str "tracks"
            , Space
            , Str "on"
            , Space
            , Str "the"
            , Space
            , Str "printed"
            , Space
            , Str "circuit"
            , Space
            , Str "board."
            ]
        ]
      ]
  , Para
      [ Str "Generally,"
      , Space
      , Str "such"
      , Space
      , Str "an"
      , Space
      , Str "attack"
      , Space
      , Str "requires"
      , Space
      , Str "knowledge"
      , Space
      , Str "of"
      , Space
      , Str "radio"
      , Space
      , Str "circuit"
      , Space
      , Str "techniques"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , SoftBreak
      , Str "result"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "affected"
      , Space
      , Str "by"
      , Space
      , Str "other"
      , Space
      , Str "factors."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "in"
      , Space
      , Str "normal"
      , Space
      , Str "environments"
      , SoftBreak
      , Str "there"
      , Space
      , Str "are"
      , Space
      , Str "many"
      , Space
      , Str "other"
      , Space
      , Str "source"
      , Space
      , Str "of"
      , Space
      , Str "RF"
      , Space
      , Str "noises"
      , Space
      , Str "that"
      , Space
      , Str "affects"
      , Space
      , Str "the"
      , Space
      , Str "accuracy"
      , Space
      , Str "of"
      , Space
      , Str "signal"
      , SoftBreak
      , Str "measurement."
      , Space
      , Str "In"
      , Space
      , Str "a"
      , Space
      , Quoted DoubleQuote [ Str "noisy" ]
      , Space
      , Str "environment,"
      , Space
      , Str "the"
      , Space
      , Str "RF"
      , Space
      , Str "signals"
      , Space
      , Str "from"
      , Space
      , Str "various"
      , Space
      , Str "wireless"
      , SoftBreak
      , Str "communication"
      , Space
      , Str "gadgets"
      , Space
      , Str "nearby"
      , Space
      , Str "might"
      , Space
      , Str "drown"
      , Space
      , Str "out"
      , Space
      , Str "the"
      , Space
      , Str "signals"
      , Space
      , Str "from"
      , Space
      , Str "the"
      , Space
      , Str "device"
      , Space
      , Str "being"
      , SoftBreak
      , Str "monitored."
      ]
  , Header
      3
      ( "side-channel-leakage-at-instruction-level" , [] , [] )
      [ Str "Side"
      , Space
      , Str "channel"
      , Space
      , Str "leakage"
      , Space
      , Str "at"
      , Space
      , Str "instruction"
      , Space
      , Str "level"
      ]
  , Para
      [ Str "Instruction"
      , Space
      , Str "executions"
      , Space
      , Str "can"
      , Space
      , Str "result"
      , Space
      , Str "in"
      , Space
      , Str "various"
      , Space
      , Str "forms"
      , Space
      , Str "of"
      , Space
      , Str "side"
      , Space
      , Str "channel"
      , Space
      , Str "leakage:"
      ]
  , Para
      [ Str "Cycle"
      , Space
      , Str "timing"
      , Space
      , Str "resulting"
      , Space
      , Str "from"
      , Space
      , Str "conditional"
      , Space
      , Str "branch"
      , Space
      , Str "\8211"
      , Space
      , Str "A"
      , Space
      , Str "code"
      , Space
      , Str "sequence"
      , Space
      , Str "containing"
      , Space
      , Str "a"
      , SoftBreak
      , Str "conditional"
      , Space
      , Str "branch"
      , Space
      , Str "could"
      , Space
      , Str "result"
      , Space
      , Str "in"
      , Space
      , Str "observable"
      , Space
      , Str "side"
      , Space
      , Str "channel"
      , Space
      , Str "leakage."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , SoftBreak
      , Str "if"
      , Space
      , Str "the"
      , Space
      , Str "power"
      , Space
      , Str "signatures"
      , Space
      , Str "of"
      , Space
      , Str "several"
      , Space
      , Str "code"
      , Space
      , Str "segments"
      , Space
      , Str "are"
      , Space
      , Str "easily"
      , Space
      , Str "recognizable"
      , SoftBreak
      , Str "(process"
      , Space
      , Str "A,"
      , Space
      , Str "B"
      , Space
      , Str "and"
      , Space
      , Str "C"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "following"
      , Space
      , Str "diagram),"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , Space
      , Str "possible"
      , Space
      , Str "to"
      , Space
      , Str "detect"
      , Space
      , Str "if"
      , Space
      , Str "the"
      , SoftBreak
      , Str "conditional"
      , Space
      , Str "branch"
      , Space
      , Str "was"
      , Space
      , Str "taken"
      , Space
      , Str "or"
      , Space
      , Str "not."
      ]
  , Figure
      ( "" , [] , [] )
      (Caption
         Nothing
         [ Plain
             [ Str "leakage"
             , Space
             , Str "of"
             , Space
             , Str "conditional"
             , Space
             , Str "branch"
             ]
         ])
      [ Plain
          [ Image
              ( "" , [] , [ ( "width" , "80%" ) ] )
              [ Str "leakage"
              , Space
              , Str "of"
              , Space
              , Str "conditional"
              , Space
              , Str "branch"
              ]
              ( "img/side_channel_leakage_figure_1_branch" , "" )
          ]
      ]
  , Para
      [ Str "Cycle"
      , Space
      , Str "timing"
      , Space
      , Str "resulting"
      , Space
      , Str "from"
      , Space
      , Str "specific"
      , Space
      , Str "data"
      , Space
      , Str "values"
      , Space
      , Str "\8211"
      , Space
      , Str "The"
      , Space
      , Str "execution"
      , Space
      , Str "cycles"
      , Space
      , Str "of"
      , Space
      , Str "some"
      , SoftBreak
      , Str "instructions"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "dependent"
      , Space
      , Str "on"
      , Space
      , Str "the"
      , Space
      , Str "values"
      , Space
      , Str "of"
      , Space
      , Str "input"
      , Space
      , Str "data,"
      , Space
      , Str "resulting"
      , Space
      , Str "in"
      , Space
      , Str "timing"
      , SoftBreak
      , Str "side-channel"
      , Space
      , Str "leakage."
      , Space
      , Str "E.g.,"
      , Space
      , Str "the"
      , Space
      , Str "integer"
      , Space
      , Str "divide"
      , Space
      , Str "instruction"
      , Space
      , Str "in"
      , Space
      , Str "Arm"
      , Space
      , Str "Cortex-M"
      , SoftBreak
      , Str "processors."
      ]
  , Figure
      ( "" , [] , [] )
      (Caption
         Nothing
         [ Plain
             [ Str "leakage"
             , Space
             , Str "of"
             , Space
             , Str "execution"
             , Space
             , Str "cycle"
             ]
         ])
      [ Plain
          [ Image
              ( "" , [] , [ ( "width" , "80%" ) ] )
              [ Str "leakage"
              , Space
              , Str "of"
              , Space
              , Str "execution"
              , Space
              , Str "cycle"
              ]
              ( "img/side_channel_leakage_figure_2_duration" , "" )
          ]
      ]
  , Para
      [ Str "Power"
      , Space
      , Str "variation"
      , Space
      , Str "due"
      , Space
      , Str "to"
      , Space
      , Str "value"
      , Space
      , Str "changes"
      , Space
      , Str "\8211"
      , Space
      , Str "The"
      , Space
      , Str "power"
      , Space
      , Str "spikes"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "power"
      , Space
      , Str "signature"
      , SoftBreak
      , Str "are"
      , Space
      , Str "often"
      , Space
      , Str "dependent"
      , Space
      , Str "on"
      , Space
      , Str "a"
      , Space
      , Str "combination"
      , Space
      , Str "of"
      , Space
      , Str "how"
      , Space
      , Str "many"
      , Space
      , Str "bits"
      , Space
      , Str "are"
      , Space
      , Str "set"
      , Space
      , Str "and"
      , Space
      , Str "how"
      , Space
      , Str "many"
      , Space
      , Str "bits"
      , SoftBreak
      , Str "have"
      , Space
      , Str "toggled"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "register(s)"
      , Space
      , Str "\8212"
      , Space
      , Str "the"
      , Space
      , Str "so-called"
      , Space
      , Str "Hamming"
      , Space
      , Str "weight"
      , Space
      , Str "and"
      , Space
      , Str "Hamming"
      , SoftBreak
      , Str "distance,"
      , Space
      , Str "so"
      , Space
      , Str "the"
      , Space
      , Str "amplitude"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "spike"
      , Space
      , Str "could"
      , Space
      , Str "be"
      , Space
      , Str "used"
      , Space
      , Str "to"
      , Space
      , Str "guess"
      , Space
      , Str "the"
      , Space
      , Str "register"
      , Space
      , Str "value"
      , SoftBreak
      , Str "in"
      , Space
      , Str "that"
      , Space
      , Str "clock"
      , Space
      , Str "cycle."
      , Space
      , Str "The"
      , Space
      , Str "power"
      , Space
      , Str "spikes"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "caused"
      , Space
      , Str "by"
      , Space
      , Str "a"
      , Space
      , Str "combination"
      , Space
      , Str "of"
      ]
  , BulletList
      [ [ Plain
            [ Str "Logic"
            , Space
            , Str "switching"
            , Space
            , Str "due"
            , Space
            , Str "to"
            , Space
            , Str "the"
            , Space
            , Str "operations"
            , Space
            , Str "of"
            , Space
            , Str "an"
            , Space
            , Str "instruction"
            , Space
            , Str "(e.g.\160power"
            , Space
            , Str "consumed"
            , SoftBreak
            , Str "by"
            , Space
            , Str "a"
            , Space
            , Str "single"
            , Space
            , Str "cycle"
            , Space
            , Str "multiplier"
            , Space
            , Str "can"
            , Space
            , Str "be"
            , Space
            , Str "much"
            , Space
            , Str "higher"
            , Space
            , Str "than"
            , Space
            , Str "the"
            , Space
            , Str "power"
            , Space
            , Str "used"
            , Space
            , Str "by"
            , Space
            , Str "a"
            , SoftBreak
            , Str "Boolean"
            , Space
            , Str "logic"
            , Space
            , Str "function),"
            , Space
            , Str "and"
            ]
        ]
      , [ Plain
            [ Str "Logic"
            , Space
            , Str "switching"
            , Space
            , Str "due"
            , Space
            , Str "to"
            , Space
            , Str "changes"
            , Space
            , Str "in"
            , Space
            , Str "data"
            , Space
            , Str "values"
            , Space
            , Str "in"
            , Space
            , Str "the"
            , Space
            , Str "register"
            , Space
            , Str "bank"
            , Space
            , Str "and"
            , Space
            , Str "data"
            , SoftBreak
            , Str "paths."
            ]
        ]
      ]
  , Para
      [ Str "The"
      , Space
      , Str "switching"
      , Space
      , Str "activities"
      , Space
      , Str "are"
      , Space
      , Str "dependent"
      , Space
      , Str "on"
      , Space
      , Str "preceding"
      , Space
      , Str "and"
      , Space
      , Str "next"
      , Space
      , Str "operations."
      , Space
      , Str "If"
      , Space
      , Str "the"
      , SoftBreak
      , Str "power"
      , Space
      , Str "signature"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "codes"
      , Space
      , Str "around"
      , Space
      , Str "a"
      , Space
      , Str "specific"
      , Space
      , Str "instruction"
      , Space
      , Str "is"
      , Space
      , Str "recognizable,"
      , Space
      , Str "then"
      , SoftBreak
      , Str "the"
      , Space
      , Str "data"
      , Space
      , Str "value"
      , Space
      , Str "being"
      , Space
      , Str "process"
      , Space
      , Str "could"
      , Space
      , Str "be"
      , Space
      , Str "guessed."
      ]
  , Figure
      ( "" , [] , [] )
      (Caption
         Nothing
         [ Plain
             [ Str "leakage"
             , Space
             , Str "of"
             , Space
             , Str "number"
             , Space
             , Str "of"
             , Space
             , Str "bit"
             , Space
             , Str "toggled"
             ]
         ])
      [ Plain
          [ Image
              ( "" , [] , [ ( "width" , "80%" ) ] )
              [ Str "leakage"
              , Space
              , Str "of"
              , Space
              , Str "number"
              , Space
              , Str "of"
              , Space
              , Str "bit"
              , Space
              , Str "toggled"
              ]
              ( "img/side_channel_leakage_figure_3_toggle" , "" )
          ]
      ]
  , Para
      [ Str "In"
      , Space
      , Str "some"
      , Space
      , Str "SoC"
      , Space
      , Str "or"
      , Space
      , Str "microcontroller"
      , Space
      , Str "implementations,"
      , Space
      , Str "the"
      , Space
      , Str "power"
      , Space
      , Str "spike"
      , Space
      , Str "effect"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , SoftBreak
      , Str "operations"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "much"
      , Space
      , Str "higher"
      , Space
      , Str "than"
      , Space
      , Str "the"
      , Space
      , Str "effect"
      , Space
      , Str "of"
      , Space
      , Str "data"
      , Space
      , Str "value"
      , Space
      , Str "changes"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , SoftBreak
      , Str "register"
      , Space
      , Str "banks."
      , Space
      , Str "In"
      , Space
      , Str "such"
      , Space
      , Str "case"
      , Space
      , Str "the"
      , Space
      , Str "program"
      , Space
      , Str "execution"
      , Space
      , Str "flow"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "observed,"
      , Space
      , Str "and"
      , SoftBreak
      , Str "as"
      , Space
      , Str "a"
      , Space
      , Str "result,"
      , Space
      , Str "might"
      , Space
      , Str "also"
      , Space
      , Str "indirectly"
      , Space
      , Str "leak"
      , Space
      , Str "information"
      , Space
      , Str "about"
      , Space
      , Str "the"
      , Space
      , Str "data"
      , Space
      , Str "that"
      , Space
      , Str "it"
      , Space
      , Str "is"
      , SoftBreak
      , Str "processing."
      ]
  , Header
      3 ( "countermeasures" , [] , [] ) [ Str "Countermeasures" ]
  , Para
      [ Str "For"
      , Space
      , Str "normal"
      , Space
      , Str "embedded"
      , Space
      , Str "devices"
      , Space
      , Str "that"
      , Space
      , Str "don\8217t"
      , Space
      , Str "have"
      , Space
      , Str "physical"
      , Space
      , Str "protection"
      , Space
      , Str "features,"
      , Space
      , Str "there"
      , SoftBreak
      , Str "is"
      , Space
      , Str "a"
      , Space
      , Str "much"
      , Space
      , Str "higher"
      , Space
      , Str "chance"
      , Space
      , Str "that"
      , Space
      , Str "power/voltage/radiation"
      , Space
      , Str "side"
      , Space
      , Str "channels"
      , Space
      , Str "can"
      , Space
      , Str "result"
      , SoftBreak
      , Str "in"
      , Space
      , Str "information"
      , Space
      , Str "leakage."
      , Space
      , Str "However,"
      , Space
      , Str "some"
      , Space
      , Str "aspects"
      , Space
      , Str "of"
      , Space
      , Str "timing"
      , Space
      , Str "signature"
      , Space
      , Str "leakage"
      , Space
      , Str "could"
      , SoftBreak
      , Str "be"
      , Space
      , Str "reduced:"
      ]
  , BulletList
      [ [ Plain
            [ Str "Using"
            , Space
            , Str "data"
            , Space
            , Str "processing"
            , Space
            , Str "instruction"
            , Space
            , Str "with"
            , Space
            , Str "data"
            , Space
            , Str "independent"
            , Space
            , Str "timing"
            , Space
            , Str "for"
            , SoftBreak
            , Str "cryptographic"
            , Space
            , Str "operations."
            , Space
            , Str "In"
            , Space
            , Str "recent"
            , Space
            , Str "Arm"
            , Space
            , Str "architectures"
            , Space
            , Str "(including"
            , Space
            , Str "Armv8-A"
            , Space
            , Str "and"
            , SoftBreak
            , Str "Armv8-M),"
            , Space
            , Str "some"
            , Space
            , Str "instructions"
            , Space
            , Str "are"
            , Space
            , Str "architecturally"
            , Space
            , Str "defined"
            , Space
            , Str "as"
            , Space
            , Str "DIT"
            , Space
            , Str "(Data"
            , SoftBreak
            , Str "Independent"
            , Space
            , Str "Timing)."
            ]
        ]
      , [ Plain
            [ Str "For"
            , Space
            , Str "conditional"
            , Space
            , Str "branches"
            , Space
            , Str "where"
            , Space
            , Str "the"
            , Space
            , Str "condition"
            , Space
            , Str "is"
            , Space
            , Str "dependent"
            , Space
            , Str "on"
            , Space
            , Str "secret"
            , Space
            , Str "data,"
            , Space
            , Str "use"
            , SoftBreak
            , Str "table"
            , Space
            , Str "branch"
            , Space
            , Str "instead"
            , Space
            , Str "might"
            , Space
            , Str "help"
            , Space
            , Str "reduce"
            , Space
            , Str "timing"
            , Space
            , Str "base"
            , Space
            , Str "leakage"
            , Space
            , Str "(both"
            , Space
            , Str "paths"
            , Space
            , Str "result"
            , SoftBreak
            , Str "in"
            , Space
            , Str "a"
            , Space
            , Str "branch)."
            , Space
            , Str "It"
            , Space
            , Str "is"
            , Space
            , Str "not"
            , Space
            , Str "necessary"
            , Space
            , Str "to"
            , Space
            , Str "replace"
            , Space
            , Str "all"
            , Space
            , Str "conditional"
            , Space
            , Str "branch."
            , Space
            , Str "For"
            , SoftBreak
            , Str "example,"
            , Space
            , Str "many"
            , Space
            , Str "loop"
            , Space
            , Str "counters"
            , Space
            , Str "in"
            , Space
            , Str "crypto"
            , Space
            , Str "operation"
            , Space
            , Str "can"
            , Space
            , Str "be"
            , Space
            , Str "independent"
            , Space
            , Str "to"
            , Space
            , Str "the"
            , SoftBreak
            , Str "crypto"
            , Space
            , Str "key"
            , Space
            , Str "or"
            , Space
            , Str "input"
            , Space
            , Str "data"
            , Space
            , Str "values,"
            , Space
            , Str "so"
            , Space
            , Str "there"
            , Space
            , Str "is"
            , Space
            , Str "no"
            , Space
            , Str "need"
            , Space
            , Str "to"
            , Space
            , Str "change"
            , Space
            , Str "those"
            , Space
            , Str "loops."
            ]
        ]
      ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "There"
          , Space
          , Str "is"
          , Space
          , Str "overlap"
          , Space
          , Str "with"
          , Space
          , Str "section"
          , Space
          , Str "timing-side-channels."
          , Space
          , Str "How"
          , Space
          , Str "to"
          , Space
          , Str "best"
          , Space
          , Str "consolidate"
          , Space
          , Str "that?"
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "182" ]
          ]
      ]
  , Para
      [ Str "There"
      , Space
      , Str "are"
      , Space
      , Str "additional"
      , Space
      , Str "software"
      , Space
      , Str "techniques"
      , Space
      , Str "to"
      , Space
      , Str "mitigate"
      , Space
      , Str "power"
      , Space
      , Str "leakage."
      , Space
      , Str "One"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , SoftBreak
      , Str "most"
      , Space
      , Str "well-known"
      , Space
      , Str "techniques"
      , Space
      , Str "is"
      , Space
      , Str "masking"
      , Space
      , Str "(e.g.\160Boolean,"
      , Space
      , Str "multiplicative,"
      , Space
      , Str "affine)."
      , SoftBreak
      , Str "When"
      , Space
      , Str "applying"
      , Space
      , Str "software"
      , Space
      , Str "mitigation,"
      , Space
      , Str "software"
      , Space
      , Str "developers"
      , Space
      , Str "need"
      , Space
      , Str "to"
      , Space
      , Str "check"
      , Space
      , Str "that"
      , SoftBreak
      , Str "optimizations"
      , Space
      , Str "carried"
      , Space
      , Str "out"
      , Space
      , Str "by"
      , Space
      , Str "compilers"
      , Space
      , Str "(C/C++)"
      , Space
      , Str "do"
      , Space
      , Str "not"
      , Space
      , Str "impact"
      , Space
      , Str "the"
      , Space
      , Str "mitigation,"
      , SoftBreak
      , Str "as"
      , Space
      , Str "compilers"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , Space
      , Str "very"
      , Space
      , Str "smart"
      , Space
      , Str "and"
      , Space
      , Str "undo"
      , Space
      , Str "the"
      , Space
      , Str "masking"
      , Space
      , Str "in"
      , Space
      , Str "order"
      , Space
      , Str "to"
      , Space
      , Str "perform"
      , SoftBreak
      , Str "faster"
      , Space
      , Str "operations"
      , Space
      , Str "(or"
      , Space
      , Str "reducing"
      , Space
      , Str "code"
      , Space
      , Str "size)."
      ]
  , Header
      2
      ( "fault-injection-attacks" , [] , [] )
      [ Str "Fault"
      , Space
      , Str "injection"
      , Space
      , Str "attacks"
      ]
  , Header
      3
      ( "common-forms-of-fault-injection-attacks" , [] , [] )
      [ Str "Common"
      , Space
      , Str "forms"
      , Space
      , Str "of"
      , Space
      , Str "Fault"
      , Space
      , Str "injection"
      , Space
      , Str "attacks"
      ]
  , Para
      [ Str "If"
      , Space
      , Str "an"
      , Space
      , Str "attacker"
      , Space
      , Str "has"
      , Space
      , Str "physical"
      , Space
      , Str "access"
      , Space
      , Str "to"
      , Space
      , Str "a"
      , Space
      , Str "device,"
      , Space
      , Str "they"
      , Space
      , Str "can"
      , Space
      , Str "also"
      , Space
      , Str "choose"
      , Space
      , Str "to"
      , Space
      , Str "use"
      , SoftBreak
      , Str "physical"
      , Space
      , Str "attacks"
      , Space
      , Str "to"
      , Space
      , Str "modify"
      , Space
      , Str "the"
      , Space
      , Str "behavior"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "software,"
      , Space
      , Str "for"
      , Space
      , Str "example,"
      , Space
      , Str "prevent"
      , SoftBreak
      , Str "the"
      , Space
      , Str "software"
      , Space
      , Str "from"
      , Space
      , Str "setting"
      , Space
      , Str "up"
      , Space
      , Str "certain"
      , Space
      , Str "security"
      , Space
      , Str "features"
      , Space
      , Str "during"
      , Space
      , Str "the"
      , Space
      , Str "device\8217s"
      , SoftBreak
      , Str "initialization"
      , Space
      , Str "sequence."
      , Space
      , Str "The"
      , Space
      , Str "two"
      , Space
      , Str "most"
      , Space
      , Str "common"
      , Space
      , Str "forms"
      , Space
      , Str "of"
      , Space
      , Str "such"
      , Space
      , Str "attacks"
      , Space
      , Str "are"
      , Space
      , Str "voltage"
      , SoftBreak
      , Str "glitching"
      , Space
      , Str "and"
      , Space
      , Str "clock"
      , Space
      , Str "glitching."
      ]
  , Figure
      ( "" , [] , [] )
      (Caption
         Nothing
         [ Plain
             [ Str "common"
             , Space
             , Str "fault"
             , Space
             , Str "injection"
             , Space
             , Str "attacks"
             ]
         ])
      [ Plain
          [ Image
              ( "" , [] , [ ( "width" , "80%" ) ] )
              [ Str "common"
              , Space
              , Str "fault"
              , Space
              , Str "injection"
              , Space
              , Str "attacks"
              ]
              ( "img/physical_attacks" , "" )
          ]
      ]
  , BulletList
      [ [ Plain
            [ Str "Voltage"
            , Space
            , Str "glitch"
            , Space
            , Str "attack"
            ]
        , BulletList
            [ [ Plain
                  [ Str "Using"
                  , Space
                  , Str "a"
                  , Space
                  , Str "programmable"
                  , Space
                  , Str "power"
                  , Space
                  , Str "supply"
                  , Space
                  , Str "that"
                  , Space
                  , Str "can"
                  , Space
                  , Str "switch"
                  , Space
                  , Str "the"
                  , Space
                  , Str "voltage"
                  , Space
                  , Str "level"
                  , SoftBreak
                  , Str "rapidly,"
                  , Space
                  , Str "it"
                  , Space
                  , Str "is"
                  , Space
                  , Str "possible"
                  , Space
                  , Str "to"
                  , Space
                  , Str "reduce/increase"
                  , Space
                  , Str "the"
                  , Space
                  , Str "power"
                  , Space
                  , Str "supply"
                  , Space
                  , Str "voltage"
                  , Space
                  , Str "of"
                  , Space
                  , Str "a"
                  , SoftBreak
                  , Str "chip"
                  , Space
                  , Str "at"
                  , Space
                  , Str "specific"
                  , Space
                  , Str "clock"
                  , Space
                  , Str "cycle"
                  , Space
                  , Str "of"
                  , Space
                  , Str "the"
                  , Space
                  , Str "software"
                  , Space
                  , Str "execution."
                  , Space
                  , Str "In"
                  , Space
                  , Str "some"
                  , Space
                  , Str "case,"
                  , Space
                  , Str "a"
                  , SoftBreak
                  , Str "precise"
                  , Space
                  , Str "voltage"
                  , Space
                  , Str "drop"
                  , Space
                  , Str "can"
                  , Space
                  , Str "cause"
                  , Space
                  , Str "a"
                  , Space
                  , Str "processor"
                  , Space
                  , Str "to"
                  , Space
                  , Quoted DoubleQuote [ Str "skip" ]
                  , Space
                  , Str "an"
                  , Space
                  , Str "instruction,"
                  , Space
                  , Str "for"
                  , SoftBreak
                  , Str "example,"
                  , Space
                  , Str "the"
                  , Space
                  , Str "write"
                  , Space
                  , Str "to"
                  , Space
                  , Str "memory"
                  , Space
                  , Str "or"
                  , Space
                  , Str "a"
                  , Space
                  , Str "hardware"
                  , Space
                  , Str "register"
                  , Space
                  , Str "might"
                  , Space
                  , Str "not"
                  , Space
                  , Str "be"
                  , Space
                  , Str "taken."
                  , SoftBreak
                  , Str "Or"
                  , Space
                  , Str "if"
                  , Space
                  , Str "a"
                  , Space
                  , Str "write"
                  , Space
                  , Str "has"
                  , Space
                  , Str "taken"
                  , Space
                  , Str "place,"
                  , Space
                  , Str "the"
                  , Space
                  , Str "actual"
                  , Space
                  , Str "write"
                  , Space
                  , Str "value"
                  , Space
                  , Str "used"
                  , Space
                  , Str "could"
                  , Space
                  , Str "be"
                  , SoftBreak
                  , Str "changed"
                  , Space
                  , Str "by"
                  , Space
                  , Str "the"
                  , Space
                  , Str "voltage"
                  , Space
                  , Str "glitch."
                  ]
              ]
            ]
        ]
      , [ Plain
            [ Str "Clock"
            , Space
            , Str "glitch"
            , Space
            , Str "attack"
            ]
        , BulletList
            [ [ Plain
                  [ Str "Using"
                  , Space
                  , Str "a"
                  , Space
                  , Str "clock"
                  , Space
                  , Str "switching"
                  , Space
                  , Str "circuit,"
                  , Space
                  , Str "it"
                  , Space
                  , Str "is"
                  , Space
                  , Str "possible"
                  , Space
                  , Str "to"
                  , Space
                  , Str "reduce"
                  , Space
                  , Str "the"
                  , Space
                  , Str "width"
                  , Space
                  , Str "of"
                  , Space
                  , Str "a"
                  , SoftBreak
                  , Str "clock"
                  , Space
                  , Str "pulse,"
                  , Space
                  , Str "or"
                  , Space
                  , Str "the"
                  , Space
                  , Str "interval"
                  , Space
                  , Str "between"
                  , Space
                  , Str "two"
                  , Space
                  , Str "clock"
                  , Space
                  , Str "pulses"
                  , Space
                  , Str "so"
                  , Space
                  , Str "that"
                  , Space
                  , Str "some"
                  , Space
                  , Str "of"
                  , Space
                  , Str "the"
                  , SoftBreak
                  , Str "hardware"
                  , Space
                  , Str "registers"
                  , Space
                  , Str "are"
                  , Space
                  , Str "not"
                  , Space
                  , Str "updated"
                  , Space
                  , Str "correctly"
                  , Space
                  , Str "at"
                  , Space
                  , Str "certain"
                  , Space
                  , Str "clock"
                  , Space
                  , Str "edge(s)."
                  , SoftBreak
                  , Str "Similar"
                  , Space
                  , Str "to"
                  , Space
                  , Str "voltage"
                  , Space
                  , Str "glitch,"
                  , Space
                  , Str "this"
                  , Space
                  , Str "can"
                  , Space
                  , Str "make"
                  , Space
                  , Str "the"
                  , Space
                  , Str "hardware"
                  , Space
                  , Str "seems"
                  , Space
                  , Str "to"
                  , Space
                  , Str "be"
                  , SoftBreak
                  , Str "skipping"
                  , Space
                  , Str "an"
                  , Space
                  , Str "instruction."
                  ]
              ]
            ]
        ]
      ]
  , Para
      [ Str "Such"
      , Space
      , Str "voltage/clock"
      , Space
      , Str "glitch"
      , Space
      , Str "attack"
      , Space
      , Str "could"
      , Space
      , Str "affect"
      , Space
      , Str "multiple"
      , Space
      , Str "parts"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "processors,"
      , SoftBreak
      , Str "but"
      , Space
      , Str "sometimes"
      , Space
      , Str "the"
      , Space
      , Str "impact"
      , Space
      , Str "might"
      , Space
      , Str "not"
      , Space
      , Str "lead"
      , Space
      , Str "to"
      , Space
      , Str "any"
      , Space
      , Str "visible"
      , Space
      , Str "error"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "operation,"
      , SoftBreak
      , Str "leaving"
      , Space
      , Str "the"
      , Space
      , Str "only"
      , Space
      , Str "effect"
      , Space
      , Str "that"
      , Space
      , Str "the"
      , Space
      , Str "processor"
      , Space
      , Str "skipping"
      , Space
      , Str "a"
      , Space
      , Str "memory/register"
      , Space
      , Str "write,"
      , Space
      , Str "or"
      , SoftBreak
      , Str "writing"
      , Space
      , Str "an"
      , Space
      , Str "incorrect"
      , Space
      , Str "value."
      , Space
      , Str "Potentially,"
      , Space
      , Str "a"
      , Space
      , Str "glitch"
      , Space
      , Str "attack"
      , Space
      , Str "could"
      , Space
      , Str "result"
      , Space
      , Str "in"
      , Space
      , Str "other"
      , SoftBreak
      , Str "observable"
      , Space
      , Str "effect"
      , Space
      , Str "(e.g.\160register"
      , Space
      , Str "reset,"
      , Space
      , Str "bit"
      , Space
      , Str "toggle)."
      , Space
      , Str "The"
      , Space
      , Str "analysis"
      , Space
      , Str "of"
      , Space
      , Str "fault"
      , SoftBreak
      , Str "injection"
      , Space
      , Str "methods"
      , Space
      , Str "(and"
      , Space
      , Str "their"
      , Space
      , Str "physical"
      , Space
      , Str "effect)"
      , Space
      , Str "and"
      , Space
      , Str "the"
      , Space
      , Str "observable"
      , Space
      , Str "effects"
      , Space
      , Str "at"
      , SoftBreak
      , Str "the"
      , Space
      , Str "program"
      , Space
      , Str "or"
      , Space
      , Str "instruction"
      , Space
      , Str "execution"
      , Space
      , Str "level"
      , Space
      , Str "are"
      , Space
      , Str "often"
      , Space
      , Str "referred"
      , Space
      , Str "to"
      , Space
      , Str "as"
      , Space
      , Str "fault"
      , SoftBreak
      , Str "models,"
      , Space
      , Str "where"
      , Space
      , Str "one"
      , Space
      , Str "can"
      , Space
      , Str "say"
      , Space
      , Str "that"
      , Space
      , Str "a"
      , Space
      , Str "specific"
      , Space
      , Str "fault"
      , Space
      , Str "injection"
      , Space
      , Str "behaves"
      , Space
      , Str "as"
      , Space
      , Str "an"
      , SoftBreak
      , Str "instruction"
      , Space
      , Str "skip,"
      , Space
      , Str "etc."
      , Space
      , Str "More"
      , Space
      , Str "details"
      , Space
      , Str "about"
      , Space
      , Str "the"
      , Space
      , Str "concept"
      , Space
      , Str "of"
      , Space
      , Str "fault"
      , Space
      , Str "models"
      , Space
      , Str "can"
      , Space
      , Str "be"
      , SoftBreak
      , Str "found"
      , Space
      , Str "in"
      , Space
      , Str "the"
      , Space
      , Str "paper"
      , Space
      , Quoted
          DoubleQuote
          [ Str "Fault"
          , Space
          , Str "Attacks"
          , Space
          , Str "on"
          , Space
          , Str "Secure"
          , Space
          , Str "Embedded"
          , Space
          , Str "Software:"
          , Space
          , Str "Threats,"
          , Space
          , Str "Design"
          , SoftBreak
          , Str "and"
          , Space
          , Str "Evaluation"
          ]
      , Space
      , Str "(https://arxiv.org/pdf/2003.10513.pdf),"
      , Space
      , Str "where"
      , Space
      , Str "a"
      , Space
      , Str "good"
      , SoftBreak
      , Str "illustration"
      , Space
      , Str "of"
      , Space
      , Str "the"
      , Space
      , Str "concept"
      , Space
      , Str "is"
      , Space
      , Str "shown"
      , Space
      , Str "in"
      , Space
      , Str "figure"
      , Space
      , Str "1"
      , Space
      , Str "of"
      , Space
      , Str "that"
      , Space
      , Str "paper."
      ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "Make"
          , Space
          , Str "the"
          , Space
          , Str "above"
          , Space
          , Str "reference"
          , Space
          , Str "to"
          , Space
          , Str "a"
          , Space
          , Str "paper"
          , Space
          , Str "use"
          , Space
          , Str "bibtex."
          , SoftBreak
          , Span ( "" , [ "issue" ] , [] ) [ Str "159" ]
          ]
      ]
  , Para
      [ Str "Using"
      , Space
      , Str "glitching"
      , Space
      , Str "methods,"
      , Space
      , Str "there"
      , Space
      , Str "are"
      , Space
      , Str "several"
      , Space
      , Str "common"
      , Space
      , Str "ways"
      , Space
      , Str "of"
      , Space
      , Str "attacking"
      , Space
      , Str "a"
      , Space
      , Str "system."
      , SoftBreak
      , Str "For"
      , Space
      , Str "example:"
      ]
  , BulletList
      [ [ Plain
            [ Str "Skipping"
            , Space
            , Str "an"
            , Space
            , Str "instruction"
            , Space
            , Str "during"
            , Space
            , Str "setup"
            , Space
            , Str "sequence"
            , Space
            , Str "for"
            , Space
            , Str "security"
            , Space
            , Str "features"
            , Space
            , Str "\8211"
            , Space
            , Str "e.g."
            , SoftBreak
            , Str "skipping"
            , Space
            , Str "the"
            , Space
            , Str "write"
            , Space
            , Str "to"
            , Space
            , Str "the"
            , Space
            , Str "MPU"
            , Space
            , Str "(Memory"
            , Space
            , Str "Protection"
            , Space
            , Str "Unit)/Security"
            , Space
            , Str "Attribution"
            , SoftBreak
            , Str "Unit"
            , Space
            , Str "(SAU)"
            , Space
            , Str "so"
            , Space
            , Str "that"
            , Space
            , Str "the"
            , Space
            , Str "MPU/SAU"
            , Space
            , Str "is"
            , Space
            , Str "not"
            , Space
            , Str "enabled."
            ]
        ]
      , [ Plain
            [ Str "Skipping"
            , Space
            , Str "an"
            , Space
            , Str "instruction"
            , Space
            , Str "after"
            , Space
            , Str "a"
            , Space
            , Str "security"
            , Space
            , Str "authentication"
            , Space
            , Str "that"
            , Space
            , Str "branch"
            , Space
            , Str "to"
            , Space
            , Str "an"
            , SoftBreak
            , Str "error"
            , Space
            , Str "handling"
            , Space
            , Str "code."
            , Space
            , Str "As"
            , Space
            , Str "the"
            , Space
            , Str "branch"
            , Space
            , Str "is"
            , Space
            , Str "not"
            , Space
            , Str "taken,"
            , Space
            , Str "the"
            , Space
            , Str "code"
            , Space
            , Str "can"
            , Space
            , Str "continue"
            , Space
            , Str "to"
            , SoftBreak
            , Str "operate"
            , Space
            , Str "even"
            , Space
            , Str "a"
            , Space
            , Str "security"
            , Space
            , Str "authentication"
            , Space
            , Str "has"
            , Space
            , Str "failed."
            ]
        ]
      , [ Plain
            [ Str "Causing"
            , Space
            , Str "an"
            , Space
            , Str "incorrect"
            , Space
            , Str "value"
            , Space
            , Str "to"
            , Space
            , Str "be"
            , Space
            , Str "written"
            , Space
            , Str "in"
            , Space
            , Str "a"
            , Space
            , Str "memory"
            , Space
            , Str "or"
            , Space
            , Str "hardware."
            , Space
            , Str "E.g."
            , Space
            , Str "When"
            , SoftBreak
            , Str "writing"
            , Space
            , Str "a"
            , Space
            , Str "crypto"
            , Space
            , Str "key"
            , Space
            , Str "to"
            , Space
            , Str "a"
            , Space
            , Str "crypto"
            , Space
            , Str "accelerator,"
            , Space
            , Str "forcing"
            , Space
            , Str "the"
            , Space
            , Str "key"
            , Space
            , Str "value"
            , Space
            , Str "written"
            , SoftBreak
            , Str "to"
            , Space
            , Str "be"
            , Space
            , Str "zero"
            , Space
            , Str "(caused"
            , Space
            , Str "to"
            , Space
            , Str "low"
            , Space
            , Str "voltage"
            , Space
            , Str "on"
            , Space
            , Str "bus"
            , Space
            , Str "hardware)."
            ]
        ]
      ]
  , Para
      [ Str "Example:"
      , Space
      , Str "Attack"
      , Space
      , Str "on"
      , Space
      , Str "TrustZone"
      , Space
      , Str "for"
      , Space
      , Str "Armv8-M:"
      , Space
      , Str "https://www.youtube.com/watch?v=4u6BAH8mEDw"
      ]
  , Para
      [ Str "There"
      , Space
      , Str "are"
      , Space
      , Str "other"
      , Space
      , Str "forms"
      , Space
      , Str "of"
      , Space
      , Str "physical"
      , Space
      , Str "attacks,"
      , Space
      , Str "but"
      , Space
      , Str "most"
      , Space
      , Str "of"
      , Space
      , Str "them"
      , Space
      , Str "requires"
      , SoftBreak
      , Str "significant"
      , Space
      , Str "effort"
      , Space
      , Str "or"
      , Space
      , Str "cost"
      , Space
      , Str "(e.g.\160cut"
      , Space
      , Str "open"
      , Space
      , Str "the"
      , Space
      , Str "chip"
      , Space
      , Str "package"
      , Space
      , Str "can"
      , Space
      , Str "carry"
      , Space
      , Str "out"
      , SoftBreak
      , Str "fault"
      , Space
      , Str "injection"
      , Space
      , Str "or"
      , Space
      , Str "readout"
      , Space
      , Str "secret"
      , Space
      , Str "data"
      , Space
      , Str "on"
      , Space
      , Str "chip)."
      ]
  , Header
      3
      ( "countermeasures-1" , [] , [] )
      [ Str "Countermeasures" ]
  , Para
      [ Str "Ideally,"
      , Space
      , Str "system"
      , Space
      , Str "designers"
      , Space
      , Str "can"
      , Space
      , Str "use"
      , Space
      , Str "hardware"
      , Space
      , Str "(SoCs"
      , Space
      , Str "or"
      , Space
      , Str "microcontroller)"
      , Space
      , Str "that"
      , SoftBreak
      , Str "support"
      , Space
      , Str "protection"
      , Space
      , Str "against"
      , Space
      , Str "fault"
      , Space
      , Str "injection."
      , Space
      , Str "For"
      , Space
      , Str "example,"
      , Space
      , Str "a"
      , Space
      , Str "hardware"
      , Space
      , Str "circuit"
      , SoftBreak
      , Str "can"
      , Space
      , Str "include"
      , Space
      , Str "redundancy"
      , Space
      , Str "logic"
      , Space
      , Str "(spatial"
      , Space
      , Str "and"
      , Space
      , Str "temporal)."
      , Space
      , Str "In"
      , Space
      , Str "addition,"
      , Space
      , Str "software"
      , SoftBreak
      , Str "developers"
      , Space
      , Str "can"
      , Space
      , Str "make"
      , Space
      , Str "such"
      , Space
      , Str "attack"
      , Space
      , Str "harder"
      , Space
      , Str "by"
      , Space
      , Str "adding"
      , Space
      , Str "checks"
      , Space
      , Str "after"
      , Space
      , Str "the"
      , Space
      , Str "write"
      , SoftBreak
      , Str "operations."
      , SoftBreak
      , Str "When"
      , Space
      , Str "applying"
      , Space
      , Str "software"
      , Space
      , Str "mitigation,"
      , Space
      , Str "software"
      , Space
      , Str "developers"
      , Space
      , Str "need"
      , Space
      , Str "to"
      , Space
      , Str "check"
      , Space
      , Str "that"
      , SoftBreak
      , Str "optimizations"
      , Space
      , Str "carried"
      , Space
      , Str "out"
      , Space
      , Str "by"
      , Space
      , Str "compilers"
      , Space
      , Str "(C/C++)"
      , Space
      , Str "do"
      , Space
      , Str "not"
      , Space
      , Str "impact"
      , Space
      , Str "the"
      , Space
      , Str "mitigation."
      ]
  , Header
      1
      ( "other-security-topics-relevant-for-compiler-developers"
      , []
      , []
      )
      [ Str "Other"
      , Space
      , Str "security"
      , Space
      , Str "topics"
      , Space
      , Str "relevant"
      , Space
      , Str "for"
      , Space
      , Str "compiler"
      , Space
      , Str "developers"
      ]
  , Div
      ( "" , [ "TODO" ] , [] )
      [ Para
          [ Str "Write"
          , Space
          , Str "chapter"
          , Space
          , Str "with"
          , Space
          , Str "other"
          , Space
          , Str "security"
          , Space
          , Str "topics."
          ]
      ]
  , Header
      1
      ( "appendix-contribution-guidelines"
      , [ "unnumbered" ]
      , []
      )
      [ Str "Appendix:"
      , Space
      , Str "contribution"
      , Space
      , Str "guidelines"
      ]
  , Para
      [ Str "If"
      , Space
      , Str "you\8217d"
      , Space
      , Str "like"
      , Space
      , Str "to"
      , Space
      , Str "start"
      , Space
      , Str "contributing"
      , Space
      , Str "to"
      , Space
      , Str "this"
      , Space
      , Str "book:"
      , Space
      , Str "please"
      , Space
      , Str "do,"
      , Space
      , Str "we\8217re"
      , Space
      , Str "looking"
      , SoftBreak
      , Str "forward"
      , Space
      , Str "to"
      , Space
      , Str "your"
      , Space
      , Str "contributions!"
      ]
  , Para
      [ Str "The"
      , Space
      , Str "project"
      , Space
      , Str "lives"
      , Space
      , Str "on"
      , Space
      , Str "github"
      , Space
      , Str "at"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "https://github.com/llsoftsec/llsoftsecbook" ]
          ( "https://github.com/llsoftsec/llsoftsecbook" , "" )
      , Str "."
      , SoftBreak
      , Str "We"
      , Space
      , Str "also"
      , Space
      , Str "have"
      , Space
      , Str "a"
      , Space
      , Str "Discord"
      , Space
      , Str "server"
      , Space
      , Str "where"
      , Space
      , Str "you"
      , Space
      , Str "can"
      , Space
      , Str "have"
      , Space
      , Str "an"
      , Space
      , Str "interactive"
      , Space
      , Str "chat"
      , Space
      , Str "with"
      , Space
      , Str "us"
      , Space
      , Str "at"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "https://discord.gg/Bm55Z9Ppgn" ]
          ( "https://discord.gg/Bm55Z9Ppgn" , "" )
      , Str "."
      ]
  , Para
      [ Str "We"
      , Space
      , Str "use"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "github" , Space , Str "issues" ]
          ( "https://github.com/llsoftsec/llsoftsecbook/issues" , "" )
      , Space
      , Str "as"
      , Space
      , Str "our"
      , SoftBreak
      , Str "issue"
      , Space
      , Str "tracker"
      , Space
      , Str "and"
      , Space
      , Str "use"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "github"
          , Space
          , Str "pull"
          , Space
          , Str "requests"
          ]
          ( "https://github.com/llsoftsec/llsoftsecbook/pulls" , "" )
      , Space
      , Str "to"
      , SoftBreak
      , Str "accept"
      , Space
      , Str "edits,"
      , Space
      , Str "changes,"
      , Space
      , Str "additions"
      , Space
      , Str "and"
      , Space
      , Str "more."
      ]
  , Para
      [ Str "If"
      , Space
      , Str "you\8217d"
      , Space
      , Str "like"
      , Space
      , Str "to"
      , Space
      , Str "contribute,"
      , Space
      , Str "but"
      , Space
      , Str "are"
      , Space
      , Str "not"
      , Space
      , Str "sure"
      , Space
      , Str "where"
      , Space
      , Str "to"
      , Space
      , Str "start,"
      , Space
      , Str "the"
      , Space
      , Str "list"
      , Space
      , Str "of"
      , SoftBreak
      , Str "open"
      , Space
      , Str "issues"
      , Space
      , Str "labeled"
      , Space
      , Str "with"
      , Space
      , Quoted
          DoubleQuote
          [ Link
              ( "" , [] , [] )
              [ Str "good" , Space , Str "first" , Space , Str "issue" ]
              ( "https://github.com/llsoftsec/llsoftsecbook/issues?q=is%3Aissue+is%3Aopen+label%3A%22good+first+issue%22"
              , ""
              )
          ]
      , Space
      , Str "may"
      , Space
      , Str "give"
      , Space
      , Str "you"
      , Space
      , Str "inspiration"
      , Space
      , Str "of"
      , Space
      , Str "things"
      , Space
      , Str "to"
      , Space
      , Str "contribute."
      , Space
      , Str "Please,"
      , Space
      , Str "also"
      , SoftBreak
      , Str "don\8217t"
      , Space
      , Str "be"
      , Space
      , Str "shy"
      , Space
      , Str "to"
      , Space
      , Str "reach"
      , Space
      , Str "out"
      , Space
      , Str "to"
      , Space
      , Str "us"
      , Space
      , Str "on"
      , Space
      , Link
          ( "" , [] , [] )
          [ Str "Discord" ]
          ( "https://discord.gg/Bm55Z9Ppgn" , "" )
      , Str "."
      ]
  , Para
      [ Str "We"
      , Space
      , Str "follow"
      , Space
      , Str "the"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "Contributor"
          , Space
          , Str "Covenant"
          , Space
          , Str "Code"
          , Space
          , Str "of"
          , Space
          , Str "Conduct"
          ]
          ( "https://github.com/llsoftsec/llsoftsecbook/blob/main/CODE_OF_CONDUCT.md"
          , ""
          )
      , SoftBreak
      , Str "in"
      , Space
      , Str "this"
      , Space
      , Str "project."
      ]
  , Para
      [ Str "For"
      , Space
      , Str "more"
      , Space
      , Str "details"
      , Space
      , Str "on"
      , Space
      , Str "how"
      , Space
      , Str "to"
      , Space
      , Str "write"
      , Space
      , Str "text"
      , Space
      , Str "for"
      , Space
      , Str "the"
      , Space
      , Str "book,"
      , Space
      , Str "please"
      , Space
      , Str "read"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "contributing.md" ]
          ( "https://github.com/llsoftsec/llsoftsecbook/blob/main/contributing.md"
          , ""
          )
      , Str "."
      , SoftBreak
      , Str "If"
      , Space
      , Str "after"
      , Space
      , Str "reading"
      , Space
      , Str "that,"
      , Space
      , Str "you"
      , Space
      , Str "think"
      , Space
      , Str "some"
      , Space
      , Str "specific"
      , Space
      , Str "aspects"
      , Space
      , Str "could"
      , Space
      , Str "be"
      , Space
      , Str "explained"
      , SoftBreak
      , Str "better,"
      , Space
      , Str "please"
      , Space
      , Str "do"
      , Space
      , Str "let"
      , Space
      , Str "us"
      , Space
      , Str "know"
      , Space
      , Str "by"
      , Space
      , Str "raising"
      , Space
      , Str "an"
      , SoftBreak
      , Link
          ( "" , [] , [] )
          [ Str "issue" ]
          ( "https://github.com/llsoftsec/llsoftsecbook/issues/new"
          , ""
          )
      , Str "."
      ]
  , RawBlock (Format "tex") "\\printindex"
  , RawBlock (Format "tex") "\\listoftodos"
  , Header
      1
      ( "references" , [ "unnumbered" ] , [] )
      [ Str "References" ]
  , Div ( "refs" , [] , [] ) []
  ]
